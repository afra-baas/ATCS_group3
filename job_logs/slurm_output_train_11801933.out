Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
****Start Time: 2023-05-21_21-57-19
Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
----------- 42 de google/flan-t5-base NLI active 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  6.56it/s]100%|██████████| 3/3 [00:00<00:00, 18.86it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.3146e-04],
        [1.7340e-03],
        [7.6997e-04],
        [5.0467e-04],
        [3.3514e-03],
        [9.2658e-04],
        [2.9566e-04],
        [3.0719e-03],
        [9.1777e-04],
        [1.5432e-03],
        [2.3695e-04],
        [1.6007e-03],
        [4.5767e-04],
        [1.9776e-03],
        [1.8417e-07],
        [1.6674e-03]], device='cuda:0') / tensor([[2.3146e-04, 1.7340e-03, 7.6997e-04, 5.0467e-04, 3.3514e-03, 9.2658e-04,
         2.9566e-04, 3.0719e-03, 9.1777e-04, 1.5432e-03, 2.3695e-04, 1.6007e-03,
         4.5767e-04, 1.9776e-03, 1.8417e-07, 1.6674e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.3910e-04],
        [1.9979e-03],
        [5.8655e-03],
        [7.1136e-04],
        [9.7467e-04],
        [1.0076e-03],
        [2.0746e-03],
        [1.9213e-03],
        [4.6745e-03],
        [1.7980e-03],
        [2.3023e-04],
        [2.8540e-03],
        [5.1193e-04],
        [3.7386e-03],
        [1.0031e-07],
        [4.0157e-03]], device='cuda:0') / tensor([[5.3910e-04, 1.9979e-03, 5.8655e-03, 7.1136e-04, 9.7467e-04, 1.0076e-03,
         2.0746e-03, 1.9213e-03, 4.6745e-03, 1.7980e-03, 2.3023e-04, 2.8540e-03,
         5.1193e-04, 3.7386e-03, 1.0031e-07, 4.0157e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[9.6731e-06],
        [1.4560e-04],
        [6.0637e-05],
        [2.5533e-05],
        [1.2846e-04],
        [5.0035e-05],
        [2.5622e-05],
        [1.4341e-04],
        [1.3961e-04],
        [3.8218e-05],
        [7.4898e-06],
        [2.9560e-04],
        [5.3205e-06],
        [1.7313e-04],
        [5.0943e-09],
        [3.3372e-04]], device='cuda:0') / tensor([[9.6731e-06, 1.4560e-04, 6.0637e-05, 2.5533e-05, 1.2846e-04, 5.0035e-05,
         2.5622e-05, 1.4341e-04, 1.3961e-04, 3.8218e-05, 7.4898e-06, 2.9560e-04,
         5.3205e-06, 1.7313e-04, 5.0943e-09, 3.3372e-04]], device='cuda:0')
answers_probs: tensor([[2.3146e-04, 5.3910e-04, 9.6731e-06],
        [1.7340e-03, 1.9979e-03, 1.4560e-04],
        [7.6997e-04, 5.8655e-03, 6.0637e-05],
        [5.0467e-04, 7.1136e-04, 2.5533e-05],
        [3.3514e-03, 9.7467e-04, 1.2846e-04],
        [9.2658e-04, 1.0076e-03, 5.0035e-05],
        [2.9566e-04, 2.0746e-03, 2.5622e-05],
        [3.0719e-03, 1.9213e-03, 1.4341e-04],
        [9.1777e-04, 4.6745e-03, 1.3961e-04],
        [1.5432e-03, 1.7980e-03, 3.8218e-05],
        [2.3695e-04, 2.3023e-04, 7.4898e-06],
        [1.6007e-03, 2.8540e-03, 2.9560e-04],
        [4.5767e-04, 5.1193e-04, 5.3205e-06],
        [1.9776e-03, 3.7386e-03, 1.7313e-04],
        [1.8417e-07, 1.0031e-07, 5.0943e-09],
        [1.6674e-03, 4.0157e-03, 3.3372e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.9306e-03],
        [4.8617e-04],
        [2.9181e-04],
        [9.8698e-05],
        [4.4437e-04],
        [1.6815e-03],
        [1.6380e-07],
        [4.1698e-04],
        [2.1575e-03],
        [1.1953e-03],
        [4.1880e-04],
        [1.5368e-03],
        [2.2252e-04],
        [4.5914e-04],
        [9.2759e-04],
        [1.5242e-03]], device='cuda:0') / tensor([[1.9306e-03, 4.8617e-04, 2.9181e-04, 9.8698e-05, 4.4437e-04, 1.6815e-03,
         1.6380e-07, 4.1698e-04, 2.1575e-03, 1.1953e-03, 4.1880e-04, 1.5368e-03,
         2.2252e-04, 4.5914e-04, 9.2759e-04, 1.5242e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[7.6629e-04],
        [7.6333e-04],
        [4.3109e-04],
        [3.7431e-04],
        [1.7442e-04],
        [3.6647e-03],
        [8.1343e-08],
        [1.0900e-03],
        [1.2511e-03],
        [1.7159e-03],
        [1.0577e-03],
        [1.4266e-03],
        [1.6796e-04],
        [1.2485e-03],
        [7.9882e-04],
        [7.2077e-04]], device='cuda:0') / tensor([[7.6629e-04, 7.6333e-04, 4.3109e-04, 3.7431e-04, 1.7442e-04, 3.6647e-03,
         8.1343e-08, 1.0900e-03, 1.2511e-03, 1.7159e-03, 1.0577e-03, 1.4266e-03,
         1.6796e-04, 1.2485e-03, 7.9882e-04, 7.2077e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.1685e-04],
        [3.1709e-05],
        [7.6564e-05],
        [7.2145e-06],
        [1.5985e-05],
        [9.9421e-05],
        [3.7535e-09],
        [2.9165e-05],
        [1.8749e-04],
        [9.2178e-05],
        [3.3930e-05],
        [9.6777e-05],
        [2.7915e-06],
        [2.6150e-05],
        [2.2351e-04],
        [7.4085e-05]], device='cuda:0') / tensor([[1.1685e-04, 3.1709e-05, 7.6564e-05, 7.2145e-06, 1.5985e-05, 9.9421e-05,
         3.7535e-09, 2.9165e-05, 1.8749e-04, 9.2178e-05, 3.3930e-05, 9.6777e-05,
         2.7915e-06, 2.6150e-05, 2.2351e-04, 7.4085e-05]], device='cuda:0')
answers_probs: tensor([[1.9306e-03, 7.6629e-04, 1.1685e-04],
        [4.8617e-04, 7.6333e-04, 3.1709e-05],
        [2.9181e-04, 4.3109e-04, 7.6564e-05],
        [9.8698e-05, 3.7431e-04, 7.2145e-06],
        [4.4437e-04, 1.7442e-04, 1.5985e-05],
        [1.6815e-03, 3.6647e-03, 9.9421e-05],
        [1.6380e-07, 8.1343e-08, 3.7535e-09],
        [4.1698e-04, 1.0900e-03, 2.9165e-05],
        [2.1575e-03, 1.2511e-03, 1.8749e-04],
        [1.1953e-03, 1.7159e-03, 9.2178e-05],
        [4.1880e-04, 1.0577e-03, 3.3930e-05],
        [1.5368e-03, 1.4266e-03, 9.6777e-05],
        [2.2252e-04, 1.6796e-04, 2.7915e-06],
        [4.5914e-04, 1.2485e-03, 2.6150e-05],
        [9.2759e-04, 7.9882e-04, 2.2351e-04],
        [1.5242e-03, 7.2077e-04, 7.4085e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[6.4983e-04],
        [4.4570e-03],
        [1.3410e-03],
        [2.6813e-03],
        [5.3692e-04],
        [4.1773e-03],
        [1.1489e-03],
        [1.1249e-03],
        [1.6681e-07],
        [9.0645e-04],
        [3.3593e-03],
        [1.4483e-03],
        [9.4765e-04],
        [3.3854e-04],
        [8.8871e-04],
        [2.4961e-03]], device='cuda:0') / tensor([[6.4983e-04, 4.4570e-03, 1.3410e-03, 2.6813e-03, 5.3692e-04, 4.1773e-03,
         1.1489e-03, 1.1249e-03, 1.6681e-07, 9.0645e-04, 3.3593e-03, 1.4483e-03,
         9.4765e-04, 3.3854e-04, 8.8871e-04, 2.4961e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.9712e-03],
        [2.8901e-03],
        [4.8938e-03],
        [1.6402e-04],
        [8.6965e-04],
        [4.6890e-03],
        [2.0164e-03],
        [3.9292e-03],
        [3.3448e-08],
        [2.8085e-03],
        [3.5950e-03],
        [1.4380e-03],
        [5.6067e-03],
        [6.0438e-04],
        [9.4065e-04],
        [1.2026e-03]], device='cuda:0') / tensor([[2.9712e-03, 2.8901e-03, 4.8938e-03, 1.6402e-04, 8.6965e-04, 4.6890e-03,
         2.0164e-03, 3.9292e-03, 3.3448e-08, 2.8085e-03, 3.5950e-03, 1.4380e-03,
         5.6067e-03, 6.0438e-04, 9.4065e-04, 1.2026e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[2.0611e-05],
        [1.0458e-04],
        [5.2688e-05],
        [1.2059e-04],
        [2.8868e-05],
        [1.8467e-04],
        [6.5887e-05],
        [6.3326e-05],
        [9.8851e-09],
        [6.5087e-05],
        [2.0680e-04],
        [4.9744e-05],
        [1.2819e-04],
        [1.1843e-05],
        [6.9060e-05],
        [1.9464e-05]], device='cuda:0') / tensor([[2.0611e-05, 1.0458e-04, 5.2688e-05, 1.2059e-04, 2.8868e-05, 1.8467e-04,
         6.5887e-05, 6.3326e-05, 9.8851e-09, 6.5087e-05, 2.0680e-04, 4.9744e-05,
         1.2819e-04, 1.1843e-05, 6.9060e-05, 1.9464e-05]], device='cuda:0')
answers_probs: tensor([[6.4983e-04, 2.9712e-03, 2.0611e-05],
        [4.4570e-03, 2.8901e-03, 1.0458e-04],
        [1.3410e-03, 4.8938e-03, 5.2688e-05],
        [2.6813e-03, 1.6402e-04, 1.2059e-04],
        [5.3692e-04, 8.6965e-04, 2.8868e-05],
        [4.1773e-03, 4.6890e-03, 1.8467e-04],
        [1.1489e-03, 2.0164e-03, 6.5887e-05],
        [1.1249e-03, 3.9292e-03, 6.3326e-05],
        [1.6681e-07, 3.3448e-08, 9.8851e-09],
        [9.0645e-04, 2.8085e-03, 6.5087e-05],
        [3.3593e-03, 3.5950e-03, 2.0680e-04],
        [1.4483e-03, 1.4380e-03, 4.9744e-05],
        [9.4765e-04, 5.6067e-03, 1.2819e-04],
        [3.3854e-04, 6.0438e-04, 1.1843e-05],
        [8.8871e-04, 9.4065e-04, 6.9060e-05],
        [2.4961e-03, 1.2026e-03, 1.9464e-05]], device='cuda:0')
acc:  0.375
Time taken to execute the de NLI task with prompt type active, variation 0 and batchsize 16: 0:02:53.161782
path ['42', 'de', 'flan', 'NLI', 'active', 'prompt_id_0']
----------- 42 de google/flan-t5-base NLI active 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 283.93it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.9498e-03],
        [9.1054e-04],
        [1.8908e-03],
        [4.1345e-03],
        [2.8472e-03],
        [1.0873e-03],
        [1.9398e-03],
        [1.7871e-07],
        [1.0941e-03],
        [5.8113e-04],
        [2.8811e-03],
        [4.7764e-04],
        [2.4430e-03],
        [3.9351e-03],
        [1.9840e-03],
        [1.2503e-03]], device='cuda:0') / tensor([[1.9498e-03, 9.1054e-04, 1.8908e-03, 4.1345e-03, 2.8472e-03, 1.0873e-03,
         1.9398e-03, 1.7871e-07, 1.0941e-03, 5.8113e-04, 2.8811e-03, 4.7764e-04,
         2.4430e-03, 3.9351e-03, 1.9840e-03, 1.2503e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.2863e-03],
        [4.7714e-03],
        [6.3270e-03],
        [1.5256e-02],
        [8.9155e-03],
        [1.8979e-03],
        [6.9453e-03],
        [2.6723e-07],
        [2.9418e-03],
        [2.5565e-03],
        [1.2898e-02],
        [2.6668e-04],
        [1.7978e-02],
        [7.1913e-03],
        [4.1892e-03],
        [4.2241e-03]], device='cuda:0') / tensor([[5.2863e-03, 4.7714e-03, 6.3270e-03, 1.5256e-02, 8.9155e-03, 1.8979e-03,
         6.9453e-03, 2.6723e-07, 2.9418e-03, 2.5565e-03, 1.2898e-02, 2.6668e-04,
         1.7978e-02, 7.1913e-03, 4.1892e-03, 4.2241e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[9.9505e-04],
        [7.5228e-04],
        [2.0771e-03],
        [1.2134e-03],
        [2.8374e-03],
        [2.3053e-04],
        [6.1256e-04],
        [1.3751e-08],
        [2.6009e-04],
        [3.4821e-04],
        [1.2106e-03],
        [3.7638e-04],
        [3.8399e-03],
        [1.6324e-03],
        [6.5945e-04],
        [5.6376e-04]], device='cuda:0') / tensor([[9.9505e-04, 7.5228e-04, 2.0771e-03, 1.2134e-03, 2.8374e-03, 2.3053e-04,
         6.1256e-04, 1.3751e-08, 2.6009e-04, 3.4821e-04, 1.2106e-03, 3.7638e-04,
         3.8399e-03, 1.6324e-03, 6.5945e-04, 5.6376e-04]], device='cuda:0')
answers_probs: tensor([[1.9498e-03, 5.2863e-03, 9.9505e-04],
        [9.1054e-04, 4.7714e-03, 7.5228e-04],
        [1.8908e-03, 6.3270e-03, 2.0771e-03],
        [4.1345e-03, 1.5256e-02, 1.2134e-03],
        [2.8472e-03, 8.9155e-03, 2.8374e-03],
        [1.0873e-03, 1.8979e-03, 2.3053e-04],
        [1.9398e-03, 6.9453e-03, 6.1256e-04],
        [1.7871e-07, 2.6723e-07, 1.3751e-08],
        [1.0941e-03, 2.9418e-03, 2.6009e-04],
        [5.8113e-04, 2.5565e-03, 3.4821e-04],
        [2.8811e-03, 1.2898e-02, 1.2106e-03],
        [4.7764e-04, 2.6668e-04, 3.7638e-04],
        [2.4430e-03, 1.7978e-02, 3.8399e-03],
        [3.9351e-03, 7.1913e-03, 1.6324e-03],
        [1.9840e-03, 4.1892e-03, 6.5945e-04],
        [1.2503e-03, 4.2241e-03, 5.6376e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.3758e-03],
        [3.8196e-04],
        [5.9653e-04],
        [2.0567e-07],
        [2.8304e-04],
        [1.1471e-03],
        [1.1034e-03],
        [1.5389e-03],
        [2.5829e-04],
        [3.6924e-04],
        [1.9377e-03],
        [8.4148e-04],
        [5.5102e-04],
        [1.0587e-03],
        [1.6775e-03],
        [1.2124e-03]], device='cuda:0') / tensor([[1.3758e-03, 3.8196e-04, 5.9653e-04, 2.0567e-07, 2.8304e-04, 1.1471e-03,
         1.1034e-03, 1.5389e-03, 2.5829e-04, 3.6924e-04, 1.9377e-03, 8.4148e-04,
         5.5102e-04, 1.0587e-03, 1.6775e-03, 1.2124e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.3593e-03],
        [1.4938e-03],
        [2.4471e-03],
        [3.6183e-07],
        [1.6025e-03],
        [5.4000e-03],
        [5.0025e-03],
        [4.6350e-03],
        [1.4907e-03],
        [4.8320e-03],
        [1.3352e-02],
        [2.5487e-03],
        [1.4132e-03],
        [3.1616e-03],
        [6.7579e-03],
        [1.9210e-03]], device='cuda:0') / tensor([[9.3593e-03, 1.4938e-03, 2.4471e-03, 3.6183e-07, 1.6025e-03, 5.4000e-03,
         5.0025e-03, 4.6350e-03, 1.4907e-03, 4.8320e-03, 1.3352e-02, 2.5487e-03,
         1.4132e-03, 3.1616e-03, 6.7579e-03, 1.9210e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.8558e-04],
        [5.0476e-04],
        [2.2549e-04],
        [1.7766e-08],
        [1.8471e-04],
        [3.9905e-04],
        [3.3067e-04],
        [1.1127e-03],
        [6.9823e-05],
        [3.2702e-04],
        [1.1650e-03],
        [1.4497e-03],
        [4.2219e-04],
        [6.2220e-05],
        [9.2306e-04],
        [2.1936e-04]], device='cuda:0') / tensor([[3.8558e-04, 5.0476e-04, 2.2549e-04, 1.7766e-08, 1.8471e-04, 3.9905e-04,
         3.3067e-04, 1.1127e-03, 6.9823e-05, 3.2702e-04, 1.1650e-03, 1.4497e-03,
         4.2219e-04, 6.2220e-05, 9.2306e-04, 2.1936e-04]], device='cuda:0')
answers_probs: tensor([[1.3758e-03, 9.3593e-03, 3.8558e-04],
        [3.8196e-04, 1.4938e-03, 5.0476e-04],
        [5.9653e-04, 2.4471e-03, 2.2549e-04],
        [2.0567e-07, 3.6183e-07, 1.7766e-08],
        [2.8304e-04, 1.6025e-03, 1.8471e-04],
        [1.1471e-03, 5.4000e-03, 3.9905e-04],
        [1.1034e-03, 5.0025e-03, 3.3067e-04],
        [1.5389e-03, 4.6350e-03, 1.1127e-03],
        [2.5829e-04, 1.4907e-03, 6.9823e-05],
        [3.6924e-04, 4.8320e-03, 3.2702e-04],
        [1.9377e-03, 1.3352e-02, 1.1650e-03],
        [8.4148e-04, 2.5487e-03, 1.4497e-03],
        [5.5102e-04, 1.4132e-03, 4.2219e-04],
        [1.0587e-03, 3.1616e-03, 6.2220e-05],
        [1.6775e-03, 6.7579e-03, 9.2306e-04],
        [1.2124e-03, 1.9210e-03, 2.1936e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.2004e-03],
        [1.8361e-03],
        [1.3005e-04],
        [4.6609e-04],
        [7.0800e-04],
        [2.0429e-04],
        [6.2819e-04],
        [2.2951e-04],
        [2.8951e-04],
        [8.8331e-04],
        [3.7682e-04],
        [3.6995e-04],
        [4.8755e-04],
        [5.1080e-04],
        [4.4216e-07],
        [8.5357e-04]], device='cuda:0') / tensor([[1.2004e-03, 1.8361e-03, 1.3005e-04, 4.6609e-04, 7.0800e-04, 2.0429e-04,
         6.2819e-04, 2.2951e-04, 2.8951e-04, 8.8331e-04, 3.7682e-04, 3.6995e-04,
         4.8755e-04, 5.1080e-04, 4.4216e-07, 8.5357e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.3080e-02],
        [3.2988e-03],
        [3.2344e-03],
        [3.4867e-03],
        [1.3841e-02],
        [4.2229e-03],
        [3.2706e-03],
        [3.0360e-03],
        [2.0757e-03],
        [4.6799e-03],
        [8.9341e-03],
        [1.4004e-03],
        [3.8168e-03],
        [5.8775e-03],
        [5.7829e-07],
        [5.2200e-03]], device='cuda:0') / tensor([[1.3080e-02, 3.2988e-03, 3.2344e-03, 3.4867e-03, 1.3841e-02, 4.2229e-03,
         3.2706e-03, 3.0360e-03, 2.0757e-03, 4.6799e-03, 8.9341e-03, 1.4004e-03,
         3.8168e-03, 5.8775e-03, 5.7829e-07, 5.2200e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[4.8666e-04],
        [5.7561e-04],
        [2.1308e-04],
        [4.4188e-04],
        [4.3676e-04],
        [1.7851e-04],
        [1.8011e-04],
        [1.7889e-04],
        [1.5169e-04],
        [2.9716e-04],
        [1.2312e-04],
        [1.2063e-04],
        [1.8559e-04],
        [3.0730e-04],
        [2.6809e-08],
        [4.2672e-04]], device='cuda:0') / tensor([[4.8666e-04, 5.7561e-04, 2.1308e-04, 4.4188e-04, 4.3676e-04, 1.7851e-04,
         1.8011e-04, 1.7889e-04, 1.5169e-04, 2.9716e-04, 1.2312e-04, 1.2063e-04,
         1.8559e-04, 3.0730e-04, 2.6809e-08, 4.2672e-04]], device='cuda:0')
answers_probs: tensor([[1.2004e-03, 1.3080e-02, 4.8666e-04],
        [1.8361e-03, 3.2988e-03, 5.7561e-04],
        [1.3005e-04, 3.2344e-03, 2.1308e-04],
        [4.6609e-04, 3.4867e-03, 4.4188e-04],
        [7.0800e-04, 1.3841e-02, 4.3676e-04],
        [2.0429e-04, 4.2229e-03, 1.7851e-04],
        [6.2819e-04, 3.2706e-03, 1.8011e-04],
        [2.2951e-04, 3.0360e-03, 1.7889e-04],
        [2.8951e-04, 2.0757e-03, 1.5169e-04],
        [8.8331e-04, 4.6799e-03, 2.9716e-04],
        [3.7682e-04, 8.9341e-03, 1.2312e-04],
        [3.6995e-04, 1.4004e-03, 1.2063e-04],
        [4.8755e-04, 3.8168e-03, 1.8559e-04],
        [5.1080e-04, 5.8775e-03, 3.0730e-04],
        [4.4216e-07, 5.7829e-07, 2.6809e-08],
        [8.5357e-04, 5.2200e-03, 4.2672e-04]], device='cuda:0')
acc:  0.3541666666666667
Time taken to execute the de NLI task with prompt type active, variation 1 and batchsize 16: 0:02:53.662159
path ['42', 'de', 'flan', 'NLI', 'active', 'prompt_id_1']
----------- 42 de google/flan-t5-base NLI active 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 329.30it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.2633e-05],
        [7.6434e-04],
        [3.7235e-05],
        [3.1037e-04],
        [5.7656e-05],
        [6.6043e-04],
        [1.5849e-03],
        [2.9716e-04],
        [1.2164e-03],
        [1.1527e-04],
        [2.5011e-04],
        [8.4946e-04],
        [1.5725e-04],
        [9.1501e-04],
        [7.9475e-04],
        [4.0239e-04]], device='cuda:0') / tensor([[3.2633e-05, 7.6434e-04, 3.7235e-05, 3.1037e-04, 5.7656e-05, 6.6043e-04,
         1.5849e-03, 2.9716e-04, 1.2164e-03, 1.1527e-04, 2.5011e-04, 8.4946e-04,
         1.5725e-04, 9.1501e-04, 7.9475e-04, 4.0239e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.2525e-05],
        [5.2197e-03],
        [1.6310e-05],
        [6.0200e-04],
        [1.6670e-04],
        [1.3920e-03],
        [2.3492e-03],
        [6.3914e-04],
        [7.2464e-03],
        [2.0659e-04],
        [1.0964e-03],
        [2.4465e-03],
        [5.1170e-05],
        [2.0991e-04],
        [3.6172e-03],
        [1.5980e-03]], device='cuda:0') / tensor([[6.2525e-05, 5.2197e-03, 1.6310e-05, 6.0200e-04, 1.6670e-04, 1.3920e-03,
         2.3492e-03, 6.3914e-04, 7.2464e-03, 2.0659e-04, 1.0964e-03, 2.4465e-03,
         5.1170e-05, 2.0991e-04, 3.6172e-03, 1.5980e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.8827e-05],
        [9.4285e-05],
        [2.1172e-04],
        [3.7013e-04],
        [7.4006e-05],
        [7.7856e-04],
        [1.6816e-04],
        [9.0428e-05],
        [4.1913e-04],
        [1.3377e-04],
        [2.2804e-04],
        [2.1562e-04],
        [4.1162e-04],
        [5.0361e-05],
        [5.1176e-04],
        [4.5887e-05]], device='cuda:0') / tensor([[3.8827e-05, 9.4285e-05, 2.1172e-04, 3.7013e-04, 7.4006e-05, 7.7856e-04,
         1.6816e-04, 9.0428e-05, 4.1913e-04, 1.3377e-04, 2.2804e-04, 2.1562e-04,
         4.1162e-04, 5.0361e-05, 5.1176e-04, 4.5887e-05]], device='cuda:0')
answers_probs: tensor([[3.2633e-05, 6.2525e-05, 3.8827e-05],
        [7.6434e-04, 5.2197e-03, 9.4285e-05],
        [3.7235e-05, 1.6310e-05, 2.1172e-04],
        [3.1037e-04, 6.0200e-04, 3.7013e-04],
        [5.7656e-05, 1.6670e-04, 7.4006e-05],
        [6.6043e-04, 1.3920e-03, 7.7856e-04],
        [1.5849e-03, 2.3492e-03, 1.6816e-04],
        [2.9716e-04, 6.3914e-04, 9.0428e-05],
        [1.2164e-03, 7.2464e-03, 4.1913e-04],
        [1.1527e-04, 2.0659e-04, 1.3377e-04],
        [2.5011e-04, 1.0964e-03, 2.2804e-04],
        [8.4946e-04, 2.4465e-03, 2.1562e-04],
        [1.5725e-04, 5.1170e-05, 4.1162e-04],
        [9.1501e-04, 2.0991e-04, 5.0361e-05],
        [7.9475e-04, 3.6172e-03, 5.1176e-04],
        [4.0239e-04, 1.5980e-03, 4.5887e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.2430e-04],
        [5.0838e-05],
        [4.6114e-04],
        [3.0992e-04],
        [3.0145e-04],
        [6.4492e-04],
        [1.5056e-04],
        [4.4354e-04],
        [6.1274e-04],
        [8.4264e-05],
        [1.1806e-04],
        [6.0992e-04],
        [1.3794e-04],
        [7.7161e-04],
        [1.6872e-04],
        [8.1233e-05]], device='cuda:0') / tensor([[2.2430e-04, 5.0838e-05, 4.6114e-04, 3.0992e-04, 3.0145e-04, 6.4492e-04,
         1.5056e-04, 4.4354e-04, 6.1274e-04, 8.4264e-05, 1.1806e-04, 6.0992e-04,
         1.3794e-04, 7.7161e-04, 1.6872e-04, 8.1233e-05]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.0059e-04],
        [6.5631e-05],
        [1.1853e-03],
        [1.4786e-03],
        [8.5971e-04],
        [1.2469e-03],
        [1.5419e-04],
        [9.8567e-04],
        [6.9452e-04],
        [8.6924e-05],
        [5.6098e-04],
        [6.3590e-04],
        [5.4447e-04],
        [1.9274e-03],
        [8.2730e-04],
        [3.5779e-05]], device='cuda:0') / tensor([[6.0059e-04, 6.5631e-05, 1.1853e-03, 1.4786e-03, 8.5971e-04, 1.2469e-03,
         1.5419e-04, 9.8567e-04, 6.9452e-04, 8.6924e-05, 5.6098e-04, 6.3590e-04,
         5.4447e-04, 1.9274e-03, 8.2730e-04, 3.5779e-05]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.2411e-04],
        [1.0441e-04],
        [5.0116e-05],
        [6.8596e-05],
        [1.2499e-04],
        [2.0259e-04],
        [2.2831e-04],
        [1.3028e-04],
        [1.0247e-04],
        [1.0329e-04],
        [5.3934e-05],
        [2.2023e-04],
        [9.0961e-05],
        [1.7021e-04],
        [6.3058e-05],
        [5.8728e-04]], device='cuda:0') / tensor([[1.2411e-04, 1.0441e-04, 5.0116e-05, 6.8596e-05, 1.2499e-04, 2.0259e-04,
         2.2831e-04, 1.3028e-04, 1.0247e-04, 1.0329e-04, 5.3934e-05, 2.2023e-04,
         9.0961e-05, 1.7021e-04, 6.3058e-05, 5.8728e-04]], device='cuda:0')
answers_probs: tensor([[2.2430e-04, 6.0059e-04, 1.2411e-04],
        [5.0838e-05, 6.5631e-05, 1.0441e-04],
        [4.6114e-04, 1.1853e-03, 5.0116e-05],
        [3.0992e-04, 1.4786e-03, 6.8596e-05],
        [3.0145e-04, 8.5971e-04, 1.2499e-04],
        [6.4492e-04, 1.2469e-03, 2.0259e-04],
        [1.5056e-04, 1.5419e-04, 2.2831e-04],
        [4.4354e-04, 9.8567e-04, 1.3028e-04],
        [6.1274e-04, 6.9452e-04, 1.0247e-04],
        [8.4264e-05, 8.6924e-05, 1.0329e-04],
        [1.1806e-04, 5.6098e-04, 5.3934e-05],
        [6.0992e-04, 6.3590e-04, 2.2023e-04],
        [1.3794e-04, 5.4447e-04, 9.0961e-05],
        [7.7161e-04, 1.9274e-03, 1.7021e-04],
        [1.6872e-04, 8.2730e-04, 6.3058e-05],
        [8.1233e-05, 3.5779e-05, 5.8728e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.5568e-04],
        [5.8920e-04],
        [1.1891e-04],
        [4.8539e-04],
        [5.1533e-04],
        [6.4234e-05],
        [7.6123e-04],
        [3.8787e-04],
        [3.2842e-04],
        [5.3561e-04],
        [7.3003e-04],
        [1.9144e-04],
        [1.3001e-04],
        [5.0198e-04],
        [1.0283e-04],
        [2.4167e-04]], device='cuda:0') / tensor([[3.5568e-04, 5.8920e-04, 1.1891e-04, 4.8539e-04, 5.1533e-04, 6.4234e-05,
         7.6123e-04, 3.8787e-04, 3.2842e-04, 5.3561e-04, 7.3003e-04, 1.9144e-04,
         1.3001e-04, 5.0198e-04, 1.0283e-04, 2.4167e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.6993e-04],
        [2.6152e-03],
        [3.6325e-05],
        [1.0997e-03],
        [4.3056e-03],
        [6.4725e-04],
        [1.2196e-03],
        [6.4990e-04],
        [1.6568e-03],
        [4.9718e-04],
        [1.2101e-03],
        [1.5428e-04],
        [1.2873e-04],
        [3.0510e-03],
        [2.7468e-04],
        [2.7532e-04]], device='cuda:0') / tensor([[9.6993e-04, 2.6152e-03, 3.6325e-05, 1.0997e-03, 4.3056e-03, 6.4725e-04,
         1.2196e-03, 6.4990e-04, 1.6568e-03, 4.9718e-04, 1.2101e-03, 1.5428e-04,
         1.2873e-04, 3.0510e-03, 2.7468e-04, 2.7532e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[3.3817e-04],
        [4.8705e-04],
        [2.5548e-04],
        [7.5183e-05],
        [1.9022e-04],
        [8.4816e-05],
        [2.1942e-04],
        [1.4752e-04],
        [4.4595e-04],
        [5.4432e-04],
        [2.4091e-04],
        [2.8694e-04],
        [1.3156e-04],
        [1.1389e-04],
        [2.5596e-05],
        [2.1254e-04]], device='cuda:0') / tensor([[3.3817e-04, 4.8705e-04, 2.5548e-04, 7.5183e-05, 1.9022e-04, 8.4816e-05,
         2.1942e-04, 1.4752e-04, 4.4595e-04, 5.4432e-04, 2.4091e-04, 2.8694e-04,
         1.3156e-04, 1.1389e-04, 2.5596e-05, 2.1254e-04]], device='cuda:0')
answers_probs: tensor([[3.5568e-04, 9.6993e-04, 3.3817e-04],
        [5.8920e-04, 2.6152e-03, 4.8705e-04],
        [1.1891e-04, 3.6325e-05, 2.5548e-04],
        [4.8539e-04, 1.0997e-03, 7.5183e-05],
        [5.1533e-04, 4.3056e-03, 1.9022e-04],
        [6.4234e-05, 6.4725e-04, 8.4816e-05],
        [7.6123e-04, 1.2196e-03, 2.1942e-04],
        [3.8787e-04, 6.4990e-04, 1.4752e-04],
        [3.2842e-04, 1.6568e-03, 4.4595e-04],
        [5.3561e-04, 4.9718e-04, 5.4432e-04],
        [7.3003e-04, 1.2101e-03, 2.4091e-04],
        [1.9144e-04, 1.5428e-04, 2.8694e-04],
        [1.3001e-04, 1.2873e-04, 1.3156e-04],
        [5.0198e-04, 3.0510e-03, 1.1389e-04],
        [1.0283e-04, 2.7468e-04, 2.5596e-05],
        [2.4167e-04, 2.7532e-04, 2.1254e-04]], device='cuda:0')
acc:  0.375
Time taken to execute the de NLI task with prompt type active, variation 2 and batchsize 16: 0:02:52.750310
path ['42', 'de', 'flan', 'NLI', 'active', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base NLI passive 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 340.50it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.2677e-04],
        [7.7276e-04],
        [1.5377e-03],
        [2.9517e-03],
        [1.7458e-03],
        [6.4602e-04],
        [7.6701e-04],
        [1.4320e-03],
        [2.9829e-04],
        [3.7964e-04],
        [2.5187e-07],
        [3.4987e-04],
        [8.9668e-04],
        [9.2015e-04],
        [6.7233e-04],
        [1.4671e-03]], device='cuda:0') / tensor([[4.2677e-04, 7.7276e-04, 1.5377e-03, 2.9517e-03, 1.7458e-03, 6.4602e-04,
         7.6701e-04, 1.4320e-03, 2.9829e-04, 3.7964e-04, 2.5187e-07, 3.4987e-04,
         8.9668e-04, 9.2015e-04, 6.7233e-04, 1.4671e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.6119e-03],
        [2.4384e-03],
        [1.7601e-03],
        [2.8426e-03],
        [8.0645e-04],
        [1.9381e-03],
        [2.8039e-03],
        [4.3275e-03],
        [2.4957e-04],
        [6.1366e-04],
        [3.6793e-07],
        [1.8308e-03],
        [3.1665e-03],
        [2.9515e-03],
        [1.9770e-03],
        [1.7398e-03]], device='cuda:0') / tensor([[2.6119e-03, 2.4384e-03, 1.7601e-03, 2.8426e-03, 8.0645e-04, 1.9381e-03,
         2.8039e-03, 4.3275e-03, 2.4957e-04, 6.1366e-04, 3.6793e-07, 1.8308e-03,
         3.1665e-03, 2.9515e-03, 1.9770e-03, 1.7398e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.3858e-05],
        [6.9851e-05],
        [4.6655e-05],
        [8.3600e-04],
        [2.9570e-04],
        [8.9067e-05],
        [2.0509e-04],
        [1.3662e-04],
        [8.4996e-06],
        [3.6321e-06],
        [2.0779e-08],
        [5.6972e-05],
        [4.2042e-04],
        [3.6103e-04],
        [1.9213e-04],
        [6.7561e-05]], device='cuda:0') / tensor([[3.3858e-05, 6.9851e-05, 4.6655e-05, 8.3600e-04, 2.9570e-04, 8.9067e-05,
         2.0509e-04, 1.3662e-04, 8.4996e-06, 3.6321e-06, 2.0779e-08, 5.6972e-05,
         4.2042e-04, 3.6103e-04, 1.9213e-04, 6.7561e-05]], device='cuda:0')
answers_probs: tensor([[4.2677e-04, 2.6119e-03, 3.3858e-05],
        [7.7276e-04, 2.4384e-03, 6.9851e-05],
        [1.5377e-03, 1.7601e-03, 4.6655e-05],
        [2.9517e-03, 2.8426e-03, 8.3600e-04],
        [1.7458e-03, 8.0645e-04, 2.9570e-04],
        [6.4602e-04, 1.9381e-03, 8.9067e-05],
        [7.6701e-04, 2.8039e-03, 2.0509e-04],
        [1.4320e-03, 4.3275e-03, 1.3662e-04],
        [2.9829e-04, 2.4957e-04, 8.4996e-06],
        [3.7964e-04, 6.1366e-04, 3.6321e-06],
        [2.5187e-07, 3.6793e-07, 2.0779e-08],
        [3.4987e-04, 1.8308e-03, 5.6972e-05],
        [8.9668e-04, 3.1665e-03, 4.2042e-04],
        [9.2015e-04, 2.9515e-03, 3.6103e-04],
        [6.7233e-04, 1.9770e-03, 1.9213e-04],
        [1.4671e-03, 1.7398e-03, 6.7561e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.5699e-03],
        [1.6978e-03],
        [1.1731e-03],
        [3.5260e-04],
        [4.2312e-04],
        [3.7948e-04],
        [7.1403e-04],
        [5.3487e-04],
        [1.9601e-03],
        [7.4808e-04],
        [9.1473e-04],
        [2.0722e-07],
        [9.0601e-04],
        [1.3846e-04],
        [1.6762e-03],
        [3.1073e-04]], device='cuda:0') / tensor([[1.5699e-03, 1.6978e-03, 1.1731e-03, 3.5260e-04, 4.2312e-04, 3.7948e-04,
         7.1403e-04, 5.3487e-04, 1.9601e-03, 7.4808e-04, 9.1473e-04, 2.0722e-07,
         9.0601e-04, 1.3846e-04, 1.6762e-03, 3.1073e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.1546e-03],
        [7.2091e-03],
        [2.2116e-03],
        [7.9455e-04],
        [3.1533e-03],
        [4.2909e-04],
        [7.6222e-03],
        [4.5765e-03],
        [4.0542e-03],
        [3.8004e-03],
        [1.2623e-03],
        [1.3650e-07],
        [2.9814e-03],
        [3.7482e-04],
        [4.5873e-03],
        [7.1861e-04]], device='cuda:0') / tensor([[9.1546e-03, 7.2091e-03, 2.2116e-03, 7.9455e-04, 3.1533e-03, 4.2909e-04,
         7.6222e-03, 4.5765e-03, 4.0542e-03, 3.8004e-03, 1.2623e-03, 1.3650e-07,
         2.9814e-03, 3.7482e-04, 4.5873e-03, 7.1861e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.0708e-03],
        [1.5908e-04],
        [5.2979e-05],
        [2.6563e-05],
        [4.7442e-04],
        [1.3191e-05],
        [3.3660e-04],
        [1.9314e-04],
        [7.2036e-04],
        [9.3004e-05],
        [6.7206e-05],
        [1.3780e-08],
        [1.3748e-04],
        [1.0102e-05],
        [5.0469e-05],
        [1.8624e-05]], device='cuda:0') / tensor([[1.0708e-03, 1.5908e-04, 5.2979e-05, 2.6563e-05, 4.7442e-04, 1.3191e-05,
         3.3660e-04, 1.9314e-04, 7.2036e-04, 9.3004e-05, 6.7206e-05, 1.3780e-08,
         1.3748e-04, 1.0102e-05, 5.0469e-05, 1.8624e-05]], device='cuda:0')
answers_probs: tensor([[1.5699e-03, 9.1546e-03, 1.0708e-03],
        [1.6978e-03, 7.2091e-03, 1.5908e-04],
        [1.1731e-03, 2.2116e-03, 5.2979e-05],
        [3.5260e-04, 7.9455e-04, 2.6563e-05],
        [4.2312e-04, 3.1533e-03, 4.7442e-04],
        [3.7948e-04, 4.2909e-04, 1.3191e-05],
        [7.1403e-04, 7.6222e-03, 3.3660e-04],
        [5.3487e-04, 4.5765e-03, 1.9314e-04],
        [1.9601e-03, 4.0542e-03, 7.2036e-04],
        [7.4808e-04, 3.8004e-03, 9.3004e-05],
        [9.1473e-04, 1.2623e-03, 6.7206e-05],
        [2.0722e-07, 1.3650e-07, 1.3780e-08],
        [9.0601e-04, 2.9814e-03, 1.3748e-04],
        [1.3846e-04, 3.7482e-04, 1.0102e-05],
        [1.6762e-03, 4.5873e-03, 5.0469e-05],
        [3.1073e-04, 7.1861e-04, 1.8624e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.3739e-03],
        [9.7040e-04],
        [1.9053e-04],
        [1.1202e-03],
        [5.2188e-04],
        [1.0651e-03],
        [7.8141e-04],
        [3.5790e-04],
        [6.6956e-08],
        [3.1206e-04],
        [1.2030e-03],
        [5.9328e-04],
        [1.1679e-03],
        [4.7303e-04],
        [5.7767e-04],
        [4.3331e-04]], device='cuda:0') / tensor([[1.3739e-03, 9.7040e-04, 1.9053e-04, 1.1202e-03, 5.2188e-04, 1.0651e-03,
         7.8141e-04, 3.5790e-04, 6.6956e-08, 3.1206e-04, 1.2030e-03, 5.9328e-04,
         1.1679e-03, 4.7303e-04, 5.7767e-04, 4.3331e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.6952e-03],
        [3.0829e-03],
        [8.9526e-04],
        [1.3904e-03],
        [8.3422e-04],
        [2.5213e-03],
        [2.0793e-03],
        [2.2856e-03],
        [7.4847e-08],
        [1.6418e-03],
        [5.1607e-03],
        [1.1638e-03],
        [1.9956e-03],
        [5.2644e-03],
        [3.7055e-03],
        [4.8152e-03]], device='cuda:0') / tensor([[2.6952e-03, 3.0829e-03, 8.9526e-04, 1.3904e-03, 8.3422e-04, 2.5213e-03,
         2.0793e-03, 2.2856e-03, 7.4847e-08, 1.6418e-03, 5.1607e-03, 1.1638e-03,
         1.9956e-03, 5.2644e-03, 3.7055e-03, 4.8152e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[1.4295e-04],
        [1.9732e-04],
        [3.8316e-05],
        [6.2331e-05],
        [3.5936e-05],
        [4.7563e-04],
        [1.1405e-04],
        [2.4071e-04],
        [2.4998e-09],
        [5.1095e-05],
        [2.8518e-05],
        [2.8365e-05],
        [4.6823e-05],
        [1.9704e-04],
        [4.6667e-04],
        [1.0499e-04]], device='cuda:0') / tensor([[1.4295e-04, 1.9732e-04, 3.8316e-05, 6.2331e-05, 3.5936e-05, 4.7563e-04,
         1.1405e-04, 2.4071e-04, 2.4998e-09, 5.1095e-05, 2.8518e-05, 2.8365e-05,
         4.6823e-05, 1.9704e-04, 4.6667e-04, 1.0499e-04]], device='cuda:0')
answers_probs: tensor([[1.3739e-03, 2.6952e-03, 1.4295e-04],
        [9.7040e-04, 3.0829e-03, 1.9732e-04],
        [1.9053e-04, 8.9526e-04, 3.8316e-05],
        [1.1202e-03, 1.3904e-03, 6.2331e-05],
        [5.2188e-04, 8.3422e-04, 3.5936e-05],
        [1.0651e-03, 2.5213e-03, 4.7563e-04],
        [7.8141e-04, 2.0793e-03, 1.1405e-04],
        [3.5790e-04, 2.2856e-03, 2.4071e-04],
        [6.6956e-08, 7.4847e-08, 2.4998e-09],
        [3.1206e-04, 1.6418e-03, 5.1095e-05],
        [1.2030e-03, 5.1607e-03, 2.8518e-05],
        [5.9328e-04, 1.1638e-03, 2.8365e-05],
        [1.1679e-03, 1.9956e-03, 4.6823e-05],
        [4.7303e-04, 5.2644e-03, 1.9704e-04],
        [5.7767e-04, 3.7055e-03, 4.6667e-04],
        [4.3331e-04, 4.8152e-03, 1.0499e-04]], device='cuda:0')
acc:  0.3333333333333333
Time taken to execute the de NLI task with prompt type passive, variation 0 and batchsize 16: 0:02:53.207661
path ['42', 'de', 'flan', 'NLI', 'passive', 'prompt_id_0']
----------- 42 de google/flan-t5-base NLI passive 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 338.95it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.2458e-04],
        [9.4388e-04],
        [1.3279e-03],
        [2.0461e-03],
        [1.4485e-03],
        [1.3467e-03],
        [5.6838e-08],
        [4.8833e-04],
        [1.0233e-03],
        [2.5127e-03],
        [1.7273e-03],
        [9.5425e-04],
        [1.1234e-03],
        [1.5494e-03],
        [2.9221e-03],
        [2.2472e-03]], device='cuda:0') / tensor([[4.2458e-04, 9.4388e-04, 1.3279e-03, 2.0461e-03, 1.4485e-03, 1.3467e-03,
         5.6838e-08, 4.8833e-04, 1.0233e-03, 2.5127e-03, 1.7273e-03, 9.5425e-04,
         1.1234e-03, 1.5494e-03, 2.9221e-03, 2.2472e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.4685e-03],
        [2.4730e-03],
        [4.7578e-03],
        [3.7641e-03],
        [4.0922e-03],
        [2.0271e-03],
        [4.9602e-08],
        [1.9251e-03],
        [7.9460e-03],
        [7.4945e-03],
        [3.7764e-03],
        [6.3180e-03],
        [3.4131e-03],
        [5.6444e-03],
        [5.3939e-03],
        [5.0212e-03]], device='cuda:0') / tensor([[2.4685e-03, 2.4730e-03, 4.7578e-03, 3.7641e-03, 4.0922e-03, 2.0271e-03,
         4.9602e-08, 1.9251e-03, 7.9460e-03, 7.4945e-03, 3.7764e-03, 6.3180e-03,
         3.4131e-03, 5.6444e-03, 5.3939e-03, 5.0212e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[6.6204e-04],
        [4.5301e-04],
        [5.2235e-04],
        [1.1316e-03],
        [3.2747e-03],
        [1.5759e-03],
        [2.1202e-09],
        [5.1892e-04],
        [8.8738e-04],
        [1.3685e-03],
        [1.3995e-03],
        [4.5361e-04],
        [1.2610e-03],
        [5.5230e-04],
        [1.8653e-03],
        [6.0645e-04]], device='cuda:0') / tensor([[6.6204e-04, 4.5301e-04, 5.2235e-04, 1.1316e-03, 3.2747e-03, 1.5759e-03,
         2.1202e-09, 5.1892e-04, 8.8738e-04, 1.3685e-03, 1.3995e-03, 4.5361e-04,
         1.2610e-03, 5.5230e-04, 1.8653e-03, 6.0645e-04]], device='cuda:0')
answers_probs: tensor([[4.2458e-04, 2.4685e-03, 6.6204e-04],
        [9.4388e-04, 2.4730e-03, 4.5301e-04],
        [1.3279e-03, 4.7578e-03, 5.2235e-04],
        [2.0461e-03, 3.7641e-03, 1.1316e-03],
        [1.4485e-03, 4.0922e-03, 3.2747e-03],
        [1.3467e-03, 2.0271e-03, 1.5759e-03],
        [5.6838e-08, 4.9602e-08, 2.1202e-09],
        [4.8833e-04, 1.9251e-03, 5.1892e-04],
        [1.0233e-03, 7.9460e-03, 8.8738e-04],
        [2.5127e-03, 7.4945e-03, 1.3685e-03],
        [1.7273e-03, 3.7764e-03, 1.3995e-03],
        [9.5425e-04, 6.3180e-03, 4.5361e-04],
        [1.1234e-03, 3.4131e-03, 1.2610e-03],
        [1.5494e-03, 5.6444e-03, 5.5230e-04],
        [2.9221e-03, 5.3939e-03, 1.8653e-03],
        [2.2472e-03, 5.0212e-03, 6.0645e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[7.0048e-04],
        [1.1339e-03],
        [3.5069e-03],
        [9.5262e-04],
        [8.4558e-04],
        [2.1054e-07],
        [6.0186e-04],
        [1.6430e-03],
        [4.0661e-04],
        [1.2127e-03],
        [1.8789e-03],
        [2.4868e-03],
        [1.8167e-03],
        [1.5371e-03],
        [7.2102e-04],
        [1.1209e-03]], device='cuda:0') / tensor([[7.0048e-04, 1.1339e-03, 3.5069e-03, 9.5262e-04, 8.4558e-04, 2.1054e-07,
         6.0186e-04, 1.6430e-03, 4.0661e-04, 1.2127e-03, 1.8789e-03, 2.4868e-03,
         1.8167e-03, 1.5371e-03, 7.2102e-04, 1.1209e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.6843e-03],
        [7.4032e-03],
        [1.4610e-02],
        [3.3452e-03],
        [5.3392e-03],
        [9.8088e-08],
        [5.1695e-03],
        [5.9017e-03],
        [2.1485e-03],
        [6.3197e-03],
        [3.8763e-03],
        [8.1444e-03],
        [4.8563e-03],
        [6.9645e-03],
        [6.4314e-03],
        [5.6886e-03]], device='cuda:0') / tensor([[5.6843e-03, 7.4032e-03, 1.4610e-02, 3.3452e-03, 5.3392e-03, 9.8088e-08,
         5.1695e-03, 5.9017e-03, 2.1485e-03, 6.3197e-03, 3.8763e-03, 8.1444e-03,
         4.8563e-03, 6.9645e-03, 6.4314e-03, 5.6886e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[4.5456e-04],
        [2.1179e-03],
        [2.9323e-03],
        [1.1265e-03],
        [2.5488e-04],
        [3.6237e-09],
        [6.1674e-04],
        [4.8509e-04],
        [3.4156e-04],
        [4.2457e-04],
        [2.5526e-04],
        [2.8400e-04],
        [1.2841e-03],
        [1.2515e-03],
        [5.3143e-04],
        [7.6878e-04]], device='cuda:0') / tensor([[4.5456e-04, 2.1179e-03, 2.9323e-03, 1.1265e-03, 2.5488e-04, 3.6237e-09,
         6.1674e-04, 4.8509e-04, 3.4156e-04, 4.2457e-04, 2.5526e-04, 2.8400e-04,
         1.2841e-03, 1.2515e-03, 5.3143e-04, 7.6878e-04]], device='cuda:0')
answers_probs: tensor([[7.0048e-04, 5.6843e-03, 4.5456e-04],
        [1.1339e-03, 7.4032e-03, 2.1179e-03],
        [3.5069e-03, 1.4610e-02, 2.9323e-03],
        [9.5262e-04, 3.3452e-03, 1.1265e-03],
        [8.4558e-04, 5.3392e-03, 2.5488e-04],
        [2.1054e-07, 9.8088e-08, 3.6237e-09],
        [6.0186e-04, 5.1695e-03, 6.1674e-04],
        [1.6430e-03, 5.9017e-03, 4.8509e-04],
        [4.0661e-04, 2.1485e-03, 3.4156e-04],
        [1.2127e-03, 6.3197e-03, 4.2457e-04],
        [1.8789e-03, 3.8763e-03, 2.5526e-04],
        [2.4868e-03, 8.1444e-03, 2.8400e-04],
        [1.8167e-03, 4.8563e-03, 1.2841e-03],
        [1.5371e-03, 6.9645e-03, 1.2515e-03],
        [7.2102e-04, 6.4314e-03, 5.3143e-04],
        [1.1209e-03, 5.6886e-03, 7.6878e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[5.3344e-04],
        [1.1109e-03],
        [1.2259e-03],
        [2.6924e-03],
        [7.7944e-04],
        [6.5899e-04],
        [9.0440e-04],
        [6.0745e-04],
        [8.6075e-04],
        [3.0412e-04],
        [7.4998e-04],
        [1.4970e-03],
        [7.0282e-04],
        [6.7629e-04],
        [4.9654e-08],
        [4.8923e-04]], device='cuda:0') / tensor([[5.3344e-04, 1.1109e-03, 1.2259e-03, 2.6924e-03, 7.7944e-04, 6.5899e-04,
         9.0440e-04, 6.0745e-04, 8.6075e-04, 3.0412e-04, 7.4998e-04, 1.4970e-03,
         7.0282e-04, 6.7629e-04, 4.9654e-08, 4.8923e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.4518e-03],
        [4.4849e-03],
        [2.7235e-03],
        [7.5486e-03],
        [1.5810e-03],
        [4.7156e-03],
        [7.1135e-03],
        [3.7288e-03],
        [5.0303e-03],
        [5.2061e-03],
        [2.8519e-03],
        [6.3414e-03],
        [2.6275e-03],
        [4.3746e-03],
        [3.6202e-08],
        [3.5719e-03]], device='cuda:0') / tensor([[1.4518e-03, 4.4849e-03, 2.7235e-03, 7.5486e-03, 1.5810e-03, 4.7156e-03,
         7.1135e-03, 3.7288e-03, 5.0303e-03, 5.2061e-03, 2.8519e-03, 6.3414e-03,
         2.6275e-03, 4.3746e-03, 3.6202e-08, 3.5719e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[2.2337e-04],
        [5.8541e-04],
        [7.9236e-04],
        [5.5998e-04],
        [4.5711e-04],
        [3.0597e-04],
        [2.0898e-04],
        [3.7989e-04],
        [5.4225e-04],
        [3.6399e-04],
        [1.8329e-04],
        [3.7099e-03],
        [2.5198e-04],
        [2.9336e-04],
        [8.5395e-10],
        [2.7168e-04]], device='cuda:0') / tensor([[2.2337e-04, 5.8541e-04, 7.9236e-04, 5.5998e-04, 4.5711e-04, 3.0597e-04,
         2.0898e-04, 3.7989e-04, 5.4225e-04, 3.6399e-04, 1.8329e-04, 3.7099e-03,
         2.5198e-04, 2.9336e-04, 8.5395e-10, 2.7168e-04]], device='cuda:0')
answers_probs: tensor([[5.3344e-04, 1.4518e-03, 2.2337e-04],
        [1.1109e-03, 4.4849e-03, 5.8541e-04],
        [1.2259e-03, 2.7235e-03, 7.9236e-04],
        [2.6924e-03, 7.5486e-03, 5.5998e-04],
        [7.7944e-04, 1.5810e-03, 4.5711e-04],
        [6.5899e-04, 4.7156e-03, 3.0597e-04],
        [9.0440e-04, 7.1135e-03, 2.0898e-04],
        [6.0745e-04, 3.7288e-03, 3.7989e-04],
        [8.6075e-04, 5.0303e-03, 5.4225e-04],
        [3.0412e-04, 5.2061e-03, 3.6399e-04],
        [7.4998e-04, 2.8519e-03, 1.8329e-04],
        [1.4970e-03, 6.3414e-03, 3.7099e-03],
        [7.0282e-04, 2.6275e-03, 2.5198e-04],
        [6.7629e-04, 4.3746e-03, 2.9336e-04],
        [4.9654e-08, 3.6202e-08, 8.5395e-10],
        [4.8923e-04, 3.5719e-03, 2.7168e-04]], device='cuda:0')
acc:  0.3125
Time taken to execute the de NLI task with prompt type passive, variation 1 and batchsize 16: 0:02:52.821748
path ['42', 'de', 'flan', 'NLI', 'passive', 'prompt_id_1']
----------- 42 de google/flan-t5-base NLI passive 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 182.44it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.1452e-04],
        [4.7132e-04],
        [1.1194e-03],
        [1.2239e-04],
        [4.2681e-04],
        [1.9493e-04],
        [9.3324e-04],
        [2.6399e-07],
        [1.0099e-04],
        [1.5334e-04],
        [5.7109e-04],
        [1.3159e-04],
        [2.7391e-04],
        [2.6067e-04],
        [2.2178e-04],
        [6.3398e-04]], device='cuda:0') / tensor([[1.1452e-04, 4.7132e-04, 1.1194e-03, 1.2239e-04, 4.2681e-04, 1.9493e-04,
         9.3324e-04, 2.6399e-07, 1.0099e-04, 1.5334e-04, 5.7109e-04, 1.3159e-04,
         2.7391e-04, 2.6067e-04, 2.2178e-04, 6.3398e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.9019e-03],
        [4.6553e-03],
        [1.0458e-02],
        [1.0889e-03],
        [3.3306e-03],
        [2.8120e-03],
        [5.9526e-03],
        [3.1595e-07],
        [1.0149e-03],
        [3.1798e-03],
        [3.9241e-03],
        [3.1093e-03],
        [3.4373e-03],
        [4.0119e-03],
        [1.1139e-03],
        [2.1786e-03]], device='cuda:0') / tensor([[3.9019e-03, 4.6553e-03, 1.0458e-02, 1.0889e-03, 3.3306e-03, 2.8120e-03,
         5.9526e-03, 3.1595e-07, 1.0149e-03, 3.1798e-03, 3.9241e-03, 3.1093e-03,
         3.4373e-03, 4.0119e-03, 1.1139e-03, 2.1786e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.8489e-05],
        [4.0680e-04],
        [1.5158e-04],
        [4.2085e-06],
        [6.9871e-05],
        [2.6077e-05],
        [1.3348e-03],
        [2.8347e-08],
        [1.3821e-05],
        [1.9148e-04],
        [1.2336e-04],
        [9.7014e-05],
        [3.2060e-04],
        [1.6638e-04],
        [1.8346e-05],
        [1.0457e-04]], device='cuda:0') / tensor([[3.8489e-05, 4.0680e-04, 1.5158e-04, 4.2085e-06, 6.9871e-05, 2.6077e-05,
         1.3348e-03, 2.8347e-08, 1.3821e-05, 1.9148e-04, 1.2336e-04, 9.7014e-05,
         3.2060e-04, 1.6638e-04, 1.8346e-05, 1.0457e-04]], device='cuda:0')
answers_probs: tensor([[1.1452e-04, 3.9019e-03, 3.8489e-05],
        [4.7132e-04, 4.6553e-03, 4.0680e-04],
        [1.1194e-03, 1.0458e-02, 1.5158e-04],
        [1.2239e-04, 1.0889e-03, 4.2085e-06],
        [4.2681e-04, 3.3306e-03, 6.9871e-05],
        [1.9493e-04, 2.8120e-03, 2.6077e-05],
        [9.3324e-04, 5.9526e-03, 1.3348e-03],
        [2.6399e-07, 3.1595e-07, 2.8347e-08],
        [1.0099e-04, 1.0149e-03, 1.3821e-05],
        [1.5334e-04, 3.1798e-03, 1.9148e-04],
        [5.7109e-04, 3.9241e-03, 1.2336e-04],
        [1.3159e-04, 3.1093e-03, 9.7014e-05],
        [2.7391e-04, 3.4373e-03, 3.2060e-04],
        [2.6067e-04, 4.0119e-03, 1.6638e-04],
        [2.2178e-04, 1.1139e-03, 1.8346e-05],
        [6.3398e-04, 2.1786e-03, 1.0457e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[8.7093e-05],
        [1.8705e-04],
        [8.9072e-05],
        [3.8009e-04],
        [3.0071e-04],
        [1.1612e-04],
        [2.8086e-04],
        [1.5277e-04],
        [1.8833e-04],
        [6.9335e-04],
        [4.9914e-04],
        [2.0167e-04],
        [7.1842e-05],
        [6.7639e-04],
        [3.5024e-04],
        [2.0003e-07]], device='cuda:0') / tensor([[8.7093e-05, 1.8705e-04, 8.9072e-05, 3.8009e-04, 3.0071e-04, 1.1612e-04,
         2.8086e-04, 1.5277e-04, 1.8833e-04, 6.9335e-04, 4.9914e-04, 2.0167e-04,
         7.1842e-05, 6.7639e-04, 3.5024e-04, 2.0003e-07]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.8771e-03],
        [4.1761e-03],
        [2.1412e-03],
        [1.8492e-03],
        [6.4787e-03],
        [4.6139e-04],
        [3.5276e-03],
        [1.3382e-03],
        [1.3725e-03],
        [4.4599e-03],
        [2.9894e-03],
        [2.8305e-03],
        [7.8617e-04],
        [4.3157e-03],
        [3.1053e-03],
        [1.4519e-07]], device='cuda:0') / tensor([[2.8771e-03, 4.1761e-03, 2.1412e-03, 1.8492e-03, 6.4787e-03, 4.6139e-04,
         3.5276e-03, 1.3382e-03, 1.3725e-03, 4.4599e-03, 2.9894e-03, 2.8305e-03,
         7.8617e-04, 4.3157e-03, 3.1053e-03, 1.4519e-07]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.2318e-04],
        [1.0882e-04],
        [9.3711e-05],
        [1.1266e-04],
        [2.1907e-04],
        [3.3427e-05],
        [8.1504e-05],
        [2.9222e-05],
        [9.8772e-05],
        [2.7094e-04],
        [7.9589e-05],
        [8.9510e-05],
        [3.7243e-05],
        [2.4231e-04],
        [2.2165e-04],
        [2.2422e-09]], device='cuda:0') / tensor([[1.2318e-04, 1.0882e-04, 9.3711e-05, 1.1266e-04, 2.1907e-04, 3.3427e-05,
         8.1504e-05, 2.9222e-05, 9.8772e-05, 2.7094e-04, 7.9589e-05, 8.9510e-05,
         3.7243e-05, 2.4231e-04, 2.2165e-04, 2.2422e-09]], device='cuda:0')
answers_probs: tensor([[8.7093e-05, 2.8771e-03, 1.2318e-04],
        [1.8705e-04, 4.1761e-03, 1.0882e-04],
        [8.9072e-05, 2.1412e-03, 9.3711e-05],
        [3.8009e-04, 1.8492e-03, 1.1266e-04],
        [3.0071e-04, 6.4787e-03, 2.1907e-04],
        [1.1612e-04, 4.6139e-04, 3.3427e-05],
        [2.8086e-04, 3.5276e-03, 8.1504e-05],
        [1.5277e-04, 1.3382e-03, 2.9222e-05],
        [1.8833e-04, 1.3725e-03, 9.8772e-05],
        [6.9335e-04, 4.4599e-03, 2.7094e-04],
        [4.9914e-04, 2.9894e-03, 7.9589e-05],
        [2.0167e-04, 2.8305e-03, 8.9510e-05],
        [7.1842e-05, 7.8617e-04, 3.7243e-05],
        [6.7639e-04, 4.3157e-03, 2.4231e-04],
        [3.5024e-04, 3.1053e-03, 2.2165e-04],
        [2.0003e-07, 1.4519e-07, 2.2422e-09]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.8643e-04],
        [8.6435e-04],
        [4.1887e-04],
        [5.6877e-04],
        [7.9691e-04],
        [2.6800e-04],
        [6.7808e-04],
        [5.4627e-04],
        [6.4089e-04],
        [7.2950e-04],
        [1.5685e-04],
        [7.6601e-04],
        [2.5537e-04],
        [6.5977e-04],
        [3.5778e-08],
        [3.6631e-04]], device='cuda:0') / tensor([[2.8643e-04, 8.6435e-04, 4.1887e-04, 5.6877e-04, 7.9691e-04, 2.6800e-04,
         6.7808e-04, 5.4627e-04, 6.4089e-04, 7.2950e-04, 1.5685e-04, 7.6601e-04,
         2.5537e-04, 6.5977e-04, 3.5778e-08, 3.6631e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.1696e-03],
        [5.4685e-03],
        [1.1162e-02],
        [2.2172e-03],
        [9.1961e-03],
        [5.5076e-03],
        [9.4263e-03],
        [2.9472e-03],
        [2.2173e-03],
        [3.7458e-03],
        [1.0480e-03],
        [4.8899e-03],
        [2.4987e-03],
        [6.4098e-03],
        [2.9174e-08],
        [3.2107e-03]], device='cuda:0') / tensor([[6.1696e-03, 5.4685e-03, 1.1162e-02, 2.2172e-03, 9.1961e-03, 5.5076e-03,
         9.4263e-03, 2.9472e-03, 2.2173e-03, 3.7458e-03, 1.0480e-03, 4.8899e-03,
         2.4987e-03, 6.4098e-03, 2.9174e-08, 3.2107e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[1.7042e-04],
        [4.2585e-04],
        [4.3654e-04],
        [3.1413e-04],
        [1.4339e-04],
        [4.3882e-04],
        [4.2269e-04],
        [1.4273e-04],
        [4.2420e-05],
        [9.3263e-05],
        [2.4695e-05],
        [1.5314e-04],
        [8.6025e-05],
        [1.0598e-03],
        [1.0191e-09],
        [6.1441e-05]], device='cuda:0') / tensor([[1.7042e-04, 4.2585e-04, 4.3654e-04, 3.1413e-04, 1.4339e-04, 4.3882e-04,
         4.2269e-04, 1.4273e-04, 4.2420e-05, 9.3263e-05, 2.4695e-05, 1.5314e-04,
         8.6025e-05, 1.0598e-03, 1.0191e-09, 6.1441e-05]], device='cuda:0')
answers_probs: tensor([[2.8643e-04, 6.1696e-03, 1.7042e-04],
        [8.6435e-04, 5.4685e-03, 4.2585e-04],
        [4.1887e-04, 1.1162e-02, 4.3654e-04],
        [5.6877e-04, 2.2172e-03, 3.1413e-04],
        [7.9691e-04, 9.1961e-03, 1.4339e-04],
        [2.6800e-04, 5.5076e-03, 4.3882e-04],
        [6.7808e-04, 9.4263e-03, 4.2269e-04],
        [5.4627e-04, 2.9472e-03, 1.4273e-04],
        [6.4089e-04, 2.2173e-03, 4.2420e-05],
        [7.2950e-04, 3.7458e-03, 9.3263e-05],
        [1.5685e-04, 1.0480e-03, 2.4695e-05],
        [7.6601e-04, 4.8899e-03, 1.5314e-04],
        [2.5537e-04, 2.4987e-03, 8.6025e-05],
        [6.5977e-04, 6.4098e-03, 1.0598e-03],
        [3.5778e-08, 2.9174e-08, 1.0191e-09],
        [3.6631e-04, 3.2107e-03, 6.1441e-05]], device='cuda:0')
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type passive, variation 2 and batchsize 16: 0:02:53.384892
path ['42', 'de', 'flan', 'NLI', 'passive', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base NLI auxiliary 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 303.86it/s]
