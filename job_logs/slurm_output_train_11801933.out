Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
****Start Time: 2023-05-21_21-57-19
Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
----------- 42 de google/flan-t5-base NLI active 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  6.56it/s]100%|██████████| 3/3 [00:00<00:00, 18.86it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.3146e-04],
        [1.7340e-03],
        [7.6997e-04],
        [5.0467e-04],
        [3.3514e-03],
        [9.2658e-04],
        [2.9566e-04],
        [3.0719e-03],
        [9.1777e-04],
        [1.5432e-03],
        [2.3695e-04],
        [1.6007e-03],
        [4.5767e-04],
        [1.9776e-03],
        [1.8417e-07],
        [1.6674e-03]], device='cuda:0') / tensor([[2.3146e-04, 1.7340e-03, 7.6997e-04, 5.0467e-04, 3.3514e-03, 9.2658e-04,
         2.9566e-04, 3.0719e-03, 9.1777e-04, 1.5432e-03, 2.3695e-04, 1.6007e-03,
         4.5767e-04, 1.9776e-03, 1.8417e-07, 1.6674e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.3910e-04],
        [1.9979e-03],
        [5.8655e-03],
        [7.1136e-04],
        [9.7467e-04],
        [1.0076e-03],
        [2.0746e-03],
        [1.9213e-03],
        [4.6745e-03],
        [1.7980e-03],
        [2.3023e-04],
        [2.8540e-03],
        [5.1193e-04],
        [3.7386e-03],
        [1.0031e-07],
        [4.0157e-03]], device='cuda:0') / tensor([[5.3910e-04, 1.9979e-03, 5.8655e-03, 7.1136e-04, 9.7467e-04, 1.0076e-03,
         2.0746e-03, 1.9213e-03, 4.6745e-03, 1.7980e-03, 2.3023e-04, 2.8540e-03,
         5.1193e-04, 3.7386e-03, 1.0031e-07, 4.0157e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[9.6731e-06],
        [1.4560e-04],
        [6.0637e-05],
        [2.5533e-05],
        [1.2846e-04],
        [5.0035e-05],
        [2.5622e-05],
        [1.4341e-04],
        [1.3961e-04],
        [3.8218e-05],
        [7.4898e-06],
        [2.9560e-04],
        [5.3205e-06],
        [1.7313e-04],
        [5.0943e-09],
        [3.3372e-04]], device='cuda:0') / tensor([[9.6731e-06, 1.4560e-04, 6.0637e-05, 2.5533e-05, 1.2846e-04, 5.0035e-05,
         2.5622e-05, 1.4341e-04, 1.3961e-04, 3.8218e-05, 7.4898e-06, 2.9560e-04,
         5.3205e-06, 1.7313e-04, 5.0943e-09, 3.3372e-04]], device='cuda:0')
answers_probs: tensor([[2.3146e-04, 5.3910e-04, 9.6731e-06],
        [1.7340e-03, 1.9979e-03, 1.4560e-04],
        [7.6997e-04, 5.8655e-03, 6.0637e-05],
        [5.0467e-04, 7.1136e-04, 2.5533e-05],
        [3.3514e-03, 9.7467e-04, 1.2846e-04],
        [9.2658e-04, 1.0076e-03, 5.0035e-05],
        [2.9566e-04, 2.0746e-03, 2.5622e-05],
        [3.0719e-03, 1.9213e-03, 1.4341e-04],
        [9.1777e-04, 4.6745e-03, 1.3961e-04],
        [1.5432e-03, 1.7980e-03, 3.8218e-05],
        [2.3695e-04, 2.3023e-04, 7.4898e-06],
        [1.6007e-03, 2.8540e-03, 2.9560e-04],
        [4.5767e-04, 5.1193e-04, 5.3205e-06],
        [1.9776e-03, 3.7386e-03, 1.7313e-04],
        [1.8417e-07, 1.0031e-07, 5.0943e-09],
        [1.6674e-03, 4.0157e-03, 3.3372e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.9306e-03],
        [4.8617e-04],
        [2.9181e-04],
        [9.8698e-05],
        [4.4437e-04],
        [1.6815e-03],
        [1.6380e-07],
        [4.1698e-04],
        [2.1575e-03],
        [1.1953e-03],
        [4.1880e-04],
        [1.5368e-03],
        [2.2252e-04],
        [4.5914e-04],
        [9.2759e-04],
        [1.5242e-03]], device='cuda:0') / tensor([[1.9306e-03, 4.8617e-04, 2.9181e-04, 9.8698e-05, 4.4437e-04, 1.6815e-03,
         1.6380e-07, 4.1698e-04, 2.1575e-03, 1.1953e-03, 4.1880e-04, 1.5368e-03,
         2.2252e-04, 4.5914e-04, 9.2759e-04, 1.5242e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[7.6629e-04],
        [7.6333e-04],
        [4.3109e-04],
        [3.7431e-04],
        [1.7442e-04],
        [3.6647e-03],
        [8.1343e-08],
        [1.0900e-03],
        [1.2511e-03],
        [1.7159e-03],
        [1.0577e-03],
        [1.4266e-03],
        [1.6796e-04],
        [1.2485e-03],
        [7.9882e-04],
        [7.2077e-04]], device='cuda:0') / tensor([[7.6629e-04, 7.6333e-04, 4.3109e-04, 3.7431e-04, 1.7442e-04, 3.6647e-03,
         8.1343e-08, 1.0900e-03, 1.2511e-03, 1.7159e-03, 1.0577e-03, 1.4266e-03,
         1.6796e-04, 1.2485e-03, 7.9882e-04, 7.2077e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.1685e-04],
        [3.1709e-05],
        [7.6564e-05],
        [7.2145e-06],
        [1.5985e-05],
        [9.9421e-05],
        [3.7535e-09],
        [2.9165e-05],
        [1.8749e-04],
        [9.2178e-05],
        [3.3930e-05],
        [9.6777e-05],
        [2.7915e-06],
        [2.6150e-05],
        [2.2351e-04],
        [7.4085e-05]], device='cuda:0') / tensor([[1.1685e-04, 3.1709e-05, 7.6564e-05, 7.2145e-06, 1.5985e-05, 9.9421e-05,
         3.7535e-09, 2.9165e-05, 1.8749e-04, 9.2178e-05, 3.3930e-05, 9.6777e-05,
         2.7915e-06, 2.6150e-05, 2.2351e-04, 7.4085e-05]], device='cuda:0')
answers_probs: tensor([[1.9306e-03, 7.6629e-04, 1.1685e-04],
        [4.8617e-04, 7.6333e-04, 3.1709e-05],
        [2.9181e-04, 4.3109e-04, 7.6564e-05],
        [9.8698e-05, 3.7431e-04, 7.2145e-06],
        [4.4437e-04, 1.7442e-04, 1.5985e-05],
        [1.6815e-03, 3.6647e-03, 9.9421e-05],
        [1.6380e-07, 8.1343e-08, 3.7535e-09],
        [4.1698e-04, 1.0900e-03, 2.9165e-05],
        [2.1575e-03, 1.2511e-03, 1.8749e-04],
        [1.1953e-03, 1.7159e-03, 9.2178e-05],
        [4.1880e-04, 1.0577e-03, 3.3930e-05],
        [1.5368e-03, 1.4266e-03, 9.6777e-05],
        [2.2252e-04, 1.6796e-04, 2.7915e-06],
        [4.5914e-04, 1.2485e-03, 2.6150e-05],
        [9.2759e-04, 7.9882e-04, 2.2351e-04],
        [1.5242e-03, 7.2077e-04, 7.4085e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[6.4983e-04],
        [4.4570e-03],
        [1.3410e-03],
        [2.6813e-03],
        [5.3692e-04],
        [4.1773e-03],
        [1.1489e-03],
        [1.1249e-03],
        [1.6681e-07],
        [9.0645e-04],
        [3.3593e-03],
        [1.4483e-03],
        [9.4765e-04],
        [3.3854e-04],
        [8.8871e-04],
        [2.4961e-03]], device='cuda:0') / tensor([[6.4983e-04, 4.4570e-03, 1.3410e-03, 2.6813e-03, 5.3692e-04, 4.1773e-03,
         1.1489e-03, 1.1249e-03, 1.6681e-07, 9.0645e-04, 3.3593e-03, 1.4483e-03,
         9.4765e-04, 3.3854e-04, 8.8871e-04, 2.4961e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.9712e-03],
        [2.8901e-03],
        [4.8938e-03],
        [1.6402e-04],
        [8.6965e-04],
        [4.6890e-03],
        [2.0164e-03],
        [3.9292e-03],
        [3.3448e-08],
        [2.8085e-03],
        [3.5950e-03],
        [1.4380e-03],
        [5.6067e-03],
        [6.0438e-04],
        [9.4065e-04],
        [1.2026e-03]], device='cuda:0') / tensor([[2.9712e-03, 2.8901e-03, 4.8938e-03, 1.6402e-04, 8.6965e-04, 4.6890e-03,
         2.0164e-03, 3.9292e-03, 3.3448e-08, 2.8085e-03, 3.5950e-03, 1.4380e-03,
         5.6067e-03, 6.0438e-04, 9.4065e-04, 1.2026e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[2.0611e-05],
        [1.0458e-04],
        [5.2688e-05],
        [1.2059e-04],
        [2.8868e-05],
        [1.8467e-04],
        [6.5887e-05],
        [6.3326e-05],
        [9.8851e-09],
        [6.5087e-05],
        [2.0680e-04],
        [4.9744e-05],
        [1.2819e-04],
        [1.1843e-05],
        [6.9060e-05],
        [1.9464e-05]], device='cuda:0') / tensor([[2.0611e-05, 1.0458e-04, 5.2688e-05, 1.2059e-04, 2.8868e-05, 1.8467e-04,
         6.5887e-05, 6.3326e-05, 9.8851e-09, 6.5087e-05, 2.0680e-04, 4.9744e-05,
         1.2819e-04, 1.1843e-05, 6.9060e-05, 1.9464e-05]], device='cuda:0')
answers_probs: tensor([[6.4983e-04, 2.9712e-03, 2.0611e-05],
        [4.4570e-03, 2.8901e-03, 1.0458e-04],
        [1.3410e-03, 4.8938e-03, 5.2688e-05],
        [2.6813e-03, 1.6402e-04, 1.2059e-04],
        [5.3692e-04, 8.6965e-04, 2.8868e-05],
        [4.1773e-03, 4.6890e-03, 1.8467e-04],
        [1.1489e-03, 2.0164e-03, 6.5887e-05],
        [1.1249e-03, 3.9292e-03, 6.3326e-05],
        [1.6681e-07, 3.3448e-08, 9.8851e-09],
        [9.0645e-04, 2.8085e-03, 6.5087e-05],
        [3.3593e-03, 3.5950e-03, 2.0680e-04],
        [1.4483e-03, 1.4380e-03, 4.9744e-05],
        [9.4765e-04, 5.6067e-03, 1.2819e-04],
        [3.3854e-04, 6.0438e-04, 1.1843e-05],
        [8.8871e-04, 9.4065e-04, 6.9060e-05],
        [2.4961e-03, 1.2026e-03, 1.9464e-05]], device='cuda:0')
acc:  0.375
Time taken to execute the de NLI task with prompt type active, variation 0 and batchsize 16: 0:02:53.161782
path ['42', 'de', 'flan', 'NLI', 'active', 'prompt_id_0']
----------- 42 de google/flan-t5-base NLI active 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 283.93it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.9498e-03],
        [9.1054e-04],
        [1.8908e-03],
        [4.1345e-03],
        [2.8472e-03],
        [1.0873e-03],
        [1.9398e-03],
        [1.7871e-07],
        [1.0941e-03],
        [5.8113e-04],
        [2.8811e-03],
        [4.7764e-04],
        [2.4430e-03],
        [3.9351e-03],
        [1.9840e-03],
        [1.2503e-03]], device='cuda:0') / tensor([[1.9498e-03, 9.1054e-04, 1.8908e-03, 4.1345e-03, 2.8472e-03, 1.0873e-03,
         1.9398e-03, 1.7871e-07, 1.0941e-03, 5.8113e-04, 2.8811e-03, 4.7764e-04,
         2.4430e-03, 3.9351e-03, 1.9840e-03, 1.2503e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.2863e-03],
        [4.7714e-03],
        [6.3270e-03],
        [1.5256e-02],
        [8.9155e-03],
        [1.8979e-03],
        [6.9453e-03],
        [2.6723e-07],
        [2.9418e-03],
        [2.5565e-03],
        [1.2898e-02],
        [2.6668e-04],
        [1.7978e-02],
        [7.1913e-03],
        [4.1892e-03],
        [4.2241e-03]], device='cuda:0') / tensor([[5.2863e-03, 4.7714e-03, 6.3270e-03, 1.5256e-02, 8.9155e-03, 1.8979e-03,
         6.9453e-03, 2.6723e-07, 2.9418e-03, 2.5565e-03, 1.2898e-02, 2.6668e-04,
         1.7978e-02, 7.1913e-03, 4.1892e-03, 4.2241e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[9.9505e-04],
        [7.5228e-04],
        [2.0771e-03],
        [1.2134e-03],
        [2.8374e-03],
        [2.3053e-04],
        [6.1256e-04],
        [1.3751e-08],
        [2.6009e-04],
        [3.4821e-04],
        [1.2106e-03],
        [3.7638e-04],
        [3.8399e-03],
        [1.6324e-03],
        [6.5945e-04],
        [5.6376e-04]], device='cuda:0') / tensor([[9.9505e-04, 7.5228e-04, 2.0771e-03, 1.2134e-03, 2.8374e-03, 2.3053e-04,
         6.1256e-04, 1.3751e-08, 2.6009e-04, 3.4821e-04, 1.2106e-03, 3.7638e-04,
         3.8399e-03, 1.6324e-03, 6.5945e-04, 5.6376e-04]], device='cuda:0')
answers_probs: tensor([[1.9498e-03, 5.2863e-03, 9.9505e-04],
        [9.1054e-04, 4.7714e-03, 7.5228e-04],
        [1.8908e-03, 6.3270e-03, 2.0771e-03],
        [4.1345e-03, 1.5256e-02, 1.2134e-03],
        [2.8472e-03, 8.9155e-03, 2.8374e-03],
        [1.0873e-03, 1.8979e-03, 2.3053e-04],
        [1.9398e-03, 6.9453e-03, 6.1256e-04],
        [1.7871e-07, 2.6723e-07, 1.3751e-08],
        [1.0941e-03, 2.9418e-03, 2.6009e-04],
        [5.8113e-04, 2.5565e-03, 3.4821e-04],
        [2.8811e-03, 1.2898e-02, 1.2106e-03],
        [4.7764e-04, 2.6668e-04, 3.7638e-04],
        [2.4430e-03, 1.7978e-02, 3.8399e-03],
        [3.9351e-03, 7.1913e-03, 1.6324e-03],
        [1.9840e-03, 4.1892e-03, 6.5945e-04],
        [1.2503e-03, 4.2241e-03, 5.6376e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.3758e-03],
        [3.8196e-04],
        [5.9653e-04],
        [2.0567e-07],
        [2.8304e-04],
        [1.1471e-03],
        [1.1034e-03],
        [1.5389e-03],
        [2.5829e-04],
        [3.6924e-04],
        [1.9377e-03],
        [8.4148e-04],
        [5.5102e-04],
        [1.0587e-03],
        [1.6775e-03],
        [1.2124e-03]], device='cuda:0') / tensor([[1.3758e-03, 3.8196e-04, 5.9653e-04, 2.0567e-07, 2.8304e-04, 1.1471e-03,
         1.1034e-03, 1.5389e-03, 2.5829e-04, 3.6924e-04, 1.9377e-03, 8.4148e-04,
         5.5102e-04, 1.0587e-03, 1.6775e-03, 1.2124e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.3593e-03],
        [1.4938e-03],
        [2.4471e-03],
        [3.6183e-07],
        [1.6025e-03],
        [5.4000e-03],
        [5.0025e-03],
        [4.6350e-03],
        [1.4907e-03],
        [4.8320e-03],
        [1.3352e-02],
        [2.5487e-03],
        [1.4132e-03],
        [3.1616e-03],
        [6.7579e-03],
        [1.9210e-03]], device='cuda:0') / tensor([[9.3593e-03, 1.4938e-03, 2.4471e-03, 3.6183e-07, 1.6025e-03, 5.4000e-03,
         5.0025e-03, 4.6350e-03, 1.4907e-03, 4.8320e-03, 1.3352e-02, 2.5487e-03,
         1.4132e-03, 3.1616e-03, 6.7579e-03, 1.9210e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.8558e-04],
        [5.0476e-04],
        [2.2549e-04],
        [1.7766e-08],
        [1.8471e-04],
        [3.9905e-04],
        [3.3067e-04],
        [1.1127e-03],
        [6.9823e-05],
        [3.2702e-04],
        [1.1650e-03],
        [1.4497e-03],
        [4.2219e-04],
        [6.2220e-05],
        [9.2306e-04],
        [2.1936e-04]], device='cuda:0') / tensor([[3.8558e-04, 5.0476e-04, 2.2549e-04, 1.7766e-08, 1.8471e-04, 3.9905e-04,
         3.3067e-04, 1.1127e-03, 6.9823e-05, 3.2702e-04, 1.1650e-03, 1.4497e-03,
         4.2219e-04, 6.2220e-05, 9.2306e-04, 2.1936e-04]], device='cuda:0')
answers_probs: tensor([[1.3758e-03, 9.3593e-03, 3.8558e-04],
        [3.8196e-04, 1.4938e-03, 5.0476e-04],
        [5.9653e-04, 2.4471e-03, 2.2549e-04],
        [2.0567e-07, 3.6183e-07, 1.7766e-08],
        [2.8304e-04, 1.6025e-03, 1.8471e-04],
        [1.1471e-03, 5.4000e-03, 3.9905e-04],
        [1.1034e-03, 5.0025e-03, 3.3067e-04],
        [1.5389e-03, 4.6350e-03, 1.1127e-03],
        [2.5829e-04, 1.4907e-03, 6.9823e-05],
        [3.6924e-04, 4.8320e-03, 3.2702e-04],
        [1.9377e-03, 1.3352e-02, 1.1650e-03],
        [8.4148e-04, 2.5487e-03, 1.4497e-03],
        [5.5102e-04, 1.4132e-03, 4.2219e-04],
        [1.0587e-03, 3.1616e-03, 6.2220e-05],
        [1.6775e-03, 6.7579e-03, 9.2306e-04],
        [1.2124e-03, 1.9210e-03, 2.1936e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.2004e-03],
        [1.8361e-03],
        [1.3005e-04],
        [4.6609e-04],
        [7.0800e-04],
        [2.0429e-04],
        [6.2819e-04],
        [2.2951e-04],
        [2.8951e-04],
        [8.8331e-04],
        [3.7682e-04],
        [3.6995e-04],
        [4.8755e-04],
        [5.1080e-04],
        [4.4216e-07],
        [8.5357e-04]], device='cuda:0') / tensor([[1.2004e-03, 1.8361e-03, 1.3005e-04, 4.6609e-04, 7.0800e-04, 2.0429e-04,
         6.2819e-04, 2.2951e-04, 2.8951e-04, 8.8331e-04, 3.7682e-04, 3.6995e-04,
         4.8755e-04, 5.1080e-04, 4.4216e-07, 8.5357e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.3080e-02],
        [3.2988e-03],
        [3.2344e-03],
        [3.4867e-03],
        [1.3841e-02],
        [4.2229e-03],
        [3.2706e-03],
        [3.0360e-03],
        [2.0757e-03],
        [4.6799e-03],
        [8.9341e-03],
        [1.4004e-03],
        [3.8168e-03],
        [5.8775e-03],
        [5.7829e-07],
        [5.2200e-03]], device='cuda:0') / tensor([[1.3080e-02, 3.2988e-03, 3.2344e-03, 3.4867e-03, 1.3841e-02, 4.2229e-03,
         3.2706e-03, 3.0360e-03, 2.0757e-03, 4.6799e-03, 8.9341e-03, 1.4004e-03,
         3.8168e-03, 5.8775e-03, 5.7829e-07, 5.2200e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[4.8666e-04],
        [5.7561e-04],
        [2.1308e-04],
        [4.4188e-04],
        [4.3676e-04],
        [1.7851e-04],
        [1.8011e-04],
        [1.7889e-04],
        [1.5169e-04],
        [2.9716e-04],
        [1.2312e-04],
        [1.2063e-04],
        [1.8559e-04],
        [3.0730e-04],
        [2.6809e-08],
        [4.2672e-04]], device='cuda:0') / tensor([[4.8666e-04, 5.7561e-04, 2.1308e-04, 4.4188e-04, 4.3676e-04, 1.7851e-04,
         1.8011e-04, 1.7889e-04, 1.5169e-04, 2.9716e-04, 1.2312e-04, 1.2063e-04,
         1.8559e-04, 3.0730e-04, 2.6809e-08, 4.2672e-04]], device='cuda:0')
answers_probs: tensor([[1.2004e-03, 1.3080e-02, 4.8666e-04],
        [1.8361e-03, 3.2988e-03, 5.7561e-04],
        [1.3005e-04, 3.2344e-03, 2.1308e-04],
        [4.6609e-04, 3.4867e-03, 4.4188e-04],
        [7.0800e-04, 1.3841e-02, 4.3676e-04],
        [2.0429e-04, 4.2229e-03, 1.7851e-04],
        [6.2819e-04, 3.2706e-03, 1.8011e-04],
        [2.2951e-04, 3.0360e-03, 1.7889e-04],
        [2.8951e-04, 2.0757e-03, 1.5169e-04],
        [8.8331e-04, 4.6799e-03, 2.9716e-04],
        [3.7682e-04, 8.9341e-03, 1.2312e-04],
        [3.6995e-04, 1.4004e-03, 1.2063e-04],
        [4.8755e-04, 3.8168e-03, 1.8559e-04],
        [5.1080e-04, 5.8775e-03, 3.0730e-04],
        [4.4216e-07, 5.7829e-07, 2.6809e-08],
        [8.5357e-04, 5.2200e-03, 4.2672e-04]], device='cuda:0')
acc:  0.3541666666666667
Time taken to execute the de NLI task with prompt type active, variation 1 and batchsize 16: 0:02:53.662159
path ['42', 'de', 'flan', 'NLI', 'active', 'prompt_id_1']
----------- 42 de google/flan-t5-base NLI active 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 329.30it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.2633e-05],
        [7.6434e-04],
        [3.7235e-05],
        [3.1037e-04],
        [5.7656e-05],
        [6.6043e-04],
        [1.5849e-03],
        [2.9716e-04],
        [1.2164e-03],
        [1.1527e-04],
        [2.5011e-04],
        [8.4946e-04],
        [1.5725e-04],
        [9.1501e-04],
        [7.9475e-04],
        [4.0239e-04]], device='cuda:0') / tensor([[3.2633e-05, 7.6434e-04, 3.7235e-05, 3.1037e-04, 5.7656e-05, 6.6043e-04,
         1.5849e-03, 2.9716e-04, 1.2164e-03, 1.1527e-04, 2.5011e-04, 8.4946e-04,
         1.5725e-04, 9.1501e-04, 7.9475e-04, 4.0239e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.2525e-05],
        [5.2197e-03],
        [1.6310e-05],
        [6.0200e-04],
        [1.6670e-04],
        [1.3920e-03],
        [2.3492e-03],
        [6.3914e-04],
        [7.2464e-03],
        [2.0659e-04],
        [1.0964e-03],
        [2.4465e-03],
        [5.1170e-05],
        [2.0991e-04],
        [3.6172e-03],
        [1.5980e-03]], device='cuda:0') / tensor([[6.2525e-05, 5.2197e-03, 1.6310e-05, 6.0200e-04, 1.6670e-04, 1.3920e-03,
         2.3492e-03, 6.3914e-04, 7.2464e-03, 2.0659e-04, 1.0964e-03, 2.4465e-03,
         5.1170e-05, 2.0991e-04, 3.6172e-03, 1.5980e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.8827e-05],
        [9.4285e-05],
        [2.1172e-04],
        [3.7013e-04],
        [7.4006e-05],
        [7.7856e-04],
        [1.6816e-04],
        [9.0428e-05],
        [4.1913e-04],
        [1.3377e-04],
        [2.2804e-04],
        [2.1562e-04],
        [4.1162e-04],
        [5.0361e-05],
        [5.1176e-04],
        [4.5887e-05]], device='cuda:0') / tensor([[3.8827e-05, 9.4285e-05, 2.1172e-04, 3.7013e-04, 7.4006e-05, 7.7856e-04,
         1.6816e-04, 9.0428e-05, 4.1913e-04, 1.3377e-04, 2.2804e-04, 2.1562e-04,
         4.1162e-04, 5.0361e-05, 5.1176e-04, 4.5887e-05]], device='cuda:0')
answers_probs: tensor([[3.2633e-05, 6.2525e-05, 3.8827e-05],
        [7.6434e-04, 5.2197e-03, 9.4285e-05],
        [3.7235e-05, 1.6310e-05, 2.1172e-04],
        [3.1037e-04, 6.0200e-04, 3.7013e-04],
        [5.7656e-05, 1.6670e-04, 7.4006e-05],
        [6.6043e-04, 1.3920e-03, 7.7856e-04],
        [1.5849e-03, 2.3492e-03, 1.6816e-04],
        [2.9716e-04, 6.3914e-04, 9.0428e-05],
        [1.2164e-03, 7.2464e-03, 4.1913e-04],
        [1.1527e-04, 2.0659e-04, 1.3377e-04],
        [2.5011e-04, 1.0964e-03, 2.2804e-04],
        [8.4946e-04, 2.4465e-03, 2.1562e-04],
        [1.5725e-04, 5.1170e-05, 4.1162e-04],
        [9.1501e-04, 2.0991e-04, 5.0361e-05],
        [7.9475e-04, 3.6172e-03, 5.1176e-04],
        [4.0239e-04, 1.5980e-03, 4.5887e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.2430e-04],
        [5.0838e-05],
        [4.6114e-04],
        [3.0992e-04],
        [3.0145e-04],
        [6.4492e-04],
        [1.5056e-04],
        [4.4354e-04],
        [6.1274e-04],
        [8.4264e-05],
        [1.1806e-04],
        [6.0992e-04],
        [1.3794e-04],
        [7.7161e-04],
        [1.6872e-04],
        [8.1233e-05]], device='cuda:0') / tensor([[2.2430e-04, 5.0838e-05, 4.6114e-04, 3.0992e-04, 3.0145e-04, 6.4492e-04,
         1.5056e-04, 4.4354e-04, 6.1274e-04, 8.4264e-05, 1.1806e-04, 6.0992e-04,
         1.3794e-04, 7.7161e-04, 1.6872e-04, 8.1233e-05]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.0059e-04],
        [6.5631e-05],
        [1.1853e-03],
        [1.4786e-03],
        [8.5971e-04],
        [1.2469e-03],
        [1.5419e-04],
        [9.8567e-04],
        [6.9452e-04],
        [8.6924e-05],
        [5.6098e-04],
        [6.3590e-04],
        [5.4447e-04],
        [1.9274e-03],
        [8.2730e-04],
        [3.5779e-05]], device='cuda:0') / tensor([[6.0059e-04, 6.5631e-05, 1.1853e-03, 1.4786e-03, 8.5971e-04, 1.2469e-03,
         1.5419e-04, 9.8567e-04, 6.9452e-04, 8.6924e-05, 5.6098e-04, 6.3590e-04,
         5.4447e-04, 1.9274e-03, 8.2730e-04, 3.5779e-05]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.2411e-04],
        [1.0441e-04],
        [5.0116e-05],
        [6.8596e-05],
        [1.2499e-04],
        [2.0259e-04],
        [2.2831e-04],
        [1.3028e-04],
        [1.0247e-04],
        [1.0329e-04],
        [5.3934e-05],
        [2.2023e-04],
        [9.0961e-05],
        [1.7021e-04],
        [6.3058e-05],
        [5.8728e-04]], device='cuda:0') / tensor([[1.2411e-04, 1.0441e-04, 5.0116e-05, 6.8596e-05, 1.2499e-04, 2.0259e-04,
         2.2831e-04, 1.3028e-04, 1.0247e-04, 1.0329e-04, 5.3934e-05, 2.2023e-04,
         9.0961e-05, 1.7021e-04, 6.3058e-05, 5.8728e-04]], device='cuda:0')
answers_probs: tensor([[2.2430e-04, 6.0059e-04, 1.2411e-04],
        [5.0838e-05, 6.5631e-05, 1.0441e-04],
        [4.6114e-04, 1.1853e-03, 5.0116e-05],
        [3.0992e-04, 1.4786e-03, 6.8596e-05],
        [3.0145e-04, 8.5971e-04, 1.2499e-04],
        [6.4492e-04, 1.2469e-03, 2.0259e-04],
        [1.5056e-04, 1.5419e-04, 2.2831e-04],
        [4.4354e-04, 9.8567e-04, 1.3028e-04],
        [6.1274e-04, 6.9452e-04, 1.0247e-04],
        [8.4264e-05, 8.6924e-05, 1.0329e-04],
        [1.1806e-04, 5.6098e-04, 5.3934e-05],
        [6.0992e-04, 6.3590e-04, 2.2023e-04],
        [1.3794e-04, 5.4447e-04, 9.0961e-05],
        [7.7161e-04, 1.9274e-03, 1.7021e-04],
        [1.6872e-04, 8.2730e-04, 6.3058e-05],
        [8.1233e-05, 3.5779e-05, 5.8728e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.5568e-04],
        [5.8920e-04],
        [1.1891e-04],
        [4.8539e-04],
        [5.1533e-04],
        [6.4234e-05],
        [7.6123e-04],
        [3.8787e-04],
        [3.2842e-04],
        [5.3561e-04],
        [7.3003e-04],
        [1.9144e-04],
        [1.3001e-04],
        [5.0198e-04],
        [1.0283e-04],
        [2.4167e-04]], device='cuda:0') / tensor([[3.5568e-04, 5.8920e-04, 1.1891e-04, 4.8539e-04, 5.1533e-04, 6.4234e-05,
         7.6123e-04, 3.8787e-04, 3.2842e-04, 5.3561e-04, 7.3003e-04, 1.9144e-04,
         1.3001e-04, 5.0198e-04, 1.0283e-04, 2.4167e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.6993e-04],
        [2.6152e-03],
        [3.6325e-05],
        [1.0997e-03],
        [4.3056e-03],
        [6.4725e-04],
        [1.2196e-03],
        [6.4990e-04],
        [1.6568e-03],
        [4.9718e-04],
        [1.2101e-03],
        [1.5428e-04],
        [1.2873e-04],
        [3.0510e-03],
        [2.7468e-04],
        [2.7532e-04]], device='cuda:0') / tensor([[9.6993e-04, 2.6152e-03, 3.6325e-05, 1.0997e-03, 4.3056e-03, 6.4725e-04,
         1.2196e-03, 6.4990e-04, 1.6568e-03, 4.9718e-04, 1.2101e-03, 1.5428e-04,
         1.2873e-04, 3.0510e-03, 2.7468e-04, 2.7532e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[3.3817e-04],
        [4.8705e-04],
        [2.5548e-04],
        [7.5183e-05],
        [1.9022e-04],
        [8.4816e-05],
        [2.1942e-04],
        [1.4752e-04],
        [4.4595e-04],
        [5.4432e-04],
        [2.4091e-04],
        [2.8694e-04],
        [1.3156e-04],
        [1.1389e-04],
        [2.5596e-05],
        [2.1254e-04]], device='cuda:0') / tensor([[3.3817e-04, 4.8705e-04, 2.5548e-04, 7.5183e-05, 1.9022e-04, 8.4816e-05,
         2.1942e-04, 1.4752e-04, 4.4595e-04, 5.4432e-04, 2.4091e-04, 2.8694e-04,
         1.3156e-04, 1.1389e-04, 2.5596e-05, 2.1254e-04]], device='cuda:0')
answers_probs: tensor([[3.5568e-04, 9.6993e-04, 3.3817e-04],
        [5.8920e-04, 2.6152e-03, 4.8705e-04],
        [1.1891e-04, 3.6325e-05, 2.5548e-04],
        [4.8539e-04, 1.0997e-03, 7.5183e-05],
        [5.1533e-04, 4.3056e-03, 1.9022e-04],
        [6.4234e-05, 6.4725e-04, 8.4816e-05],
        [7.6123e-04, 1.2196e-03, 2.1942e-04],
        [3.8787e-04, 6.4990e-04, 1.4752e-04],
        [3.2842e-04, 1.6568e-03, 4.4595e-04],
        [5.3561e-04, 4.9718e-04, 5.4432e-04],
        [7.3003e-04, 1.2101e-03, 2.4091e-04],
        [1.9144e-04, 1.5428e-04, 2.8694e-04],
        [1.3001e-04, 1.2873e-04, 1.3156e-04],
        [5.0198e-04, 3.0510e-03, 1.1389e-04],
        [1.0283e-04, 2.7468e-04, 2.5596e-05],
        [2.4167e-04, 2.7532e-04, 2.1254e-04]], device='cuda:0')
acc:  0.375
Time taken to execute the de NLI task with prompt type active, variation 2 and batchsize 16: 0:02:52.750310
path ['42', 'de', 'flan', 'NLI', 'active', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base NLI passive 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 340.50it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.2677e-04],
        [7.7276e-04],
        [1.5377e-03],
        [2.9517e-03],
        [1.7458e-03],
        [6.4602e-04],
        [7.6701e-04],
        [1.4320e-03],
        [2.9829e-04],
        [3.7964e-04],
        [2.5187e-07],
        [3.4987e-04],
        [8.9668e-04],
        [9.2015e-04],
        [6.7233e-04],
        [1.4671e-03]], device='cuda:0') / tensor([[4.2677e-04, 7.7276e-04, 1.5377e-03, 2.9517e-03, 1.7458e-03, 6.4602e-04,
         7.6701e-04, 1.4320e-03, 2.9829e-04, 3.7964e-04, 2.5187e-07, 3.4987e-04,
         8.9668e-04, 9.2015e-04, 6.7233e-04, 1.4671e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.6119e-03],
        [2.4384e-03],
        [1.7601e-03],
        [2.8426e-03],
        [8.0645e-04],
        [1.9381e-03],
        [2.8039e-03],
        [4.3275e-03],
        [2.4957e-04],
        [6.1366e-04],
        [3.6793e-07],
        [1.8308e-03],
        [3.1665e-03],
        [2.9515e-03],
        [1.9770e-03],
        [1.7398e-03]], device='cuda:0') / tensor([[2.6119e-03, 2.4384e-03, 1.7601e-03, 2.8426e-03, 8.0645e-04, 1.9381e-03,
         2.8039e-03, 4.3275e-03, 2.4957e-04, 6.1366e-04, 3.6793e-07, 1.8308e-03,
         3.1665e-03, 2.9515e-03, 1.9770e-03, 1.7398e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.3858e-05],
        [6.9851e-05],
        [4.6655e-05],
        [8.3600e-04],
        [2.9570e-04],
        [8.9067e-05],
        [2.0509e-04],
        [1.3662e-04],
        [8.4996e-06],
        [3.6321e-06],
        [2.0779e-08],
        [5.6972e-05],
        [4.2042e-04],
        [3.6103e-04],
        [1.9213e-04],
        [6.7561e-05]], device='cuda:0') / tensor([[3.3858e-05, 6.9851e-05, 4.6655e-05, 8.3600e-04, 2.9570e-04, 8.9067e-05,
         2.0509e-04, 1.3662e-04, 8.4996e-06, 3.6321e-06, 2.0779e-08, 5.6972e-05,
         4.2042e-04, 3.6103e-04, 1.9213e-04, 6.7561e-05]], device='cuda:0')
answers_probs: tensor([[4.2677e-04, 2.6119e-03, 3.3858e-05],
        [7.7276e-04, 2.4384e-03, 6.9851e-05],
        [1.5377e-03, 1.7601e-03, 4.6655e-05],
        [2.9517e-03, 2.8426e-03, 8.3600e-04],
        [1.7458e-03, 8.0645e-04, 2.9570e-04],
        [6.4602e-04, 1.9381e-03, 8.9067e-05],
        [7.6701e-04, 2.8039e-03, 2.0509e-04],
        [1.4320e-03, 4.3275e-03, 1.3662e-04],
        [2.9829e-04, 2.4957e-04, 8.4996e-06],
        [3.7964e-04, 6.1366e-04, 3.6321e-06],
        [2.5187e-07, 3.6793e-07, 2.0779e-08],
        [3.4987e-04, 1.8308e-03, 5.6972e-05],
        [8.9668e-04, 3.1665e-03, 4.2042e-04],
        [9.2015e-04, 2.9515e-03, 3.6103e-04],
        [6.7233e-04, 1.9770e-03, 1.9213e-04],
        [1.4671e-03, 1.7398e-03, 6.7561e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.5699e-03],
        [1.6978e-03],
        [1.1731e-03],
        [3.5260e-04],
        [4.2312e-04],
        [3.7948e-04],
        [7.1403e-04],
        [5.3487e-04],
        [1.9601e-03],
        [7.4808e-04],
        [9.1473e-04],
        [2.0722e-07],
        [9.0601e-04],
        [1.3846e-04],
        [1.6762e-03],
        [3.1073e-04]], device='cuda:0') / tensor([[1.5699e-03, 1.6978e-03, 1.1731e-03, 3.5260e-04, 4.2312e-04, 3.7948e-04,
         7.1403e-04, 5.3487e-04, 1.9601e-03, 7.4808e-04, 9.1473e-04, 2.0722e-07,
         9.0601e-04, 1.3846e-04, 1.6762e-03, 3.1073e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.1546e-03],
        [7.2091e-03],
        [2.2116e-03],
        [7.9455e-04],
        [3.1533e-03],
        [4.2909e-04],
        [7.6222e-03],
        [4.5765e-03],
        [4.0542e-03],
        [3.8004e-03],
        [1.2623e-03],
        [1.3650e-07],
        [2.9814e-03],
        [3.7482e-04],
        [4.5873e-03],
        [7.1861e-04]], device='cuda:0') / tensor([[9.1546e-03, 7.2091e-03, 2.2116e-03, 7.9455e-04, 3.1533e-03, 4.2909e-04,
         7.6222e-03, 4.5765e-03, 4.0542e-03, 3.8004e-03, 1.2623e-03, 1.3650e-07,
         2.9814e-03, 3.7482e-04, 4.5873e-03, 7.1861e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.0708e-03],
        [1.5908e-04],
        [5.2979e-05],
        [2.6563e-05],
        [4.7442e-04],
        [1.3191e-05],
        [3.3660e-04],
        [1.9314e-04],
        [7.2036e-04],
        [9.3004e-05],
        [6.7206e-05],
        [1.3780e-08],
        [1.3748e-04],
        [1.0102e-05],
        [5.0469e-05],
        [1.8624e-05]], device='cuda:0') / tensor([[1.0708e-03, 1.5908e-04, 5.2979e-05, 2.6563e-05, 4.7442e-04, 1.3191e-05,
         3.3660e-04, 1.9314e-04, 7.2036e-04, 9.3004e-05, 6.7206e-05, 1.3780e-08,
         1.3748e-04, 1.0102e-05, 5.0469e-05, 1.8624e-05]], device='cuda:0')
answers_probs: tensor([[1.5699e-03, 9.1546e-03, 1.0708e-03],
        [1.6978e-03, 7.2091e-03, 1.5908e-04],
        [1.1731e-03, 2.2116e-03, 5.2979e-05],
        [3.5260e-04, 7.9455e-04, 2.6563e-05],
        [4.2312e-04, 3.1533e-03, 4.7442e-04],
        [3.7948e-04, 4.2909e-04, 1.3191e-05],
        [7.1403e-04, 7.6222e-03, 3.3660e-04],
        [5.3487e-04, 4.5765e-03, 1.9314e-04],
        [1.9601e-03, 4.0542e-03, 7.2036e-04],
        [7.4808e-04, 3.8004e-03, 9.3004e-05],
        [9.1473e-04, 1.2623e-03, 6.7206e-05],
        [2.0722e-07, 1.3650e-07, 1.3780e-08],
        [9.0601e-04, 2.9814e-03, 1.3748e-04],
        [1.3846e-04, 3.7482e-04, 1.0102e-05],
        [1.6762e-03, 4.5873e-03, 5.0469e-05],
        [3.1073e-04, 7.1861e-04, 1.8624e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.3739e-03],
        [9.7040e-04],
        [1.9053e-04],
        [1.1202e-03],
        [5.2188e-04],
        [1.0651e-03],
        [7.8141e-04],
        [3.5790e-04],
        [6.6956e-08],
        [3.1206e-04],
        [1.2030e-03],
        [5.9328e-04],
        [1.1679e-03],
        [4.7303e-04],
        [5.7767e-04],
        [4.3331e-04]], device='cuda:0') / tensor([[1.3739e-03, 9.7040e-04, 1.9053e-04, 1.1202e-03, 5.2188e-04, 1.0651e-03,
         7.8141e-04, 3.5790e-04, 6.6956e-08, 3.1206e-04, 1.2030e-03, 5.9328e-04,
         1.1679e-03, 4.7303e-04, 5.7767e-04, 4.3331e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.6952e-03],
        [3.0829e-03],
        [8.9526e-04],
        [1.3904e-03],
        [8.3422e-04],
        [2.5213e-03],
        [2.0793e-03],
        [2.2856e-03],
        [7.4847e-08],
        [1.6418e-03],
        [5.1607e-03],
        [1.1638e-03],
        [1.9956e-03],
        [5.2644e-03],
        [3.7055e-03],
        [4.8152e-03]], device='cuda:0') / tensor([[2.6952e-03, 3.0829e-03, 8.9526e-04, 1.3904e-03, 8.3422e-04, 2.5213e-03,
         2.0793e-03, 2.2856e-03, 7.4847e-08, 1.6418e-03, 5.1607e-03, 1.1638e-03,
         1.9956e-03, 5.2644e-03, 3.7055e-03, 4.8152e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[1.4295e-04],
        [1.9732e-04],
        [3.8316e-05],
        [6.2331e-05],
        [3.5936e-05],
        [4.7563e-04],
        [1.1405e-04],
        [2.4071e-04],
        [2.4998e-09],
        [5.1095e-05],
        [2.8518e-05],
        [2.8365e-05],
        [4.6823e-05],
        [1.9704e-04],
        [4.6667e-04],
        [1.0499e-04]], device='cuda:0') / tensor([[1.4295e-04, 1.9732e-04, 3.8316e-05, 6.2331e-05, 3.5936e-05, 4.7563e-04,
         1.1405e-04, 2.4071e-04, 2.4998e-09, 5.1095e-05, 2.8518e-05, 2.8365e-05,
         4.6823e-05, 1.9704e-04, 4.6667e-04, 1.0499e-04]], device='cuda:0')
answers_probs: tensor([[1.3739e-03, 2.6952e-03, 1.4295e-04],
        [9.7040e-04, 3.0829e-03, 1.9732e-04],
        [1.9053e-04, 8.9526e-04, 3.8316e-05],
        [1.1202e-03, 1.3904e-03, 6.2331e-05],
        [5.2188e-04, 8.3422e-04, 3.5936e-05],
        [1.0651e-03, 2.5213e-03, 4.7563e-04],
        [7.8141e-04, 2.0793e-03, 1.1405e-04],
        [3.5790e-04, 2.2856e-03, 2.4071e-04],
        [6.6956e-08, 7.4847e-08, 2.4998e-09],
        [3.1206e-04, 1.6418e-03, 5.1095e-05],
        [1.2030e-03, 5.1607e-03, 2.8518e-05],
        [5.9328e-04, 1.1638e-03, 2.8365e-05],
        [1.1679e-03, 1.9956e-03, 4.6823e-05],
        [4.7303e-04, 5.2644e-03, 1.9704e-04],
        [5.7767e-04, 3.7055e-03, 4.6667e-04],
        [4.3331e-04, 4.8152e-03, 1.0499e-04]], device='cuda:0')
acc:  0.3333333333333333
Time taken to execute the de NLI task with prompt type passive, variation 0 and batchsize 16: 0:02:53.207661
path ['42', 'de', 'flan', 'NLI', 'passive', 'prompt_id_0']
----------- 42 de google/flan-t5-base NLI passive 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 338.95it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.2458e-04],
        [9.4388e-04],
        [1.3279e-03],
        [2.0461e-03],
        [1.4485e-03],
        [1.3467e-03],
        [5.6838e-08],
        [4.8833e-04],
        [1.0233e-03],
        [2.5127e-03],
        [1.7273e-03],
        [9.5425e-04],
        [1.1234e-03],
        [1.5494e-03],
        [2.9221e-03],
        [2.2472e-03]], device='cuda:0') / tensor([[4.2458e-04, 9.4388e-04, 1.3279e-03, 2.0461e-03, 1.4485e-03, 1.3467e-03,
         5.6838e-08, 4.8833e-04, 1.0233e-03, 2.5127e-03, 1.7273e-03, 9.5425e-04,
         1.1234e-03, 1.5494e-03, 2.9221e-03, 2.2472e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.4685e-03],
        [2.4730e-03],
        [4.7578e-03],
        [3.7641e-03],
        [4.0922e-03],
        [2.0271e-03],
        [4.9602e-08],
        [1.9251e-03],
        [7.9460e-03],
        [7.4945e-03],
        [3.7764e-03],
        [6.3180e-03],
        [3.4131e-03],
        [5.6444e-03],
        [5.3939e-03],
        [5.0212e-03]], device='cuda:0') / tensor([[2.4685e-03, 2.4730e-03, 4.7578e-03, 3.7641e-03, 4.0922e-03, 2.0271e-03,
         4.9602e-08, 1.9251e-03, 7.9460e-03, 7.4945e-03, 3.7764e-03, 6.3180e-03,
         3.4131e-03, 5.6444e-03, 5.3939e-03, 5.0212e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[6.6204e-04],
        [4.5301e-04],
        [5.2235e-04],
        [1.1316e-03],
        [3.2747e-03],
        [1.5759e-03],
        [2.1202e-09],
        [5.1892e-04],
        [8.8738e-04],
        [1.3685e-03],
        [1.3995e-03],
        [4.5361e-04],
        [1.2610e-03],
        [5.5230e-04],
        [1.8653e-03],
        [6.0645e-04]], device='cuda:0') / tensor([[6.6204e-04, 4.5301e-04, 5.2235e-04, 1.1316e-03, 3.2747e-03, 1.5759e-03,
         2.1202e-09, 5.1892e-04, 8.8738e-04, 1.3685e-03, 1.3995e-03, 4.5361e-04,
         1.2610e-03, 5.5230e-04, 1.8653e-03, 6.0645e-04]], device='cuda:0')
answers_probs: tensor([[4.2458e-04, 2.4685e-03, 6.6204e-04],
        [9.4388e-04, 2.4730e-03, 4.5301e-04],
        [1.3279e-03, 4.7578e-03, 5.2235e-04],
        [2.0461e-03, 3.7641e-03, 1.1316e-03],
        [1.4485e-03, 4.0922e-03, 3.2747e-03],
        [1.3467e-03, 2.0271e-03, 1.5759e-03],
        [5.6838e-08, 4.9602e-08, 2.1202e-09],
        [4.8833e-04, 1.9251e-03, 5.1892e-04],
        [1.0233e-03, 7.9460e-03, 8.8738e-04],
        [2.5127e-03, 7.4945e-03, 1.3685e-03],
        [1.7273e-03, 3.7764e-03, 1.3995e-03],
        [9.5425e-04, 6.3180e-03, 4.5361e-04],
        [1.1234e-03, 3.4131e-03, 1.2610e-03],
        [1.5494e-03, 5.6444e-03, 5.5230e-04],
        [2.9221e-03, 5.3939e-03, 1.8653e-03],
        [2.2472e-03, 5.0212e-03, 6.0645e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[7.0048e-04],
        [1.1339e-03],
        [3.5069e-03],
        [9.5262e-04],
        [8.4558e-04],
        [2.1054e-07],
        [6.0186e-04],
        [1.6430e-03],
        [4.0661e-04],
        [1.2127e-03],
        [1.8789e-03],
        [2.4868e-03],
        [1.8167e-03],
        [1.5371e-03],
        [7.2102e-04],
        [1.1209e-03]], device='cuda:0') / tensor([[7.0048e-04, 1.1339e-03, 3.5069e-03, 9.5262e-04, 8.4558e-04, 2.1054e-07,
         6.0186e-04, 1.6430e-03, 4.0661e-04, 1.2127e-03, 1.8789e-03, 2.4868e-03,
         1.8167e-03, 1.5371e-03, 7.2102e-04, 1.1209e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.6843e-03],
        [7.4032e-03],
        [1.4610e-02],
        [3.3452e-03],
        [5.3392e-03],
        [9.8088e-08],
        [5.1695e-03],
        [5.9017e-03],
        [2.1485e-03],
        [6.3197e-03],
        [3.8763e-03],
        [8.1444e-03],
        [4.8563e-03],
        [6.9645e-03],
        [6.4314e-03],
        [5.6886e-03]], device='cuda:0') / tensor([[5.6843e-03, 7.4032e-03, 1.4610e-02, 3.3452e-03, 5.3392e-03, 9.8088e-08,
         5.1695e-03, 5.9017e-03, 2.1485e-03, 6.3197e-03, 3.8763e-03, 8.1444e-03,
         4.8563e-03, 6.9645e-03, 6.4314e-03, 5.6886e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[4.5456e-04],
        [2.1179e-03],
        [2.9323e-03],
        [1.1265e-03],
        [2.5488e-04],
        [3.6237e-09],
        [6.1674e-04],
        [4.8509e-04],
        [3.4156e-04],
        [4.2457e-04],
        [2.5526e-04],
        [2.8400e-04],
        [1.2841e-03],
        [1.2515e-03],
        [5.3143e-04],
        [7.6878e-04]], device='cuda:0') / tensor([[4.5456e-04, 2.1179e-03, 2.9323e-03, 1.1265e-03, 2.5488e-04, 3.6237e-09,
         6.1674e-04, 4.8509e-04, 3.4156e-04, 4.2457e-04, 2.5526e-04, 2.8400e-04,
         1.2841e-03, 1.2515e-03, 5.3143e-04, 7.6878e-04]], device='cuda:0')
answers_probs: tensor([[7.0048e-04, 5.6843e-03, 4.5456e-04],
        [1.1339e-03, 7.4032e-03, 2.1179e-03],
        [3.5069e-03, 1.4610e-02, 2.9323e-03],
        [9.5262e-04, 3.3452e-03, 1.1265e-03],
        [8.4558e-04, 5.3392e-03, 2.5488e-04],
        [2.1054e-07, 9.8088e-08, 3.6237e-09],
        [6.0186e-04, 5.1695e-03, 6.1674e-04],
        [1.6430e-03, 5.9017e-03, 4.8509e-04],
        [4.0661e-04, 2.1485e-03, 3.4156e-04],
        [1.2127e-03, 6.3197e-03, 4.2457e-04],
        [1.8789e-03, 3.8763e-03, 2.5526e-04],
        [2.4868e-03, 8.1444e-03, 2.8400e-04],
        [1.8167e-03, 4.8563e-03, 1.2841e-03],
        [1.5371e-03, 6.9645e-03, 1.2515e-03],
        [7.2102e-04, 6.4314e-03, 5.3143e-04],
        [1.1209e-03, 5.6886e-03, 7.6878e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[5.3344e-04],
        [1.1109e-03],
        [1.2259e-03],
        [2.6924e-03],
        [7.7944e-04],
        [6.5899e-04],
        [9.0440e-04],
        [6.0745e-04],
        [8.6075e-04],
        [3.0412e-04],
        [7.4998e-04],
        [1.4970e-03],
        [7.0282e-04],
        [6.7629e-04],
        [4.9654e-08],
        [4.8923e-04]], device='cuda:0') / tensor([[5.3344e-04, 1.1109e-03, 1.2259e-03, 2.6924e-03, 7.7944e-04, 6.5899e-04,
         9.0440e-04, 6.0745e-04, 8.6075e-04, 3.0412e-04, 7.4998e-04, 1.4970e-03,
         7.0282e-04, 6.7629e-04, 4.9654e-08, 4.8923e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.4518e-03],
        [4.4849e-03],
        [2.7235e-03],
        [7.5486e-03],
        [1.5810e-03],
        [4.7156e-03],
        [7.1135e-03],
        [3.7288e-03],
        [5.0303e-03],
        [5.2061e-03],
        [2.8519e-03],
        [6.3414e-03],
        [2.6275e-03],
        [4.3746e-03],
        [3.6202e-08],
        [3.5719e-03]], device='cuda:0') / tensor([[1.4518e-03, 4.4849e-03, 2.7235e-03, 7.5486e-03, 1.5810e-03, 4.7156e-03,
         7.1135e-03, 3.7288e-03, 5.0303e-03, 5.2061e-03, 2.8519e-03, 6.3414e-03,
         2.6275e-03, 4.3746e-03, 3.6202e-08, 3.5719e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[2.2337e-04],
        [5.8541e-04],
        [7.9236e-04],
        [5.5998e-04],
        [4.5711e-04],
        [3.0597e-04],
        [2.0898e-04],
        [3.7989e-04],
        [5.4225e-04],
        [3.6399e-04],
        [1.8329e-04],
        [3.7099e-03],
        [2.5198e-04],
        [2.9336e-04],
        [8.5395e-10],
        [2.7168e-04]], device='cuda:0') / tensor([[2.2337e-04, 5.8541e-04, 7.9236e-04, 5.5998e-04, 4.5711e-04, 3.0597e-04,
         2.0898e-04, 3.7989e-04, 5.4225e-04, 3.6399e-04, 1.8329e-04, 3.7099e-03,
         2.5198e-04, 2.9336e-04, 8.5395e-10, 2.7168e-04]], device='cuda:0')
answers_probs: tensor([[5.3344e-04, 1.4518e-03, 2.2337e-04],
        [1.1109e-03, 4.4849e-03, 5.8541e-04],
        [1.2259e-03, 2.7235e-03, 7.9236e-04],
        [2.6924e-03, 7.5486e-03, 5.5998e-04],
        [7.7944e-04, 1.5810e-03, 4.5711e-04],
        [6.5899e-04, 4.7156e-03, 3.0597e-04],
        [9.0440e-04, 7.1135e-03, 2.0898e-04],
        [6.0745e-04, 3.7288e-03, 3.7989e-04],
        [8.6075e-04, 5.0303e-03, 5.4225e-04],
        [3.0412e-04, 5.2061e-03, 3.6399e-04],
        [7.4998e-04, 2.8519e-03, 1.8329e-04],
        [1.4970e-03, 6.3414e-03, 3.7099e-03],
        [7.0282e-04, 2.6275e-03, 2.5198e-04],
        [6.7629e-04, 4.3746e-03, 2.9336e-04],
        [4.9654e-08, 3.6202e-08, 8.5395e-10],
        [4.8923e-04, 3.5719e-03, 2.7168e-04]], device='cuda:0')
acc:  0.3125
Time taken to execute the de NLI task with prompt type passive, variation 1 and batchsize 16: 0:02:52.821748
path ['42', 'de', 'flan', 'NLI', 'passive', 'prompt_id_1']
----------- 42 de google/flan-t5-base NLI passive 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 182.44it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.1452e-04],
        [4.7132e-04],
        [1.1194e-03],
        [1.2239e-04],
        [4.2681e-04],
        [1.9493e-04],
        [9.3324e-04],
        [2.6399e-07],
        [1.0099e-04],
        [1.5334e-04],
        [5.7109e-04],
        [1.3159e-04],
        [2.7391e-04],
        [2.6067e-04],
        [2.2178e-04],
        [6.3398e-04]], device='cuda:0') / tensor([[1.1452e-04, 4.7132e-04, 1.1194e-03, 1.2239e-04, 4.2681e-04, 1.9493e-04,
         9.3324e-04, 2.6399e-07, 1.0099e-04, 1.5334e-04, 5.7109e-04, 1.3159e-04,
         2.7391e-04, 2.6067e-04, 2.2178e-04, 6.3398e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.9019e-03],
        [4.6553e-03],
        [1.0458e-02],
        [1.0889e-03],
        [3.3306e-03],
        [2.8120e-03],
        [5.9526e-03],
        [3.1595e-07],
        [1.0149e-03],
        [3.1798e-03],
        [3.9241e-03],
        [3.1093e-03],
        [3.4373e-03],
        [4.0119e-03],
        [1.1139e-03],
        [2.1786e-03]], device='cuda:0') / tensor([[3.9019e-03, 4.6553e-03, 1.0458e-02, 1.0889e-03, 3.3306e-03, 2.8120e-03,
         5.9526e-03, 3.1595e-07, 1.0149e-03, 3.1798e-03, 3.9241e-03, 3.1093e-03,
         3.4373e-03, 4.0119e-03, 1.1139e-03, 2.1786e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.8489e-05],
        [4.0680e-04],
        [1.5158e-04],
        [4.2085e-06],
        [6.9871e-05],
        [2.6077e-05],
        [1.3348e-03],
        [2.8347e-08],
        [1.3821e-05],
        [1.9148e-04],
        [1.2336e-04],
        [9.7014e-05],
        [3.2060e-04],
        [1.6638e-04],
        [1.8346e-05],
        [1.0457e-04]], device='cuda:0') / tensor([[3.8489e-05, 4.0680e-04, 1.5158e-04, 4.2085e-06, 6.9871e-05, 2.6077e-05,
         1.3348e-03, 2.8347e-08, 1.3821e-05, 1.9148e-04, 1.2336e-04, 9.7014e-05,
         3.2060e-04, 1.6638e-04, 1.8346e-05, 1.0457e-04]], device='cuda:0')
answers_probs: tensor([[1.1452e-04, 3.9019e-03, 3.8489e-05],
        [4.7132e-04, 4.6553e-03, 4.0680e-04],
        [1.1194e-03, 1.0458e-02, 1.5158e-04],
        [1.2239e-04, 1.0889e-03, 4.2085e-06],
        [4.2681e-04, 3.3306e-03, 6.9871e-05],
        [1.9493e-04, 2.8120e-03, 2.6077e-05],
        [9.3324e-04, 5.9526e-03, 1.3348e-03],
        [2.6399e-07, 3.1595e-07, 2.8347e-08],
        [1.0099e-04, 1.0149e-03, 1.3821e-05],
        [1.5334e-04, 3.1798e-03, 1.9148e-04],
        [5.7109e-04, 3.9241e-03, 1.2336e-04],
        [1.3159e-04, 3.1093e-03, 9.7014e-05],
        [2.7391e-04, 3.4373e-03, 3.2060e-04],
        [2.6067e-04, 4.0119e-03, 1.6638e-04],
        [2.2178e-04, 1.1139e-03, 1.8346e-05],
        [6.3398e-04, 2.1786e-03, 1.0457e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[8.7093e-05],
        [1.8705e-04],
        [8.9072e-05],
        [3.8009e-04],
        [3.0071e-04],
        [1.1612e-04],
        [2.8086e-04],
        [1.5277e-04],
        [1.8833e-04],
        [6.9335e-04],
        [4.9914e-04],
        [2.0167e-04],
        [7.1842e-05],
        [6.7639e-04],
        [3.5024e-04],
        [2.0003e-07]], device='cuda:0') / tensor([[8.7093e-05, 1.8705e-04, 8.9072e-05, 3.8009e-04, 3.0071e-04, 1.1612e-04,
         2.8086e-04, 1.5277e-04, 1.8833e-04, 6.9335e-04, 4.9914e-04, 2.0167e-04,
         7.1842e-05, 6.7639e-04, 3.5024e-04, 2.0003e-07]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.8771e-03],
        [4.1761e-03],
        [2.1412e-03],
        [1.8492e-03],
        [6.4787e-03],
        [4.6139e-04],
        [3.5276e-03],
        [1.3382e-03],
        [1.3725e-03],
        [4.4599e-03],
        [2.9894e-03],
        [2.8305e-03],
        [7.8617e-04],
        [4.3157e-03],
        [3.1053e-03],
        [1.4519e-07]], device='cuda:0') / tensor([[2.8771e-03, 4.1761e-03, 2.1412e-03, 1.8492e-03, 6.4787e-03, 4.6139e-04,
         3.5276e-03, 1.3382e-03, 1.3725e-03, 4.4599e-03, 2.9894e-03, 2.8305e-03,
         7.8617e-04, 4.3157e-03, 3.1053e-03, 1.4519e-07]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.2318e-04],
        [1.0882e-04],
        [9.3711e-05],
        [1.1266e-04],
        [2.1907e-04],
        [3.3427e-05],
        [8.1504e-05],
        [2.9222e-05],
        [9.8772e-05],
        [2.7094e-04],
        [7.9589e-05],
        [8.9510e-05],
        [3.7243e-05],
        [2.4231e-04],
        [2.2165e-04],
        [2.2422e-09]], device='cuda:0') / tensor([[1.2318e-04, 1.0882e-04, 9.3711e-05, 1.1266e-04, 2.1907e-04, 3.3427e-05,
         8.1504e-05, 2.9222e-05, 9.8772e-05, 2.7094e-04, 7.9589e-05, 8.9510e-05,
         3.7243e-05, 2.4231e-04, 2.2165e-04, 2.2422e-09]], device='cuda:0')
answers_probs: tensor([[8.7093e-05, 2.8771e-03, 1.2318e-04],
        [1.8705e-04, 4.1761e-03, 1.0882e-04],
        [8.9072e-05, 2.1412e-03, 9.3711e-05],
        [3.8009e-04, 1.8492e-03, 1.1266e-04],
        [3.0071e-04, 6.4787e-03, 2.1907e-04],
        [1.1612e-04, 4.6139e-04, 3.3427e-05],
        [2.8086e-04, 3.5276e-03, 8.1504e-05],
        [1.5277e-04, 1.3382e-03, 2.9222e-05],
        [1.8833e-04, 1.3725e-03, 9.8772e-05],
        [6.9335e-04, 4.4599e-03, 2.7094e-04],
        [4.9914e-04, 2.9894e-03, 7.9589e-05],
        [2.0167e-04, 2.8305e-03, 8.9510e-05],
        [7.1842e-05, 7.8617e-04, 3.7243e-05],
        [6.7639e-04, 4.3157e-03, 2.4231e-04],
        [3.5024e-04, 3.1053e-03, 2.2165e-04],
        [2.0003e-07, 1.4519e-07, 2.2422e-09]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.8643e-04],
        [8.6435e-04],
        [4.1887e-04],
        [5.6877e-04],
        [7.9691e-04],
        [2.6800e-04],
        [6.7808e-04],
        [5.4627e-04],
        [6.4089e-04],
        [7.2950e-04],
        [1.5685e-04],
        [7.6601e-04],
        [2.5537e-04],
        [6.5977e-04],
        [3.5778e-08],
        [3.6631e-04]], device='cuda:0') / tensor([[2.8643e-04, 8.6435e-04, 4.1887e-04, 5.6877e-04, 7.9691e-04, 2.6800e-04,
         6.7808e-04, 5.4627e-04, 6.4089e-04, 7.2950e-04, 1.5685e-04, 7.6601e-04,
         2.5537e-04, 6.5977e-04, 3.5778e-08, 3.6631e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.1696e-03],
        [5.4685e-03],
        [1.1162e-02],
        [2.2172e-03],
        [9.1961e-03],
        [5.5076e-03],
        [9.4263e-03],
        [2.9472e-03],
        [2.2173e-03],
        [3.7458e-03],
        [1.0480e-03],
        [4.8899e-03],
        [2.4987e-03],
        [6.4098e-03],
        [2.9174e-08],
        [3.2107e-03]], device='cuda:0') / tensor([[6.1696e-03, 5.4685e-03, 1.1162e-02, 2.2172e-03, 9.1961e-03, 5.5076e-03,
         9.4263e-03, 2.9472e-03, 2.2173e-03, 3.7458e-03, 1.0480e-03, 4.8899e-03,
         2.4987e-03, 6.4098e-03, 2.9174e-08, 3.2107e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[1.7042e-04],
        [4.2585e-04],
        [4.3654e-04],
        [3.1413e-04],
        [1.4339e-04],
        [4.3882e-04],
        [4.2269e-04],
        [1.4273e-04],
        [4.2420e-05],
        [9.3263e-05],
        [2.4695e-05],
        [1.5314e-04],
        [8.6025e-05],
        [1.0598e-03],
        [1.0191e-09],
        [6.1441e-05]], device='cuda:0') / tensor([[1.7042e-04, 4.2585e-04, 4.3654e-04, 3.1413e-04, 1.4339e-04, 4.3882e-04,
         4.2269e-04, 1.4273e-04, 4.2420e-05, 9.3263e-05, 2.4695e-05, 1.5314e-04,
         8.6025e-05, 1.0598e-03, 1.0191e-09, 6.1441e-05]], device='cuda:0')
answers_probs: tensor([[2.8643e-04, 6.1696e-03, 1.7042e-04],
        [8.6435e-04, 5.4685e-03, 4.2585e-04],
        [4.1887e-04, 1.1162e-02, 4.3654e-04],
        [5.6877e-04, 2.2172e-03, 3.1413e-04],
        [7.9691e-04, 9.1961e-03, 1.4339e-04],
        [2.6800e-04, 5.5076e-03, 4.3882e-04],
        [6.7808e-04, 9.4263e-03, 4.2269e-04],
        [5.4627e-04, 2.9472e-03, 1.4273e-04],
        [6.4089e-04, 2.2173e-03, 4.2420e-05],
        [7.2950e-04, 3.7458e-03, 9.3263e-05],
        [1.5685e-04, 1.0480e-03, 2.4695e-05],
        [7.6601e-04, 4.8899e-03, 1.5314e-04],
        [2.5537e-04, 2.4987e-03, 8.6025e-05],
        [6.5977e-04, 6.4098e-03, 1.0598e-03],
        [3.5778e-08, 2.9174e-08, 1.0191e-09],
        [3.6631e-04, 3.2107e-03, 6.1441e-05]], device='cuda:0')
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type passive, variation 2 and batchsize 16: 0:02:53.384892
path ['42', 'de', 'flan', 'NLI', 'passive', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base NLI auxiliary 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 303.86it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.4804e-04],
        [2.7479e-04],
        [1.3518e-03],
        [5.2071e-07],
        [8.3109e-04],
        [1.1407e-03],
        [3.6658e-04],
        [7.2020e-04],
        [5.4946e-04],
        [2.7743e-04],
        [1.3492e-03],
        [6.7346e-04],
        [4.6211e-04],
        [1.2236e-04],
        [1.0004e-03],
        [3.9055e-03]], device='cuda:0') / tensor([[3.4804e-04, 2.7479e-04, 1.3518e-03, 5.2071e-07, 8.3109e-04, 1.1407e-03,
         3.6658e-04, 7.2020e-04, 5.4946e-04, 2.7743e-04, 1.3492e-03, 6.7346e-04,
         4.6211e-04, 1.2236e-04, 1.0004e-03, 3.9055e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.7995e-04],
        [3.1650e-04],
        [1.5940e-03],
        [4.3247e-07],
        [6.7540e-04],
        [1.9622e-03],
        [1.1271e-03],
        [2.5412e-03],
        [2.4768e-04],
        [5.2617e-04],
        [8.9688e-04],
        [1.2785e-03],
        [7.9891e-04],
        [4.3688e-04],
        [9.4435e-04],
        [6.3378e-03]], device='cuda:0') / tensor([[9.7995e-04, 3.1650e-04, 1.5940e-03, 4.3247e-07, 6.7540e-04, 1.9622e-03,
         1.1271e-03, 2.5412e-03, 2.4768e-04, 5.2617e-04, 8.9688e-04, 1.2785e-03,
         7.9891e-04, 4.3688e-04, 9.4435e-04, 6.3378e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[2.8046e-05],
        [2.8391e-06],
        [7.6861e-05],
        [2.4748e-08],
        [1.9821e-04],
        [6.2665e-05],
        [1.9356e-05],
        [7.6941e-05],
        [1.2373e-05],
        [8.8560e-06],
        [3.6210e-05],
        [4.6424e-05],
        [3.1625e-05],
        [5.3472e-06],
        [4.9513e-05],
        [2.6558e-04]], device='cuda:0') / tensor([[2.8046e-05, 2.8391e-06, 7.6861e-05, 2.4748e-08, 1.9821e-04, 6.2665e-05,
         1.9356e-05, 7.6941e-05, 1.2373e-05, 8.8560e-06, 3.6210e-05, 4.6424e-05,
         3.1625e-05, 5.3472e-06, 4.9513e-05, 2.6558e-04]], device='cuda:0')
answers_probs: tensor([[3.4804e-04, 9.7995e-04, 2.8046e-05],
        [2.7479e-04, 3.1650e-04, 2.8391e-06],
        [1.3518e-03, 1.5940e-03, 7.6861e-05],
        [5.2071e-07, 4.3247e-07, 2.4748e-08],
        [8.3109e-04, 6.7540e-04, 1.9821e-04],
        [1.1407e-03, 1.9622e-03, 6.2665e-05],
        [3.6658e-04, 1.1271e-03, 1.9356e-05],
        [7.2020e-04, 2.5412e-03, 7.6941e-05],
        [5.4946e-04, 2.4768e-04, 1.2373e-05],
        [2.7743e-04, 5.2617e-04, 8.8560e-06],
        [1.3492e-03, 8.9688e-04, 3.6210e-05],
        [6.7346e-04, 1.2785e-03, 4.6424e-05],
        [4.6211e-04, 7.9891e-04, 3.1625e-05],
        [1.2236e-04, 4.3688e-04, 5.3472e-06],
        [1.0004e-03, 9.4435e-04, 4.9513e-05],
        [3.9055e-03, 6.3378e-03, 2.6558e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.8591e-07],
        [1.6649e-03],
        [1.3702e-03],
        [6.9407e-04],
        [5.3264e-04],
        [1.5455e-03],
        [9.2858e-04],
        [1.3958e-03],
        [2.8944e-03],
        [1.2627e-03],
        [8.3031e-04],
        [2.8907e-03],
        [2.0402e-04],
        [1.9518e-03],
        [2.8682e-03],
        [1.4922e-03]], device='cuda:0') / tensor([[1.8591e-07, 1.6649e-03, 1.3702e-03, 6.9407e-04, 5.3264e-04, 1.5455e-03,
         9.2858e-04, 1.3958e-03, 2.8944e-03, 1.2627e-03, 8.3031e-04, 2.8907e-03,
         2.0402e-04, 1.9518e-03, 2.8682e-03, 1.4922e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[4.0401e-08],
        [2.4804e-03],
        [2.9511e-04],
        [1.5085e-03],
        [4.5009e-04],
        [2.4422e-03],
        [5.1158e-04],
        [1.5181e-03],
        [3.2338e-03],
        [4.2094e-03],
        [4.6704e-03],
        [5.3296e-04],
        [1.9235e-04],
        [9.5693e-04],
        [1.2343e-03],
        [2.3257e-03]], device='cuda:0') / tensor([[4.0401e-08, 2.4804e-03, 2.9511e-04, 1.5085e-03, 4.5009e-04, 2.4422e-03,
         5.1158e-04, 1.5181e-03, 3.2338e-03, 4.2094e-03, 4.6704e-03, 5.3296e-04,
         1.9235e-04, 9.5693e-04, 1.2343e-03, 2.3257e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[2.9255e-08],
        [1.2055e-04],
        [5.8242e-05],
        [4.0800e-04],
        [4.2944e-05],
        [7.5588e-05],
        [4.8653e-05],
        [4.1991e-05],
        [2.0980e-04],
        [4.5685e-05],
        [1.3391e-04],
        [1.0990e-04],
        [6.7178e-06],
        [2.0576e-05],
        [1.1419e-04],
        [2.3797e-05]], device='cuda:0') / tensor([[2.9255e-08, 1.2055e-04, 5.8242e-05, 4.0800e-04, 4.2944e-05, 7.5588e-05,
         4.8653e-05, 4.1991e-05, 2.0980e-04, 4.5685e-05, 1.3391e-04, 1.0990e-04,
         6.7178e-06, 2.0576e-05, 1.1419e-04, 2.3797e-05]], device='cuda:0')
answers_probs: tensor([[1.8591e-07, 4.0401e-08, 2.9255e-08],
        [1.6649e-03, 2.4804e-03, 1.2055e-04],
        [1.3702e-03, 2.9511e-04, 5.8242e-05],
        [6.9407e-04, 1.5085e-03, 4.0800e-04],
        [5.3264e-04, 4.5009e-04, 4.2944e-05],
        [1.5455e-03, 2.4422e-03, 7.5588e-05],
        [9.2858e-04, 5.1158e-04, 4.8653e-05],
        [1.3958e-03, 1.5181e-03, 4.1991e-05],
        [2.8944e-03, 3.2338e-03, 2.0980e-04],
        [1.2627e-03, 4.2094e-03, 4.5685e-05],
        [8.3031e-04, 4.6704e-03, 1.3391e-04],
        [2.8907e-03, 5.3296e-04, 1.0990e-04],
        [2.0402e-04, 1.9235e-04, 6.7178e-06],
        [1.9518e-03, 9.5693e-04, 2.0576e-05],
        [2.8682e-03, 1.2343e-03, 1.1419e-04],
        [1.4922e-03, 2.3257e-03, 2.3797e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.4829e-04],
        [4.2515e-03],
        [8.8968e-04],
        [2.1489e-07],
        [1.1916e-03],
        [5.7150e-04],
        [2.3063e-04],
        [4.2202e-04],
        [2.2784e-04],
        [1.4073e-04],
        [2.4730e-04],
        [5.4490e-04],
        [1.2703e-03],
        [1.1848e-03],
        [1.1595e-03],
        [1.3581e-03]], device='cuda:0') / tensor([[4.4829e-04, 4.2515e-03, 8.8968e-04, 2.1489e-07, 1.1916e-03, 5.7150e-04,
         2.3063e-04, 4.2202e-04, 2.2784e-04, 1.4073e-04, 2.4730e-04, 5.4490e-04,
         1.2703e-03, 1.1848e-03, 1.1595e-03, 1.3581e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.3740e-04],
        [2.1786e-03],
        [2.1036e-03],
        [1.3173e-07],
        [1.0646e-03],
        [4.5694e-03],
        [3.8871e-04],
        [5.8179e-04],
        [1.5637e-03],
        [3.2988e-04],
        [2.0393e-04],
        [2.4176e-03],
        [7.6591e-04],
        [8.5902e-05],
        [1.0998e-03],
        [3.2848e-03]], device='cuda:0') / tensor([[6.3740e-04, 2.1786e-03, 2.1036e-03, 1.3173e-07, 1.0646e-03, 4.5694e-03,
         3.8871e-04, 5.8179e-04, 1.5637e-03, 3.2988e-04, 2.0393e-04, 2.4176e-03,
         7.6591e-04, 8.5902e-05, 1.0998e-03, 3.2848e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[1.7333e-05],
        [1.1920e-04],
        [4.2962e-05],
        [8.6066e-09],
        [5.3308e-05],
        [4.4074e-05],
        [2.1212e-05],
        [2.2539e-05],
        [2.2017e-05],
        [4.4649e-06],
        [1.3252e-06],
        [1.7478e-05],
        [9.2058e-05],
        [1.0363e-04],
        [8.7345e-05],
        [3.0228e-04]], device='cuda:0') / tensor([[1.7333e-05, 1.1920e-04, 4.2962e-05, 8.6066e-09, 5.3308e-05, 4.4074e-05,
         2.1212e-05, 2.2539e-05, 2.2017e-05, 4.4649e-06, 1.3252e-06, 1.7478e-05,
         9.2058e-05, 1.0363e-04, 8.7345e-05, 3.0228e-04]], device='cuda:0')
answers_probs: tensor([[4.4829e-04, 6.3740e-04, 1.7333e-05],
        [4.2515e-03, 2.1786e-03, 1.1920e-04],
        [8.8968e-04, 2.1036e-03, 4.2962e-05],
        [2.1489e-07, 1.3173e-07, 8.6066e-09],
        [1.1916e-03, 1.0646e-03, 5.3308e-05],
        [5.7150e-04, 4.5694e-03, 4.4074e-05],
        [2.3063e-04, 3.8871e-04, 2.1212e-05],
        [4.2202e-04, 5.8179e-04, 2.2539e-05],
        [2.2784e-04, 1.5637e-03, 2.2017e-05],
        [1.4073e-04, 3.2988e-04, 4.4649e-06],
        [2.4730e-04, 2.0393e-04, 1.3252e-06],
        [5.4490e-04, 2.4176e-03, 1.7478e-05],
        [1.2703e-03, 7.6591e-04, 9.2058e-05],
        [1.1848e-03, 8.5902e-05, 1.0363e-04],
        [1.1595e-03, 1.0998e-03, 8.7345e-05],
        [1.3581e-03, 3.2848e-03, 3.0228e-04]], device='cuda:0')
acc:  0.4166666666666667
Time taken to execute the de NLI task with prompt type auxiliary, variation 0 and batchsize 16: 0:02:53.709814
path ['42', 'de', 'flan', 'NLI', 'auxiliary', 'prompt_id_0']
----------- 42 de google/flan-t5-base NLI auxiliary 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 341.68it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.3684e-03],
        [4.4016e-04],
        [1.2218e-03],
        [1.2910e-03],
        [1.2500e-03],
        [1.6966e-04],
        [4.5943e-07],
        [8.6002e-05],
        [7.7135e-04],
        [2.9516e-03],
        [8.5653e-04],
        [7.6148e-04],
        [6.3524e-04],
        [1.7368e-04],
        [7.4213e-04],
        [1.8502e-03]], device='cuda:0') / tensor([[1.3684e-03, 4.4016e-04, 1.2218e-03, 1.2910e-03, 1.2500e-03, 1.6966e-04,
         4.5943e-07, 8.6002e-05, 7.7135e-04, 2.9516e-03, 8.5653e-04, 7.6148e-04,
         6.3524e-04, 1.7368e-04, 7.4213e-04, 1.8502e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.6323e-04],
        [1.6174e-03],
        [1.1845e-03],
        [5.3804e-04],
        [6.7484e-04],
        [1.1467e-04],
        [1.1213e-07],
        [3.5667e-04],
        [5.9620e-04],
        [4.6593e-04],
        [1.2016e-03],
        [7.5014e-04],
        [5.3852e-04],
        [1.4726e-04],
        [2.2394e-03],
        [1.2472e-03]], device='cuda:0') / tensor([[5.6323e-04, 1.6174e-03, 1.1845e-03, 5.3804e-04, 6.7484e-04, 1.1467e-04,
         1.1213e-07, 3.5667e-04, 5.9620e-04, 4.6593e-04, 1.2016e-03, 7.5014e-04,
         5.3852e-04, 1.4726e-04, 2.2394e-03, 1.2472e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.2136e-04],
        [3.8007e-05],
        [1.1119e-04],
        [7.4172e-05],
        [5.9945e-05],
        [1.7094e-05],
        [1.2536e-08],
        [9.0200e-06],
        [2.4636e-04],
        [3.9112e-04],
        [1.0733e-04],
        [1.0171e-04],
        [9.6303e-05],
        [3.1347e-06],
        [1.5487e-04],
        [3.7965e-04]], device='cuda:0') / tensor([[1.2136e-04, 3.8007e-05, 1.1119e-04, 7.4172e-05, 5.9945e-05, 1.7094e-05,
         1.2536e-08, 9.0200e-06, 2.4636e-04, 3.9112e-04, 1.0733e-04, 1.0171e-04,
         9.6303e-05, 3.1347e-06, 1.5487e-04, 3.7965e-04]], device='cuda:0')
answers_probs: tensor([[1.3684e-03, 5.6323e-04, 1.2136e-04],
        [4.4016e-04, 1.6174e-03, 3.8007e-05],
        [1.2218e-03, 1.1845e-03, 1.1119e-04],
        [1.2910e-03, 5.3804e-04, 7.4172e-05],
        [1.2500e-03, 6.7484e-04, 5.9945e-05],
        [1.6966e-04, 1.1467e-04, 1.7094e-05],
        [4.5943e-07, 1.1213e-07, 1.2536e-08],
        [8.6002e-05, 3.5667e-04, 9.0200e-06],
        [7.7135e-04, 5.9620e-04, 2.4636e-04],
        [2.9516e-03, 4.6593e-04, 3.9112e-04],
        [8.5653e-04, 1.2016e-03, 1.0733e-04],
        [7.6148e-04, 7.5014e-04, 1.0171e-04],
        [6.3524e-04, 5.3852e-04, 9.6303e-05],
        [1.7368e-04, 1.4726e-04, 3.1347e-06],
        [7.4213e-04, 2.2394e-03, 1.5487e-04],
        [1.8502e-03, 1.2472e-03, 3.7965e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.3354e-03],
        [1.4196e-03],
        [1.4612e-03],
        [1.4555e-03],
        [2.6587e-04],
        [3.1398e-04],
        [9.7771e-04],
        [8.6151e-04],
        [2.9940e-07],
        [3.8065e-03],
        [1.5649e-03],
        [4.1721e-04],
        [1.2109e-03],
        [2.7168e-03],
        [1.3367e-03],
        [5.0212e-04]], device='cuda:0') / tensor([[1.3354e-03, 1.4196e-03, 1.4612e-03, 1.4555e-03, 2.6587e-04, 3.1398e-04,
         9.7771e-04, 8.6151e-04, 2.9940e-07, 3.8065e-03, 1.5649e-03, 4.1721e-04,
         1.2109e-03, 2.7168e-03, 1.3367e-03, 5.0212e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.4542e-03],
        [4.3380e-03],
        [2.8035e-03],
        [2.7169e-03],
        [4.5360e-04],
        [5.6125e-04],
        [3.6343e-03],
        [4.5781e-03],
        [1.2028e-07],
        [6.2319e-03],
        [1.8986e-03],
        [2.7745e-04],
        [1.1147e-03],
        [2.9960e-03],
        [2.4064e-03],
        [1.2246e-03]], device='cuda:0') / tensor([[3.4542e-03, 4.3380e-03, 2.8035e-03, 2.7169e-03, 4.5360e-04, 5.6125e-04,
         3.6343e-03, 4.5781e-03, 1.2028e-07, 6.2319e-03, 1.8986e-03, 2.7745e-04,
         1.1147e-03, 2.9960e-03, 2.4064e-03, 1.2246e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.7296e-04],
        [1.0742e-04],
        [1.7007e-04],
        [7.3478e-05],
        [3.4094e-05],
        [1.3960e-05],
        [6.6034e-05],
        [2.3367e-04],
        [1.0388e-08],
        [3.7310e-04],
        [6.6294e-05],
        [2.0801e-05],
        [7.1165e-05],
        [2.4494e-04],
        [1.2620e-04],
        [2.7263e-05]], device='cuda:0') / tensor([[3.7296e-04, 1.0742e-04, 1.7007e-04, 7.3478e-05, 3.4094e-05, 1.3960e-05,
         6.6034e-05, 2.3367e-04, 1.0388e-08, 3.7310e-04, 6.6294e-05, 2.0801e-05,
         7.1165e-05, 2.4494e-04, 1.2620e-04, 2.7263e-05]], device='cuda:0')
answers_probs: tensor([[1.3354e-03, 3.4542e-03, 3.7296e-04],
        [1.4196e-03, 4.3380e-03, 1.0742e-04],
        [1.4612e-03, 2.8035e-03, 1.7007e-04],
        [1.4555e-03, 2.7169e-03, 7.3478e-05],
        [2.6587e-04, 4.5360e-04, 3.4094e-05],
        [3.1398e-04, 5.6125e-04, 1.3960e-05],
        [9.7771e-04, 3.6343e-03, 6.6034e-05],
        [8.6151e-04, 4.5781e-03, 2.3367e-04],
        [2.9940e-07, 1.2028e-07, 1.0388e-08],
        [3.8065e-03, 6.2319e-03, 3.7310e-04],
        [1.5649e-03, 1.8986e-03, 6.6294e-05],
        [4.1721e-04, 2.7745e-04, 2.0801e-05],
        [1.2109e-03, 1.1147e-03, 7.1165e-05],
        [2.7168e-03, 2.9960e-03, 2.4494e-04],
        [1.3367e-03, 2.4064e-03, 1.2620e-04],
        [5.0212e-04, 1.2246e-03, 2.7263e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.6938e-04],
        [6.4211e-04],
        [2.2456e-03],
        [1.2545e-04],
        [3.4655e-04],
        [5.8675e-04],
        [1.1260e-04],
        [7.8309e-04],
        [3.3037e-07],
        [3.2260e-04],
        [3.6703e-04],
        [1.3560e-03],
        [2.6552e-04],
        [2.0699e-04],
        [4.0266e-04],
        [3.2300e-04]], device='cuda:0') / tensor([[2.6938e-04, 6.4211e-04, 2.2456e-03, 1.2545e-04, 3.4655e-04, 5.8675e-04,
         1.1260e-04, 7.8309e-04, 3.3037e-07, 3.2260e-04, 3.6703e-04, 1.3560e-03,
         2.6552e-04, 2.0699e-04, 4.0266e-04, 3.2300e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.3134e-04],
        [1.2350e-03],
        [1.8783e-03],
        [2.5599e-04],
        [6.6562e-03],
        [2.8838e-03],
        [1.0176e-03],
        [2.1097e-03],
        [3.0367e-07],
        [8.2416e-04],
        [1.2316e-03],
        [3.2561e-04],
        [7.5551e-04],
        [2.7647e-04],
        [2.9701e-03],
        [1.5281e-03]], device='cuda:0') / tensor([[6.3134e-04, 1.2350e-03, 1.8783e-03, 2.5599e-04, 6.6562e-03, 2.8838e-03,
         1.0176e-03, 2.1097e-03, 3.0367e-07, 8.2416e-04, 1.2316e-03, 3.2561e-04,
         7.5551e-04, 2.7647e-04, 2.9701e-03, 1.5281e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[2.8568e-05],
        [6.3837e-05],
        [1.8778e-04],
        [7.7595e-06],
        [1.0075e-04],
        [1.1866e-04],
        [1.2746e-05],
        [2.4444e-05],
        [2.0484e-08],
        [2.5580e-05],
        [7.0167e-05],
        [1.1771e-04],
        [2.1702e-05],
        [5.6876e-06],
        [7.0535e-04],
        [8.0070e-05]], device='cuda:0') / tensor([[2.8568e-05, 6.3837e-05, 1.8778e-04, 7.7595e-06, 1.0075e-04, 1.1866e-04,
         1.2746e-05, 2.4444e-05, 2.0484e-08, 2.5580e-05, 7.0167e-05, 1.1771e-04,
         2.1702e-05, 5.6876e-06, 7.0535e-04, 8.0070e-05]], device='cuda:0')
answers_probs: tensor([[2.6938e-04, 6.3134e-04, 2.8568e-05],
        [6.4211e-04, 1.2350e-03, 6.3837e-05],
        [2.2456e-03, 1.8783e-03, 1.8778e-04],
        [1.2545e-04, 2.5599e-04, 7.7595e-06],
        [3.4655e-04, 6.6562e-03, 1.0075e-04],
        [5.8675e-04, 2.8838e-03, 1.1866e-04],
        [1.1260e-04, 1.0176e-03, 1.2746e-05],
        [7.8309e-04, 2.1097e-03, 2.4444e-05],
        [3.3037e-07, 3.0367e-07, 2.0484e-08],
        [3.2260e-04, 8.2416e-04, 2.5580e-05],
        [3.6703e-04, 1.2316e-03, 7.0167e-05],
        [1.3560e-03, 3.2561e-04, 1.1771e-04],
        [2.6552e-04, 7.5551e-04, 2.1702e-05],
        [2.0699e-04, 2.7647e-04, 5.6876e-06],
        [4.0266e-04, 2.9701e-03, 7.0535e-04],
        [3.2300e-04, 1.5281e-03, 8.0070e-05]], device='cuda:0')
acc:  0.4375
Time taken to execute the de NLI task with prompt type auxiliary, variation 1 and batchsize 16: 0:02:50.682388
path ['42', 'de', 'flan', 'NLI', 'auxiliary', 'prompt_id_1']
----------- 42 de google/flan-t5-base NLI auxiliary 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 304.24it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.8229e-04],
        [4.6703e-04],
        [5.8682e-04],
        [4.0819e-04],
        [3.7672e-07],
        [3.9374e-04],
        [1.2359e-03],
        [4.9848e-04],
        [1.2359e-03],
        [3.0646e-03],
        [7.8552e-04],
        [2.6901e-04],
        [3.1454e-04],
        [7.1049e-04],
        [2.4434e-04],
        [2.7538e-04]], device='cuda:0') / tensor([[2.8229e-04, 4.6703e-04, 5.8682e-04, 4.0819e-04, 3.7672e-07, 3.9374e-04,
         1.2359e-03, 4.9848e-04, 1.2359e-03, 3.0646e-03, 7.8552e-04, 2.6901e-04,
         3.1454e-04, 7.1049e-04, 2.4434e-04, 2.7538e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.0998e-04],
        [6.7153e-04],
        [1.3837e-03],
        [1.1008e-03],
        [4.0005e-07],
        [1.3405e-03],
        [1.7081e-03],
        [2.8736e-04],
        [1.2310e-03],
        [3.9241e-03],
        [2.4578e-03],
        [2.9092e-04],
        [1.0152e-03],
        [1.1302e-03],
        [3.4735e-04],
        [4.4146e-04]], device='cuda:0') / tensor([[6.0998e-04, 6.7153e-04, 1.3837e-03, 1.1008e-03, 4.0005e-07, 1.3405e-03,
         1.7081e-03, 2.8736e-04, 1.2310e-03, 3.9241e-03, 2.4578e-03, 2.9092e-04,
         1.0152e-03, 1.1302e-03, 3.4735e-04, 4.4146e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[9.5210e-06],
        [2.8121e-05],
        [3.9797e-05],
        [3.5606e-05],
        [1.2083e-08],
        [2.4252e-05],
        [4.6220e-05],
        [1.3176e-05],
        [5.1690e-05],
        [2.4012e-04],
        [3.8884e-04],
        [1.6338e-06],
        [2.5807e-05],
        [7.8208e-05],
        [3.1575e-06],
        [1.7349e-05]], device='cuda:0') / tensor([[9.5210e-06, 2.8121e-05, 3.9797e-05, 3.5606e-05, 1.2083e-08, 2.4252e-05,
         4.6220e-05, 1.3176e-05, 5.1690e-05, 2.4012e-04, 3.8884e-04, 1.6338e-06,
         2.5807e-05, 7.8208e-05, 3.1575e-06, 1.7349e-05]], device='cuda:0')
answers_probs: tensor([[2.8229e-04, 6.0998e-04, 9.5210e-06],
        [4.6703e-04, 6.7153e-04, 2.8121e-05],
        [5.8682e-04, 1.3837e-03, 3.9797e-05],
        [4.0819e-04, 1.1008e-03, 3.5606e-05],
        [3.7672e-07, 4.0005e-07, 1.2083e-08],
        [3.9374e-04, 1.3405e-03, 2.4252e-05],
        [1.2359e-03, 1.7081e-03, 4.6220e-05],
        [4.9848e-04, 2.8736e-04, 1.3176e-05],
        [1.2359e-03, 1.2310e-03, 5.1690e-05],
        [3.0646e-03, 3.9241e-03, 2.4012e-04],
        [7.8552e-04, 2.4578e-03, 3.8884e-04],
        [2.6901e-04, 2.9092e-04, 1.6338e-06],
        [3.1454e-04, 1.0152e-03, 2.5807e-05],
        [7.1049e-04, 1.1302e-03, 7.8208e-05],
        [2.4434e-04, 3.4735e-04, 3.1575e-06],
        [2.7538e-04, 4.4146e-04, 1.7349e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[9.9358e-04],
        [1.0113e-04],
        [1.6056e-03],
        [6.5865e-04],
        [3.9757e-03],
        [8.7823e-04],
        [1.6989e-03],
        [6.1900e-04],
        [1.0913e-03],
        [1.6656e-07],
        [9.1299e-04],
        [3.0840e-03],
        [3.7917e-03],
        [1.4159e-03],
        [1.4091e-04],
        [2.7540e-03]], device='cuda:0') / tensor([[9.9358e-04, 1.0113e-04, 1.6056e-03, 6.5865e-04, 3.9757e-03, 8.7823e-04,
         1.6989e-03, 6.1900e-04, 1.0913e-03, 1.6656e-07, 9.1299e-04, 3.0840e-03,
         3.7917e-03, 1.4159e-03, 1.4091e-04, 2.7540e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.8747e-03],
        [5.4185e-04],
        [8.0711e-04],
        [2.4438e-03],
        [9.9363e-04],
        [8.3170e-04],
        [1.7243e-03],
        [6.2745e-04],
        [2.0751e-03],
        [1.4431e-07],
        [6.4866e-03],
        [5.2374e-03],
        [6.7739e-04],
        [7.3432e-04],
        [3.4635e-04],
        [2.6482e-03]], device='cuda:0') / tensor([[1.8747e-03, 5.4185e-04, 8.0711e-04, 2.4438e-03, 9.9363e-04, 8.3170e-04,
         1.7243e-03, 6.2745e-04, 2.0751e-03, 1.4431e-07, 6.4866e-03, 5.2374e-03,
         6.7739e-04, 7.3432e-04, 3.4635e-04, 2.6482e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.4942e-04],
        [1.1908e-05],
        [1.1138e-04],
        [1.3602e-04],
        [1.7608e-04],
        [2.9726e-04],
        [4.5059e-04],
        [9.0160e-05],
        [1.9701e-04],
        [1.1496e-08],
        [4.5563e-04],
        [4.0983e-04],
        [5.0546e-04],
        [7.3151e-05],
        [2.0293e-05],
        [3.6247e-04]], device='cuda:0') / tensor([[1.4942e-04, 1.1908e-05, 1.1138e-04, 1.3602e-04, 1.7608e-04, 2.9726e-04,
         4.5059e-04, 9.0160e-05, 1.9701e-04, 1.1496e-08, 4.5563e-04, 4.0983e-04,
         5.0546e-04, 7.3151e-05, 2.0293e-05, 3.6247e-04]], device='cuda:0')
answers_probs: tensor([[9.9358e-04, 1.8747e-03, 1.4942e-04],
        [1.0113e-04, 5.4185e-04, 1.1908e-05],
        [1.6056e-03, 8.0711e-04, 1.1138e-04],
        [6.5865e-04, 2.4438e-03, 1.3602e-04],
        [3.9757e-03, 9.9363e-04, 1.7608e-04],
        [8.7823e-04, 8.3170e-04, 2.9726e-04],
        [1.6989e-03, 1.7243e-03, 4.5059e-04],
        [6.1900e-04, 6.2745e-04, 9.0160e-05],
        [1.0913e-03, 2.0751e-03, 1.9701e-04],
        [1.6656e-07, 1.4431e-07, 1.1496e-08],
        [9.1299e-04, 6.4866e-03, 4.5563e-04],
        [3.0840e-03, 5.2374e-03, 4.0983e-04],
        [3.7917e-03, 6.7739e-04, 5.0546e-04],
        [1.4159e-03, 7.3432e-04, 7.3151e-05],
        [1.4091e-04, 3.4635e-04, 2.0293e-05],
        [2.7540e-03, 2.6482e-03, 3.6247e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.2662e-03],
        [8.2204e-04],
        [5.0643e-04],
        [7.7537e-04],
        [4.7916e-04],
        [1.2740e-03],
        [6.0423e-04],
        [9.9992e-04],
        [1.2844e-07],
        [1.2182e-03],
        [8.9346e-04],
        [2.3366e-04],
        [1.4818e-03],
        [1.6641e-04],
        [1.5281e-03],
        [8.9087e-04]], device='cuda:0') / tensor([[1.2662e-03, 8.2204e-04, 5.0643e-04, 7.7537e-04, 4.7916e-04, 1.2740e-03,
         6.0423e-04, 9.9992e-04, 1.2844e-07, 1.2182e-03, 8.9346e-04, 2.3366e-04,
         1.4818e-03, 1.6641e-04, 1.5281e-03, 8.9087e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.5520e-03],
        [1.3127e-03],
        [2.1949e-03],
        [1.8110e-03],
        [6.1406e-04],
        [3.5244e-03],
        [5.1748e-03],
        [1.4318e-03],
        [1.0471e-07],
        [2.0465e-03],
        [2.1947e-03],
        [1.6959e-03],
        [4.3552e-04],
        [1.5247e-04],
        [9.0872e-04],
        [3.7459e-03]], device='cuda:0') / tensor([[2.5520e-03, 1.3127e-03, 2.1949e-03, 1.8110e-03, 6.1406e-04, 3.5244e-03,
         5.1748e-03, 1.4318e-03, 1.0471e-07, 2.0465e-03, 2.1947e-03, 1.6959e-03,
         4.3552e-04, 1.5247e-04, 9.0872e-04, 3.7459e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[9.2544e-05],
        [6.0474e-05],
        [1.7274e-05],
        [7.4990e-05],
        [2.5826e-05],
        [3.3776e-04],
        [5.7778e-05],
        [8.5568e-05],
        [4.1635e-09],
        [1.8103e-05],
        [4.6220e-05],
        [2.7121e-05],
        [5.8489e-05],
        [5.5085e-06],
        [2.8682e-05],
        [5.7106e-05]], device='cuda:0') / tensor([[9.2544e-05, 6.0474e-05, 1.7274e-05, 7.4990e-05, 2.5826e-05, 3.3776e-04,
         5.7778e-05, 8.5568e-05, 4.1635e-09, 1.8103e-05, 4.6220e-05, 2.7121e-05,
         5.8489e-05, 5.5085e-06, 2.8682e-05, 5.7106e-05]], device='cuda:0')
answers_probs: tensor([[1.2662e-03, 2.5520e-03, 9.2544e-05],
        [8.2204e-04, 1.3127e-03, 6.0474e-05],
        [5.0643e-04, 2.1949e-03, 1.7274e-05],
        [7.7537e-04, 1.8110e-03, 7.4990e-05],
        [4.7916e-04, 6.1406e-04, 2.5826e-05],
        [1.2740e-03, 3.5244e-03, 3.3776e-04],
        [6.0423e-04, 5.1748e-03, 5.7778e-05],
        [9.9992e-04, 1.4318e-03, 8.5568e-05],
        [1.2844e-07, 1.0471e-07, 4.1635e-09],
        [1.2182e-03, 2.0465e-03, 1.8103e-05],
        [8.9346e-04, 2.1947e-03, 4.6220e-05],
        [2.3366e-04, 1.6959e-03, 2.7121e-05],
        [1.4818e-03, 4.3552e-04, 5.8489e-05],
        [1.6641e-04, 1.5247e-04, 5.5085e-06],
        [1.5281e-03, 9.0872e-04, 2.8682e-05],
        [8.9087e-04, 3.7459e-03, 5.7106e-05]], device='cuda:0')
acc:  0.375
Time taken to execute the de NLI task with prompt type auxiliary, variation 2 and batchsize 16: 0:03:05.038063
path ['42', 'de', 'flan', 'NLI', 'auxiliary', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base NLI modal 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 339.45it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[6.0636e-08],
        [6.6211e-04],
        [1.1841e-03],
        [3.6725e-04],
        [5.3464e-04],
        [2.1681e-04],
        [8.1308e-04],
        [3.1608e-03],
        [1.3117e-04],
        [3.9167e-04],
        [1.6084e-03],
        [7.3242e-04],
        [3.1549e-03],
        [6.5928e-04],
        [4.1619e-04],
        [9.3057e-04]], device='cuda:0') / tensor([[6.0636e-08, 6.6211e-04, 1.1841e-03, 3.6725e-04, 5.3464e-04, 2.1681e-04,
         8.1308e-04, 3.1608e-03, 1.3117e-04, 3.9167e-04, 1.6084e-03, 7.3242e-04,
         3.1549e-03, 6.5928e-04, 4.1619e-04, 9.3057e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[7.7735e-08],
        [4.9291e-04],
        [1.2325e-03],
        [1.3184e-04],
        [3.9526e-03],
        [2.7245e-04],
        [5.7233e-04],
        [1.6365e-03],
        [1.4369e-04],
        [2.5850e-04],
        [1.3336e-03],
        [9.5543e-04],
        [1.5185e-03],
        [2.8260e-03],
        [2.8041e-04],
        [9.3171e-04]], device='cuda:0') / tensor([[7.7735e-08, 4.9291e-04, 1.2325e-03, 1.3184e-04, 3.9526e-03, 2.7245e-04,
         5.7233e-04, 1.6365e-03, 1.4369e-04, 2.5850e-04, 1.3336e-03, 9.5543e-04,
         1.5185e-03, 2.8260e-03, 2.8041e-04, 9.3171e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[4.2290e-09],
        [6.9813e-05],
        [6.8189e-05],
        [2.6295e-05],
        [6.5256e-05],
        [2.3816e-05],
        [4.7456e-05],
        [2.2593e-04],
        [7.0555e-06],
        [2.0355e-05],
        [9.0921e-05],
        [7.4072e-05],
        [4.1159e-05],
        [1.7455e-04],
        [5.4630e-05],
        [5.3627e-05]], device='cuda:0') / tensor([[4.2290e-09, 6.9813e-05, 6.8189e-05, 2.6295e-05, 6.5256e-05, 2.3816e-05,
         4.7456e-05, 2.2593e-04, 7.0555e-06, 2.0355e-05, 9.0921e-05, 7.4072e-05,
         4.1159e-05, 1.7455e-04, 5.4630e-05, 5.3627e-05]], device='cuda:0')
answers_probs: tensor([[6.0636e-08, 7.7735e-08, 4.2290e-09],
        [6.6211e-04, 4.9291e-04, 6.9813e-05],
        [1.1841e-03, 1.2325e-03, 6.8189e-05],
        [3.6725e-04, 1.3184e-04, 2.6295e-05],
        [5.3464e-04, 3.9526e-03, 6.5256e-05],
        [2.1681e-04, 2.7245e-04, 2.3816e-05],
        [8.1308e-04, 5.7233e-04, 4.7456e-05],
        [3.1608e-03, 1.6365e-03, 2.2593e-04],
        [1.3117e-04, 1.4369e-04, 7.0555e-06],
        [3.9167e-04, 2.5850e-04, 2.0355e-05],
        [1.6084e-03, 1.3336e-03, 9.0921e-05],
        [7.3242e-04, 9.5543e-04, 7.4072e-05],
        [3.1549e-03, 1.5185e-03, 4.1159e-05],
        [6.5928e-04, 2.8260e-03, 1.7455e-04],
        [4.1619e-04, 2.8041e-04, 5.4630e-05],
        [9.3057e-04, 9.3171e-04, 5.3627e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.4124e-03],
        [4.7452e-04],
        [4.2107e-04],
        [7.6719e-05],
        [1.5617e-03],
        [3.6873e-04],
        [1.6862e-03],
        [3.8586e-04],
        [6.9886e-04],
        [2.4543e-03],
        [9.4501e-04],
        [6.0393e-04],
        [4.6296e-05],
        [2.5124e-03],
        [5.8780e-08],
        [5.4907e-04]], device='cuda:0') / tensor([[4.4124e-03, 4.7452e-04, 4.2107e-04, 7.6719e-05, 1.5617e-03, 3.6873e-04,
         1.6862e-03, 3.8586e-04, 6.9886e-04, 2.4543e-03, 9.4501e-04, 6.0393e-04,
         4.6296e-05, 2.5124e-03, 5.8780e-08, 5.4907e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.0617e-03],
        [5.4279e-04],
        [4.9041e-04],
        [1.2927e-04],
        [3.3040e-03],
        [2.8806e-04],
        [4.4328e-04],
        [7.7737e-04],
        [4.5605e-04],
        [8.7377e-04],
        [1.6570e-03],
        [9.3743e-04],
        [3.3524e-04],
        [6.3754e-04],
        [1.0870e-07],
        [3.9695e-04]], device='cuda:0') / tensor([[6.0617e-03, 5.4279e-04, 4.9041e-04, 1.2927e-04, 3.3040e-03, 2.8806e-04,
         4.4328e-04, 7.7737e-04, 4.5605e-04, 8.7377e-04, 1.6570e-03, 9.3743e-04,
         3.3524e-04, 6.3754e-04, 1.0870e-07, 3.9695e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[6.1354e-04],
        [3.8860e-05],
        [4.8628e-05],
        [1.1100e-05],
        [1.5157e-04],
        [1.0632e-05],
        [1.5831e-04],
        [2.8007e-05],
        [3.6844e-05],
        [1.0573e-04],
        [1.0992e-04],
        [7.5937e-05],
        [8.3862e-06],
        [1.4810e-04],
        [2.9408e-09],
        [5.0320e-05]], device='cuda:0') / tensor([[6.1354e-04, 3.8860e-05, 4.8628e-05, 1.1100e-05, 1.5157e-04, 1.0632e-05,
         1.5831e-04, 2.8007e-05, 3.6844e-05, 1.0573e-04, 1.0992e-04, 7.5937e-05,
         8.3862e-06, 1.4810e-04, 2.9408e-09, 5.0320e-05]], device='cuda:0')
answers_probs: tensor([[4.4124e-03, 6.0617e-03, 6.1354e-04],
        [4.7452e-04, 5.4279e-04, 3.8860e-05],
        [4.2107e-04, 4.9041e-04, 4.8628e-05],
        [7.6719e-05, 1.2927e-04, 1.1100e-05],
        [1.5617e-03, 3.3040e-03, 1.5157e-04],
        [3.6873e-04, 2.8806e-04, 1.0632e-05],
        [1.6862e-03, 4.4328e-04, 1.5831e-04],
        [3.8586e-04, 7.7737e-04, 2.8007e-05],
        [6.9886e-04, 4.5605e-04, 3.6844e-05],
        [2.4543e-03, 8.7377e-04, 1.0573e-04],
        [9.4501e-04, 1.6570e-03, 1.0992e-04],
        [6.0393e-04, 9.3743e-04, 7.5937e-05],
        [4.6296e-05, 3.3524e-04, 8.3862e-06],
        [2.5124e-03, 6.3754e-04, 1.4810e-04],
        [5.8780e-08, 1.0870e-07, 2.9408e-09],
        [5.4907e-04, 3.9695e-04, 5.0320e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.5556e-04],
        [4.8196e-04],
        [2.8392e-04],
        [1.8159e-03],
        [1.7209e-03],
        [3.4495e-04],
        [7.8823e-04],
        [6.1438e-04],
        [1.9939e-03],
        [1.2510e-07],
        [7.3486e-04],
        [1.1587e-03],
        [8.8982e-04],
        [1.3523e-03],
        [3.3566e-04],
        [9.7380e-04]], device='cuda:0') / tensor([[1.5556e-04, 4.8196e-04, 2.8392e-04, 1.8159e-03, 1.7209e-03, 3.4495e-04,
         7.8823e-04, 6.1438e-04, 1.9939e-03, 1.2510e-07, 7.3486e-04, 1.1587e-03,
         8.8982e-04, 1.3523e-03, 3.3566e-04, 9.7380e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.1046e-04],
        [2.6566e-03],
        [3.6433e-04],
        [2.2835e-03],
        [3.8151e-03],
        [3.1425e-04],
        [2.3632e-03],
        [4.7606e-04],
        [1.7129e-03],
        [3.2739e-07],
        [2.3332e-03],
        [1.5741e-03],
        [9.6848e-04],
        [2.3402e-03],
        [1.8632e-04],
        [1.4970e-03]], device='cuda:0') / tensor([[9.1046e-04, 2.6566e-03, 3.6433e-04, 2.2835e-03, 3.8151e-03, 3.1425e-04,
         2.3632e-03, 4.7606e-04, 1.7129e-03, 3.2739e-07, 2.3332e-03, 1.5741e-03,
         9.6848e-04, 2.3402e-03, 1.8632e-04, 1.4970e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[2.3201e-05],
        [4.1094e-05],
        [1.4339e-05],
        [1.5118e-04],
        [2.5424e-04],
        [4.2354e-06],
        [1.1095e-04],
        [5.1719e-05],
        [7.5278e-05],
        [1.1605e-08],
        [3.0241e-04],
        [5.7331e-05],
        [1.2739e-04],
        [3.9001e-04],
        [8.0552e-05],
        [7.6675e-05]], device='cuda:0') / tensor([[2.3201e-05, 4.1094e-05, 1.4339e-05, 1.5118e-04, 2.5424e-04, 4.2354e-06,
         1.1095e-04, 5.1719e-05, 7.5278e-05, 1.1605e-08, 3.0241e-04, 5.7331e-05,
         1.2739e-04, 3.9001e-04, 8.0552e-05, 7.6675e-05]], device='cuda:0')
answers_probs: tensor([[1.5556e-04, 9.1046e-04, 2.3201e-05],
        [4.8196e-04, 2.6566e-03, 4.1094e-05],
        [2.8392e-04, 3.6433e-04, 1.4339e-05],
        [1.8159e-03, 2.2835e-03, 1.5118e-04],
        [1.7209e-03, 3.8151e-03, 2.5424e-04],
        [3.4495e-04, 3.1425e-04, 4.2354e-06],
        [7.8823e-04, 2.3632e-03, 1.1095e-04],
        [6.1438e-04, 4.7606e-04, 5.1719e-05],
        [1.9939e-03, 1.7129e-03, 7.5278e-05],
        [1.2510e-07, 3.2739e-07, 1.1605e-08],
        [7.3486e-04, 2.3332e-03, 3.0241e-04],
        [1.1587e-03, 1.5741e-03, 5.7331e-05],
        [8.8982e-04, 9.6848e-04, 1.2739e-04],
        [1.3523e-03, 2.3402e-03, 3.9001e-04],
        [3.3566e-04, 1.8632e-04, 8.0552e-05],
        [9.7380e-04, 1.4970e-03, 7.6675e-05]], device='cuda:0')
acc:  0.3958333333333333
Time taken to execute the de NLI task with prompt type modal, variation 0 and batchsize 16: 0:03:04.729708
path ['42', 'de', 'flan', 'NLI', 'modal', 'prompt_id_0']
----------- 42 de google/flan-t5-base NLI modal 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 338.70it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.6992e-03],
        [7.6097e-04],
        [1.8677e-04],
        [7.8849e-04],
        [6.8579e-04],
        [1.8513e-03],
        [1.7870e-03],
        [3.5683e-04],
        [1.8908e-03],
        [3.5134e-04],
        [6.7881e-08],
        [9.0637e-04],
        [2.0896e-04],
        [1.3807e-03],
        [3.3064e-03],
        [3.3072e-04]], device='cuda:0') / tensor([[3.6992e-03, 7.6097e-04, 1.8677e-04, 7.8849e-04, 6.8579e-04, 1.8513e-03,
         1.7870e-03, 3.5683e-04, 1.8908e-03, 3.5134e-04, 6.7881e-08, 9.0637e-04,
         2.0896e-04, 1.3807e-03, 3.3064e-03, 3.3072e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.6163e-03],
        [5.0062e-04],
        [6.8737e-04],
        [2.7480e-03],
        [3.2840e-04],
        [4.7486e-03],
        [2.8369e-03],
        [1.1292e-04],
        [1.3322e-03],
        [1.7567e-04],
        [5.7029e-08],
        [9.0723e-04],
        [3.0109e-04],
        [8.0631e-04],
        [1.7921e-03],
        [6.0552e-04]], device='cuda:0') / tensor([[1.6163e-03, 5.0062e-04, 6.8737e-04, 2.7480e-03, 3.2840e-04, 4.7486e-03,
         2.8369e-03, 1.1292e-04, 1.3322e-03, 1.7567e-04, 5.7029e-08, 9.0723e-04,
         3.0109e-04, 8.0631e-04, 1.7921e-03, 6.0552e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[4.8580e-05],
        [9.2669e-05],
        [2.4468e-05],
        [2.3084e-04],
        [6.0807e-05],
        [1.7678e-04],
        [3.8607e-04],
        [3.1135e-05],
        [1.1902e-04],
        [9.3487e-05],
        [5.6817e-09],
        [5.4087e-05],
        [1.5069e-05],
        [5.3164e-05],
        [2.5031e-04],
        [4.3902e-05]], device='cuda:0') / tensor([[4.8580e-05, 9.2669e-05, 2.4468e-05, 2.3084e-04, 6.0807e-05, 1.7678e-04,
         3.8607e-04, 3.1135e-05, 1.1902e-04, 9.3487e-05, 5.6817e-09, 5.4087e-05,
         1.5069e-05, 5.3164e-05, 2.5031e-04, 4.3902e-05]], device='cuda:0')
answers_probs: tensor([[3.6992e-03, 1.6163e-03, 4.8580e-05],
        [7.6097e-04, 5.0062e-04, 9.2669e-05],
        [1.8677e-04, 6.8737e-04, 2.4468e-05],
        [7.8849e-04, 2.7480e-03, 2.3084e-04],
        [6.8579e-04, 3.2840e-04, 6.0807e-05],
        [1.8513e-03, 4.7486e-03, 1.7678e-04],
        [1.7870e-03, 2.8369e-03, 3.8607e-04],
        [3.5683e-04, 1.1292e-04, 3.1135e-05],
        [1.8908e-03, 1.3322e-03, 1.1902e-04],
        [3.5134e-04, 1.7567e-04, 9.3487e-05],
        [6.7881e-08, 5.7029e-08, 5.6817e-09],
        [9.0637e-04, 9.0723e-04, 5.4087e-05],
        [2.0896e-04, 3.0109e-04, 1.5069e-05],
        [1.3807e-03, 8.0631e-04, 5.3164e-05],
        [3.3064e-03, 1.7921e-03, 2.5031e-04],
        [3.3072e-04, 6.0552e-04, 4.3902e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.0868e-03],
        [2.0417e-03],
        [2.0445e-04],
        [1.0290e-03],
        [1.5518e-03],
        [4.4421e-04],
        [1.5336e-07],
        [4.8481e-04],
        [5.4476e-04],
        [4.2152e-04],
        [8.9555e-04],
        [4.9211e-03],
        [1.4021e-03],
        [1.8340e-03],
        [1.4000e-03],
        [3.6882e-04]], device='cuda:0') / tensor([[1.0868e-03, 2.0417e-03, 2.0445e-04, 1.0290e-03, 1.5518e-03, 4.4421e-04,
         1.5336e-07, 4.8481e-04, 5.4476e-04, 4.2152e-04, 8.9555e-04, 4.9211e-03,
         1.4021e-03, 1.8340e-03, 1.4000e-03, 3.6882e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.6376e-03],
        [2.3166e-03],
        [2.7250e-04],
        [9.1699e-04],
        [3.6053e-04],
        [2.9919e-04],
        [2.9640e-07],
        [5.3276e-04],
        [3.8461e-04],
        [7.6130e-04],
        [2.3906e-03],
        [6.6390e-03],
        [2.4512e-03],
        [3.9903e-03],
        [1.2867e-03],
        [4.2478e-04]], device='cuda:0') / tensor([[1.6376e-03, 2.3166e-03, 2.7250e-04, 9.1699e-04, 3.6053e-04, 2.9919e-04,
         2.9640e-07, 5.3276e-04, 3.8461e-04, 7.6130e-04, 2.3906e-03, 6.6390e-03,
         2.4512e-03, 3.9903e-03, 1.2867e-03, 4.2478e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[8.7926e-05],
        [1.8450e-04],
        [3.4943e-05],
        [6.3594e-05],
        [1.3677e-04],
        [2.8899e-05],
        [2.2167e-08],
        [1.1228e-05],
        [8.4354e-05],
        [3.0376e-05],
        [1.3316e-04],
        [6.2706e-04],
        [1.4731e-04],
        [2.8630e-04],
        [8.7915e-05],
        [1.9683e-05]], device='cuda:0') / tensor([[8.7926e-05, 1.8450e-04, 3.4943e-05, 6.3594e-05, 1.3677e-04, 2.8899e-05,
         2.2167e-08, 1.1228e-05, 8.4354e-05, 3.0376e-05, 1.3316e-04, 6.2706e-04,
         1.4731e-04, 2.8630e-04, 8.7915e-05, 1.9683e-05]], device='cuda:0')
answers_probs: tensor([[1.0868e-03, 1.6376e-03, 8.7926e-05],
        [2.0417e-03, 2.3166e-03, 1.8450e-04],
        [2.0445e-04, 2.7250e-04, 3.4943e-05],
        [1.0290e-03, 9.1699e-04, 6.3594e-05],
        [1.5518e-03, 3.6053e-04, 1.3677e-04],
        [4.4421e-04, 2.9919e-04, 2.8899e-05],
        [1.5336e-07, 2.9640e-07, 2.2167e-08],
        [4.8481e-04, 5.3276e-04, 1.1228e-05],
        [5.4476e-04, 3.8461e-04, 8.4354e-05],
        [4.2152e-04, 7.6130e-04, 3.0376e-05],
        [8.9555e-04, 2.3906e-03, 1.3316e-04],
        [4.9211e-03, 6.6390e-03, 6.2706e-04],
        [1.4021e-03, 2.4512e-03, 1.4731e-04],
        [1.8340e-03, 3.9903e-03, 2.8630e-04],
        [1.4000e-03, 1.2867e-03, 8.7915e-05],
        [3.6882e-04, 4.2478e-04, 1.9683e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.1944e-03],
        [9.6858e-04],
        [3.9116e-04],
        [1.1353e-03],
        [2.5323e-03],
        [3.0029e-03],
        [7.5741e-04],
        [7.3807e-05],
        [6.3672e-04],
        [4.2909e-04],
        [5.7052e-04],
        [8.3746e-04],
        [8.4195e-04],
        [1.4111e-04],
        [5.9551e-08],
        [2.0427e-03]], device='cuda:0') / tensor([[1.1944e-03, 9.6858e-04, 3.9116e-04, 1.1353e-03, 2.5323e-03, 3.0029e-03,
         7.5741e-04, 7.3807e-05, 6.3672e-04, 4.2909e-04, 5.7052e-04, 8.3746e-04,
         8.4195e-04, 1.4111e-04, 5.9551e-08, 2.0427e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[8.1388e-04],
        [1.3855e-03],
        [2.1329e-04],
        [2.0942e-03],
        [7.1141e-04],
        [6.1752e-04],
        [1.0305e-03],
        [4.2802e-04],
        [3.9935e-04],
        [3.1701e-03],
        [2.0254e-03],
        [7.6752e-04],
        [1.7795e-03],
        [1.1906e-04],
        [8.1860e-08],
        [1.8821e-03]], device='cuda:0') / tensor([[8.1388e-04, 1.3855e-03, 2.1329e-04, 2.0942e-03, 7.1141e-04, 6.1752e-04,
         1.0305e-03, 4.2802e-04, 3.9935e-04, 3.1701e-03, 2.0254e-03, 7.6752e-04,
         1.7795e-03, 1.1906e-04, 8.1860e-08, 1.8821e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[1.6130e-04],
        [8.1194e-05],
        [6.4581e-06],
        [1.5970e-04],
        [9.7138e-05],
        [2.0889e-04],
        [9.9016e-05],
        [1.3793e-05],
        [7.2342e-05],
        [8.7732e-05],
        [6.3838e-05],
        [9.8358e-05],
        [3.5031e-04],
        [1.4169e-05],
        [2.9088e-09],
        [1.7028e-04]], device='cuda:0') / tensor([[1.6130e-04, 8.1194e-05, 6.4581e-06, 1.5970e-04, 9.7138e-05, 2.0889e-04,
         9.9016e-05, 1.3793e-05, 7.2342e-05, 8.7732e-05, 6.3838e-05, 9.8358e-05,
         3.5031e-04, 1.4169e-05, 2.9088e-09, 1.7028e-04]], device='cuda:0')
answers_probs: tensor([[1.1944e-03, 8.1388e-04, 1.6130e-04],
        [9.6858e-04, 1.3855e-03, 8.1194e-05],
        [3.9116e-04, 2.1329e-04, 6.4581e-06],
        [1.1353e-03, 2.0942e-03, 1.5970e-04],
        [2.5323e-03, 7.1141e-04, 9.7138e-05],
        [3.0029e-03, 6.1752e-04, 2.0889e-04],
        [7.5741e-04, 1.0305e-03, 9.9016e-05],
        [7.3807e-05, 4.2802e-04, 1.3793e-05],
        [6.3672e-04, 3.9935e-04, 7.2342e-05],
        [4.2909e-04, 3.1701e-03, 8.7732e-05],
        [5.7052e-04, 2.0254e-03, 6.3838e-05],
        [8.3746e-04, 7.6752e-04, 9.8358e-05],
        [8.4195e-04, 1.7795e-03, 3.5031e-04],
        [1.4111e-04, 1.1906e-04, 1.4169e-05],
        [5.9551e-08, 8.1860e-08, 2.9088e-09],
        [2.0427e-03, 1.8821e-03, 1.7028e-04]], device='cuda:0')
acc:  0.4375
Time taken to execute the de NLI task with prompt type modal, variation 1 and batchsize 16: 0:02:45.814840
path ['42', 'de', 'flan', 'NLI', 'modal', 'prompt_id_1']
----------- 42 de google/flan-t5-base NLI modal 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 365.46it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.5536e-03],
        [6.1012e-04],
        [1.9432e-03],
        [1.6163e-04],
        [8.5345e-04],
        [5.6434e-04],
        [3.5848e-04],
        [1.2924e-03],
        [1.4730e-04],
        [5.2081e-04],
        [4.2815e-03],
        [6.6638e-04],
        [5.7001e-07],
        [1.0467e-03],
        [1.6138e-03],
        [2.0791e-03]], device='cuda:0') / tensor([[3.5536e-03, 6.1012e-04, 1.9432e-03, 1.6163e-04, 8.5345e-04, 5.6434e-04,
         3.5848e-04, 1.2924e-03, 1.4730e-04, 5.2081e-04, 4.2815e-03, 6.6638e-04,
         5.7001e-07, 1.0467e-03, 1.6138e-03, 2.0791e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.3643e-03],
        [2.9959e-03],
        [4.0042e-03],
        [6.1871e-04],
        [5.5731e-04],
        [2.4233e-04],
        [2.2256e-04],
        [7.7547e-04],
        [1.3886e-04],
        [3.1510e-04],
        [4.7968e-03],
        [3.7364e-03],
        [2.1111e-06],
        [7.8523e-04],
        [3.7389e-04],
        [1.2082e-03]], device='cuda:0') / tensor([[1.3643e-03, 2.9959e-03, 4.0042e-03, 6.1871e-04, 5.5731e-04, 2.4233e-04,
         2.2256e-04, 7.7547e-04, 1.3886e-04, 3.1510e-04, 4.7968e-03, 3.7364e-03,
         2.1111e-06, 7.8523e-04, 3.7389e-04, 1.2082e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[4.1163e-05],
        [4.9947e-05],
        [1.6015e-04],
        [2.3383e-05],
        [5.3307e-05],
        [3.7009e-05],
        [3.8778e-05],
        [4.5952e-05],
        [6.6221e-06],
        [2.0764e-05],
        [5.3230e-04],
        [8.1121e-05],
        [7.0250e-08],
        [1.0474e-04],
        [1.0383e-04],
        [1.0196e-04]], device='cuda:0') / tensor([[4.1163e-05, 4.9947e-05, 1.6015e-04, 2.3383e-05, 5.3307e-05, 3.7009e-05,
         3.8778e-05, 4.5952e-05, 6.6221e-06, 2.0764e-05, 5.3230e-04, 8.1121e-05,
         7.0250e-08, 1.0474e-04, 1.0383e-04, 1.0196e-04]], device='cuda:0')
answers_probs: tensor([[3.5536e-03, 1.3643e-03, 4.1163e-05],
        [6.1012e-04, 2.9959e-03, 4.9947e-05],
        [1.9432e-03, 4.0042e-03, 1.6015e-04],
        [1.6163e-04, 6.1871e-04, 2.3383e-05],
        [8.5345e-04, 5.5731e-04, 5.3307e-05],
        [5.6434e-04, 2.4233e-04, 3.7009e-05],
        [3.5848e-04, 2.2256e-04, 3.8778e-05],
        [1.2924e-03, 7.7547e-04, 4.5952e-05],
        [1.4730e-04, 1.3886e-04, 6.6221e-06],
        [5.2081e-04, 3.1510e-04, 2.0764e-05],
        [4.2815e-03, 4.7968e-03, 5.3230e-04],
        [6.6638e-04, 3.7364e-03, 8.1121e-05],
        [5.7001e-07, 2.1111e-06, 7.0250e-08],
        [1.0467e-03, 7.8523e-04, 1.0474e-04],
        [1.6138e-03, 3.7389e-04, 1.0383e-04],
        [2.0791e-03, 1.2082e-03, 1.0196e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.0096e-04],
        [4.5230e-04],
        [1.1109e-03],
        [1.7265e-07],
        [3.4089e-04],
        [4.8832e-04],
        [8.0634e-04],
        [9.7272e-04],
        [2.2652e-03],
        [1.2525e-03],
        [6.2701e-04],
        [7.2316e-04],
        [1.4468e-03],
        [1.1623e-03],
        [7.2919e-04],
        [1.6148e-04]], device='cuda:0') / tensor([[3.0096e-04, 4.5230e-04, 1.1109e-03, 1.7265e-07, 3.4089e-04, 4.8832e-04,
         8.0634e-04, 9.7272e-04, 2.2652e-03, 1.2525e-03, 6.2701e-04, 7.2316e-04,
         1.4468e-03, 1.1623e-03, 7.2919e-04, 1.6148e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.2925e-04],
        [4.7288e-04],
        [1.4401e-03],
        [4.6942e-07],
        [6.7617e-04],
        [3.6146e-04],
        [9.7970e-04],
        [8.5492e-04],
        [1.6561e-03],
        [2.1134e-03],
        [4.1448e-04],
        [1.8718e-03],
        [2.1896e-03],
        [2.6519e-04],
        [7.7128e-04],
        [2.0822e-04]], device='cuda:0') / tensor([[1.2925e-04, 4.7288e-04, 1.4401e-03, 4.6942e-07, 6.7617e-04, 3.6146e-04,
         9.7970e-04, 8.5492e-04, 1.6561e-03, 2.1134e-03, 4.1448e-04, 1.8718e-03,
         2.1896e-03, 2.6519e-04, 7.7128e-04, 2.0822e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.1358e-05],
        [8.4271e-06],
        [8.4473e-05],
        [1.8579e-08],
        [3.9194e-05],
        [5.4248e-06],
        [6.9434e-05],
        [5.6770e-05],
        [8.5613e-05],
        [1.3063e-04],
        [5.4046e-05],
        [2.4399e-04],
        [3.8376e-04],
        [8.9617e-05],
        [3.4105e-05],
        [9.8452e-06]], device='cuda:0') / tensor([[3.1358e-05, 8.4271e-06, 8.4473e-05, 1.8579e-08, 3.9194e-05, 5.4248e-06,
         6.9434e-05, 5.6770e-05, 8.5613e-05, 1.3063e-04, 5.4046e-05, 2.4399e-04,
         3.8376e-04, 8.9617e-05, 3.4105e-05, 9.8452e-06]], device='cuda:0')
answers_probs: tensor([[3.0096e-04, 1.2925e-04, 3.1358e-05],
        [4.5230e-04, 4.7288e-04, 8.4271e-06],
        [1.1109e-03, 1.4401e-03, 8.4473e-05],
        [1.7265e-07, 4.6942e-07, 1.8579e-08],
        [3.4089e-04, 6.7617e-04, 3.9194e-05],
        [4.8832e-04, 3.6146e-04, 5.4248e-06],
        [8.0634e-04, 9.7970e-04, 6.9434e-05],
        [9.7272e-04, 8.5492e-04, 5.6770e-05],
        [2.2652e-03, 1.6561e-03, 8.5613e-05],
        [1.2525e-03, 2.1134e-03, 1.3063e-04],
        [6.2701e-04, 4.1448e-04, 5.4046e-05],
        [7.2316e-04, 1.8718e-03, 2.4399e-04],
        [1.4468e-03, 2.1896e-03, 3.8376e-04],
        [1.1623e-03, 2.6519e-04, 8.9617e-05],
        [7.2919e-04, 7.7128e-04, 3.4105e-05],
        [1.6148e-04, 2.0822e-04, 9.8452e-06]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[8.4300e-08],
        [1.1527e-03],
        [7.7286e-04],
        [8.5088e-05],
        [3.9321e-04],
        [3.3034e-03],
        [3.9693e-04],
        [1.5125e-03],
        [5.3685e-04],
        [3.0404e-04],
        [2.2458e-03],
        [7.4032e-04],
        [6.4347e-04],
        [1.4070e-03],
        [2.4062e-04],
        [1.2801e-03]], device='cuda:0') / tensor([[8.4300e-08, 1.1527e-03, 7.7286e-04, 8.5088e-05, 3.9321e-04, 3.3034e-03,
         3.9693e-04, 1.5125e-03, 5.3685e-04, 3.0404e-04, 2.2458e-03, 7.4032e-04,
         6.4347e-04, 1.4070e-03, 2.4062e-04, 1.2801e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.3047e-07],
        [9.7730e-04],
        [1.8306e-03],
        [4.8772e-04],
        [4.8928e-04],
        [1.5566e-03],
        [7.1763e-04],
        [8.9385e-04],
        [3.9025e-04],
        [1.4659e-04],
        [1.7961e-03],
        [2.8059e-03],
        [9.1285e-04],
        [1.9623e-03],
        [2.6624e-04],
        [1.1836e-03]], device='cuda:0') / tensor([[1.3047e-07, 9.7730e-04, 1.8306e-03, 4.8772e-04, 4.8928e-04, 1.5566e-03,
         7.1763e-04, 8.9385e-04, 3.9025e-04, 1.4659e-04, 1.7961e-03, 2.8059e-03,
         9.1285e-04, 1.9623e-03, 2.6624e-04, 1.1836e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[8.2336e-09],
        [5.4505e-05],
        [1.1201e-04],
        [1.0260e-05],
        [2.0745e-05],
        [2.3165e-04],
        [2.6912e-05],
        [9.9263e-05],
        [5.3518e-05],
        [8.0613e-05],
        [1.9490e-04],
        [2.0666e-04],
        [8.5259e-05],
        [4.7156e-05],
        [2.1321e-05],
        [7.3260e-05]], device='cuda:0') / tensor([[8.2336e-09, 5.4505e-05, 1.1201e-04, 1.0260e-05, 2.0745e-05, 2.3165e-04,
         2.6912e-05, 9.9263e-05, 5.3518e-05, 8.0613e-05, 1.9490e-04, 2.0666e-04,
         8.5259e-05, 4.7156e-05, 2.1321e-05, 7.3260e-05]], device='cuda:0')
answers_probs: tensor([[8.4300e-08, 1.3047e-07, 8.2336e-09],
        [1.1527e-03, 9.7730e-04, 5.4505e-05],
        [7.7286e-04, 1.8306e-03, 1.1201e-04],
        [8.5088e-05, 4.8772e-04, 1.0260e-05],
        [3.9321e-04, 4.8928e-04, 2.0745e-05],
        [3.3034e-03, 1.5566e-03, 2.3165e-04],
        [3.9693e-04, 7.1763e-04, 2.6912e-05],
        [1.5125e-03, 8.9385e-04, 9.9263e-05],
        [5.3685e-04, 3.9025e-04, 5.3518e-05],
        [3.0404e-04, 1.4659e-04, 8.0613e-05],
        [2.2458e-03, 1.7961e-03, 1.9490e-04],
        [7.4032e-04, 2.8059e-03, 2.0666e-04],
        [6.4347e-04, 9.1285e-04, 8.5259e-05],
        [1.4070e-03, 1.9623e-03, 4.7156e-05],
        [2.4062e-04, 2.6624e-04, 2.1321e-05],
        [1.2801e-03, 1.1836e-03, 7.3260e-05]], device='cuda:0')
acc:  0.4166666666666667
Time taken to execute the de NLI task with prompt type modal, variation 2 and batchsize 16: 0:02:46.734957
path ['42', 'de', 'flan', 'NLI', 'modal', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base NLI rare_synonyms 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 169.75it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.4424e-03],
        [1.1926e-03],
        [6.5779e-04],
        [9.4798e-04],
        [6.6317e-05],
        [2.1678e-03],
        [7.9701e-04],
        [5.5659e-04],
        [6.0889e-04],
        [1.3104e-04],
        [3.7069e-04],
        [2.7637e-04],
        [1.1202e-03],
        [3.3233e-04],
        [3.9405e-04],
        [7.9032e-08]], device='cuda:0') / tensor([[1.4424e-03, 1.1926e-03, 6.5779e-04, 9.4798e-04, 6.6317e-05, 2.1678e-03,
         7.9701e-04, 5.5659e-04, 6.0889e-04, 1.3104e-04, 3.7069e-04, 2.7637e-04,
         1.1202e-03, 3.3233e-04, 3.9405e-04, 7.9032e-08]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.2465e-04],
        [1.9994e-03],
        [1.0270e-03],
        [7.1724e-04],
        [3.9963e-04],
        [1.6699e-03],
        [2.4652e-03],
        [6.5908e-04],
        [6.4867e-04],
        [1.0313e-03],
        [4.6853e-04],
        [3.5386e-04],
        [3.6562e-03],
        [8.8598e-04],
        [2.6343e-04],
        [1.6457e-07]], device='cuda:0') / tensor([[3.2465e-04, 1.9994e-03, 1.0270e-03, 7.1724e-04, 3.9963e-04, 1.6699e-03,
         2.4652e-03, 6.5908e-04, 6.4867e-04, 1.0313e-03, 4.6853e-04, 3.5386e-04,
         3.6562e-03, 8.8598e-04, 2.6343e-04, 1.6457e-07]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.0716e-04],
        [6.4105e-05],
        [5.6786e-05],
        [3.8763e-05],
        [7.1818e-06],
        [7.6339e-05],
        [1.2118e-04],
        [2.3143e-05],
        [6.5189e-05],
        [2.4340e-05],
        [7.6141e-06],
        [1.5740e-05],
        [1.1069e-04],
        [2.8233e-05],
        [1.0026e-04],
        [6.7947e-09]], device='cuda:0') / tensor([[1.0716e-04, 6.4105e-05, 5.6786e-05, 3.8763e-05, 7.1818e-06, 7.6339e-05,
         1.2118e-04, 2.3143e-05, 6.5189e-05, 2.4340e-05, 7.6141e-06, 1.5740e-05,
         1.1069e-04, 2.8233e-05, 1.0026e-04, 6.7947e-09]], device='cuda:0')
answers_probs: tensor([[1.4424e-03, 3.2465e-04, 1.0716e-04],
        [1.1926e-03, 1.9994e-03, 6.4105e-05],
        [6.5779e-04, 1.0270e-03, 5.6786e-05],
        [9.4798e-04, 7.1724e-04, 3.8763e-05],
        [6.6317e-05, 3.9963e-04, 7.1818e-06],
        [2.1678e-03, 1.6699e-03, 7.6339e-05],
        [7.9701e-04, 2.4652e-03, 1.2118e-04],
        [5.5659e-04, 6.5908e-04, 2.3143e-05],
        [6.0889e-04, 6.4867e-04, 6.5189e-05],
        [1.3104e-04, 1.0313e-03, 2.4340e-05],
        [3.7069e-04, 4.6853e-04, 7.6141e-06],
        [2.7637e-04, 3.5386e-04, 1.5740e-05],
        [1.1202e-03, 3.6562e-03, 1.1069e-04],
        [3.3233e-04, 8.8598e-04, 2.8233e-05],
        [3.9405e-04, 2.6343e-04, 1.0026e-04],
        [7.9032e-08, 1.6457e-07, 6.7947e-09]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[3.6638e-08],
        [1.6326e-03],
        [3.0253e-03],
        [1.6377e-03],
        [1.1189e-03],
        [1.2515e-03],
        [1.4037e-03],
        [9.0187e-04],
        [5.3710e-04],
        [9.3214e-04],
        [7.0280e-04],
        [3.8734e-04],
        [9.6637e-04],
        [6.6704e-04],
        [4.1467e-04],
        [1.2111e-03]], device='cuda:0') / tensor([[3.6638e-08, 1.6326e-03, 3.0253e-03, 1.6377e-03, 1.1189e-03, 1.2515e-03,
         1.4037e-03, 9.0187e-04, 5.3710e-04, 9.3214e-04, 7.0280e-04, 3.8734e-04,
         9.6637e-04, 6.6704e-04, 4.1467e-04, 1.2111e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.9957e-08],
        [2.8294e-03],
        [1.6655e-03],
        [1.0996e-03],
        [1.8246e-03],
        [1.2249e-03],
        [2.2900e-03],
        [1.7593e-03],
        [8.0798e-04],
        [9.5431e-04],
        [1.5355e-03],
        [4.0568e-03],
        [8.1219e-04],
        [2.4932e-03],
        [2.3319e-04],
        [4.5263e-03]], device='cuda:0') / tensor([[3.9957e-08, 2.8294e-03, 1.6655e-03, 1.0996e-03, 1.8246e-03, 1.2249e-03,
         2.2900e-03, 1.7593e-03, 8.0798e-04, 9.5431e-04, 1.5355e-03, 4.0568e-03,
         8.1219e-04, 2.4932e-03, 2.3319e-04, 4.5263e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[2.4956e-09],
        [3.3296e-04],
        [1.9441e-04],
        [1.0635e-04],
        [4.2718e-05],
        [6.5554e-05],
        [1.2359e-04],
        [1.0330e-04],
        [7.2745e-05],
        [5.1323e-05],
        [2.2314e-04],
        [5.3421e-05],
        [1.1207e-04],
        [1.9055e-04],
        [1.8418e-05],
        [1.6646e-04]], device='cuda:0') / tensor([[2.4956e-09, 3.3296e-04, 1.9441e-04, 1.0635e-04, 4.2718e-05, 6.5554e-05,
         1.2359e-04, 1.0330e-04, 7.2745e-05, 5.1323e-05, 2.2314e-04, 5.3421e-05,
         1.1207e-04, 1.9055e-04, 1.8418e-05, 1.6646e-04]], device='cuda:0')
answers_probs: tensor([[3.6638e-08, 3.9957e-08, 2.4956e-09],
        [1.6326e-03, 2.8294e-03, 3.3296e-04],
        [3.0253e-03, 1.6655e-03, 1.9441e-04],
        [1.6377e-03, 1.0996e-03, 1.0635e-04],
        [1.1189e-03, 1.8246e-03, 4.2718e-05],
        [1.2515e-03, 1.2249e-03, 6.5554e-05],
        [1.4037e-03, 2.2900e-03, 1.2359e-04],
        [9.0187e-04, 1.7593e-03, 1.0330e-04],
        [5.3710e-04, 8.0798e-04, 7.2745e-05],
        [9.3214e-04, 9.5431e-04, 5.1323e-05],
        [7.0280e-04, 1.5355e-03, 2.2314e-04],
        [3.8734e-04, 4.0568e-03, 5.3421e-05],
        [9.6637e-04, 8.1219e-04, 1.1207e-04],
        [6.6704e-04, 2.4932e-03, 1.9055e-04],
        [4.1467e-04, 2.3319e-04, 1.8418e-05],
        [1.2111e-03, 4.5263e-03, 1.6646e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[7.1977e-04],
        [2.0978e-04],
        [5.2113e-04],
        [1.6810e-03],
        [2.0570e-03],
        [1.0974e-04],
        [2.0790e-08],
        [7.6116e-05],
        [4.7534e-04],
        [6.4672e-04],
        [3.4028e-04],
        [2.3770e-03],
        [2.0761e-04],
        [1.1138e-03],
        [2.7213e-03],
        [4.0465e-03]], device='cuda:0') / tensor([[7.1977e-04, 2.0978e-04, 5.2113e-04, 1.6810e-03, 2.0570e-03, 1.0974e-04,
         2.0790e-08, 7.6116e-05, 4.7534e-04, 6.4672e-04, 3.4028e-04, 2.3770e-03,
         2.0761e-04, 1.1138e-03, 2.7213e-03, 4.0465e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[4.3918e-04],
        [1.3377e-04],
        [2.9939e-04],
        [1.2563e-03],
        [1.0309e-03],
        [1.2372e-04],
        [4.2892e-08],
        [1.2251e-04],
        [5.2585e-04],
        [2.4459e-04],
        [1.6093e-03],
        [2.8134e-03],
        [3.2037e-04],
        [6.4027e-04],
        [7.4245e-04],
        [5.0876e-03]], device='cuda:0') / tensor([[4.3918e-04, 1.3377e-04, 2.9939e-04, 1.2563e-03, 1.0309e-03, 1.2372e-04,
         4.2892e-08, 1.2251e-04, 5.2585e-04, 2.4459e-04, 1.6093e-03, 2.8134e-03,
         3.2037e-04, 6.4027e-04, 7.4245e-04, 5.0876e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[3.8843e-05],
        [3.5962e-06],
        [5.8981e-05],
        [8.0899e-05],
        [4.8874e-05],
        [1.2189e-05],
        [4.0003e-09],
        [8.9865e-06],
        [5.8099e-05],
        [4.3782e-05],
        [3.7822e-05],
        [2.5996e-04],
        [6.9270e-05],
        [8.7239e-05],
        [1.6916e-04],
        [4.8341e-04]], device='cuda:0') / tensor([[3.8843e-05, 3.5962e-06, 5.8981e-05, 8.0899e-05, 4.8874e-05, 1.2189e-05,
         4.0003e-09, 8.9865e-06, 5.8099e-05, 4.3782e-05, 3.7822e-05, 2.5996e-04,
         6.9270e-05, 8.7239e-05, 1.6916e-04, 4.8341e-04]], device='cuda:0')
answers_probs: tensor([[7.1977e-04, 4.3918e-04, 3.8843e-05],
        [2.0978e-04, 1.3377e-04, 3.5962e-06],
        [5.2113e-04, 2.9939e-04, 5.8981e-05],
        [1.6810e-03, 1.2563e-03, 8.0899e-05],
        [2.0570e-03, 1.0309e-03, 4.8874e-05],
        [1.0974e-04, 1.2372e-04, 1.2189e-05],
        [2.0790e-08, 4.2892e-08, 4.0003e-09],
        [7.6116e-05, 1.2251e-04, 8.9865e-06],
        [4.7534e-04, 5.2585e-04, 5.8099e-05],
        [6.4672e-04, 2.4459e-04, 4.3782e-05],
        [3.4028e-04, 1.6093e-03, 3.7822e-05],
        [2.3770e-03, 2.8134e-03, 2.5996e-04],
        [2.0761e-04, 3.2037e-04, 6.9270e-05],
        [1.1138e-03, 6.4027e-04, 8.7239e-05],
        [2.7213e-03, 7.4245e-04, 1.6916e-04],
        [4.0465e-03, 5.0876e-03, 4.8341e-04]], device='cuda:0')
acc:  0.3958333333333333
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 0 and batchsize 16: 0:02:45.575579
path ['42', 'de', 'flan', 'NLI', 'rare_synonyms', 'prompt_id_0']
----------- 42 de google/flan-t5-base NLI rare_synonyms 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 364.88it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.6766e-04],
        [3.2820e-04],
        [6.9463e-04],
        [7.6216e-04],
        [4.9928e-04],
        [4.1749e-04],
        [9.1316e-04],
        [7.4368e-04],
        [1.0184e-03],
        [4.0674e-05],
        [2.2348e-03],
        [6.0310e-04],
        [1.4115e-04],
        [1.0380e-03],
        [6.2362e-05],
        [7.0336e-08]], device='cuda:0') / tensor([[4.6766e-04, 3.2820e-04, 6.9463e-04, 7.6216e-04, 4.9928e-04, 4.1749e-04,
         9.1316e-04, 7.4368e-04, 1.0184e-03, 4.0674e-05, 2.2348e-03, 6.0310e-04,
         1.4115e-04, 1.0380e-03, 6.2362e-05, 7.0336e-08]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.6861e-03],
        [8.5698e-04],
        [7.5835e-04],
        [1.5958e-03],
        [1.0546e-03],
        [7.1509e-04],
        [1.8287e-03],
        [2.0216e-03],
        [1.9718e-03],
        [3.0802e-04],
        [2.0989e-03],
        [6.5971e-04],
        [2.5974e-04],
        [1.3779e-03],
        [1.4229e-04],
        [1.2765e-07]], device='cuda:0') / tensor([[1.6861e-03, 8.5698e-04, 7.5835e-04, 1.5958e-03, 1.0546e-03, 7.1509e-04,
         1.8287e-03, 2.0216e-03, 1.9718e-03, 3.0802e-04, 2.0989e-03, 6.5971e-04,
         2.5974e-04, 1.3779e-03, 1.4229e-04, 1.2765e-07]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[1.9317e-04],
        [3.2642e-05],
        [7.3340e-05],
        [2.0567e-05],
        [5.0178e-05],
        [2.2158e-05],
        [7.3335e-05],
        [5.2238e-05],
        [4.5168e-05],
        [3.5792e-06],
        [1.1789e-04],
        [4.2628e-05],
        [1.9856e-05],
        [1.1233e-04],
        [3.0451e-06],
        [3.9505e-09]], device='cuda:0') / tensor([[1.9317e-04, 3.2642e-05, 7.3340e-05, 2.0567e-05, 5.0178e-05, 2.2158e-05,
         7.3335e-05, 5.2238e-05, 4.5168e-05, 3.5792e-06, 1.1789e-04, 4.2628e-05,
         1.9856e-05, 1.1233e-04, 3.0451e-06, 3.9505e-09]], device='cuda:0')
answers_probs: tensor([[4.6766e-04, 1.6861e-03, 1.9317e-04],
        [3.2820e-04, 8.5698e-04, 3.2642e-05],
        [6.9463e-04, 7.5835e-04, 7.3340e-05],
        [7.6216e-04, 1.5958e-03, 2.0567e-05],
        [4.9928e-04, 1.0546e-03, 5.0178e-05],
        [4.1749e-04, 7.1509e-04, 2.2158e-05],
        [9.1316e-04, 1.8287e-03, 7.3335e-05],
        [7.4368e-04, 2.0216e-03, 5.2238e-05],
        [1.0184e-03, 1.9718e-03, 4.5168e-05],
        [4.0674e-05, 3.0802e-04, 3.5792e-06],
        [2.2348e-03, 2.0989e-03, 1.1789e-04],
        [6.0310e-04, 6.5971e-04, 4.2628e-05],
        [1.4115e-04, 2.5974e-04, 1.9856e-05],
        [1.0380e-03, 1.3779e-03, 1.1233e-04],
        [6.2362e-05, 1.4229e-04, 3.0451e-06],
        [7.0336e-08, 1.2765e-07, 3.9505e-09]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.7208e-03],
        [1.6637e-04],
        [7.2017e-04],
        [3.5809e-04],
        [6.9030e-04],
        [2.1262e-08],
        [1.0078e-03],
        [2.5042e-04],
        [1.1069e-03],
        [2.6680e-04],
        [2.5986e-03],
        [8.1139e-05],
        [2.5765e-04],
        [7.6769e-04],
        [1.3461e-03],
        [6.4520e-04]], device='cuda:0') / tensor([[2.7208e-03, 1.6637e-04, 7.2017e-04, 3.5809e-04, 6.9030e-04, 2.1262e-08,
         1.0078e-03, 2.5042e-04, 1.1069e-03, 2.6680e-04, 2.5986e-03, 8.1139e-05,
         2.5765e-04, 7.6769e-04, 1.3461e-03, 6.4520e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[4.1269e-03],
        [1.8286e-04],
        [2.7704e-04],
        [4.9774e-04],
        [2.2297e-03],
        [3.9250e-08],
        [3.0204e-03],
        [2.3326e-04],
        [1.2682e-03],
        [1.3906e-03],
        [8.0667e-04],
        [1.1135e-03],
        [9.3189e-04],
        [6.6952e-04],
        [9.2383e-04],
        [1.6480e-03]], device='cuda:0') / tensor([[4.1269e-03, 1.8286e-04, 2.7704e-04, 4.9774e-04, 2.2297e-03, 3.9250e-08,
         3.0204e-03, 2.3326e-04, 1.2682e-03, 1.3906e-03, 8.0667e-04, 1.1135e-03,
         9.3189e-04, 6.6952e-04, 9.2383e-04, 1.6480e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[2.0642e-04],
        [8.1790e-06],
        [3.6722e-05],
        [2.1443e-05],
        [1.7806e-04],
        [2.8221e-09],
        [6.8757e-05],
        [4.3976e-06],
        [6.8315e-05],
        [2.1726e-05],
        [1.6950e-04],
        [2.2598e-05],
        [1.7189e-05],
        [1.5469e-04],
        [2.5865e-05],
        [6.5274e-05]], device='cuda:0') / tensor([[2.0642e-04, 8.1790e-06, 3.6722e-05, 2.1443e-05, 1.7806e-04, 2.8221e-09,
         6.8757e-05, 4.3976e-06, 6.8315e-05, 2.1726e-05, 1.6950e-04, 2.2598e-05,
         1.7189e-05, 1.5469e-04, 2.5865e-05, 6.5274e-05]], device='cuda:0')
answers_probs: tensor([[2.7208e-03, 4.1269e-03, 2.0642e-04],
        [1.6637e-04, 1.8286e-04, 8.1790e-06],
        [7.2017e-04, 2.7704e-04, 3.6722e-05],
        [3.5809e-04, 4.9774e-04, 2.1443e-05],
        [6.9030e-04, 2.2297e-03, 1.7806e-04],
        [2.1262e-08, 3.9250e-08, 2.8221e-09],
        [1.0078e-03, 3.0204e-03, 6.8757e-05],
        [2.5042e-04, 2.3326e-04, 4.3976e-06],
        [1.1069e-03, 1.2682e-03, 6.8315e-05],
        [2.6680e-04, 1.3906e-03, 2.1726e-05],
        [2.5986e-03, 8.0667e-04, 1.6950e-04],
        [8.1139e-05, 1.1135e-03, 2.2598e-05],
        [2.5765e-04, 9.3189e-04, 1.7189e-05],
        [7.6769e-04, 6.6952e-04, 1.5469e-04],
        [1.3461e-03, 9.2383e-04, 2.5865e-05],
        [6.4520e-04, 1.6480e-03, 6.5274e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[8.6485e-04],
        [1.3443e-03],
        [2.6107e-04],
        [9.7544e-04],
        [1.5733e-03],
        [2.1217e-03],
        [2.3683e-03],
        [8.9083e-04],
        [9.3673e-04],
        [1.8816e-03],
        [1.1094e-03],
        [2.2291e-04],
        [1.7680e-07],
        [3.1732e-04],
        [1.4231e-04],
        [2.0660e-03]], device='cuda:0') / tensor([[8.6485e-04, 1.3443e-03, 2.6107e-04, 9.7544e-04, 1.5733e-03, 2.1217e-03,
         2.3683e-03, 8.9083e-04, 9.3673e-04, 1.8816e-03, 1.1094e-03, 2.2291e-04,
         1.7680e-07, 3.1732e-04, 1.4231e-04, 2.0660e-03]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.9194e-04],
        [3.2290e-03],
        [2.0638e-04],
        [7.3650e-04],
        [1.2987e-03],
        [6.5633e-04],
        [1.6314e-03],
        [6.8761e-04],
        [2.2956e-03],
        [1.9167e-03],
        [8.0626e-04],
        [4.1348e-03],
        [3.8157e-07],
        [2.2464e-04],
        [1.9978e-04],
        [2.3540e-03]], device='cuda:0') / tensor([[9.9194e-04, 3.2290e-03, 2.0638e-04, 7.3650e-04, 1.2987e-03, 6.5633e-04,
         1.6314e-03, 6.8761e-04, 2.2956e-03, 1.9167e-03, 8.0626e-04, 4.1348e-03,
         3.8157e-07, 2.2464e-04, 1.9978e-04, 2.3540e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [10330] -> tensor([[4.3547e-05],
        [3.0027e-04],
        [1.7217e-06],
        [5.1801e-05],
        [5.8200e-05],
        [9.0692e-05],
        [1.2545e-04],
        [4.3059e-05],
        [1.0538e-04],
        [5.5532e-05],
        [3.0436e-05],
        [2.7848e-05],
        [8.3454e-09],
        [1.0043e-05],
        [5.9304e-06],
        [1.5581e-04]], device='cuda:0') / tensor([[4.3547e-05, 3.0027e-04, 1.7217e-06, 5.1801e-05, 5.8200e-05, 9.0692e-05,
         1.2545e-04, 4.3059e-05, 1.0538e-04, 5.5532e-05, 3.0436e-05, 2.7848e-05,
         8.3454e-09, 1.0043e-05, 5.9304e-06, 1.5581e-04]], device='cuda:0')
answers_probs: tensor([[8.6485e-04, 9.9194e-04, 4.3547e-05],
        [1.3443e-03, 3.2290e-03, 3.0027e-04],
        [2.6107e-04, 2.0638e-04, 1.7217e-06],
        [9.7544e-04, 7.3650e-04, 5.1801e-05],
        [1.5733e-03, 1.2987e-03, 5.8200e-05],
        [2.1217e-03, 6.5633e-04, 9.0692e-05],
        [2.3683e-03, 1.6314e-03, 1.2545e-04],
        [8.9083e-04, 6.8761e-04, 4.3059e-05],
        [9.3673e-04, 2.2956e-03, 1.0538e-04],
        [1.8816e-03, 1.9167e-03, 5.5532e-05],
        [1.1094e-03, 8.0626e-04, 3.0436e-05],
        [2.2291e-04, 4.1348e-03, 2.7848e-05],
        [1.7680e-07, 3.8157e-07, 8.3454e-09],
        [3.1732e-04, 2.2464e-04, 1.0043e-05],
        [1.4231e-04, 1.9978e-04, 5.9304e-06],
        [2.0660e-03, 2.3540e-03, 1.5581e-04]], device='cuda:0')
acc:  0.3541666666666667
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 1 and batchsize 16: 0:02:45.544981
path ['42', 'de', 'flan', 'NLI', 'rare_synonyms', 'prompt_id_1']
----------- 42 de google/flan-t5-base NLI rare_synonyms 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 320.94it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[2.3460e-03],
        [7.4922e-04],
        [7.5539e-04],
        [1.4767e-03],
        [1.1199e-03],
        [1.2329e-03],
        [1.8152e-04],
        [4.6756e-04],
        [1.2386e-04],
        [6.0038e-04],
        [1.8395e-07],
        [1.0701e-03],
        [1.8680e-03],
        [1.4666e-03],
        [9.6265e-04],
        [4.5558e-04]], device='cuda:0') / tensor([[2.3460e-03, 7.4922e-04, 7.5539e-04, 1.4767e-03, 1.1199e-03, 1.2329e-03,
         1.8152e-04, 4.6756e-04, 1.2386e-04, 6.0038e-04, 1.8395e-07, 1.0701e-03,
         1.8680e-03, 1.4666e-03, 9.6265e-04, 4.5558e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[8.9282e-04],
        [9.4252e-04],
        [1.5131e-03],
        [2.7645e-03],
        [1.4867e-03],
        [1.0227e-03],
        [3.8480e-04],
        [6.1193e-04],
        [2.0615e-03],
        [7.3278e-04],
        [4.7125e-07],
        [4.0431e-03],
        [1.3402e-03],
        [2.9024e-03],
        [3.6383e-03],
        [2.4411e-04]], device='cuda:0') / tensor([[8.9282e-04, 9.4252e-04, 1.5131e-03, 2.7645e-03, 1.4867e-03, 1.0227e-03,
         3.8480e-04, 6.1193e-04, 2.0615e-03, 7.3278e-04, 4.7125e-07, 4.0431e-03,
         1.3402e-03, 2.9024e-03, 3.6383e-03, 2.4411e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[3.3561e-04],
        [1.4318e-04],
        [8.4572e-05],
        [1.4954e-04],
        [7.8484e-05],
        [7.9099e-05],
        [1.9088e-05],
        [8.6061e-06],
        [5.4045e-05],
        [1.0926e-04],
        [3.4890e-08],
        [4.8605e-04],
        [1.3328e-04],
        [3.2882e-04],
        [2.6685e-04],
        [6.1350e-05]], device='cuda:0') / tensor([[3.3561e-04, 1.4318e-04, 8.4572e-05, 1.4954e-04, 7.8484e-05, 7.9099e-05,
         1.9088e-05, 8.6061e-06, 5.4045e-05, 1.0926e-04, 3.4890e-08, 4.8605e-04,
         1.3328e-04, 3.2882e-04, 2.6685e-04, 6.1350e-05]], device='cuda:0')
answers_probs: tensor([[2.3460e-03, 8.9282e-04, 3.3561e-04],
        [7.4922e-04, 9.4252e-04, 1.4318e-04],
        [7.5539e-04, 1.5131e-03, 8.4572e-05],
        [1.4767e-03, 2.7645e-03, 1.4954e-04],
        [1.1199e-03, 1.4867e-03, 7.8484e-05],
        [1.2329e-03, 1.0227e-03, 7.9099e-05],
        [1.8152e-04, 3.8480e-04, 1.9088e-05],
        [4.6756e-04, 6.1193e-04, 8.6061e-06],
        [1.2386e-04, 2.0615e-03, 5.4045e-05],
        [6.0038e-04, 7.3278e-04, 1.0926e-04],
        [1.8395e-07, 4.7125e-07, 3.4890e-08],
        [1.0701e-03, 4.0431e-03, 4.8605e-04],
        [1.8680e-03, 1.3402e-03, 1.3328e-04],
        [1.4666e-03, 2.9024e-03, 3.2882e-04],
        [9.6265e-04, 3.6383e-03, 2.6685e-04],
        [4.5558e-04, 2.4411e-04, 6.1350e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.0386e-03],
        [1.0844e-03],
        [8.2579e-04],
        [1.1333e-04],
        [7.8416e-08],
        [8.3299e-04],
        [4.0589e-04],
        [1.4514e-03],
        [2.3767e-03],
        [2.3798e-04],
        [4.1845e-03],
        [5.1513e-04],
        [3.0528e-03],
        [7.9016e-04],
        [4.5021e-04],
        [5.6346e-05]], device='cuda:0') / tensor([[4.0386e-03, 1.0844e-03, 8.2579e-04, 1.1333e-04, 7.8416e-08, 8.3299e-04,
         4.0589e-04, 1.4514e-03, 2.3767e-03, 2.3798e-04, 4.1845e-03, 5.1513e-04,
         3.0528e-03, 7.9016e-04, 4.5021e-04, 5.6346e-05]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.6650e-03],
        [2.7767e-03],
        [9.5559e-04],
        [5.3963e-04],
        [1.6331e-07],
        [2.7277e-03],
        [3.6042e-03],
        [2.5756e-03],
        [2.7219e-03],
        [6.7253e-04],
        [6.7166e-03],
        [1.8878e-03],
        [4.1923e-03],
        [1.8639e-03],
        [2.6452e-03],
        [7.2827e-04]], device='cuda:0') / tensor([[3.6650e-03, 2.7767e-03, 9.5559e-04, 5.3963e-04, 1.6331e-07, 2.7277e-03,
         3.6042e-03, 2.5756e-03, 2.7219e-03, 6.7253e-04, 6.7166e-03, 1.8878e-03,
         4.1923e-03, 1.8639e-03, 2.6452e-03, 7.2827e-04]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
id: [10330] -> tensor([[4.6221e-04],
        [1.0899e-04],
        [1.0694e-04],
        [2.0614e-05],
        [7.7630e-09],
        [2.7335e-04],
        [5.8575e-05],
        [4.0372e-04],
        [2.8182e-04],
        [6.5204e-05],
        [4.9239e-04],
        [2.5873e-04],
        [2.6480e-04],
        [1.0941e-04],
        [8.3495e-05],
        [1.0693e-05]], device='cuda:0') / tensor([[4.6221e-04, 1.0899e-04, 1.0694e-04, 2.0614e-05, 7.7630e-09, 2.7335e-04,
         5.8575e-05, 4.0372e-04, 2.8182e-04, 6.5204e-05, 4.9239e-04, 2.5873e-04,
         2.6480e-04, 1.0941e-04, 8.3495e-05, 1.0693e-05]], device='cuda:0')
answers_probs: tensor([[4.0386e-03, 3.6650e-03, 4.6221e-04],
        [1.0844e-03, 2.7767e-03, 1.0899e-04],
        [8.2579e-04, 9.5559e-04, 1.0694e-04],
        [1.1333e-04, 5.3963e-04, 2.0614e-05],
        [7.8416e-08, 1.6331e-07, 7.7630e-09],
        [8.3299e-04, 2.7277e-03, 2.7335e-04],
        [4.0589e-04, 3.6042e-03, 5.8575e-05],
        [1.4514e-03, 2.5756e-03, 4.0372e-04],
        [2.3767e-03, 2.7219e-03, 2.8182e-04],
        [2.3798e-04, 6.7253e-04, 6.5204e-05],
        [4.1845e-03, 6.7166e-03, 4.9239e-04],
        [5.1513e-04, 1.8878e-03, 2.5873e-04],
        [3.0528e-03, 4.1923e-03, 2.6480e-04],
        [7.9016e-04, 1.8639e-03, 1.0941e-04],
        [4.5021e-04, 2.6452e-03, 8.3495e-05],
        [5.6346e-05, 7.2827e-04, 1.0693e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[7.2539e-04],
        [1.6060e-03],
        [3.3016e-04],
        [6.5805e-08],
        [3.7113e-04],
        [2.1775e-04],
        [3.9849e-04],
        [5.6453e-04],
        [6.3766e-04],
        [9.2065e-04],
        [5.9723e-04],
        [3.7383e-04],
        [3.4987e-04],
        [7.3578e-04],
        [1.7915e-03],
        [1.2258e-04]], device='cuda:0') / tensor([[7.2539e-04, 1.6060e-03, 3.3016e-04, 6.5805e-08, 3.7113e-04, 2.1775e-04,
         3.9849e-04, 5.6453e-04, 6.3766e-04, 9.2065e-04, 5.9723e-04, 3.7383e-04,
         3.4987e-04, 7.3578e-04, 1.7915e-03, 1.2258e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.9862e-03],
        [4.1808e-03],
        [2.0109e-03],
        [1.2978e-07],
        [1.9476e-03],
        [8.2828e-04],
        [1.7049e-03],
        [2.5189e-03],
        [3.8523e-03],
        [7.8288e-03],
        [3.8268e-03],
        [8.0233e-04],
        [2.4181e-04],
        [2.0496e-03],
        [2.8622e-03],
        [7.3510e-03]], device='cuda:0') / tensor([[3.9862e-03, 4.1808e-03, 2.0109e-03, 1.2978e-07, 1.9476e-03, 8.2828e-04,
         1.7049e-03, 2.5189e-03, 3.8523e-03, 7.8288e-03, 3.8268e-03, 8.0233e-04,
         2.4181e-04, 2.0496e-03, 2.8622e-03, 7.3510e-03]], device='cuda:0')
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
probs_ shape torch.Size([16, 1])
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
id: [10330] -> tensor([[1.3145e-04],
        [2.8036e-04],
        [1.5499e-04],
        [7.6501e-09],
        [9.4319e-05],
        [3.6161e-05],
        [2.2010e-05],
        [2.0933e-04],
        [1.3995e-04],
        [1.5460e-04],
        [5.0898e-05],
        [2.1759e-04],
        [1.5240e-04],
        [1.1139e-04],
        [6.8311e-05],
        [3.4436e-05]], device='cuda:0') / tensor([[1.3145e-04, 2.8036e-04, 1.5499e-04, 7.6501e-09, 9.4319e-05, 3.6161e-05,
         2.2010e-05, 2.0933e-04, 1.3995e-04, 1.5460e-04, 5.0898e-05, 2.1759e-04,
         1.5240e-04, 1.1139e-04, 6.8311e-05, 3.4436e-05]], device='cuda:0')
answers_probs: tensor([[7.2539e-04, 3.9862e-03, 1.3145e-04],
        [1.6060e-03, 4.1808e-03, 2.8036e-04],
        [3.3016e-04, 2.0109e-03, 1.5499e-04],
        [6.5805e-08, 1.2978e-07, 7.6501e-09],
        [3.7113e-04, 1.9476e-03, 9.4319e-05],
        [2.1775e-04, 8.2828e-04, 3.6161e-05],
        [3.9849e-04, 1.7049e-03, 2.2010e-05],
        [5.6453e-04, 2.5189e-03, 2.0933e-04],
        [6.3766e-04, 3.8523e-03, 1.3995e-04],
        [9.2065e-04, 7.8288e-03, 1.5460e-04],
        [5.9723e-04, 3.8268e-03, 5.0898e-05],
        [3.7383e-04, 8.0233e-04, 2.1759e-04],
        [3.4987e-04, 2.4181e-04, 1.5240e-04],
        [7.3578e-04, 2.0496e-03, 1.1139e-04],
        [1.7915e-03, 2.8622e-03, 6.8311e-05],
        [1.2258e-04, 7.3510e-03, 3.4436e-05]], device='cuda:0')
acc:  0.3333333333333333
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 2 and batchsize 16: 0:02:46.113120
path ['42', 'de', 'flan', 'NLI', 'rare_synonyms', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base SA active 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  8.18it/s]100%|██████████| 3/3 [00:00<00:00, 22.93it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0010],
        [0.0013],
        [0.0006],
        [0.0008],
        [0.0016],
        [0.0010],
        [0.0005],
        [0.0009],
        [0.0015],
        [0.0005],
        [0.0003],
        [0.0006],
        [0.0001],
        [0.0013],
        [0.0007],
        [0.0010]], device='cuda:0') / tensor([[0.0010, 0.0013, 0.0006, 0.0008, 0.0016, 0.0010, 0.0005, 0.0009, 0.0015,
         0.0005, 0.0003, 0.0006, 0.0001, 0.0013, 0.0007, 0.0010]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0076],
        [0.0814],
        [0.0020],
        [0.0006],
        [0.0659],
        [0.0004],
        [0.0143],
        [0.0030],
        [0.0103],
        [0.0256],
        [0.0008],
        [0.2350],
        [0.0026],
        [0.0017],
        [0.0593],
        [0.0309]], device='cuda:0') / tensor([[0.0076, 0.0814, 0.0020, 0.0006, 0.0659, 0.0004, 0.0143, 0.0030, 0.0103,
         0.0256, 0.0008, 0.2350, 0.0026, 0.0017, 0.0593, 0.0309]],
       device='cuda:0')
answers_probs: tensor([[1.0069e-03, 7.6385e-03],
        [1.2729e-03, 8.1403e-02],
        [6.3998e-04, 1.9547e-03],
        [8.0861e-04, 5.8286e-04],
        [1.5853e-03, 6.5850e-02],
        [9.5873e-04, 3.6985e-04],
        [4.8934e-04, 1.4299e-02],
        [9.0511e-04, 2.9639e-03],
        [1.4854e-03, 1.0334e-02],
        [5.1254e-04, 2.5573e-02],
        [3.4483e-04, 8.0013e-04],
        [5.8884e-04, 2.3498e-01],
        [1.3996e-04, 2.6202e-03],
        [1.3008e-03, 1.7248e-03],
        [7.0378e-04, 5.9313e-02],
        [1.0204e-03, 3.0856e-02]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0014],
        [0.0013],
        [0.0006],
        [0.0007],
        [0.0003],
        [0.0006],
        [0.0012],
        [0.0004],
        [0.0003],
        [0.0007],
        [0.0017],
        [0.0004],
        [0.0001],
        [0.0007],
        [0.0006],
        [0.0015]], device='cuda:0') / tensor([[0.0014, 0.0013, 0.0006, 0.0007, 0.0003, 0.0006, 0.0012, 0.0004, 0.0003,
         0.0007, 0.0017, 0.0004, 0.0001, 0.0007, 0.0006, 0.0015]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.4619e-02],
        [1.2561e-02],
        [2.1047e-02],
        [1.2886e-03],
        [1.1420e-02],
        [2.3695e-02],
        [1.4890e-02],
        [1.8499e-02],
        [9.9661e-05],
        [7.2880e-04],
        [2.4712e-02],
        [3.2904e-04],
        [3.3015e-04],
        [7.7385e-03],
        [4.8726e-02],
        [1.1070e-03]], device='cuda:0') / tensor([[5.4619e-02, 1.2561e-02, 2.1047e-02, 1.2886e-03, 1.1420e-02, 2.3695e-02,
         1.4890e-02, 1.8499e-02, 9.9661e-05, 7.2880e-04, 2.4712e-02, 3.2904e-04,
         3.3015e-04, 7.7385e-03, 4.8726e-02, 1.1070e-03]], device='cuda:0')
answers_probs: tensor([[1.3986e-03, 5.4619e-02],
        [1.3032e-03, 1.2561e-02],
        [6.1852e-04, 2.1047e-02],
        [6.6034e-04, 1.2886e-03],
        [2.7473e-04, 1.1420e-02],
        [6.2009e-04, 2.3695e-02],
        [1.1636e-03, 1.4890e-02],
        [4.2844e-04, 1.8499e-02],
        [3.0865e-04, 9.9661e-05],
        [7.3019e-04, 7.2880e-04],
        [1.7317e-03, 2.4712e-02],
        [4.3105e-04, 3.2904e-04],
        [1.2311e-04, 3.3015e-04],
        [6.5635e-04, 7.7385e-03],
        [5.5805e-04, 4.8726e-02],
        [1.4689e-03, 1.1070e-03]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0004],
        [0.0017],
        [0.0003],
        [0.0007],
        [0.0008],
        [0.0014],
        [0.0006],
        [0.0009],
        [0.0027],
        [0.0010],
        [0.0003],
        [0.0014],
        [0.0004],
        [0.0005],
        [0.0005],
        [0.0010]], device='cuda:0') / tensor([[0.0004, 0.0017, 0.0003, 0.0007, 0.0008, 0.0014, 0.0006, 0.0009, 0.0027,
         0.0010, 0.0003, 0.0014, 0.0004, 0.0005, 0.0005, 0.0010]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0018],
        [0.0553],
        [0.0255],
        [0.0021],
        [0.0060],
        [0.0772],
        [0.1352],
        [0.0012],
        [0.0245],
        [0.0190],
        [0.0532],
        [0.0492],
        [0.0002],
        [0.0204],
        [0.1000],
        [0.0010]], device='cuda:0') / tensor([[0.0018, 0.0553, 0.0255, 0.0021, 0.0060, 0.0772, 0.1352, 0.0012, 0.0245,
         0.0190, 0.0532, 0.0492, 0.0002, 0.0204, 0.1000, 0.0010]],
       device='cuda:0')
answers_probs: tensor([[0.0004, 0.0018],
        [0.0017, 0.0553],
        [0.0003, 0.0255],
        [0.0007, 0.0021],
        [0.0008, 0.0060],
        [0.0014, 0.0772],
        [0.0006, 0.1352],
        [0.0009, 0.0012],
        [0.0027, 0.0245],
        [0.0010, 0.0190],
        [0.0003, 0.0532],
        [0.0014, 0.0492],
        [0.0004, 0.0002],
        [0.0005, 0.0204],
        [0.0005, 0.1000],
        [0.0010, 0.0010]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0007],
        [0.0002]], device='cuda:0') / tensor([[0.0007, 0.0002]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.0086],
        [0.0778]], device='cuda:0') / tensor([[0.0086, 0.0778]], device='cuda:0')
answers_probs: tensor([[0.0007, 0.0086],
        [0.0002, 0.0778]], device='cuda:0')
acc:  0.66
Time taken to execute the de SA task with prompt type active, variation 0 and batchsize 16: 0:03:07.966812
path ['42', 'de', 'flan', 'SA', 'active', 'prompt_id_0']
----------- 42 de google/flan-t5-base SA active 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 318.63it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[7.6076e-04],
        [1.8712e-03],
        [3.8139e-04],
        [3.9985e-05],
        [4.6829e-04],
        [1.0019e-03],
        [8.6180e-04],
        [1.3615e-03],
        [7.0630e-04],
        [1.0290e-03],
        [8.1017e-04],
        [6.8614e-04],
        [3.4192e-04],
        [8.3746e-04],
        [5.8596e-04],
        [6.7471e-04]], device='cuda:0') / tensor([[7.6076e-04, 1.8712e-03, 3.8139e-04, 3.9985e-05, 4.6829e-04, 1.0019e-03,
         8.6180e-04, 1.3615e-03, 7.0630e-04, 1.0290e-03, 8.1017e-04, 6.8614e-04,
         3.4192e-04, 8.3746e-04, 5.8596e-04, 6.7471e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.3789e-03],
        [5.7906e-02],
        [7.8026e-04],
        [1.1053e-05],
        [1.3984e-03],
        [1.3115e-03],
        [7.5905e-04],
        [2.5560e-01],
        [2.1591e-01],
        [6.0646e-04],
        [5.5168e-02],
        [2.8696e-02],
        [2.5697e-02],
        [5.3566e-04],
        [1.7381e-03],
        [8.3750e-04]], device='cuda:0') / tensor([[3.3789e-03, 5.7906e-02, 7.8026e-04, 1.1053e-05, 1.3984e-03, 1.3115e-03,
         7.5905e-04, 2.5560e-01, 2.1591e-01, 6.0646e-04, 5.5168e-02, 2.8696e-02,
         2.5697e-02, 5.3566e-04, 1.7381e-03, 8.3750e-04]], device='cuda:0')
answers_probs: tensor([[7.6076e-04, 3.3789e-03],
        [1.8712e-03, 5.7906e-02],
        [3.8139e-04, 7.8026e-04],
        [3.9985e-05, 1.1053e-05],
        [4.6829e-04, 1.3984e-03],
        [1.0019e-03, 1.3115e-03],
        [8.6180e-04, 7.5905e-04],
        [1.3615e-03, 2.5560e-01],
        [7.0630e-04, 2.1591e-01],
        [1.0290e-03, 6.0646e-04],
        [8.1017e-04, 5.5168e-02],
        [6.8614e-04, 2.8696e-02],
        [3.4192e-04, 2.5697e-02],
        [8.3746e-04, 5.3566e-04],
        [5.8596e-04, 1.7381e-03],
        [6.7471e-04, 8.3750e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0003],
        [0.0007],
        [0.0006],
        [0.0003],
        [0.0026],
        [0.0033],
        [0.0011],
        [0.0018],
        [0.0015],
        [0.0006],
        [0.0006],
        [0.0003],
        [0.0010],
        [0.0014],
        [0.0003],
        [0.0002]], device='cuda:0') / tensor([[0.0003, 0.0007, 0.0006, 0.0003, 0.0026, 0.0033, 0.0011, 0.0018, 0.0015,
         0.0006, 0.0006, 0.0003, 0.0010, 0.0014, 0.0003, 0.0002]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.7088e-05],
        [7.4613e-02],
        [1.4125e-02],
        [8.6324e-05],
        [1.3790e-01],
        [5.8955e-02],
        [3.8145e-02],
        [4.0667e-02],
        [3.1557e-02],
        [7.1623e-05],
        [4.2073e-04],
        [3.2689e-03],
        [1.0118e-02],
        [8.6725e-03],
        [8.4028e-05],
        [1.6705e-04]], device='cuda:0') / tensor([[2.7088e-05, 7.4613e-02, 1.4125e-02, 8.6324e-05, 1.3790e-01, 5.8955e-02,
         3.8145e-02, 4.0667e-02, 3.1557e-02, 7.1623e-05, 4.2073e-04, 3.2689e-03,
         1.0118e-02, 8.6725e-03, 8.4028e-05, 1.6705e-04]], device='cuda:0')
answers_probs: tensor([[2.6935e-04, 2.7088e-05],
        [7.2274e-04, 7.4613e-02],
        [5.6713e-04, 1.4125e-02],
        [2.8412e-04, 8.6324e-05],
        [2.5536e-03, 1.3790e-01],
        [3.3388e-03, 5.8955e-02],
        [1.0719e-03, 3.8145e-02],
        [1.7718e-03, 4.0667e-02],
        [1.4666e-03, 3.1557e-02],
        [6.4739e-04, 7.1623e-05],
        [6.0889e-04, 4.2073e-04],
        [2.9875e-04, 3.2689e-03],
        [1.0466e-03, 1.0118e-02],
        [1.3557e-03, 8.6725e-03],
        [2.7754e-04, 8.4028e-05],
        [2.1991e-04, 1.6705e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[4.6509e-04],
        [8.8160e-05],
        [1.1293e-03],
        [1.2169e-03],
        [8.0230e-04],
        [4.4044e-03],
        [6.8649e-04],
        [1.4303e-03],
        [1.6536e-03],
        [1.3162e-03],
        [6.5143e-04],
        [4.8331e-04],
        [1.0884e-03],
        [2.9613e-04],
        [1.7674e-03],
        [6.7447e-04]], device='cuda:0') / tensor([[4.6509e-04, 8.8160e-05, 1.1293e-03, 1.2169e-03, 8.0230e-04, 4.4044e-03,
         6.8649e-04, 1.4303e-03, 1.6536e-03, 1.3162e-03, 6.5143e-04, 4.8331e-04,
         1.0884e-03, 2.9613e-04, 1.7674e-03, 6.7447e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.0858e-01],
        [1.1383e-04],
        [9.3583e-04],
        [2.0688e-01],
        [5.1185e-02],
        [1.6168e-01],
        [4.7962e-02],
        [1.4206e-02],
        [1.1874e-01],
        [5.9593e-02],
        [2.7158e-03],
        [3.4425e-02],
        [7.3968e-04],
        [9.2524e-04],
        [5.8610e-03],
        [8.4780e-05]], device='cuda:0') / tensor([[1.0858e-01, 1.1383e-04, 9.3583e-04, 2.0688e-01, 5.1185e-02, 1.6168e-01,
         4.7962e-02, 1.4206e-02, 1.1874e-01, 5.9593e-02, 2.7158e-03, 3.4425e-02,
         7.3968e-04, 9.2524e-04, 5.8610e-03, 8.4780e-05]], device='cuda:0')
answers_probs: tensor([[4.6509e-04, 1.0858e-01],
        [8.8160e-05, 1.1383e-04],
        [1.1293e-03, 9.3583e-04],
        [1.2169e-03, 2.0688e-01],
        [8.0230e-04, 5.1185e-02],
        [4.4044e-03, 1.6168e-01],
        [6.8649e-04, 4.7962e-02],
        [1.4303e-03, 1.4206e-02],
        [1.6536e-03, 1.1874e-01],
        [1.3162e-03, 5.9593e-02],
        [6.5143e-04, 2.7158e-03],
        [4.8331e-04, 3.4425e-02],
        [1.0884e-03, 7.3968e-04],
        [2.9613e-04, 9.2524e-04],
        [1.7674e-03, 5.8610e-03],
        [6.7447e-04, 8.4780e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[1.2473e-04],
        [6.3758e-07]], device='cuda:0') / tensor([[1.2473e-04, 6.3758e-07]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[9.5621e-04],
        [4.2749e-06]], device='cuda:0') / tensor([[9.5621e-04, 4.2749e-06]], device='cuda:0')
answers_probs: tensor([[1.2473e-04, 9.5621e-04],
        [6.3758e-07, 4.2749e-06]], device='cuda:0')
acc:  0.72
Time taken to execute the de SA task with prompt type active, variation 1 and batchsize 16: 0:03:08.178174
path ['42', 'de', 'flan', 'SA', 'active', 'prompt_id_1']
----------- 42 de google/flan-t5-base SA active 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 371.68it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[1.1899e-03],
        [7.7995e-04],
        [8.0863e-04],
        [4.2156e-04],
        [4.7193e-05],
        [6.6258e-04],
        [1.3417e-03],
        [2.5080e-04],
        [4.9510e-04],
        [1.0010e-04],
        [2.9087e-04],
        [7.9527e-04],
        [9.2220e-04],
        [2.7612e-04],
        [8.2018e-04],
        [8.9018e-04]], device='cuda:0') / tensor([[1.1899e-03, 7.7995e-04, 8.0863e-04, 4.2156e-04, 4.7193e-05, 6.6258e-04,
         1.3417e-03, 2.5080e-04, 4.9510e-04, 1.0010e-04, 2.9087e-04, 7.9527e-04,
         9.2220e-04, 2.7612e-04, 8.2018e-04, 8.9018e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.4037e-03],
        [7.5358e-04],
        [1.3302e-03],
        [2.4645e-05],
        [2.6786e-03],
        [1.8248e-02],
        [1.4655e-04],
        [2.5419e-05],
        [1.0880e-04],
        [6.7092e-03],
        [1.0174e-03],
        [1.3243e-04],
        [3.2898e-03],
        [1.0305e-02],
        [2.8893e-04],
        [5.9799e-05]], device='cuda:0') / tensor([[2.4037e-03, 7.5358e-04, 1.3302e-03, 2.4645e-05, 2.6786e-03, 1.8248e-02,
         1.4655e-04, 2.5419e-05, 1.0880e-04, 6.7092e-03, 1.0174e-03, 1.3243e-04,
         3.2898e-03, 1.0305e-02, 2.8893e-04, 5.9799e-05]], device='cuda:0')
answers_probs: tensor([[1.1899e-03, 2.4037e-03],
        [7.7995e-04, 7.5358e-04],
        [8.0863e-04, 1.3302e-03],
        [4.2156e-04, 2.4645e-05],
        [4.7193e-05, 2.6786e-03],
        [6.6258e-04, 1.8248e-02],
        [1.3417e-03, 1.4655e-04],
        [2.5080e-04, 2.5419e-05],
        [4.9510e-04, 1.0880e-04],
        [1.0010e-04, 6.7092e-03],
        [2.9087e-04, 1.0174e-03],
        [7.9527e-04, 1.3243e-04],
        [9.2220e-04, 3.2898e-03],
        [2.7612e-04, 1.0305e-02],
        [8.2018e-04, 2.8893e-04],
        [8.9018e-04, 5.9799e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[5.6865e-04],
        [7.7327e-05],
        [6.0856e-04],
        [4.7293e-04],
        [1.2199e-04],
        [9.7417e-04],
        [3.0532e-04],
        [7.5954e-04],
        [1.5006e-04],
        [1.9018e-04],
        [2.7814e-04],
        [5.8177e-04],
        [1.1131e-03],
        [1.9771e-04],
        [3.6885e-04],
        [7.5282e-04]], device='cuda:0') / tensor([[5.6865e-04, 7.7327e-05, 6.0856e-04, 4.7293e-04, 1.2199e-04, 9.7417e-04,
         3.0532e-04, 7.5954e-04, 1.5006e-04, 1.9018e-04, 2.7814e-04, 5.8177e-04,
         1.1131e-03, 1.9771e-04, 3.6885e-04, 7.5282e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[9.3122e-04],
        [1.6752e-02],
        [4.1680e-02],
        [2.0744e-05],
        [1.2399e-02],
        [8.9324e-03],
        [8.7551e-03],
        [5.2131e-04],
        [5.4426e-03],
        [4.9661e-03],
        [7.6457e-06],
        [3.4409e-04],
        [8.8648e-04],
        [7.3168e-03],
        [1.6898e-04],
        [2.2211e-04]], device='cuda:0') / tensor([[9.3122e-04, 1.6752e-02, 4.1680e-02, 2.0744e-05, 1.2399e-02, 8.9324e-03,
         8.7551e-03, 5.2131e-04, 5.4426e-03, 4.9661e-03, 7.6457e-06, 3.4409e-04,
         8.8648e-04, 7.3168e-03, 1.6898e-04, 2.2211e-04]], device='cuda:0')
answers_probs: tensor([[5.6865e-04, 9.3122e-04],
        [7.7327e-05, 1.6752e-02],
        [6.0856e-04, 4.1680e-02],
        [4.7293e-04, 2.0744e-05],
        [1.2199e-04, 1.2399e-02],
        [9.7417e-04, 8.9324e-03],
        [3.0532e-04, 8.7551e-03],
        [7.5954e-04, 5.2131e-04],
        [1.5006e-04, 5.4426e-03],
        [1.9018e-04, 4.9661e-03],
        [2.7814e-04, 7.6457e-06],
        [5.8177e-04, 3.4409e-04],
        [1.1131e-03, 8.8648e-04],
        [1.9771e-04, 7.3168e-03],
        [3.6885e-04, 1.6898e-04],
        [7.5282e-04, 2.2211e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0002],
        [0.0011],
        [0.0002],
        [0.0012],
        [0.0008],
        [0.0002],
        [0.0014],
        [0.0004],
        [0.0007],
        [0.0021],
        [0.0003],
        [0.0004],
        [0.0007],
        [0.0002],
        [0.0010],
        [0.0004]], device='cuda:0') / tensor([[0.0002, 0.0011, 0.0002, 0.0012, 0.0008, 0.0002, 0.0014, 0.0004, 0.0007,
         0.0021, 0.0003, 0.0004, 0.0007, 0.0002, 0.0010, 0.0004]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[4.5461e-02],
        [1.2056e-03],
        [3.9412e-02],
        [9.2810e-03],
        [1.4878e-02],
        [6.2511e-06],
        [2.1961e-02],
        [4.8270e-05],
        [5.7907e-02],
        [5.4434e-03],
        [3.0338e-05],
        [1.0559e-04],
        [5.7962e-04],
        [2.6379e-03],
        [8.9801e-03],
        [1.6949e-05]], device='cuda:0') / tensor([[4.5461e-02, 1.2056e-03, 3.9412e-02, 9.2810e-03, 1.4878e-02, 6.2511e-06,
         2.1961e-02, 4.8270e-05, 5.7907e-02, 5.4434e-03, 3.0338e-05, 1.0559e-04,
         5.7962e-04, 2.6379e-03, 8.9801e-03, 1.6949e-05]], device='cuda:0')
answers_probs: tensor([[2.0155e-04, 4.5461e-02],
        [1.1025e-03, 1.2056e-03],
        [1.9436e-04, 3.9412e-02],
        [1.2399e-03, 9.2810e-03],
        [8.2136e-04, 1.4878e-02],
        [1.5424e-04, 6.2511e-06],
        [1.3562e-03, 2.1961e-02],
        [3.6885e-04, 4.8270e-05],
        [6.8429e-04, 5.7907e-02],
        [2.1374e-03, 5.4434e-03],
        [3.2653e-04, 3.0338e-05],
        [4.3626e-04, 1.0559e-04],
        [7.3463e-04, 5.7962e-04],
        [2.2057e-04, 2.6379e-03],
        [9.8026e-04, 8.9801e-03],
        [4.0184e-04, 1.6949e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0008],
        [0.0002]], device='cuda:0') / tensor([[0.0008, 0.0002]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.0071],
        [0.0040]], device='cuda:0') / tensor([[0.0071, 0.0040]], device='cuda:0')
answers_probs: tensor([[0.0008, 0.0071],
        [0.0002, 0.0040]], device='cuda:0')
acc:  0.8
Time taken to execute the de SA task with prompt type active, variation 2 and batchsize 16: 0:03:08.558587
path ['42', 'de', 'flan', 'SA', 'active', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base SA passive 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 353.81it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0009],
        [0.0017],
        [0.0010],
        [0.0015],
        [0.0018],
        [0.0018],
        [0.0012],
        [0.0005],
        [0.0006],
        [0.0023],
        [0.0001],
        [0.0010],
        [0.0011],
        [0.0008],
        [0.0005],
        [0.0018]], device='cuda:0') / tensor([[0.0009, 0.0017, 0.0010, 0.0015, 0.0018, 0.0018, 0.0012, 0.0005, 0.0006,
         0.0023, 0.0001, 0.0010, 0.0011, 0.0008, 0.0005, 0.0018]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0549],
        [0.0067],
        [0.1446],
        [0.0108],
        [0.0801],
        [0.0026],
        [0.0013],
        [0.0307],
        [0.0010],
        [0.0465],
        [0.0052],
        [0.0007],
        [0.0264],
        [0.0796],
        [0.0051],
        [0.1414]], device='cuda:0') / tensor([[0.0549, 0.0067, 0.1446, 0.0108, 0.0801, 0.0026, 0.0013, 0.0307, 0.0010,
         0.0465, 0.0052, 0.0007, 0.0264, 0.0796, 0.0051, 0.1414]],
       device='cuda:0')
answers_probs: tensor([[8.8142e-04, 5.4933e-02],
        [1.6868e-03, 6.7351e-03],
        [9.6116e-04, 1.4460e-01],
        [1.4924e-03, 1.0770e-02],
        [1.7755e-03, 8.0088e-02],
        [1.8380e-03, 2.5843e-03],
        [1.1599e-03, 1.2680e-03],
        [4.8253e-04, 3.0710e-02],
        [5.9903e-04, 1.0220e-03],
        [2.3319e-03, 4.6522e-02],
        [1.3893e-04, 5.2423e-03],
        [1.0186e-03, 7.1040e-04],
        [1.0658e-03, 2.6368e-02],
        [8.3179e-04, 7.9626e-02],
        [4.9099e-04, 5.0692e-03],
        [1.7548e-03, 1.4141e-01]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0010],
        [0.0006],
        [0.0021],
        [0.0013],
        [0.0011],
        [0.0006],
        [0.0006],
        [0.0005],
        [0.0017],
        [0.0008],
        [0.0004],
        [0.0009],
        [0.0006],
        [0.0016],
        [0.0013],
        [0.0004]], device='cuda:0') / tensor([[0.0010, 0.0006, 0.0021, 0.0013, 0.0011, 0.0006, 0.0006, 0.0005, 0.0017,
         0.0008, 0.0004, 0.0009, 0.0006, 0.0016, 0.0013, 0.0004]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.2548e-04],
        [1.8571e-03],
        [1.6074e-03],
        [3.1335e-02],
        [9.8578e-04],
        [3.6400e-04],
        [7.8031e-02],
        [1.0142e-02],
        [1.4904e-02],
        [3.4483e-02],
        [1.3030e-04],
        [1.5403e-03],
        [1.1203e-03],
        [4.1891e-02],
        [1.3091e-01],
        [2.1434e-03]], device='cuda:0') / tensor([[3.2548e-04, 1.8571e-03, 1.6074e-03, 3.1335e-02, 9.8578e-04, 3.6400e-04,
         7.8031e-02, 1.0142e-02, 1.4904e-02, 3.4483e-02, 1.3030e-04, 1.5403e-03,
         1.1203e-03, 4.1891e-02, 1.3091e-01, 2.1434e-03]], device='cuda:0')
answers_probs: tensor([[9.7766e-04, 3.2548e-04],
        [5.9424e-04, 1.8571e-03],
        [2.0784e-03, 1.6074e-03],
        [1.3486e-03, 3.1335e-02],
        [1.1305e-03, 9.8578e-04],
        [5.5249e-04, 3.6400e-04],
        [5.9137e-04, 7.8031e-02],
        [4.7939e-04, 1.0142e-02],
        [1.6974e-03, 1.4904e-02],
        [7.6816e-04, 3.4483e-02],
        [3.9006e-04, 1.3030e-04],
        [9.4965e-04, 1.5403e-03],
        [6.3974e-04, 1.1203e-03],
        [1.6113e-03, 4.1891e-02],
        [1.2510e-03, 1.3091e-01],
        [4.0609e-04, 2.1434e-03]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0010],
        [0.0004],
        [0.0015],
        [0.0013],
        [0.0002],
        [0.0005],
        [0.0006],
        [0.0014],
        [0.0021],
        [0.0005],
        [0.0004],
        [0.0004],
        [0.0018],
        [0.0036],
        [0.0016],
        [0.0007]], device='cuda:0') / tensor([[0.0010, 0.0004, 0.0015, 0.0013, 0.0002, 0.0005, 0.0006, 0.0014, 0.0021,
         0.0005, 0.0004, 0.0004, 0.0018, 0.0036, 0.0016, 0.0007]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.9804e-03],
        [1.9706e-02],
        [5.3916e-03],
        [1.5718e-02],
        [6.6154e-05],
        [1.2367e-02],
        [1.2064e-02],
        [1.3978e-02],
        [6.4422e-03],
        [1.6724e-02],
        [1.5211e-04],
        [9.5218e-04],
        [4.9214e-02],
        [1.9574e-02],
        [4.5126e-04],
        [1.2577e-01]], device='cuda:0') / tensor([[3.9804e-03, 1.9706e-02, 5.3916e-03, 1.5718e-02, 6.6154e-05, 1.2367e-02,
         1.2064e-02, 1.3978e-02, 6.4422e-03, 1.6724e-02, 1.5211e-04, 9.5218e-04,
         4.9214e-02, 1.9574e-02, 4.5126e-04, 1.2577e-01]], device='cuda:0')
answers_probs: tensor([[9.6104e-04, 3.9804e-03],
        [4.1157e-04, 1.9706e-02],
        [1.4643e-03, 5.3916e-03],
        [1.2621e-03, 1.5718e-02],
        [1.6384e-04, 6.6154e-05],
        [4.9686e-04, 1.2367e-02],
        [5.6350e-04, 1.2064e-02],
        [1.4401e-03, 1.3978e-02],
        [2.0924e-03, 6.4422e-03],
        [4.9298e-04, 1.6724e-02],
        [3.8074e-04, 1.5211e-04],
        [4.2480e-04, 9.5218e-04],
        [1.7657e-03, 4.9214e-02],
        [3.6148e-03, 1.9574e-02],
        [1.5844e-03, 4.5126e-04],
        [6.7417e-04, 1.2577e-01]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0002],
        [0.0001]], device='cuda:0') / tensor([[0.0002, 0.0001]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.0207],
        [0.0001]], device='cuda:0') / tensor([[0.0207, 0.0001]], device='cuda:0')
answers_probs: tensor([[0.0002, 0.0207],
        [0.0001, 0.0001]], device='cuda:0')
acc:  0.66
Time taken to execute the de SA task with prompt type passive, variation 0 and batchsize 16: 0:03:08.669007
path ['42', 'de', 'flan', 'SA', 'passive', 'prompt_id_0']
----------- 42 de google/flan-t5-base SA passive 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 369.91it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0004],
        [0.0007],
        [0.0008],
        [0.0003],
        [0.0011],
        [0.0002],
        [0.0003],
        [0.0004],
        [0.0003],
        [0.0013],
        [0.0003],
        [0.0005],
        [0.0001],
        [0.0008],
        [0.0006],
        [0.0006]], device='cuda:0') / tensor([[0.0004, 0.0007, 0.0008, 0.0003, 0.0011, 0.0002, 0.0003, 0.0004, 0.0003,
         0.0013, 0.0003, 0.0005, 0.0001, 0.0008, 0.0006, 0.0006]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.6212e-02],
        [6.0620e-02],
        [2.2202e-03],
        [1.0533e-02],
        [3.9664e-03],
        [1.6414e-02],
        [1.7292e-04],
        [2.2867e-04],
        [1.1116e-02],
        [5.0770e-02],
        [1.6626e-03],
        [1.1606e-03],
        [9.9737e-06],
        [3.4707e-04],
        [8.9713e-05],
        [3.7974e-04]], device='cuda:0') / tensor([[5.6212e-02, 6.0620e-02, 2.2202e-03, 1.0533e-02, 3.9664e-03, 1.6414e-02,
         1.7292e-04, 2.2867e-04, 1.1116e-02, 5.0770e-02, 1.6626e-03, 1.1606e-03,
         9.9737e-06, 3.4707e-04, 8.9713e-05, 3.7974e-04]], device='cuda:0')
answers_probs: tensor([[4.3963e-04, 5.6212e-02],
        [7.3016e-04, 6.0620e-02],
        [8.1546e-04, 2.2202e-03],
        [2.7887e-04, 1.0533e-02],
        [1.1364e-03, 3.9664e-03],
        [1.8341e-04, 1.6414e-02],
        [2.5739e-04, 1.7292e-04],
        [3.5671e-04, 2.2867e-04],
        [2.5256e-04, 1.1116e-02],
        [1.3409e-03, 5.0770e-02],
        [2.6735e-04, 1.6626e-03],
        [4.6426e-04, 1.1606e-03],
        [1.2122e-04, 9.9737e-06],
        [8.4853e-04, 3.4707e-04],
        [5.7049e-04, 8.9713e-05],
        [6.3047e-04, 3.7974e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0017],
        [0.0014],
        [0.0003],
        [0.0007],
        [0.0005],
        [0.0002],
        [0.0002],
        [0.0012],
        [0.0002],
        [0.0010],
        [0.0006],
        [0.0002],
        [0.0005],
        [0.0005],
        [0.0005],
        [0.0011]], device='cuda:0') / tensor([[0.0017, 0.0014, 0.0003, 0.0007, 0.0005, 0.0002, 0.0002, 0.0012, 0.0002,
         0.0010, 0.0006, 0.0002, 0.0005, 0.0005, 0.0005, 0.0011]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0418],
        [0.0038],
        [0.0066],
        [0.0554],
        [0.0121],
        [0.0002],
        [0.0036],
        [0.0235],
        [0.0061],
        [0.0012],
        [0.0005],
        [0.0060],
        [0.0338],
        [0.0004],
        [0.0010],
        [0.1383]], device='cuda:0') / tensor([[0.0418, 0.0038, 0.0066, 0.0554, 0.0121, 0.0002, 0.0036, 0.0235, 0.0061,
         0.0012, 0.0005, 0.0060, 0.0338, 0.0004, 0.0010, 0.1383]],
       device='cuda:0')
answers_probs: tensor([[0.0017, 0.0418],
        [0.0014, 0.0038],
        [0.0003, 0.0066],
        [0.0007, 0.0554],
        [0.0005, 0.0121],
        [0.0002, 0.0002],
        [0.0002, 0.0036],
        [0.0012, 0.0235],
        [0.0002, 0.0061],
        [0.0010, 0.0012],
        [0.0006, 0.0005],
        [0.0002, 0.0060],
        [0.0005, 0.0338],
        [0.0005, 0.0004],
        [0.0005, 0.0010],
        [0.0011, 0.1383]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0001],
        [0.0009],
        [0.0006],
        [0.0005],
        [0.0005],
        [0.0005],
        [0.0003],
        [0.0009],
        [0.0015],
        [0.0003],
        [0.0007],
        [0.0002],
        [0.0013],
        [0.0006],
        [0.0002],
        [0.0016]], device='cuda:0') / tensor([[0.0001, 0.0009, 0.0006, 0.0005, 0.0005, 0.0005, 0.0003, 0.0009, 0.0015,
         0.0003, 0.0007, 0.0002, 0.0013, 0.0006, 0.0002, 0.0016]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.0419e-05],
        [2.0386e-02],
        [9.9672e-04],
        [3.7883e-04],
        [3.9286e-03],
        [1.7045e-03],
        [1.1847e-04],
        [2.2266e-03],
        [6.1152e-02],
        [4.4148e-03],
        [1.3032e-02],
        [7.8744e-04],
        [5.1773e-02],
        [1.0252e-04],
        [8.7990e-05],
        [3.1485e-02]], device='cuda:0') / tensor([[2.0419e-05, 2.0386e-02, 9.9672e-04, 3.7883e-04, 3.9286e-03, 1.7045e-03,
         1.1847e-04, 2.2266e-03, 6.1152e-02, 4.4148e-03, 1.3032e-02, 7.8744e-04,
         5.1773e-02, 1.0252e-04, 8.7990e-05, 3.1485e-02]], device='cuda:0')
answers_probs: tensor([[1.2739e-04, 2.0419e-05],
        [9.0209e-04, 2.0386e-02],
        [6.2841e-04, 9.9672e-04],
        [4.9096e-04, 3.7883e-04],
        [4.6756e-04, 3.9286e-03],
        [4.5183e-04, 1.7045e-03],
        [2.9554e-04, 1.1847e-04],
        [8.9124e-04, 2.2266e-03],
        [1.5429e-03, 6.1152e-02],
        [2.8011e-04, 4.4148e-03],
        [6.7531e-04, 1.3032e-02],
        [2.4548e-04, 7.8744e-04],
        [1.2627e-03, 5.1773e-02],
        [6.1643e-04, 1.0252e-04],
        [1.6414e-04, 8.7990e-05],
        [1.5811e-03, 3.1485e-02]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0006],
        [0.0001]], device='cuda:0') / tensor([[0.0006, 0.0001]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.0004],
        [0.0141]], device='cuda:0') / tensor([[0.0004, 0.0141]], device='cuda:0')
answers_probs: tensor([[0.0006, 0.0004],
        [0.0001, 0.0141]], device='cuda:0')
acc:  0.74
Time taken to execute the de SA task with prompt type passive, variation 1 and batchsize 16: 0:03:07.688055
path ['42', 'de', 'flan', 'SA', 'passive', 'prompt_id_1']
----------- 42 de google/flan-t5-base SA passive 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 321.45it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0005],
        [0.0007],
        [0.0016],
        [0.0009],
        [0.0009],
        [0.0009],
        [0.0014],
        [0.0012],
        [0.0005],
        [0.0014],
        [0.0004],
        [0.0019],
        [0.0004],
        [0.0003],
        [0.0006],
        [0.0001]], device='cuda:0') / tensor([[0.0005, 0.0007, 0.0016, 0.0009, 0.0009, 0.0009, 0.0014, 0.0012, 0.0005,
         0.0014, 0.0004, 0.0019, 0.0004, 0.0003, 0.0006, 0.0001]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.1488e-01],
        [9.2538e-04],
        [4.2012e-05],
        [4.1601e-04],
        [1.5017e-01],
        [2.4867e-04],
        [2.6380e-04],
        [1.8485e-04],
        [1.8158e-02],
        [2.1354e-02],
        [7.1368e-03],
        [1.3925e-04],
        [4.1490e-05],
        [1.2639e-02],
        [4.2336e-04],
        [9.5649e-03]], device='cuda:0') / tensor([[1.1488e-01, 9.2538e-04, 4.2012e-05, 4.1601e-04, 1.5017e-01, 2.4867e-04,
         2.6380e-04, 1.8485e-04, 1.8158e-02, 2.1354e-02, 7.1368e-03, 1.3925e-04,
         4.1490e-05, 1.2639e-02, 4.2336e-04, 9.5649e-03]], device='cuda:0')
answers_probs: tensor([[4.7352e-04, 1.1488e-01],
        [6.8593e-04, 9.2538e-04],
        [1.6145e-03, 4.2012e-05],
        [9.2319e-04, 4.1601e-04],
        [9.3286e-04, 1.5017e-01],
        [8.5147e-04, 2.4867e-04],
        [1.4106e-03, 2.6380e-04],
        [1.1685e-03, 1.8485e-04],
        [5.2810e-04, 1.8158e-02],
        [1.3741e-03, 2.1354e-02],
        [3.6680e-04, 7.1368e-03],
        [1.9202e-03, 1.3925e-04],
        [4.0829e-04, 4.1490e-05],
        [3.4408e-04, 1.2639e-02],
        [6.3398e-04, 4.2336e-04],
        [1.1465e-04, 9.5649e-03]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0005],
        [0.0027],
        [0.0025],
        [0.0003],
        [0.0002],
        [0.0002],
        [0.0008],
        [0.0015],
        [0.0004],
        [0.0010],
        [0.0014],
        [0.0023],
        [0.0017],
        [0.0026],
        [0.0011],
        [0.0004]], device='cuda:0') / tensor([[0.0005, 0.0027, 0.0025, 0.0003, 0.0002, 0.0002, 0.0008, 0.0015, 0.0004,
         0.0010, 0.0014, 0.0023, 0.0017, 0.0026, 0.0011, 0.0004]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.2987e-03],
        [2.8067e-03],
        [4.3743e-03],
        [1.8967e-02],
        [1.3141e-02],
        [8.0055e-02],
        [1.6703e-05],
        [2.0050e-03],
        [1.5332e-05],
        [3.2071e-03],
        [5.8172e-02],
        [3.2288e-02],
        [7.0289e-02],
        [2.8711e-02],
        [4.2162e-03],
        [1.1371e-02]], device='cuda:0') / tensor([[3.2987e-03, 2.8067e-03, 4.3743e-03, 1.8967e-02, 1.3141e-02, 8.0055e-02,
         1.6703e-05, 2.0050e-03, 1.5332e-05, 3.2071e-03, 5.8172e-02, 3.2288e-02,
         7.0289e-02, 2.8711e-02, 4.2162e-03, 1.1371e-02]], device='cuda:0')
answers_probs: tensor([[5.2384e-04, 3.2987e-03],
        [2.7321e-03, 2.8067e-03],
        [2.4704e-03, 4.3743e-03],
        [2.6368e-04, 1.8967e-02],
        [1.9238e-04, 1.3141e-02],
        [2.4915e-04, 8.0055e-02],
        [8.2980e-04, 1.6703e-05],
        [1.4801e-03, 2.0050e-03],
        [3.8527e-04, 1.5332e-05],
        [1.0187e-03, 3.2071e-03],
        [1.4292e-03, 5.8172e-02],
        [2.2659e-03, 3.2288e-02],
        [1.6569e-03, 7.0289e-02],
        [2.6277e-03, 2.8711e-02],
        [1.1386e-03, 4.2162e-03],
        [3.7166e-04, 1.1371e-02]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0018],
        [0.0027],
        [0.0010],
        [0.0005],
        [0.0003],
        [0.0047],
        [0.0004],
        [0.0025],
        [0.0001],
        [0.0012],
        [0.0017],
        [0.0022],
        [0.0015],
        [0.0010],
        [0.0022],
        [0.0021]], device='cuda:0') / tensor([[0.0018, 0.0027, 0.0010, 0.0005, 0.0003, 0.0047, 0.0004, 0.0025, 0.0001,
         0.0012, 0.0017, 0.0022, 0.0015, 0.0010, 0.0022, 0.0021]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[4.5508e-04],
        [2.0201e-03],
        [2.9665e-05],
        [1.4680e-02],
        [1.0216e-01],
        [1.6150e-01],
        [1.3425e-02],
        [1.4259e-03],
        [4.4821e-03],
        [9.1772e-05],
        [6.5913e-05],
        [5.8736e-04],
        [6.4754e-02],
        [5.1878e-05],
        [4.9484e-05],
        [2.0201e-02]], device='cuda:0') / tensor([[4.5508e-04, 2.0201e-03, 2.9665e-05, 1.4680e-02, 1.0216e-01, 1.6150e-01,
         1.3425e-02, 1.4259e-03, 4.4821e-03, 9.1772e-05, 6.5913e-05, 5.8736e-04,
         6.4754e-02, 5.1878e-05, 4.9484e-05, 2.0201e-02]], device='cuda:0')
answers_probs: tensor([[1.8190e-03, 4.5508e-04],
        [2.6796e-03, 2.0201e-03],
        [1.0347e-03, 2.9665e-05],
        [5.3536e-04, 1.4680e-02],
        [2.9082e-04, 1.0216e-01],
        [4.7366e-03, 1.6150e-01],
        [3.7112e-04, 1.3425e-02],
        [2.5124e-03, 1.4259e-03],
        [1.4391e-04, 4.4821e-03],
        [1.2141e-03, 9.1772e-05],
        [1.6860e-03, 6.5913e-05],
        [2.2029e-03, 5.8736e-04],
        [1.5350e-03, 6.4754e-02],
        [1.0411e-03, 5.1878e-05],
        [2.2078e-03, 4.9484e-05],
        [2.0560e-03, 2.0201e-02]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0010],
        [0.0003]], device='cuda:0') / tensor([[0.0010, 0.0003]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[9.9628e-05],
        [8.4539e-06]], device='cuda:0') / tensor([[9.9628e-05, 8.4539e-06]], device='cuda:0')
answers_probs: tensor([[9.7014e-04, 9.9628e-05],
        [3.4201e-04, 8.4539e-06]], device='cuda:0')
acc:  0.8
Time taken to execute the de SA task with prompt type passive, variation 2 and batchsize 16: 0:03:07.817030
path ['42', 'de', 'flan', 'SA', 'passive', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base SA auxiliary 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 350.67it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0008],
        [0.0003],
        [0.0002],
        [0.0004],
        [0.0006],
        [0.0005],
        [0.0001],
        [0.0002],
        [0.0006],
        [0.0009],
        [0.0010],
        [0.0013],
        [0.0005],
        [0.0003],
        [0.0004],
        [0.0004]], device='cuda:0') / tensor([[0.0008, 0.0003, 0.0002, 0.0004, 0.0006, 0.0005, 0.0001, 0.0002, 0.0006,
         0.0009, 0.0010, 0.0013, 0.0005, 0.0003, 0.0004, 0.0004]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.5868e-02],
        [2.3865e-04],
        [3.7750e-05],
        [7.2024e-03],
        [3.0596e-03],
        [4.7254e-02],
        [2.1070e-04],
        [1.7363e-04],
        [2.5200e-03],
        [1.7144e-03],
        [4.3572e-02],
        [1.0738e-02],
        [5.6417e-02],
        [2.5307e-03],
        [1.2814e-03],
        [1.8338e-01]], device='cuda:0') / tensor([[5.5868e-02, 2.3865e-04, 3.7750e-05, 7.2024e-03, 3.0596e-03, 4.7254e-02,
         2.1070e-04, 1.7363e-04, 2.5200e-03, 1.7144e-03, 4.3572e-02, 1.0738e-02,
         5.6417e-02, 2.5307e-03, 1.2814e-03, 1.8338e-01]], device='cuda:0')
answers_probs: tensor([[7.8434e-04, 5.5868e-02],
        [3.3338e-04, 2.3865e-04],
        [1.5904e-04, 3.7750e-05],
        [3.8267e-04, 7.2024e-03],
        [5.9376e-04, 3.0596e-03],
        [4.8693e-04, 4.7254e-02],
        [1.1854e-04, 2.1070e-04],
        [2.1847e-04, 1.7363e-04],
        [6.4249e-04, 2.5200e-03],
        [8.6755e-04, 1.7144e-03],
        [1.0170e-03, 4.3572e-02],
        [1.3238e-03, 1.0738e-02],
        [4.8536e-04, 5.6417e-02],
        [3.1391e-04, 2.5307e-03],
        [3.6426e-04, 1.2814e-03],
        [3.7346e-04, 1.8338e-01]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0002],
        [0.0006],
        [0.0005],
        [0.0003],
        [0.0004],
        [0.0002],
        [0.0007],
        [0.0001],
        [0.0001],
        [0.0002],
        [0.0009],
        [0.0003],
        [0.0002],
        [0.0010],
        [0.0001],
        [0.0007]], device='cuda:0') / tensor([[0.0002, 0.0006, 0.0005, 0.0003, 0.0004, 0.0002, 0.0007, 0.0001, 0.0001,
         0.0002, 0.0009, 0.0003, 0.0002, 0.0010, 0.0001, 0.0007]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.8354e-03],
        [2.5536e-03],
        [4.7390e-04],
        [3.1654e-04],
        [1.2661e-03],
        [1.4268e-04],
        [1.3280e-04],
        [1.9229e-05],
        [4.8883e-03],
        [4.4391e-03],
        [7.3493e-03],
        [3.3836e-02],
        [3.3944e-04],
        [4.9258e-02],
        [3.5209e-03],
        [1.1979e-02]], device='cuda:0') / tensor([[2.8354e-03, 2.5536e-03, 4.7390e-04, 3.1654e-04, 1.2661e-03, 1.4268e-04,
         1.3280e-04, 1.9229e-05, 4.8883e-03, 4.4391e-03, 7.3493e-03, 3.3836e-02,
         3.3944e-04, 4.9258e-02, 3.5209e-03, 1.1979e-02]], device='cuda:0')
answers_probs: tensor([[1.9187e-04, 2.8354e-03],
        [6.2902e-04, 2.5536e-03],
        [5.0290e-04, 4.7390e-04],
        [2.8281e-04, 3.1654e-04],
        [3.7660e-04, 1.2661e-03],
        [1.7148e-04, 1.4268e-04],
        [6.5487e-04, 1.3280e-04],
        [1.2650e-04, 1.9229e-05],
        [1.4394e-04, 4.8883e-03],
        [1.8876e-04, 4.4391e-03],
        [9.3925e-04, 7.3493e-03],
        [3.4168e-04, 3.3836e-02],
        [2.0827e-04, 3.3944e-04],
        [1.0035e-03, 4.9258e-02],
        [1.1387e-04, 3.5209e-03],
        [7.0977e-04, 1.1979e-02]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0011],
        [0.0002],
        [0.0001],
        [0.0002],
        [0.0004],
        [0.0003],
        [0.0006],
        [0.0002],
        [0.0005],
        [0.0004],
        [0.0001],
        [0.0007],
        [0.0004],
        [0.0009],
        [0.0010],
        [0.0007]], device='cuda:0') / tensor([[0.0011, 0.0002, 0.0001, 0.0002, 0.0004, 0.0003, 0.0006, 0.0002, 0.0005,
         0.0004, 0.0001, 0.0007, 0.0004, 0.0009, 0.0010, 0.0007]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0389],
        [0.0156],
        [0.0066],
        [0.0075],
        [0.0003],
        [0.0003],
        [0.0066],
        [0.0089],
        [0.0194],
        [0.0075],
        [0.0042],
        [0.0008],
        [0.0002],
        [0.0469],
        [0.0140],
        [0.0006]], device='cuda:0') / tensor([[0.0389, 0.0156, 0.0066, 0.0075, 0.0003, 0.0003, 0.0066, 0.0089, 0.0194,
         0.0075, 0.0042, 0.0008, 0.0002, 0.0469, 0.0140, 0.0006]],
       device='cuda:0')
answers_probs: tensor([[0.0011, 0.0389],
        [0.0002, 0.0156],
        [0.0001, 0.0066],
        [0.0002, 0.0075],
        [0.0004, 0.0003],
        [0.0003, 0.0003],
        [0.0006, 0.0066],
        [0.0002, 0.0089],
        [0.0005, 0.0194],
        [0.0004, 0.0075],
        [0.0001, 0.0042],
        [0.0007, 0.0008],
        [0.0004, 0.0002],
        [0.0009, 0.0469],
        [0.0010, 0.0140],
        [0.0007, 0.0006]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0009],
        [0.0012]], device='cuda:0') / tensor([[0.0009, 0.0012]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.0205],
        [0.0030]], device='cuda:0') / tensor([[0.0205, 0.0030]], device='cuda:0')
answers_probs: tensor([[0.0009, 0.0205],
        [0.0012, 0.0030]], device='cuda:0')
acc:  0.7
Time taken to execute the de SA task with prompt type auxiliary, variation 0 and batchsize 16: 0:03:07.697516
path ['42', 'de', 'flan', 'SA', 'auxiliary', 'prompt_id_0']
----------- 42 de google/flan-t5-base SA auxiliary 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 352.23it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0021],
        [0.0014],
        [0.0029],
        [0.0015],
        [0.0009],
        [0.0003],
        [0.0015],
        [0.0004],
        [0.0003],
        [0.0002],
        [0.0014],
        [0.0014],
        [0.0002],
        [0.0022],
        [0.0010],
        [0.0004]], device='cuda:0') / tensor([[0.0021, 0.0014, 0.0029, 0.0015, 0.0009, 0.0003, 0.0015, 0.0004, 0.0003,
         0.0002, 0.0014, 0.0014, 0.0002, 0.0022, 0.0010, 0.0004]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.1028e-01],
        [3.2081e-04],
        [1.8271e-02],
        [3.1321e-03],
        [3.7508e-03],
        [6.2791e-03],
        [2.7059e-04],
        [8.4118e-04],
        [3.2499e-02],
        [2.3165e-02],
        [4.8289e-03],
        [6.8553e-02],
        [2.3077e-05],
        [2.3089e-02],
        [4.5978e-03],
        [9.3944e-05]], device='cuda:0') / tensor([[1.1028e-01, 3.2081e-04, 1.8271e-02, 3.1321e-03, 3.7508e-03, 6.2791e-03,
         2.7059e-04, 8.4118e-04, 3.2499e-02, 2.3165e-02, 4.8289e-03, 6.8553e-02,
         2.3077e-05, 2.3089e-02, 4.5978e-03, 9.3944e-05]], device='cuda:0')
answers_probs: tensor([[2.1142e-03, 1.1028e-01],
        [1.4337e-03, 3.2081e-04],
        [2.8995e-03, 1.8271e-02],
        [1.4768e-03, 3.1321e-03],
        [8.6211e-04, 3.7508e-03],
        [3.3731e-04, 6.2791e-03],
        [1.4774e-03, 2.7059e-04],
        [3.6249e-04, 8.4118e-04],
        [2.7076e-04, 3.2499e-02],
        [2.1462e-04, 2.3165e-02],
        [1.3754e-03, 4.8289e-03],
        [1.3656e-03, 6.8553e-02],
        [1.5425e-04, 2.3077e-05],
        [2.2151e-03, 2.3089e-02],
        [9.9282e-04, 4.5978e-03],
        [4.4285e-04, 9.3944e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0005],
        [0.0008],
        [0.0011],
        [0.0009],
        [0.0004],
        [0.0002],
        [0.0007],
        [0.0003],
        [0.0008],
        [0.0014],
        [0.0020],
        [0.0009],
        [0.0004],
        [0.0008],
        [0.0017],
        [0.0007]], device='cuda:0') / tensor([[0.0005, 0.0008, 0.0011, 0.0009, 0.0004, 0.0002, 0.0007, 0.0003, 0.0008,
         0.0014, 0.0020, 0.0009, 0.0004, 0.0008, 0.0017, 0.0007]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0012],
        [0.0080],
        [0.1434],
        [0.0912],
        [0.0141],
        [0.0149],
        [0.0041],
        [0.0005],
        [0.0013],
        [0.0284],
        [0.0484],
        [0.0775],
        [0.0226],
        [0.0007],
        [0.0772],
        [0.0006]], device='cuda:0') / tensor([[0.0012, 0.0080, 0.1434, 0.0912, 0.0141, 0.0149, 0.0041, 0.0005, 0.0013,
         0.0284, 0.0484, 0.0775, 0.0226, 0.0007, 0.0772, 0.0006]],
       device='cuda:0')
answers_probs: tensor([[0.0005, 0.0012],
        [0.0008, 0.0080],
        [0.0011, 0.1434],
        [0.0009, 0.0912],
        [0.0004, 0.0141],
        [0.0002, 0.0149],
        [0.0007, 0.0041],
        [0.0003, 0.0005],
        [0.0008, 0.0013],
        [0.0014, 0.0284],
        [0.0020, 0.0484],
        [0.0009, 0.0775],
        [0.0004, 0.0226],
        [0.0008, 0.0007],
        [0.0017, 0.0772],
        [0.0007, 0.0006]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0019],
        [0.0012],
        [0.0012],
        [0.0011],
        [0.0003],
        [0.0012],
        [0.0009],
        [0.0013],
        [0.0005],
        [0.0003],
        [0.0008],
        [0.0013],
        [0.0002],
        [0.0005],
        [0.0007],
        [0.0010]], device='cuda:0') / tensor([[0.0019, 0.0012, 0.0012, 0.0011, 0.0003, 0.0012, 0.0009, 0.0013, 0.0005,
         0.0003, 0.0008, 0.0013, 0.0002, 0.0005, 0.0007, 0.0010]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[4.4306e-02],
        [2.9038e-02],
        [1.1158e-01],
        [1.1870e-03],
        [6.0135e-03],
        [1.4169e-03],
        [8.5222e-02],
        [1.4056e-03],
        [1.9366e-02],
        [4.3629e-04],
        [1.5259e-02],
        [4.8484e-03],
        [6.6918e-05],
        [1.5684e-02],
        [6.4446e-03],
        [4.4743e-04]], device='cuda:0') / tensor([[4.4306e-02, 2.9038e-02, 1.1158e-01, 1.1870e-03, 6.0135e-03, 1.4169e-03,
         8.5222e-02, 1.4056e-03, 1.9366e-02, 4.3629e-04, 1.5259e-02, 4.8484e-03,
         6.6918e-05, 1.5684e-02, 6.4446e-03, 4.4743e-04]], device='cuda:0')
answers_probs: tensor([[1.8532e-03, 4.4306e-02],
        [1.2132e-03, 2.9038e-02],
        [1.1604e-03, 1.1158e-01],
        [1.1219e-03, 1.1870e-03],
        [3.2018e-04, 6.0135e-03],
        [1.2328e-03, 1.4169e-03],
        [8.7596e-04, 8.5222e-02],
        [1.3300e-03, 1.4056e-03],
        [5.4787e-04, 1.9366e-02],
        [3.1284e-04, 4.3629e-04],
        [7.8243e-04, 1.5259e-02],
        [1.2867e-03, 4.8484e-03],
        [2.1178e-04, 6.6918e-05],
        [5.0711e-04, 1.5684e-02],
        [7.2805e-04, 6.4446e-03],
        [9.8639e-04, 4.4743e-04]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0003],
        [0.0003]], device='cuda:0') / tensor([[0.0003, 0.0003]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.0148],
        [0.0001]], device='cuda:0') / tensor([[0.0148, 0.0001]], device='cuda:0')
answers_probs: tensor([[0.0003, 0.0148],
        [0.0003, 0.0001]], device='cuda:0')
acc:  0.6
Time taken to execute the de SA task with prompt type auxiliary, variation 1 and batchsize 16: 0:03:09.589012
path ['42', 'de', 'flan', 'SA', 'auxiliary', 'prompt_id_1']
----------- 42 de google/flan-t5-base SA auxiliary 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 353.85it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0006],
        [0.0010],
        [0.0002],
        [0.0007],
        [0.0002],
        [0.0002],
        [0.0002],
        [0.0002],
        [0.0007],
        [0.0007],
        [0.0004],
        [0.0009],
        [0.0006],
        [0.0005],
        [0.0002],
        [0.0006]], device='cuda:0') / tensor([[0.0006, 0.0010, 0.0002, 0.0007, 0.0002, 0.0002, 0.0002, 0.0002, 0.0007,
         0.0007, 0.0004, 0.0009, 0.0006, 0.0005, 0.0002, 0.0006]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.1318e-04],
        [4.6147e-02],
        [6.2951e-03],
        [1.6349e-02],
        [4.4801e-03],
        [2.7146e-04],
        [2.3433e-02],
        [7.4518e-05],
        [2.2534e-02],
        [9.7258e-04],
        [3.2745e-04],
        [2.1058e-02],
        [1.6933e-04],
        [4.0040e-02],
        [9.3330e-03],
        [1.3208e-01]], device='cuda:0') / tensor([[2.1318e-04, 4.6147e-02, 6.2951e-03, 1.6349e-02, 4.4801e-03, 2.7146e-04,
         2.3433e-02, 7.4518e-05, 2.2534e-02, 9.7258e-04, 3.2745e-04, 2.1058e-02,
         1.6933e-04, 4.0040e-02, 9.3330e-03, 1.3208e-01]], device='cuda:0')
answers_probs: tensor([[5.7240e-04, 2.1318e-04],
        [9.7644e-04, 4.6147e-02],
        [2.0971e-04, 6.2951e-03],
        [6.5755e-04, 1.6349e-02],
        [2.1050e-04, 4.4801e-03],
        [2.4255e-04, 2.7146e-04],
        [2.2335e-04, 2.3433e-02],
        [1.8431e-04, 7.4518e-05],
        [6.7554e-04, 2.2534e-02],
        [6.7975e-04, 9.7258e-04],
        [3.5963e-04, 3.2745e-04],
        [8.9649e-04, 2.1058e-02],
        [5.5773e-04, 1.6933e-04],
        [4.6001e-04, 4.0040e-02],
        [1.9648e-04, 9.3330e-03],
        [5.5637e-04, 1.3208e-01]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0003],
        [0.0005],
        [0.0005],
        [0.0002],
        [0.0006],
        [0.0003],
        [0.0002],
        [0.0003],
        [0.0005],
        [0.0001],
        [0.0004],
        [0.0004],
        [0.0008],
        [0.0006],
        [0.0001],
        [0.0002]], device='cuda:0') / tensor([[0.0003, 0.0005, 0.0005, 0.0002, 0.0006, 0.0003, 0.0002, 0.0003, 0.0005,
         0.0001, 0.0004, 0.0004, 0.0008, 0.0006, 0.0001, 0.0002]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0025],
        [0.0426],
        [0.0131],
        [0.0094],
        [0.0692],
        [0.0019],
        [0.0150],
        [0.0003],
        [0.0518],
        [0.0082],
        [0.0026],
        [0.0067],
        [0.0108],
        [0.0037],
        [0.0127],
        [0.0017]], device='cuda:0') / tensor([[0.0025, 0.0426, 0.0131, 0.0094, 0.0692, 0.0019, 0.0150, 0.0003, 0.0518,
         0.0082, 0.0026, 0.0067, 0.0108, 0.0037, 0.0127, 0.0017]],
       device='cuda:0')
answers_probs: tensor([[0.0003, 0.0025],
        [0.0005, 0.0426],
        [0.0005, 0.0131],
        [0.0002, 0.0094],
        [0.0006, 0.0692],
        [0.0003, 0.0019],
        [0.0002, 0.0150],
        [0.0003, 0.0003],
        [0.0005, 0.0518],
        [0.0001, 0.0082],
        [0.0004, 0.0026],
        [0.0004, 0.0067],
        [0.0008, 0.0108],
        [0.0006, 0.0037],
        [0.0001, 0.0127],
        [0.0002, 0.0017]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0003],
        [0.0011],
        [0.0006],
        [0.0006],
        [0.0003],
        [0.0012],
        [0.0006],
        [0.0002],
        [0.0001],
        [0.0004],
        [0.0012],
        [0.0005],
        [0.0010],
        [0.0005],
        [0.0002],
        [0.0005]], device='cuda:0') / tensor([[0.0003, 0.0011, 0.0006, 0.0006, 0.0003, 0.0012, 0.0006, 0.0002, 0.0001,
         0.0004, 0.0012, 0.0005, 0.0010, 0.0005, 0.0002, 0.0005]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0006],
        [0.0024],
        [0.0007],
        [0.0030],
        [0.0089],
        [0.0071],
        [0.0010],
        [0.0005],
        [0.0050],
        [0.0008],
        [0.0320],
        [0.0085],
        [0.0407],
        [0.0014],
        [0.0170],
        [0.0006]], device='cuda:0') / tensor([[0.0006, 0.0024, 0.0007, 0.0030, 0.0089, 0.0071, 0.0010, 0.0005, 0.0050,
         0.0008, 0.0320, 0.0085, 0.0407, 0.0014, 0.0170, 0.0006]],
       device='cuda:0')
answers_probs: tensor([[0.0003, 0.0006],
        [0.0011, 0.0024],
        [0.0006, 0.0007],
        [0.0006, 0.0030],
        [0.0003, 0.0089],
        [0.0012, 0.0071],
        [0.0006, 0.0010],
        [0.0002, 0.0005],
        [0.0001, 0.0050],
        [0.0004, 0.0008],
        [0.0012, 0.0320],
        [0.0005, 0.0085],
        [0.0010, 0.0407],
        [0.0005, 0.0014],
        [0.0002, 0.0170],
        [0.0005, 0.0006]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[4.7839e-05],
        [7.7920e-04]], device='cuda:0') / tensor([[4.7839e-05, 7.7920e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[4.4891e-05],
        [2.4977e-03]], device='cuda:0') / tensor([[4.4891e-05, 2.4977e-03]], device='cuda:0')
answers_probs: tensor([[4.7839e-05, 4.4891e-05],
        [7.7920e-04, 2.4977e-03]], device='cuda:0')
acc:  0.6
Time taken to execute the de SA task with prompt type auxiliary, variation 2 and batchsize 16: 0:03:08.381953
path ['42', 'de', 'flan', 'SA', 'auxiliary', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base SA modal 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 328.71it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0009],
        [0.0002],
        [0.0006],
        [0.0004],
        [0.0016],
        [0.0005],
        [0.0002],
        [0.0006],
        [0.0008],
        [0.0016],
        [0.0005],
        [0.0004],
        [0.0002],
        [0.0010],
        [0.0006],
        [0.0004]], device='cuda:0') / tensor([[0.0009, 0.0002, 0.0006, 0.0004, 0.0016, 0.0005, 0.0002, 0.0006, 0.0008,
         0.0016, 0.0005, 0.0004, 0.0002, 0.0010, 0.0006, 0.0004]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.4029e-01],
        [3.0906e-03],
        [3.7492e-03],
        [1.0167e-04],
        [1.1238e-02],
        [8.1596e-02],
        [2.7908e-04],
        [5.5114e-02],
        [2.0650e-03],
        [5.5429e-02],
        [8.3259e-04],
        [4.5745e-04],
        [5.4739e-05],
        [2.4374e-02],
        [1.6607e-04],
        [1.7590e-02]], device='cuda:0') / tensor([[1.4029e-01, 3.0906e-03, 3.7492e-03, 1.0167e-04, 1.1238e-02, 8.1596e-02,
         2.7908e-04, 5.5114e-02, 2.0650e-03, 5.5429e-02, 8.3259e-04, 4.5745e-04,
         5.4739e-05, 2.4374e-02, 1.6607e-04, 1.7590e-02]], device='cuda:0')
answers_probs: tensor([[8.6934e-04, 1.4029e-01],
        [2.2173e-04, 3.0906e-03],
        [5.5618e-04, 3.7492e-03],
        [4.4847e-04, 1.0167e-04],
        [1.6317e-03, 1.1238e-02],
        [5.3361e-04, 8.1596e-02],
        [1.9165e-04, 2.7908e-04],
        [5.6871e-04, 5.5114e-02],
        [8.0233e-04, 2.0650e-03],
        [1.5616e-03, 5.5429e-02],
        [5.2030e-04, 8.3259e-04],
        [3.5969e-04, 4.5745e-04],
        [1.9466e-04, 5.4739e-05],
        [1.0151e-03, 2.4374e-02],
        [5.9938e-04, 1.6607e-04],
        [3.7410e-04, 1.7590e-02]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0004],
        [0.0004],
        [0.0010],
        [0.0010],
        [0.0018],
        [0.0020],
        [0.0002],
        [0.0007],
        [0.0006],
        [0.0007],
        [0.0008],
        [0.0004],
        [0.0007],
        [0.0005],
        [0.0016],
        [0.0001]], device='cuda:0') / tensor([[0.0004, 0.0004, 0.0010, 0.0010, 0.0018, 0.0020, 0.0002, 0.0007, 0.0006,
         0.0007, 0.0008, 0.0004, 0.0007, 0.0005, 0.0016, 0.0001]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0001],
        [0.0013],
        [0.0386],
        [0.0241],
        [0.0037],
        [0.0495],
        [0.0106],
        [0.0006],
        [0.0095],
        [0.0007],
        [0.0030],
        [0.0003],
        [0.0015],
        [0.0011],
        [0.0427],
        [0.0100]], device='cuda:0') / tensor([[0.0001, 0.0013, 0.0386, 0.0241, 0.0037, 0.0495, 0.0106, 0.0006, 0.0095,
         0.0007, 0.0030, 0.0003, 0.0015, 0.0011, 0.0427, 0.0100]],
       device='cuda:0')
answers_probs: tensor([[0.0004, 0.0001],
        [0.0004, 0.0013],
        [0.0010, 0.0386],
        [0.0010, 0.0241],
        [0.0018, 0.0037],
        [0.0020, 0.0495],
        [0.0002, 0.0106],
        [0.0007, 0.0006],
        [0.0006, 0.0095],
        [0.0007, 0.0007],
        [0.0008, 0.0030],
        [0.0004, 0.0003],
        [0.0007, 0.0015],
        [0.0005, 0.0011],
        [0.0016, 0.0427],
        [0.0001, 0.0100]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0009],
        [0.0002],
        [0.0001],
        [0.0004],
        [0.0001],
        [0.0004],
        [0.0001],
        [0.0003],
        [0.0013],
        [0.0005],
        [0.0003],
        [0.0005],
        [0.0007],
        [0.0002],
        [0.0004],
        [0.0006]], device='cuda:0') / tensor([[0.0009, 0.0002, 0.0001, 0.0004, 0.0001, 0.0004, 0.0001, 0.0003, 0.0013,
         0.0005, 0.0003, 0.0005, 0.0007, 0.0002, 0.0004, 0.0006]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.5474e-02],
        [1.7330e-04],
        [1.1202e-05],
        [1.2365e-02],
        [9.0849e-03],
        [1.2495e-01],
        [1.0139e-02],
        [1.0908e-02],
        [2.0186e-02],
        [5.0079e-03],
        [2.1120e-02],
        [6.7132e-02],
        [6.8143e-04],
        [4.0773e-02],
        [1.6976e-03],
        [6.0755e-03]], device='cuda:0') / tensor([[2.5474e-02, 1.7330e-04, 1.1202e-05, 1.2365e-02, 9.0849e-03, 1.2495e-01,
         1.0139e-02, 1.0908e-02, 2.0186e-02, 5.0079e-03, 2.1120e-02, 6.7132e-02,
         6.8143e-04, 4.0773e-02, 1.6976e-03, 6.0755e-03]], device='cuda:0')
answers_probs: tensor([[8.7572e-04, 2.5474e-02],
        [2.2974e-04, 1.7330e-04],
        [1.1330e-04, 1.1202e-05],
        [3.8963e-04, 1.2365e-02],
        [1.1292e-04, 9.0849e-03],
        [3.9034e-04, 1.2495e-01],
        [1.4713e-04, 1.0139e-02],
        [2.5357e-04, 1.0908e-02],
        [1.2598e-03, 2.0186e-02],
        [4.6731e-04, 5.0079e-03],
        [3.0240e-04, 2.1120e-02],
        [5.2635e-04, 6.7132e-02],
        [6.7665e-04, 6.8143e-04],
        [2.4696e-04, 4.0773e-02],
        [4.2535e-04, 1.6976e-03],
        [6.0938e-04, 6.0755e-03]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0004],
        [0.0008]], device='cuda:0') / tensor([[0.0004, 0.0008]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.0007],
        [0.0029]], device='cuda:0') / tensor([[0.0007, 0.0029]], device='cuda:0')
answers_probs: tensor([[0.0004, 0.0007],
        [0.0008, 0.0029]], device='cuda:0')
acc:  0.68
Time taken to execute the de SA task with prompt type modal, variation 0 and batchsize 16: 0:03:07.474523
path ['42', 'de', 'flan', 'SA', 'modal', 'prompt_id_0']
----------- 42 de google/flan-t5-base SA modal 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 365.33it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0010],
        [0.0009],
        [0.0014],
        [0.0016],
        [0.0006],
        [0.0006],
        [0.0014],
        [0.0005],
        [0.0003],
        [0.0009],
        [0.0003],
        [0.0011],
        [0.0005],
        [0.0008],
        [0.0006],
        [0.0030]], device='cuda:0') / tensor([[0.0010, 0.0009, 0.0014, 0.0016, 0.0006, 0.0006, 0.0014, 0.0005, 0.0003,
         0.0009, 0.0003, 0.0011, 0.0005, 0.0008, 0.0006, 0.0030]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0003],
        [0.0013],
        [0.0101],
        [0.0365],
        [0.0024],
        [0.0031],
        [0.0763],
        [0.0290],
        [0.0007],
        [0.0038],
        [0.0160],
        [0.0027],
        [0.0515],
        [0.0005],
        [0.0153],
        [0.1190]], device='cuda:0') / tensor([[0.0003, 0.0013, 0.0101, 0.0365, 0.0024, 0.0031, 0.0763, 0.0290, 0.0007,
         0.0038, 0.0160, 0.0027, 0.0515, 0.0005, 0.0153, 0.1190]],
       device='cuda:0')
answers_probs: tensor([[0.0010, 0.0003],
        [0.0009, 0.0013],
        [0.0014, 0.0101],
        [0.0016, 0.0365],
        [0.0006, 0.0024],
        [0.0006, 0.0031],
        [0.0014, 0.0763],
        [0.0005, 0.0290],
        [0.0003, 0.0007],
        [0.0009, 0.0038],
        [0.0003, 0.0160],
        [0.0011, 0.0027],
        [0.0005, 0.0515],
        [0.0008, 0.0005],
        [0.0006, 0.0153],
        [0.0030, 0.1190]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0004],
        [0.0007],
        [0.0008],
        [0.0004],
        [0.0013],
        [0.0009],
        [0.0002],
        [0.0004],
        [0.0005],
        [0.0001],
        [0.0017],
        [0.0011],
        [0.0003],
        [0.0003],
        [0.0008],
        [0.0009]], device='cuda:0') / tensor([[0.0004, 0.0007, 0.0008, 0.0004, 0.0013, 0.0009, 0.0002, 0.0004, 0.0005,
         0.0001, 0.0017, 0.0011, 0.0003, 0.0003, 0.0008, 0.0009]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0001],
        [0.0788],
        [0.0957],
        [0.0006],
        [0.0009],
        [0.0454],
        [0.0103],
        [0.0160],
        [0.0123],
        [0.0096],
        [0.0697],
        [0.0272],
        [0.0344],
        [0.0165],
        [0.0006],
        [0.0002]], device='cuda:0') / tensor([[0.0001, 0.0788, 0.0957, 0.0006, 0.0009, 0.0454, 0.0103, 0.0160, 0.0123,
         0.0096, 0.0697, 0.0272, 0.0344, 0.0165, 0.0006, 0.0002]],
       device='cuda:0')
answers_probs: tensor([[0.0004, 0.0001],
        [0.0007, 0.0788],
        [0.0008, 0.0957],
        [0.0004, 0.0006],
        [0.0013, 0.0009],
        [0.0009, 0.0454],
        [0.0002, 0.0103],
        [0.0004, 0.0160],
        [0.0005, 0.0123],
        [0.0001, 0.0096],
        [0.0017, 0.0697],
        [0.0011, 0.0272],
        [0.0003, 0.0344],
        [0.0003, 0.0165],
        [0.0008, 0.0006],
        [0.0009, 0.0002]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0007],
        [0.0015],
        [0.0011],
        [0.0009],
        [0.0002],
        [0.0006],
        [0.0005],
        [0.0009],
        [0.0005],
        [0.0010],
        [0.0012],
        [0.0008],
        [0.0003],
        [0.0003],
        [0.0003],
        [0.0013]], device='cuda:0') / tensor([[0.0007, 0.0015, 0.0011, 0.0009, 0.0002, 0.0006, 0.0005, 0.0009, 0.0005,
         0.0010, 0.0012, 0.0008, 0.0003, 0.0003, 0.0003, 0.0013]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.1898e-04],
        [1.5933e-03],
        [1.2873e-02],
        [9.1931e-04],
        [1.1075e-02],
        [5.1926e-03],
        [2.7756e-02],
        [3.5789e-03],
        [1.2913e-04],
        [3.0116e-03],
        [1.1187e-02],
        [6.5705e-03],
        [5.3577e-03],
        [4.6359e-03],
        [5.9458e-05],
        [1.7076e-01]], device='cuda:0') / tensor([[3.1898e-04, 1.5933e-03, 1.2873e-02, 9.1931e-04, 1.1075e-02, 5.1926e-03,
         2.7756e-02, 3.5789e-03, 1.2913e-04, 3.0116e-03, 1.1187e-02, 6.5705e-03,
         5.3577e-03, 4.6359e-03, 5.9458e-05, 1.7076e-01]], device='cuda:0')
answers_probs: tensor([[6.8640e-04, 3.1898e-04],
        [1.5465e-03, 1.5933e-03],
        [1.0827e-03, 1.2873e-02],
        [9.0050e-04, 9.1931e-04],
        [2.3611e-04, 1.1075e-02],
        [5.8854e-04, 5.1926e-03],
        [5.0502e-04, 2.7756e-02],
        [8.6232e-04, 3.5789e-03],
        [5.2678e-04, 1.2913e-04],
        [1.0122e-03, 3.0116e-03],
        [1.1902e-03, 1.1187e-02],
        [8.3737e-04, 6.5705e-03],
        [2.6616e-04, 5.3577e-03],
        [3.1467e-04, 4.6359e-03],
        [2.5812e-04, 5.9458e-05],
        [1.2813e-03, 1.7076e-01]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0004],
        [0.0011]], device='cuda:0') / tensor([[0.0004, 0.0011]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.0002],
        [0.0020]], device='cuda:0') / tensor([[0.0002, 0.0020]], device='cuda:0')
answers_probs: tensor([[0.0004, 0.0002],
        [0.0011, 0.0020]], device='cuda:0')
acc:  0.66
Time taken to execute the de SA task with prompt type modal, variation 1 and batchsize 16: 0:03:07.731419
path ['42', 'de', 'flan', 'SA', 'modal', 'prompt_id_1']
----------- 42 de google/flan-t5-base SA modal 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 344.53it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0003],
        [0.0003],
        [0.0009],
        [0.0021],
        [0.0002],
        [0.0007],
        [0.0001],
        [0.0003],
        [0.0005],
        [0.0002],
        [0.0002],
        [0.0006],
        [0.0007],
        [0.0006],
        [0.0003],
        [0.0003]], device='cuda:0') / tensor([[0.0003, 0.0003, 0.0009, 0.0021, 0.0002, 0.0007, 0.0001, 0.0003, 0.0005,
         0.0002, 0.0002, 0.0006, 0.0007, 0.0006, 0.0003, 0.0003]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.6768e-02],
        [1.2029e-04],
        [1.1347e-02],
        [9.2710e-02],
        [1.2392e-02],
        [5.7101e-04],
        [3.0829e-04],
        [1.4662e-02],
        [2.2480e-03],
        [6.5651e-03],
        [9.6784e-05],
        [8.4808e-05],
        [1.4539e-03],
        [5.1903e-04],
        [5.0643e-04],
        [1.2378e-04]], device='cuda:0') / tensor([[3.6768e-02, 1.2029e-04, 1.1347e-02, 9.2710e-02, 1.2392e-02, 5.7101e-04,
         3.0829e-04, 1.4662e-02, 2.2480e-03, 6.5651e-03, 9.6784e-05, 8.4808e-05,
         1.4539e-03, 5.1903e-04, 5.0643e-04, 1.2378e-04]], device='cuda:0')
answers_probs: tensor([[2.8606e-04, 3.6768e-02],
        [3.2738e-04, 1.2029e-04],
        [8.5167e-04, 1.1347e-02],
        [2.1260e-03, 9.2710e-02],
        [2.0961e-04, 1.2392e-02],
        [7.4866e-04, 5.7101e-04],
        [1.3833e-04, 3.0829e-04],
        [2.5013e-04, 1.4662e-02],
        [4.9377e-04, 2.2480e-03],
        [1.7959e-04, 6.5651e-03],
        [1.5994e-04, 9.6784e-05],
        [5.7639e-04, 8.4808e-05],
        [7.1664e-04, 1.4539e-03],
        [5.5169e-04, 5.1903e-04],
        [3.0558e-04, 5.0643e-04],
        [2.8704e-04, 1.2378e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0001],
        [0.0004],
        [0.0004],
        [0.0004],
        [0.0001],
        [0.0003],
        [0.0002],
        [0.0001],
        [0.0005],
        [0.0004],
        [0.0004],
        [0.0018],
        [0.0009],
        [0.0009],
        [0.0006],
        [0.0002]], device='cuda:0') / tensor([[0.0001, 0.0004, 0.0004, 0.0004, 0.0001, 0.0003, 0.0002, 0.0001, 0.0005,
         0.0004, 0.0004, 0.0018, 0.0009, 0.0009, 0.0006, 0.0002]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.9206e-03],
        [3.4806e-02],
        [1.1420e-02],
        [2.2633e-03],
        [3.8551e-05],
        [9.6302e-04],
        [2.9212e-03],
        [7.3011e-03],
        [2.3137e-05],
        [6.6010e-02],
        [9.5568e-03],
        [1.1343e-02],
        [4.5378e-02],
        [5.8263e-04],
        [1.7510e-02],
        [1.6703e-05]], device='cuda:0') / tensor([[5.9206e-03, 3.4806e-02, 1.1420e-02, 2.2633e-03, 3.8551e-05, 9.6302e-04,
         2.9212e-03, 7.3011e-03, 2.3137e-05, 6.6010e-02, 9.5568e-03, 1.1343e-02,
         4.5378e-02, 5.8263e-04, 1.7510e-02, 1.6703e-05]], device='cuda:0')
answers_probs: tensor([[1.4116e-04, 5.9206e-03],
        [4.3189e-04, 3.4806e-02],
        [4.4377e-04, 1.1420e-02],
        [3.6035e-04, 2.2633e-03],
        [1.4382e-04, 3.8551e-05],
        [3.1200e-04, 9.6302e-04],
        [2.1489e-04, 2.9212e-03],
        [1.1257e-04, 7.3011e-03],
        [4.8102e-04, 2.3137e-05],
        [4.1664e-04, 6.6010e-02],
        [3.7293e-04, 9.5568e-03],
        [1.7725e-03, 1.1343e-02],
        [9.1448e-04, 4.5378e-02],
        [9.2339e-04, 5.8263e-04],
        [5.8647e-04, 1.7510e-02],
        [2.0368e-04, 1.6703e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[8.7191e-04],
        [9.1501e-04],
        [6.8627e-04],
        [1.4152e-04],
        [9.0507e-04],
        [8.6064e-04],
        [6.5551e-04],
        [7.8554e-04],
        [1.1165e-04],
        [5.7801e-04],
        [7.8450e-04],
        [4.2622e-04],
        [3.9519e-04],
        [1.9295e-04],
        [5.5672e-04],
        [8.5624e-05]], device='cuda:0') / tensor([[8.7191e-04, 9.1501e-04, 6.8627e-04, 1.4152e-04, 9.0507e-04, 8.6064e-04,
         6.5551e-04, 7.8554e-04, 1.1165e-04, 5.7801e-04, 7.8450e-04, 4.2622e-04,
         3.9519e-04, 1.9295e-04, 5.5672e-04, 8.5624e-05]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.2394e-02],
        [3.1942e-03],
        [7.2345e-04],
        [2.0416e-04],
        [1.6088e-02],
        [2.6811e-02],
        [4.8913e-03],
        [1.0829e-01],
        [1.3374e-05],
        [3.1679e-04],
        [3.9451e-02],
        [5.8307e-02],
        [1.6742e-03],
        [8.5330e-03],
        [4.6310e-02],
        [5.5338e-03]], device='cuda:0') / tensor([[1.2394e-02, 3.1942e-03, 7.2345e-04, 2.0416e-04, 1.6088e-02, 2.6811e-02,
         4.8913e-03, 1.0829e-01, 1.3374e-05, 3.1679e-04, 3.9451e-02, 5.8307e-02,
         1.6742e-03, 8.5330e-03, 4.6310e-02, 5.5338e-03]], device='cuda:0')
answers_probs: tensor([[8.7191e-04, 1.2394e-02],
        [9.1501e-04, 3.1942e-03],
        [6.8627e-04, 7.2345e-04],
        [1.4152e-04, 2.0416e-04],
        [9.0507e-04, 1.6088e-02],
        [8.6064e-04, 2.6811e-02],
        [6.5551e-04, 4.8913e-03],
        [7.8554e-04, 1.0829e-01],
        [1.1165e-04, 1.3374e-05],
        [5.7801e-04, 3.1679e-04],
        [7.8450e-04, 3.9451e-02],
        [4.2622e-04, 5.8307e-02],
        [3.9519e-04, 1.6742e-03],
        [1.9295e-04, 8.5330e-03],
        [5.5672e-04, 4.6310e-02],
        [8.5624e-05, 5.5338e-03]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0001],
        [0.0006]], device='cuda:0') / tensor([[0.0001, 0.0006]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[3.9083e-05],
        [3.4136e-03]], device='cuda:0') / tensor([[3.9083e-05, 3.4136e-03]], device='cuda:0')
answers_probs: tensor([[1.4648e-04, 3.9083e-05],
        [5.6148e-04, 3.4136e-03]], device='cuda:0')
acc:  0.72
Time taken to execute the de SA task with prompt type modal, variation 2 and batchsize 16: 0:03:07.365247
path ['42', 'de', 'flan', 'SA', 'modal', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de google/flan-t5-base SA rare_synonyms 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 350.28it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0006],
        [0.0006],
        [0.0008],
        [0.0005],
        [0.0009],
        [0.0009],
        [0.0005],
        [0.0003],
        [0.0005],
        [0.0008],
        [0.0006],
        [0.0003],
        [0.0008],
        [0.0012],
        [0.0012],
        [0.0002]], device='cuda:0') / tensor([[0.0006, 0.0006, 0.0008, 0.0005, 0.0009, 0.0009, 0.0005, 0.0003, 0.0005,
         0.0008, 0.0006, 0.0003, 0.0008, 0.0012, 0.0012, 0.0002]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[1.9135e-02],
        [3.8820e-03],
        [1.9942e-03],
        [7.9660e-02],
        [8.4286e-04],
        [3.5444e-03],
        [3.1811e-04],
        [2.5944e-04],
        [3.9952e-03],
        [1.6901e-04],
        [6.7127e-04],
        [4.1742e-02],
        [5.1894e-03],
        [7.1172e-03],
        [7.3559e-02],
        [6.3595e-05]], device='cuda:0') / tensor([[1.9135e-02, 3.8820e-03, 1.9942e-03, 7.9660e-02, 8.4286e-04, 3.5444e-03,
         3.1811e-04, 2.5944e-04, 3.9952e-03, 1.6901e-04, 6.7127e-04, 4.1742e-02,
         5.1894e-03, 7.1172e-03, 7.3559e-02, 6.3595e-05]], device='cuda:0')
answers_probs: tensor([[5.8590e-04, 1.9135e-02],
        [5.9025e-04, 3.8820e-03],
        [8.3661e-04, 1.9942e-03],
        [4.8602e-04, 7.9660e-02],
        [8.9866e-04, 8.4286e-04],
        [8.7930e-04, 3.5444e-03],
        [5.1771e-04, 3.1811e-04],
        [2.5044e-04, 2.5944e-04],
        [4.5057e-04, 3.9952e-03],
        [8.2077e-04, 1.6901e-04],
        [5.9260e-04, 6.7127e-04],
        [3.0211e-04, 4.1742e-02],
        [7.7299e-04, 5.1894e-03],
        [1.2007e-03, 7.1172e-03],
        [1.1990e-03, 7.3559e-02],
        [2.2144e-04, 6.3595e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0005],
        [0.0005],
        [0.0017],
        [0.0005],
        [0.0007],
        [0.0001],
        [0.0012],
        [0.0003],
        [0.0009],
        [0.0009],
        [0.0002],
        [0.0006],
        [0.0010],
        [0.0007],
        [0.0004],
        [0.0003]], device='cuda:0') / tensor([[0.0005, 0.0005, 0.0017, 0.0005, 0.0007, 0.0001, 0.0012, 0.0003, 0.0009,
         0.0009, 0.0002, 0.0006, 0.0010, 0.0007, 0.0004, 0.0003]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.6123e-02],
        [1.6085e-04],
        [1.1725e-01],
        [2.2827e-03],
        [6.4526e-02],
        [2.3019e-05],
        [3.0786e-02],
        [7.7146e-03],
        [7.2663e-03],
        [1.8723e-01],
        [1.1462e-02],
        [1.2748e-01],
        [7.7394e-04],
        [1.0000e-03],
        [5.0634e-04],
        [2.4203e-02]], device='cuda:0') / tensor([[2.6123e-02, 1.6085e-04, 1.1725e-01, 2.2827e-03, 6.4526e-02, 2.3019e-05,
         3.0786e-02, 7.7146e-03, 7.2663e-03, 1.8723e-01, 1.1462e-02, 1.2748e-01,
         7.7394e-04, 1.0000e-03, 5.0634e-04, 2.4203e-02]], device='cuda:0')
answers_probs: tensor([[4.7108e-04, 2.6123e-02],
        [4.6590e-04, 1.6085e-04],
        [1.6508e-03, 1.1725e-01],
        [5.4321e-04, 2.2827e-03],
        [6.8855e-04, 6.4526e-02],
        [1.4989e-04, 2.3019e-05],
        [1.2017e-03, 3.0786e-02],
        [3.1506e-04, 7.7146e-03],
        [8.8069e-04, 7.2663e-03],
        [9.3560e-04, 1.8723e-01],
        [1.9669e-04, 1.1462e-02],
        [6.3834e-04, 1.2748e-01],
        [9.7277e-04, 7.7394e-04],
        [7.1101e-04, 1.0000e-03],
        [3.9840e-04, 5.0634e-04],
        [3.3494e-04, 2.4203e-02]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0009],
        [0.0008],
        [0.0020],
        [0.0013],
        [0.0004],
        [0.0008],
        [0.0005],
        [0.0012],
        [0.0003],
        [0.0003],
        [0.0021],
        [0.0005],
        [0.0020],
        [0.0025],
        [0.0002],
        [0.0009]], device='cuda:0') / tensor([[0.0009, 0.0008, 0.0020, 0.0013, 0.0004, 0.0008, 0.0005, 0.0012, 0.0003,
         0.0003, 0.0021, 0.0005, 0.0020, 0.0025, 0.0002, 0.0009]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0002],
        [0.0768],
        [0.0037],
        [0.0237],
        [0.0014],
        [0.0007],
        [0.0005],
        [0.0385],
        [0.0042],
        [0.0164],
        [0.0121],
        [0.0199],
        [0.0335],
        [0.0710],
        [0.0003],
        [0.0137]], device='cuda:0') / tensor([[0.0002, 0.0768, 0.0037, 0.0237, 0.0014, 0.0007, 0.0005, 0.0385, 0.0042,
         0.0164, 0.0121, 0.0199, 0.0335, 0.0710, 0.0003, 0.0137]],
       device='cuda:0')
answers_probs: tensor([[0.0009, 0.0002],
        [0.0008, 0.0768],
        [0.0020, 0.0037],
        [0.0013, 0.0237],
        [0.0004, 0.0014],
        [0.0008, 0.0007],
        [0.0005, 0.0005],
        [0.0012, 0.0385],
        [0.0003, 0.0042],
        [0.0003, 0.0164],
        [0.0021, 0.0121],
        [0.0005, 0.0199],
        [0.0020, 0.0335],
        [0.0025, 0.0710],
        [0.0002, 0.0003],
        [0.0009, 0.0137]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[5.9589e-07],
        [2.4478e-04]], device='cuda:0') / tensor([[5.9589e-07, 2.4478e-04]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[4.0846e-06],
        [2.4185e-03]], device='cuda:0') / tensor([[4.0846e-06, 2.4185e-03]], device='cuda:0')
answers_probs: tensor([[5.9589e-07, 4.0846e-06],
        [2.4478e-04, 2.4185e-03]], device='cuda:0')
acc:  0.68
Time taken to execute the de SA task with prompt type rare_synonyms, variation 0 and batchsize 16: 0:03:06.908299
path ['42', 'de', 'flan', 'SA', 'rare_synonyms', 'prompt_id_0']
----------- 42 de google/flan-t5-base SA rare_synonyms 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 365.05it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0017],
        [0.0002],
        [0.0005],
        [0.0013],
        [0.0023],
        [0.0022],
        [0.0005],
        [0.0006],
        [0.0005],
        [0.0008],
        [0.0010],
        [0.0014],
        [0.0008],
        [0.0003],
        [0.0012],
        [0.0025]], device='cuda:0') / tensor([[0.0017, 0.0002, 0.0005, 0.0013, 0.0023, 0.0022, 0.0005, 0.0006, 0.0005,
         0.0008, 0.0010, 0.0014, 0.0008, 0.0003, 0.0012, 0.0025]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[5.9204e-02],
        [1.2368e-02],
        [1.7900e-02],
        [3.2360e-02],
        [3.0468e-02],
        [9.1440e-03],
        [9.9266e-05],
        [2.0991e-02],
        [1.5006e-01],
        [5.1964e-04],
        [5.1216e-04],
        [3.1698e-03],
        [2.7692e-04],
        [1.4486e-04],
        [1.3995e-02],
        [4.6605e-03]], device='cuda:0') / tensor([[5.9204e-02, 1.2368e-02, 1.7900e-02, 3.2360e-02, 3.0468e-02, 9.1440e-03,
         9.9266e-05, 2.0991e-02, 1.5006e-01, 5.1964e-04, 5.1216e-04, 3.1698e-03,
         2.7692e-04, 1.4486e-04, 1.3995e-02, 4.6605e-03]], device='cuda:0')
answers_probs: tensor([[1.7171e-03, 5.9204e-02],
        [1.8179e-04, 1.2368e-02],
        [4.9671e-04, 1.7900e-02],
        [1.2804e-03, 3.2360e-02],
        [2.2673e-03, 3.0468e-02],
        [2.1702e-03, 9.1440e-03],
        [5.1971e-04, 9.9266e-05],
        [5.8266e-04, 2.0991e-02],
        [5.2818e-04, 1.5006e-01],
        [8.2897e-04, 5.1964e-04],
        [1.0167e-03, 5.1216e-04],
        [1.3712e-03, 3.1698e-03],
        [8.1543e-04, 2.7692e-04],
        [2.6322e-04, 1.4486e-04],
        [1.1579e-03, 1.3995e-02],
        [2.5123e-03, 4.6605e-03]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0004],
        [0.0011],
        [0.0002],
        [0.0013],
        [0.0005],
        [0.0011],
        [0.0004],
        [0.0016],
        [0.0002],
        [0.0003],
        [0.0003],
        [0.0004],
        [0.0005],
        [0.0003],
        [0.0009],
        [0.0003]], device='cuda:0') / tensor([[0.0004, 0.0011, 0.0002, 0.0013, 0.0005, 0.0011, 0.0004, 0.0016, 0.0002,
         0.0003, 0.0003, 0.0004, 0.0005, 0.0003, 0.0009, 0.0003]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[6.0696e-02],
        [4.8049e-03],
        [1.5502e-02],
        [1.0335e-04],
        [2.4071e-04],
        [3.6214e-02],
        [1.4024e-02],
        [2.5641e-02],
        [1.3426e-02],
        [1.3369e-02],
        [2.0989e-05],
        [1.9893e-02],
        [1.2359e-04],
        [1.1067e-04],
        [3.1088e-03],
        [4.7579e-04]], device='cuda:0') / tensor([[6.0696e-02, 4.8049e-03, 1.5502e-02, 1.0335e-04, 2.4071e-04, 3.6214e-02,
         1.4024e-02, 2.5641e-02, 1.3426e-02, 1.3369e-02, 2.0989e-05, 1.9893e-02,
         1.2359e-04, 1.1067e-04, 3.1088e-03, 4.7579e-04]], device='cuda:0')
answers_probs: tensor([[3.7661e-04, 6.0696e-02],
        [1.0817e-03, 4.8049e-03],
        [1.9688e-04, 1.5502e-02],
        [1.2689e-03, 1.0335e-04],
        [4.9051e-04, 2.4071e-04],
        [1.1307e-03, 3.6214e-02],
        [4.4325e-04, 1.4024e-02],
        [1.5656e-03, 2.5641e-02],
        [1.8157e-04, 1.3426e-02],
        [2.5155e-04, 1.3369e-02],
        [2.8170e-04, 2.0989e-05],
        [3.8458e-04, 1.9893e-02],
        [5.4740e-04, 1.2359e-04],
        [3.1927e-04, 1.1067e-04],
        [8.6586e-04, 3.1088e-03],
        [3.0691e-04, 4.7579e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0011],
        [0.0011],
        [0.0031],
        [0.0006],
        [0.0002],
        [0.0007],
        [0.0014],
        [0.0011],
        [0.0009],
        [0.0005],
        [0.0007],
        [0.0018],
        [0.0007],
        [0.0006],
        [0.0004],
        [0.0011]], device='cuda:0') / tensor([[0.0011, 0.0011, 0.0031, 0.0006, 0.0002, 0.0007, 0.0014, 0.0011, 0.0009,
         0.0005, 0.0007, 0.0018, 0.0007, 0.0006, 0.0004, 0.0011]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.9401e-03],
        [1.5777e-03],
        [8.6197e-02],
        [4.7326e-02],
        [8.1997e-06],
        [2.5601e-04],
        [2.9935e-02],
        [1.7583e-01],
        [7.5851e-02],
        [1.4641e-03],
        [1.0242e-01],
        [9.6589e-02],
        [1.9164e-03],
        [7.2143e-04],
        [3.3077e-03],
        [5.2519e-04]], device='cuda:0') / tensor([[2.9401e-03, 1.5777e-03, 8.6197e-02, 4.7326e-02, 8.1997e-06, 2.5601e-04,
         2.9935e-02, 1.7583e-01, 7.5851e-02, 1.4641e-03, 1.0242e-01, 9.6589e-02,
         1.9164e-03, 7.2143e-04, 3.3077e-03, 5.2519e-04]], device='cuda:0')
answers_probs: tensor([[1.0822e-03, 2.9401e-03],
        [1.1280e-03, 1.5777e-03],
        [3.1376e-03, 8.6197e-02],
        [5.9865e-04, 4.7326e-02],
        [1.5298e-04, 8.1997e-06],
        [7.0707e-04, 2.5601e-04],
        [1.3904e-03, 2.9935e-02],
        [1.0865e-03, 1.7583e-01],
        [8.6102e-04, 7.5851e-02],
        [5.4935e-04, 1.4641e-03],
        [7.0405e-04, 1.0242e-01],
        [1.8177e-03, 9.6589e-02],
        [7.2287e-04, 1.9164e-03],
        [5.6127e-04, 7.2143e-04],
        [3.6590e-04, 3.3077e-03],
        [1.1242e-03, 5.2519e-04]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0017],
        [0.0007]], device='cuda:0') / tensor([[0.0017, 0.0007]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.3777],
        [0.0009]], device='cuda:0') / tensor([[0.3777, 0.0009]], device='cuda:0')
answers_probs: tensor([[0.0017, 0.3777],
        [0.0007, 0.0009]], device='cuda:0')
acc:  0.76
Time taken to execute the de SA task with prompt type rare_synonyms, variation 1 and batchsize 16: 0:03:07.742491
path ['42', 'de', 'flan', 'SA', 'rare_synonyms', 'prompt_id_1']
----------- 42 de google/flan-t5-base SA rare_synonyms 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 300.63it/s]
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0012],
        [0.0002],
        [0.0010],
        [0.0005],
        [0.0007],
        [0.0003],
        [0.0009],
        [0.0005],
        [0.0004],
        [0.0007],
        [0.0007],
        [0.0030],
        [0.0012],
        [0.0003],
        [0.0004],
        [0.0004]], device='cuda:0') / tensor([[0.0012, 0.0002, 0.0010, 0.0005, 0.0007, 0.0003, 0.0009, 0.0005, 0.0004,
         0.0007, 0.0007, 0.0030, 0.0012, 0.0003, 0.0004, 0.0004]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[3.5950e-02],
        [3.6084e-05],
        [2.0595e-02],
        [2.3205e-04],
        [2.7653e-03],
        [2.2593e-02],
        [8.6459e-04],
        [2.9668e-02],
        [4.8764e-04],
        [5.8400e-02],
        [6.1375e-04],
        [1.2879e-01],
        [5.5687e-03],
        [2.4088e-04],
        [6.3008e-02],
        [3.7181e-02]], device='cuda:0') / tensor([[3.5950e-02, 3.6084e-05, 2.0595e-02, 2.3205e-04, 2.7653e-03, 2.2593e-02,
         8.6459e-04, 2.9668e-02, 4.8764e-04, 5.8400e-02, 6.1375e-04, 1.2879e-01,
         5.5687e-03, 2.4088e-04, 6.3008e-02, 3.7181e-02]], device='cuda:0')
answers_probs: tensor([[1.1998e-03, 3.5950e-02],
        [1.6616e-04, 3.6084e-05],
        [1.0234e-03, 2.0595e-02],
        [4.5517e-04, 2.3205e-04],
        [6.6404e-04, 2.7653e-03],
        [2.7036e-04, 2.2593e-02],
        [8.5942e-04, 8.6459e-04],
        [4.8850e-04, 2.9668e-02],
        [3.9649e-04, 4.8764e-04],
        [7.4406e-04, 5.8400e-02],
        [6.7350e-04, 6.1375e-04],
        [2.9672e-03, 1.2879e-01],
        [1.2338e-03, 5.5687e-03],
        [2.9073e-04, 2.4088e-04],
        [3.9647e-04, 6.3008e-02],
        [3.5602e-04, 3.7181e-02]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0009],
        [0.0006],
        [0.0005],
        [0.0018],
        [0.0009],
        [0.0005],
        [0.0014],
        [0.0003],
        [0.0003],
        [0.0005],
        [0.0002],
        [0.0010],
        [0.0009],
        [0.0007],
        [0.0007],
        [0.0017]], device='cuda:0') / tensor([[0.0009, 0.0006, 0.0005, 0.0018, 0.0009, 0.0005, 0.0014, 0.0003, 0.0003,
         0.0005, 0.0002, 0.0010, 0.0009, 0.0007, 0.0007, 0.0017]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[0.0006],
        [0.0017],
        [0.1295],
        [0.0027],
        [0.0017],
        [0.0185],
        [0.0352],
        [0.0054],
        [0.0042],
        [0.1531],
        [0.0003],
        [0.0007],
        [0.0009],
        [0.0256],
        [0.0733],
        [0.0094]], device='cuda:0') / tensor([[0.0006, 0.0017, 0.1295, 0.0027, 0.0017, 0.0185, 0.0352, 0.0054, 0.0042,
         0.1531, 0.0003, 0.0007, 0.0009, 0.0256, 0.0733, 0.0094]],
       device='cuda:0')
answers_probs: tensor([[0.0009, 0.0006],
        [0.0006, 0.0017],
        [0.0005, 0.1295],
        [0.0018, 0.0027],
        [0.0009, 0.0017],
        [0.0005, 0.0185],
        [0.0014, 0.0352],
        [0.0003, 0.0054],
        [0.0003, 0.0042],
        [0.0005, 0.1531],
        [0.0002, 0.0003],
        [0.0010, 0.0007],
        [0.0009, 0.0009],
        [0.0007, 0.0256],
        [0.0007, 0.0733],
        [0.0017, 0.0094]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([16, 1])
id: [2662] -> tensor([[0.0009],
        [0.0007],
        [0.0010],
        [0.0028],
        [0.0013],
        [0.0015],
        [0.0002],
        [0.0004],
        [0.0007],
        [0.0006],
        [0.0003],
        [0.0008],
        [0.0005],
        [0.0008],
        [0.0008],
        [0.0005]], device='cuda:0') / tensor([[0.0009, 0.0007, 0.0010, 0.0028, 0.0013, 0.0015, 0.0002, 0.0004, 0.0007,
         0.0006, 0.0003, 0.0008, 0.0005, 0.0008, 0.0008, 0.0005]],
       device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([16, 1])
id: [23607] -> tensor([[2.3174e-03],
        [2.9110e-03],
        [2.3969e-04],
        [4.9952e-02],
        [5.4134e-02],
        [1.4540e-02],
        [2.2510e-02],
        [4.4574e-04],
        [6.8073e-02],
        [2.3762e-03],
        [6.4114e-05],
        [1.7669e-01],
        [3.7179e-02],
        [6.4704e-03],
        [2.2925e-04],
        [2.5921e-04]], device='cuda:0') / tensor([[2.3174e-03, 2.9110e-03, 2.3969e-04, 4.9952e-02, 5.4134e-02, 1.4540e-02,
         2.2510e-02, 4.4574e-04, 6.8073e-02, 2.3762e-03, 6.4114e-05, 1.7669e-01,
         3.7179e-02, 6.4704e-03, 2.2925e-04, 2.5921e-04]], device='cuda:0')
answers_probs: tensor([[9.3789e-04, 2.3174e-03],
        [7.1082e-04, 2.9110e-03],
        [9.6070e-04, 2.3969e-04],
        [2.8074e-03, 4.9952e-02],
        [1.2926e-03, 5.4134e-02],
        [1.4998e-03, 1.4540e-02],
        [2.4847e-04, 2.2510e-02],
        [4.4521e-04, 4.4574e-04],
        [7.2460e-04, 6.8073e-02],
        [5.8535e-04, 2.3762e-03],
        [2.8295e-04, 6.4114e-05],
        [7.8421e-04, 1.7669e-01],
        [5.0677e-04, 3.7179e-02],
        [8.3901e-04, 6.4704e-03],
        [8.3760e-04, 2.2925e-04],
        [5.3035e-04, 2.5921e-04]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
probs_ shape torch.Size([2, 1])
id: [2662] -> tensor([[0.0016],
        [0.0005]], device='cuda:0') / tensor([[0.0016, 0.0005]], device='cuda:0')
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
probs_ shape torch.Size([2, 1])
id: [23607] -> tensor([[0.1048],
        [0.0041]], device='cuda:0') / tensor([[0.1048, 0.0041]], device='cuda:0')
answers_probs: tensor([[0.0016, 0.1048],
        [0.0005, 0.0041]], device='cuda:0')
acc:  0.7
Time taken to execute the de SA task with prompt type rare_synonyms, variation 2 and batchsize 16: 0:03:07.211960
path ['42', 'de', 'flan', 'SA', 'rare_synonyms', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.58s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.45s/it]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
----------- 42 de huggyllama/llama-7b NLI active 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 273.92it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[8.7142e-05],
        [1.3888e-05],
        [7.4387e-05],
        [4.8280e-05],
        [7.2539e-05],
        [1.0574e-04],
        [2.0742e-04],
        [2.0027e-04],
        [2.3782e-05],
        [1.3936e-04],
        [2.0278e-04],
        [4.6992e-04],
        [1.0270e-04],
        [9.8407e-05],
        [6.2585e-05],
        [1.0151e-04]], device='cuda:0', dtype=torch.float16)/tensor([[8.7142e-05, 1.3888e-05, 7.4387e-05, 4.8280e-05, 7.2539e-05, 1.0574e-04,
         2.0742e-04, 2.0027e-04, 2.3782e-05, 1.3936e-04, 2.0278e-04, 4.6992e-04,
         1.0270e-04, 9.8407e-05, 6.2585e-05, 1.0151e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([4.5121e-05, 2.1577e-05, 5.6326e-05, 3.7432e-05, 3.4451e-05, 4.7982e-05,
        9.6023e-05, 7.8559e-05, 3.7789e-05, 5.4061e-05, 7.9691e-05, 7.4208e-05,
        4.1842e-05, 4.9531e-05, 4.7147e-05, 2.9087e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.6286e-05, 1.0073e-05, 2.9683e-05, 1.5378e-05, 1.2219e-05, 2.9027e-05,
        7.4208e-05, 5.0426e-05, 9.0599e-06, 5.5969e-05, 3.5405e-05, 2.3067e-05,
        3.8385e-05, 2.0981e-05, 5.0664e-05, 2.4796e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[8.7142e-05, 4.5121e-05, 2.6286e-05],
        [1.3888e-05, 2.1577e-05, 1.0073e-05],
        [7.4387e-05, 5.6326e-05, 2.9683e-05],
        [4.8280e-05, 3.7432e-05, 1.5378e-05],
        [7.2539e-05, 3.4451e-05, 1.2219e-05],
        [1.0574e-04, 4.7982e-05, 2.9027e-05],
        [2.0742e-04, 9.6023e-05, 7.4208e-05],
        [2.0027e-04, 7.8559e-05, 5.0426e-05],
        [2.3782e-05, 3.7789e-05, 9.0599e-06],
        [1.3936e-04, 5.4061e-05, 5.5969e-05],
        [2.0278e-04, 7.9691e-05, 3.5405e-05],
        [4.6992e-04, 7.4208e-05, 2.3067e-05],
        [1.0270e-04, 4.1842e-05, 3.8385e-05],
        [9.8407e-05, 4.9531e-05, 2.0981e-05],
        [6.2585e-05, 4.7147e-05, 5.0664e-05],
        [1.0151e-04, 2.9087e-05, 2.4796e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[2.1362e-04],
        [1.1575e-04],
        [9.6619e-05],
        [2.4617e-05],
        [2.7895e-05],
        [4.0472e-05],
        [4.2319e-05],
        [3.0041e-05],
        [7.3195e-05],
        [1.4627e-04],
        [1.6606e-04],
        [1.3900e-04],
        [3.3617e-04],
        [2.9564e-05],
        [7.1108e-05],
        [6.1572e-05]], device='cuda:0', dtype=torch.float16)/tensor([[2.1362e-04, 1.1575e-04, 9.6619e-05, 2.4617e-05, 2.7895e-05, 4.0472e-05,
         4.2319e-05, 3.0041e-05, 7.3195e-05, 1.4627e-04, 1.6606e-04, 1.3900e-04,
         3.3617e-04, 2.9564e-05, 7.1108e-05, 6.1572e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([9.1016e-05, 5.2691e-05, 4.7028e-05, 3.0637e-05, 1.9789e-05, 4.6074e-05,
        2.9862e-05, 2.9564e-05, 4.2915e-05, 7.5877e-05, 5.5134e-05, 3.9160e-05,
        1.2410e-04, 1.8001e-05, 7.5459e-05, 2.5034e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([4.3273e-05, 2.6762e-05, 3.2902e-05, 1.3947e-05, 1.2398e-05, 1.3053e-05,
        2.9922e-05, 6.7353e-06, 1.7405e-05, 5.3465e-05, 4.8101e-05, 1.1444e-05,
        6.2764e-05, 7.2718e-06, 2.0266e-05, 2.3365e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.1362e-04, 9.1016e-05, 4.3273e-05],
        [1.1575e-04, 5.2691e-05, 2.6762e-05],
        [9.6619e-05, 4.7028e-05, 3.2902e-05],
        [2.4617e-05, 3.0637e-05, 1.3947e-05],
        [2.7895e-05, 1.9789e-05, 1.2398e-05],
        [4.0472e-05, 4.6074e-05, 1.3053e-05],
        [4.2319e-05, 2.9862e-05, 2.9922e-05],
        [3.0041e-05, 2.9564e-05, 6.7353e-06],
        [7.3195e-05, 4.2915e-05, 1.7405e-05],
        [1.4627e-04, 7.5877e-05, 5.3465e-05],
        [1.6606e-04, 5.5134e-05, 4.8101e-05],
        [1.3900e-04, 3.9160e-05, 1.1444e-05],
        [3.3617e-04, 1.2410e-04, 6.2764e-05],
        [2.9564e-05, 1.8001e-05, 7.2718e-06],
        [7.1108e-05, 7.5459e-05, 2.0266e-05],
        [6.1572e-05, 2.5034e-05, 2.3365e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.7905e-04],
        [4.2260e-05],
        [3.4451e-05],
        [2.4915e-04],
        [6.5374e-04],
        [1.5450e-04],
        [4.6194e-05],
        [3.2246e-05],
        [6.0856e-05],
        [3.2842e-05],
        [3.1471e-05],
        [4.5419e-05],
        [9.6321e-05],
        [5.7638e-05],
        [1.4985e-04],
        [9.5546e-05]], device='cuda:0', dtype=torch.float16)/tensor([[1.7905e-04, 4.2260e-05, 3.4451e-05, 2.4915e-04, 6.5374e-04, 1.5450e-04,
         4.6194e-05, 3.2246e-05, 6.0856e-05, 3.2842e-05, 3.1471e-05, 4.5419e-05,
         9.6321e-05, 5.7638e-05, 1.4985e-04, 9.5546e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([5.7995e-05, 4.4882e-05, 3.8683e-05, 1.1265e-04, 1.7464e-04, 6.8784e-05,
        2.3961e-05, 2.4021e-05, 4.8578e-05, 2.1696e-05, 2.0087e-05, 3.6359e-05,
        7.6771e-05, 4.8995e-05, 7.4506e-05, 7.4744e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([4.7266e-05, 3.0279e-05, 1.0371e-05, 1.1814e-04, 6.9380e-05, 2.5928e-05,
        1.0967e-05, 1.2100e-05, 1.1861e-05, 6.1989e-06, 8.2850e-06, 1.6093e-05,
        4.5061e-05, 2.7537e-05, 4.0650e-05, 2.6524e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.7905e-04, 5.7995e-05, 4.7266e-05],
        [4.2260e-05, 4.4882e-05, 3.0279e-05],
        [3.4451e-05, 3.8683e-05, 1.0371e-05],
        [2.4915e-04, 1.1265e-04, 1.1814e-04],
        [6.5374e-04, 1.7464e-04, 6.9380e-05],
        [1.5450e-04, 6.8784e-05, 2.5928e-05],
        [4.6194e-05, 2.3961e-05, 1.0967e-05],
        [3.2246e-05, 2.4021e-05, 1.2100e-05],
        [6.0856e-05, 4.8578e-05, 1.1861e-05],
        [3.2842e-05, 2.1696e-05, 6.1989e-06],
        [3.1471e-05, 2.0087e-05, 8.2850e-06],
        [4.5419e-05, 3.6359e-05, 1.6093e-05],
        [9.6321e-05, 7.6771e-05, 4.5061e-05],
        [5.7638e-05, 4.8995e-05, 2.7537e-05],
        [1.4985e-04, 7.4506e-05, 4.0650e-05],
        [9.5546e-05, 7.4744e-05, 2.6524e-05]], device='cuda:0')
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type active, variation 0 and batchsize 16: 0:02:46.753359
path ['42', 'de', 'llama', 'NLI', 'active', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI active 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 273.93it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.6868e-05],
        [7.0751e-05],
        [2.7955e-05],
        [8.6784e-05],
        [6.0916e-05],
        [6.8665e-05],
        [3.3879e-04],
        [5.0485e-05],
        [3.5346e-05],
        [2.5094e-05],
        [2.5940e-04],
        [1.3661e-04],
        [6.3956e-05],
        [3.7909e-05],
        [4.2498e-05],
        [2.0373e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.6868e-05, 7.0751e-05, 2.7955e-05, 8.6784e-05, 6.0916e-05, 6.8665e-05,
         3.3879e-04, 5.0485e-05, 3.5346e-05, 2.5094e-05, 2.5940e-04, 1.3661e-04,
         6.3956e-05, 3.7909e-05, 4.2498e-05, 2.0373e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.2352e-05, 2.6286e-05, 2.5153e-05, 3.2365e-05, 4.6194e-05, 7.1108e-05,
        1.8311e-04, 3.6120e-05, 3.1471e-05, 1.7226e-05, 1.0854e-04, 5.3465e-05,
        2.8551e-05, 2.7239e-05, 3.3617e-05, 9.5367e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([4.8876e-06, 1.3113e-05, 4.8876e-06, 1.5259e-05, 1.3769e-05, 1.1206e-05,
        3.9577e-05, 8.5235e-06, 7.8082e-06, 4.2915e-06, 4.1187e-05, 3.3736e-05,
        1.4901e-05, 6.1989e-06, 1.2994e-05, 4.6611e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.6868e-05, 2.2352e-05, 4.8876e-06],
        [7.0751e-05, 2.6286e-05, 1.3113e-05],
        [2.7955e-05, 2.5153e-05, 4.8876e-06],
        [8.6784e-05, 3.2365e-05, 1.5259e-05],
        [6.0916e-05, 4.6194e-05, 1.3769e-05],
        [6.8665e-05, 7.1108e-05, 1.1206e-05],
        [3.3879e-04, 1.8311e-04, 3.9577e-05],
        [5.0485e-05, 3.6120e-05, 8.5235e-06],
        [3.5346e-05, 3.1471e-05, 7.8082e-06],
        [2.5094e-05, 1.7226e-05, 4.2915e-06],
        [2.5940e-04, 1.0854e-04, 4.1187e-05],
        [1.3661e-04, 5.3465e-05, 3.3736e-05],
        [6.3956e-05, 2.8551e-05, 1.4901e-05],
        [3.7909e-05, 2.7239e-05, 6.1989e-06],
        [4.2498e-05, 3.3617e-05, 1.2994e-05],
        [2.0373e-04, 9.5367e-05, 4.6611e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[8.1480e-05],
        [4.2796e-05],
        [5.8293e-05],
        [2.2471e-05],
        [2.7895e-05],
        [3.0518e-05],
        [7.5936e-05],
        [7.0095e-05],
        [2.8849e-05],
        [6.5625e-05],
        [1.7893e-04],
        [4.5478e-05],
        [1.3864e-04],
        [1.3590e-05],
        [2.8491e-05],
        [3.7730e-05]], device='cuda:0', dtype=torch.float16)/tensor([[8.1480e-05, 4.2796e-05, 5.8293e-05, 2.2471e-05, 2.7895e-05, 3.0518e-05,
         7.5936e-05, 7.0095e-05, 2.8849e-05, 6.5625e-05, 1.7893e-04, 4.5478e-05,
         1.3864e-04, 1.3590e-05, 2.8491e-05, 3.7730e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([5.5552e-05, 2.5392e-05, 4.2796e-05, 1.4603e-05, 3.2663e-05, 2.3782e-05,
        9.0778e-05, 4.6849e-05, 1.4424e-05, 4.0174e-05, 5.2392e-05, 3.0398e-05,
        6.5684e-05, 8.8811e-06, 1.9848e-05, 2.9445e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.6464e-05, 8.0466e-06, 9.4771e-06, 3.5167e-06, 9.7752e-06, 6.8545e-06,
        3.1531e-05, 1.3709e-05, 5.8413e-06, 1.1563e-05, 2.6405e-05, 8.1062e-06,
        8.0705e-05, 2.3842e-06, 5.5432e-06, 8.7023e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[8.1480e-05, 5.5552e-05, 2.6464e-05],
        [4.2796e-05, 2.5392e-05, 8.0466e-06],
        [5.8293e-05, 4.2796e-05, 9.4771e-06],
        [2.2471e-05, 1.4603e-05, 3.5167e-06],
        [2.7895e-05, 3.2663e-05, 9.7752e-06],
        [3.0518e-05, 2.3782e-05, 6.8545e-06],
        [7.5936e-05, 9.0778e-05, 3.1531e-05],
        [7.0095e-05, 4.6849e-05, 1.3709e-05],
        [2.8849e-05, 1.4424e-05, 5.8413e-06],
        [6.5625e-05, 4.0174e-05, 1.1563e-05],
        [1.7893e-04, 5.2392e-05, 2.6405e-05],
        [4.5478e-05, 3.0398e-05, 8.1062e-06],
        [1.3864e-04, 6.5684e-05, 8.0705e-05],
        [1.3590e-05, 8.8811e-06, 2.3842e-06],
        [2.8491e-05, 1.9848e-05, 5.5432e-06],
        [3.7730e-05, 2.9445e-05, 8.7023e-06]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[9.1612e-05],
        [6.1572e-05],
        [2.2113e-05],
        [6.0558e-05],
        [4.5538e-05],
        [6.0380e-05],
        [1.6332e-05],
        [5.6565e-05],
        [4.8280e-05],
        [3.5107e-05],
        [3.9518e-05],
        [5.0247e-05],
        [3.1710e-05],
        [4.2796e-05],
        [7.4446e-05],
        [4.3213e-05]], device='cuda:0', dtype=torch.float16)/tensor([[9.1612e-05, 6.1572e-05, 2.2113e-05, 6.0558e-05, 4.5538e-05, 6.0380e-05,
         1.6332e-05, 5.6565e-05, 4.8280e-05, 3.5107e-05, 3.9518e-05, 5.0247e-05,
         3.1710e-05, 4.2796e-05, 7.4446e-05, 4.3213e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([6.7711e-05, 3.3677e-05, 1.1742e-05, 5.4300e-05, 2.4557e-05, 3.1292e-05,
        1.1027e-05, 4.6194e-05, 4.0412e-05, 2.8908e-05, 4.2498e-05, 2.9743e-05,
        1.7047e-05, 2.8551e-05, 7.8678e-05, 3.3975e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.3292e-05, 1.2279e-05, 3.5763e-06, 1.5557e-05, 8.4639e-06, 1.5080e-05,
        3.0994e-06, 1.4663e-05, 7.0333e-06, 7.0333e-06, 6.6757e-06, 4.0531e-06,
        5.2452e-06, 1.1623e-05, 1.2934e-05, 8.6427e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[9.1612e-05, 6.7711e-05, 1.3292e-05],
        [6.1572e-05, 3.3677e-05, 1.2279e-05],
        [2.2113e-05, 1.1742e-05, 3.5763e-06],
        [6.0558e-05, 5.4300e-05, 1.5557e-05],
        [4.5538e-05, 2.4557e-05, 8.4639e-06],
        [6.0380e-05, 3.1292e-05, 1.5080e-05],
        [1.6332e-05, 1.1027e-05, 3.0994e-06],
        [5.6565e-05, 4.6194e-05, 1.4663e-05],
        [4.8280e-05, 4.0412e-05, 7.0333e-06],
        [3.5107e-05, 2.8908e-05, 7.0333e-06],
        [3.9518e-05, 4.2498e-05, 6.6757e-06],
        [5.0247e-05, 2.9743e-05, 4.0531e-06],
        [3.1710e-05, 1.7047e-05, 5.2452e-06],
        [4.2796e-05, 2.8551e-05, 1.1623e-05],
        [7.4446e-05, 7.8678e-05, 1.2934e-05],
        [4.3213e-05, 3.3975e-05, 8.6427e-06]], device='cuda:0')
acc:  0.3541666666666667
Time taken to execute the de NLI task with prompt type active, variation 1 and batchsize 16: 0:02:46.366376
path ['42', 'de', 'llama', 'NLI', 'active', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI active 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 352.58it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0120],
        [0.0606],
        [0.0050],
        [0.0027],
        [0.0114],
        [0.0215],
        [0.0447],
        [0.0007],
        [0.0047],
        [0.0012],
        [0.0892],
        [0.0022],
        [0.0023],
        [0.0271],
        [0.0084],
        [0.0008]], device='cuda:0', dtype=torch.float16)/tensor([[0.0120, 0.0606, 0.0050, 0.0027, 0.0114, 0.0215, 0.0447, 0.0007, 0.0047,
         0.0012, 0.0892, 0.0022, 0.0023, 0.0271, 0.0084, 0.0008]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([0.0015, 0.0025, 0.0008, 0.0005, 0.0015, 0.0025, 0.0043, 0.0004, 0.0011,
        0.0007, 0.0117, 0.0009, 0.0010, 0.0038, 0.0017, 0.0004],
       device='cuda:0', dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.7823e-04, 1.8966e-04, 1.0324e-04, 4.8816e-05, 3.0828e-04, 2.8467e-04,
        3.1662e-04, 7.8082e-05, 1.1855e-04, 4.2737e-05, 8.5926e-04, 7.8797e-05,
        1.1122e-04, 4.1556e-04, 1.6272e-04, 4.2558e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.1963e-02, 1.5202e-03, 2.7823e-04],
        [6.0638e-02, 2.5215e-03, 1.8966e-04],
        [5.0087e-03, 8.2779e-04, 1.0324e-04],
        [2.7428e-03, 5.2977e-04, 4.8816e-05],
        [1.1398e-02, 1.4544e-03, 3.0828e-04],
        [2.1500e-02, 2.5272e-03, 2.8467e-04],
        [4.4708e-02, 4.3030e-03, 3.1662e-04],
        [7.2861e-04, 3.8195e-04, 7.8082e-05],
        [4.7112e-03, 1.0548e-03, 1.1855e-04],
        [1.1559e-03, 7.0906e-04, 4.2737e-05],
        [8.9172e-02, 1.1734e-02, 8.5926e-04],
        [2.2240e-03, 9.0551e-04, 7.8797e-05],
        [2.3060e-03, 1.0195e-03, 1.1122e-04],
        [2.7100e-02, 3.8261e-03, 4.1556e-04],
        [8.4152e-03, 1.6565e-03, 1.6272e-04],
        [7.9203e-04, 3.6740e-04, 4.2558e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0023],
        [0.0155],
        [0.0575],
        [0.0029],
        [0.0173],
        [0.0084],
        [0.0355],
        [0.0069],
        [0.0172],
        [0.0131],
        [0.0043],
        [0.0155],
        [0.0022],
        [0.0069],
        [0.0050],
        [0.0038]], device='cuda:0', dtype=torch.float16)/tensor([[0.0023, 0.0155, 0.0575, 0.0029, 0.0173, 0.0084, 0.0355, 0.0069, 0.0172,
         0.0131, 0.0043, 0.0155, 0.0022, 0.0069, 0.0050, 0.0038]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([0.0006, 0.0030, 0.0035, 0.0010, 0.0028, 0.0013, 0.0027, 0.0018, 0.0017,
        0.0019, 0.0012, 0.0023, 0.0006, 0.0019, 0.0015, 0.0007],
       device='cuda:0', dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([4.7743e-05, 1.6606e-04, 7.2479e-04, 1.6475e-04, 1.6475e-04, 1.5736e-04,
        2.2388e-04, 2.1195e-04, 3.6907e-04, 2.2149e-04, 1.0222e-04, 5.1594e-04,
        4.6134e-05, 1.3947e-04, 1.1218e-04, 9.1612e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.3365e-03, 5.7364e-04, 4.7743e-05],
        [1.5511e-02, 2.9697e-03, 1.6606e-04],
        [5.7526e-02, 3.5343e-03, 7.2479e-04],
        [2.8725e-03, 9.9277e-04, 1.6475e-04],
        [1.7303e-02, 2.7580e-03, 1.6475e-04],
        [8.3618e-03, 1.2808e-03, 1.5736e-04],
        [3.5522e-02, 2.7065e-03, 2.2388e-04],
        [6.8626e-03, 1.7548e-03, 2.1195e-04],
        [1.7181e-02, 1.7271e-03, 3.6907e-04],
        [1.3054e-02, 1.8883e-03, 2.2149e-04],
        [4.2686e-03, 1.2369e-03, 1.0222e-04],
        [1.5472e-02, 2.3251e-03, 5.1594e-04],
        [2.2106e-03, 5.5218e-04, 4.6134e-05],
        [6.9237e-03, 1.9302e-03, 1.3947e-04],
        [4.9782e-03, 1.4534e-03, 1.1218e-04],
        [3.7880e-03, 7.1955e-04, 9.1612e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0036],
        [0.0058],
        [0.0100],
        [0.0036],
        [0.0167],
        [0.0025],
        [0.0023],
        [0.0007],
        [0.0036],
        [0.0100],
        [0.0360],
        [0.0039],
        [0.0024],
        [0.0026],
        [0.0058],
        [0.0246]], device='cuda:0', dtype=torch.float16)/tensor([[0.0036, 0.0058, 0.0100, 0.0036, 0.0167, 0.0025, 0.0023, 0.0007, 0.0036,
         0.0100, 0.0360, 0.0039, 0.0024, 0.0026, 0.0058, 0.0246]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([0.0011, 0.0012, 0.0020, 0.0010, 0.0018, 0.0007, 0.0008, 0.0004, 0.0011,
        0.0014, 0.0039, 0.0006, 0.0006, 0.0007, 0.0005, 0.0024],
       device='cuda:0', dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([8.3447e-05, 8.7023e-05, 1.3185e-04, 7.7844e-05, 1.8632e-04, 8.4281e-05,
        1.3816e-04, 2.8431e-05, 1.5402e-04, 2.8181e-04, 7.4053e-04, 9.6381e-05,
        1.3328e-04, 7.7367e-05, 1.8263e-04, 4.0174e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[3.6068e-03, 1.1177e-03, 8.3447e-05],
        [5.8479e-03, 1.1921e-03, 8.7023e-05],
        [9.9945e-03, 1.9741e-03, 1.3185e-04],
        [3.6011e-03, 9.9659e-04, 7.7844e-05],
        [1.6693e-02, 1.8291e-03, 1.8632e-04],
        [2.5139e-03, 6.8521e-04, 8.4281e-05],
        [2.2793e-03, 7.5865e-04, 1.3816e-04],
        [7.2527e-04, 3.6955e-04, 2.8431e-05],
        [3.5763e-03, 1.1253e-03, 1.5402e-04],
        [9.9869e-03, 1.4381e-03, 2.8181e-04],
        [3.6041e-02, 3.8853e-03, 7.4053e-04],
        [3.9253e-03, 6.0177e-04, 9.6381e-05],
        [2.3689e-03, 6.2513e-04, 1.3328e-04],
        [2.5787e-03, 7.4530e-04, 7.7367e-05],
        [5.7907e-03, 5.4979e-04, 1.8263e-04],
        [2.4582e-02, 2.4147e-03, 4.0174e-04]], device='cuda:0')
acc:  0.3333333333333333
Time taken to execute the de NLI task with prompt type active, variation 2 and batchsize 16: 0:02:46.371548
path ['42', 'de', 'llama', 'NLI', 'active', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b NLI passive 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 314.04it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.4496e-04],
        [4.5228e-04],
        [1.9491e-04],
        [2.7394e-04],
        [8.8036e-05],
        [1.1444e-04],
        [1.3459e-04],
        [1.2171e-04],
        [5.4598e-05],
        [9.0599e-05],
        [5.3227e-05],
        [1.8215e-04],
        [2.9683e-04],
        [9.8884e-05],
        [1.3506e-04],
        [4.2510e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.4496e-04, 4.5228e-04, 1.9491e-04, 2.7394e-04, 8.8036e-05, 1.1444e-04,
         1.3459e-04, 1.2171e-04, 5.4598e-05, 9.0599e-05, 5.3227e-05, 1.8215e-04,
         2.9683e-04, 9.8884e-05, 1.3506e-04, 4.2510e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([8.9705e-05, 2.1374e-04, 4.8697e-05, 1.3506e-04, 4.7028e-05, 4.0591e-05,
        7.0691e-05, 5.0366e-05, 3.5703e-05, 1.2034e-04, 5.5909e-05, 1.0842e-04,
        1.3936e-04, 4.5240e-05, 4.9829e-05, 1.5581e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([3.7253e-05, 9.0480e-05, 5.2571e-05, 6.7472e-05, 2.3127e-05, 3.5584e-05,
        4.7863e-05, 6.1095e-05, 1.8239e-05, 3.6299e-05, 3.1173e-05, 5.4479e-05,
        7.3910e-05, 5.3048e-05, 2.7776e-05, 1.2827e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.4496e-04, 8.9705e-05, 3.7253e-05],
        [4.5228e-04, 2.1374e-04, 9.0480e-05],
        [1.9491e-04, 4.8697e-05, 5.2571e-05],
        [2.7394e-04, 1.3506e-04, 6.7472e-05],
        [8.8036e-05, 4.7028e-05, 2.3127e-05],
        [1.1444e-04, 4.0591e-05, 3.5584e-05],
        [1.3459e-04, 7.0691e-05, 4.7863e-05],
        [1.2171e-04, 5.0366e-05, 6.1095e-05],
        [5.4598e-05, 3.5703e-05, 1.8239e-05],
        [9.0599e-05, 1.2034e-04, 3.6299e-05],
        [5.3227e-05, 5.5909e-05, 3.1173e-05],
        [1.8215e-04, 1.0842e-04, 5.4479e-05],
        [2.9683e-04, 1.3936e-04, 7.3910e-05],
        [9.8884e-05, 4.5240e-05, 5.3048e-05],
        [1.3506e-04, 4.9829e-05, 2.7776e-05],
        [4.2510e-04, 1.5581e-04, 1.2827e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[3.1137e-04],
        [1.6356e-04],
        [1.1629e-04],
        [8.6248e-05],
        [7.0930e-05],
        [3.6240e-04],
        [6.9797e-05],
        [2.3472e-04],
        [1.9753e-04],
        [1.2743e-04],
        [1.1849e-04],
        [2.9469e-04],
        [1.3864e-04],
        [7.7629e-04],
        [5.0592e-04],
        [3.7193e-05]], device='cuda:0', dtype=torch.float16)/tensor([[3.1137e-04, 1.6356e-04, 1.1629e-04, 8.6248e-05, 7.0930e-05, 3.6240e-04,
         6.9797e-05, 2.3472e-04, 1.9753e-04, 1.2743e-04, 1.1849e-04, 2.9469e-04,
         1.3864e-04, 7.7629e-04, 5.0592e-04, 3.7193e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.2505e-04, 9.1374e-05, 6.6221e-05, 5.2989e-05, 4.8637e-05, 1.8513e-04,
        4.9710e-05, 9.5785e-05, 9.9719e-05, 6.7115e-05, 1.0830e-04, 1.1104e-04,
        5.0664e-05, 3.9554e-04, 1.2767e-04, 3.3319e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([3.4750e-05, 3.4809e-05, 5.2452e-05, 4.8161e-05, 3.0875e-05, 1.4520e-04,
        1.7405e-05, 8.1480e-05, 5.3585e-05, 3.4451e-05, 5.6446e-05, 4.4227e-05,
        2.3901e-05, 2.6894e-04, 4.7088e-05, 1.8477e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[3.1137e-04, 1.2505e-04, 3.4750e-05],
        [1.6356e-04, 9.1374e-05, 3.4809e-05],
        [1.1629e-04, 6.6221e-05, 5.2452e-05],
        [8.6248e-05, 5.2989e-05, 4.8161e-05],
        [7.0930e-05, 4.8637e-05, 3.0875e-05],
        [3.6240e-04, 1.8513e-04, 1.4520e-04],
        [6.9797e-05, 4.9710e-05, 1.7405e-05],
        [2.3472e-04, 9.5785e-05, 8.1480e-05],
        [1.9753e-04, 9.9719e-05, 5.3585e-05],
        [1.2743e-04, 6.7115e-05, 3.4451e-05],
        [1.1849e-04, 1.0830e-04, 5.6446e-05],
        [2.9469e-04, 1.1104e-04, 4.4227e-05],
        [1.3864e-04, 5.0664e-05, 2.3901e-05],
        [7.7629e-04, 3.9554e-04, 2.6894e-04],
        [5.0592e-04, 1.2767e-04, 4.7088e-05],
        [3.7193e-05, 3.3319e-05, 1.8477e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.0657e-04],
        [6.6042e-05],
        [1.2720e-04],
        [2.1696e-04],
        [8.8811e-05],
        [1.1969e-04],
        [1.0157e-04],
        [1.6165e-04],
        [1.9705e-04],
        [9.6738e-05],
        [1.0598e-04],
        [4.1962e-04],
        [2.8348e-04],
        [2.1446e-04],
        [9.3281e-05],
        [1.8108e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.0657e-04, 6.6042e-05, 1.2720e-04, 2.1696e-04, 8.8811e-05, 1.1969e-04,
         1.0157e-04, 1.6165e-04, 1.9705e-04, 9.6738e-05, 1.0598e-04, 4.1962e-04,
         2.8348e-04, 2.1446e-04, 9.3281e-05, 1.8108e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([7.0632e-05, 4.3154e-05, 4.2439e-05, 6.5744e-05, 9.9301e-05, 2.7895e-05,
        4.0233e-05, 6.4135e-05, 1.0139e-04, 3.5524e-05, 3.7134e-05, 9.5725e-05,
        9.8407e-05, 8.1360e-05, 2.6524e-05, 1.0794e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([3.8087e-05, 1.4603e-05, 2.8372e-05, 3.7074e-05, 2.5868e-05, 1.6630e-05,
        1.9729e-05, 7.0989e-05, 4.1842e-05, 3.0756e-05, 3.3736e-05, 1.1891e-04,
        5.0783e-05, 8.8036e-05, 2.5988e-05, 7.6830e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.0657e-04, 7.0632e-05, 3.8087e-05],
        [6.6042e-05, 4.3154e-05, 1.4603e-05],
        [1.2720e-04, 4.2439e-05, 2.8372e-05],
        [2.1696e-04, 6.5744e-05, 3.7074e-05],
        [8.8811e-05, 9.9301e-05, 2.5868e-05],
        [1.1969e-04, 2.7895e-05, 1.6630e-05],
        [1.0157e-04, 4.0233e-05, 1.9729e-05],
        [1.6165e-04, 6.4135e-05, 7.0989e-05],
        [1.9705e-04, 1.0139e-04, 4.1842e-05],
        [9.6738e-05, 3.5524e-05, 3.0756e-05],
        [1.0598e-04, 3.7134e-05, 3.3736e-05],
        [4.1962e-04, 9.5725e-05, 1.1891e-04],
        [2.8348e-04, 9.8407e-05, 5.0783e-05],
        [2.1446e-04, 8.1360e-05, 8.8036e-05],
        [9.3281e-05, 2.6524e-05, 2.5988e-05],
        [1.8108e-04, 1.0794e-04, 7.6830e-05]], device='cuda:0')
acc:  0.3125
Time taken to execute the de NLI task with prompt type passive, variation 0 and batchsize 16: 0:02:46.438953
path ['42', 'de', 'llama', 'NLI', 'passive', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI passive 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 311.71it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.7166e-05],
        [1.3709e-05],
        [1.8954e-05],
        [2.4676e-05],
        [1.8716e-05],
        [1.3530e-05],
        [1.1623e-05],
        [1.5259e-05],
        [1.7965e-04],
        [1.6332e-05],
        [1.1802e-05],
        [3.3081e-05],
        [1.3828e-05],
        [7.8976e-05],
        [6.0260e-05],
        [2.2471e-05]], device='cuda:0', dtype=torch.float16)/tensor([[1.7166e-05, 1.3709e-05, 1.8954e-05, 2.4676e-05, 1.8716e-05, 1.3530e-05,
         1.1623e-05, 1.5259e-05, 1.7965e-04, 1.6332e-05, 1.1802e-05, 3.3081e-05,
         1.3828e-05, 7.8976e-05, 6.0260e-05, 2.2471e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.4842e-05, 1.2100e-05, 1.2755e-05, 1.1146e-05, 8.4639e-06, 7.6294e-06,
        8.1062e-06, 1.0371e-05, 7.8976e-05, 1.1265e-05, 1.1683e-05, 3.3081e-05,
        1.1265e-05, 2.1517e-05, 3.4332e-05, 1.6093e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([7.7486e-06, 4.0531e-06, 7.6294e-06, 8.1062e-06, 5.0068e-06, 2.9802e-06,
        2.6822e-06, 5.4240e-06, 9.4414e-05, 3.5763e-06, 5.3048e-06, 2.1458e-05,
        2.9802e-06, 7.3910e-06, 2.1577e-05, 5.0068e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.7166e-05, 1.4842e-05, 7.7486e-06],
        [1.3709e-05, 1.2100e-05, 4.0531e-06],
        [1.8954e-05, 1.2755e-05, 7.6294e-06],
        [2.4676e-05, 1.1146e-05, 8.1062e-06],
        [1.8716e-05, 8.4639e-06, 5.0068e-06],
        [1.3530e-05, 7.6294e-06, 2.9802e-06],
        [1.1623e-05, 8.1062e-06, 2.6822e-06],
        [1.5259e-05, 1.0371e-05, 5.4240e-06],
        [1.7965e-04, 7.8976e-05, 9.4414e-05],
        [1.6332e-05, 1.1265e-05, 3.5763e-06],
        [1.1802e-05, 1.1683e-05, 5.3048e-06],
        [3.3081e-05, 3.3081e-05, 2.1458e-05],
        [1.3828e-05, 1.1265e-05, 2.9802e-06],
        [7.8976e-05, 2.1517e-05, 7.3910e-06],
        [6.0260e-05, 3.4332e-05, 2.1577e-05],
        [2.2471e-05, 1.6093e-05, 5.0068e-06]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[6.4373e-06],
        [2.6286e-05],
        [1.5020e-05],
        [1.3769e-05],
        [1.5199e-05],
        [1.0371e-05],
        [1.1683e-05],
        [2.1279e-05],
        [3.0100e-05],
        [1.3232e-05],
        [1.2219e-05],
        [3.1650e-05],
        [2.2173e-05],
        [1.5056e-04],
        [2.0802e-05],
        [1.7166e-05]], device='cuda:0', dtype=torch.float16)/tensor([[6.4373e-06, 2.6286e-05, 1.5020e-05, 1.3769e-05, 1.5199e-05, 1.0371e-05,
         1.1683e-05, 2.1279e-05, 3.0100e-05, 1.3232e-05, 1.2219e-05, 3.1650e-05,
         2.2173e-05, 1.5056e-04, 2.0802e-05, 1.7166e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([4.3511e-06, 1.9789e-05, 9.2983e-06, 9.0599e-06, 1.1086e-05, 6.8545e-06,
        6.9737e-06, 9.2387e-06, 1.3173e-05, 9.5367e-06, 1.2577e-05, 1.7881e-05,
        1.0252e-05, 2.7895e-05, 1.3351e-05, 1.0729e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.9670e-06, 8.4043e-06, 3.2783e-06, 3.9339e-06, 2.9802e-06, 3.8743e-06,
        4.1127e-06, 9.1791e-06, 6.7949e-06, 4.2915e-06, 4.8280e-06, 8.9407e-06,
        6.6757e-06, 1.2755e-05, 3.5763e-06, 2.8610e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[6.4373e-06, 4.3511e-06, 1.9670e-06],
        [2.6286e-05, 1.9789e-05, 8.4043e-06],
        [1.5020e-05, 9.2983e-06, 3.2783e-06],
        [1.3769e-05, 9.0599e-06, 3.9339e-06],
        [1.5199e-05, 1.1086e-05, 2.9802e-06],
        [1.0371e-05, 6.8545e-06, 3.8743e-06],
        [1.1683e-05, 6.9737e-06, 4.1127e-06],
        [2.1279e-05, 9.2387e-06, 9.1791e-06],
        [3.0100e-05, 1.3173e-05, 6.7949e-06],
        [1.3232e-05, 9.5367e-06, 4.2915e-06],
        [1.2219e-05, 1.2577e-05, 4.8280e-06],
        [3.1650e-05, 1.7881e-05, 8.9407e-06],
        [2.2173e-05, 1.0252e-05, 6.6757e-06],
        [1.5056e-04, 2.7895e-05, 1.2755e-05],
        [2.0802e-05, 1.3351e-05, 3.5763e-06],
        [1.7166e-05, 1.0729e-05, 2.8610e-06]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.6630e-05],
        [2.6166e-05],
        [4.1664e-05],
        [2.2233e-05],
        [1.4305e-05],
        [3.4869e-05],
        [1.8060e-05],
        [5.4657e-05],
        [2.1398e-05],
        [2.2352e-05],
        [1.4961e-05],
        [2.3007e-05],
        [3.8445e-05],
        [3.3319e-05],
        [3.0637e-05],
        [5.9605e-05]], device='cuda:0', dtype=torch.float16)/tensor([[1.6630e-05, 2.6166e-05, 4.1664e-05, 2.2233e-05, 1.4305e-05, 3.4869e-05,
         1.8060e-05, 5.4657e-05, 2.1398e-05, 2.2352e-05, 1.4961e-05, 2.3007e-05,
         3.8445e-05, 3.3319e-05, 3.0637e-05, 5.9605e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([7.6890e-06, 4.7684e-06, 2.4796e-05, 2.4557e-05, 7.4506e-06, 1.5020e-05,
        1.9848e-05, 2.7001e-05, 2.1756e-05, 1.9193e-05, 1.1742e-05, 1.0073e-05,
        2.3663e-05, 1.3411e-05, 1.3769e-05, 2.9683e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([3.4571e-06, 1.0252e-05, 1.0073e-05, 4.1127e-06, 3.5167e-06, 1.2934e-05,
        9.0599e-06, 6.8545e-06, 7.5698e-06, 6.7353e-06, 3.8743e-06, 6.7949e-06,
        2.4021e-05, 1.0669e-05, 8.0466e-06, 2.6166e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.6630e-05, 7.6890e-06, 3.4571e-06],
        [2.6166e-05, 4.7684e-06, 1.0252e-05],
        [4.1664e-05, 2.4796e-05, 1.0073e-05],
        [2.2233e-05, 2.4557e-05, 4.1127e-06],
        [1.4305e-05, 7.4506e-06, 3.5167e-06],
        [3.4869e-05, 1.5020e-05, 1.2934e-05],
        [1.8060e-05, 1.9848e-05, 9.0599e-06],
        [5.4657e-05, 2.7001e-05, 6.8545e-06],
        [2.1398e-05, 2.1756e-05, 7.5698e-06],
        [2.2352e-05, 1.9193e-05, 6.7353e-06],
        [1.4961e-05, 1.1742e-05, 3.8743e-06],
        [2.3007e-05, 1.0073e-05, 6.7949e-06],
        [3.8445e-05, 2.3663e-05, 2.4021e-05],
        [3.3319e-05, 1.3411e-05, 1.0669e-05],
        [3.0637e-05, 1.3769e-05, 8.0466e-06],
        [5.9605e-05, 2.9683e-05, 2.6166e-05]], device='cuda:0')
acc:  0.3125
Time taken to execute the de NLI task with prompt type passive, variation 1 and batchsize 16: 0:02:46.438524
path ['42', 'de', 'llama', 'NLI', 'passive', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI passive 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 342.35it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[4.7684e-04],
        [1.3268e-04],
        [1.0357e-03],
        [8.2254e-05],
        [1.9062e-04],
        [1.1051e-04],
        [5.9128e-05],
        [8.5592e-05],
        [1.2118e-04],
        [1.0961e-04],
        [2.4509e-04],
        [1.9801e-04],
        [3.5501e-04],
        [2.0552e-04],
        [5.7459e-05],
        [1.0020e-04]], device='cuda:0', dtype=torch.float16)/tensor([[4.7684e-04, 1.3268e-04, 1.0357e-03, 8.2254e-05, 1.9062e-04, 1.1051e-04,
         5.9128e-05, 8.5592e-05, 1.2118e-04, 1.0961e-04, 2.4509e-04, 1.9801e-04,
         3.5501e-04, 2.0552e-04, 5.7459e-05, 1.0020e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.4438e-04, 8.0526e-05, 5.1546e-04, 5.1856e-05, 1.0478e-04, 6.3598e-05,
        1.6749e-05, 5.3346e-05, 4.4644e-05, 4.5180e-05, 8.9049e-05, 1.3828e-04,
        9.2685e-05, 7.6652e-05, 3.6001e-05, 9.6440e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.6117e-04, 7.5042e-05, 2.4462e-04, 1.7226e-05, 3.5405e-05, 3.0160e-05,
        1.1861e-05, 1.8954e-05, 3.8385e-05, 2.5868e-05, 4.6015e-05, 5.2214e-05,
        9.4295e-05, 2.9922e-05, 2.4199e-05, 3.0637e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[4.7684e-04, 2.4438e-04, 1.6117e-04],
        [1.3268e-04, 8.0526e-05, 7.5042e-05],
        [1.0357e-03, 5.1546e-04, 2.4462e-04],
        [8.2254e-05, 5.1856e-05, 1.7226e-05],
        [1.9062e-04, 1.0478e-04, 3.5405e-05],
        [1.1051e-04, 6.3598e-05, 3.0160e-05],
        [5.9128e-05, 1.6749e-05, 1.1861e-05],
        [8.5592e-05, 5.3346e-05, 1.8954e-05],
        [1.2118e-04, 4.4644e-05, 3.8385e-05],
        [1.0961e-04, 4.5180e-05, 2.5868e-05],
        [2.4509e-04, 8.9049e-05, 4.6015e-05],
        [1.9801e-04, 1.3828e-04, 5.2214e-05],
        [3.5501e-04, 9.2685e-05, 9.4295e-05],
        [2.0552e-04, 7.6652e-05, 2.9922e-05],
        [5.7459e-05, 3.6001e-05, 2.4199e-05],
        [1.0020e-04, 9.6440e-05, 3.0637e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.8120e-04],
        [6.0201e-05],
        [3.0994e-04],
        [1.3101e-04],
        [2.1076e-04],
        [9.6977e-05],
        [4.4882e-05],
        [9.1016e-05],
        [5.3596e-04],
        [2.0099e-04],
        [1.0484e-04],
        [5.3048e-05],
        [1.3804e-04],
        [3.1567e-04],
        [7.8380e-05],
        [1.0771e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.8120e-04, 6.0201e-05, 3.0994e-04, 1.3101e-04, 2.1076e-04, 9.6977e-05,
         4.4882e-05, 9.1016e-05, 5.3596e-04, 2.0099e-04, 1.0484e-04, 5.3048e-05,
         1.3804e-04, 3.1567e-04, 7.8380e-05, 1.0771e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([8.9645e-05, 3.0816e-05, 1.6713e-04, 6.6876e-05, 9.5665e-05, 4.0472e-05,
        2.9922e-05, 1.0943e-04, 1.3292e-04, 5.0962e-05, 9.8407e-05, 4.8101e-05,
        9.0837e-05, 1.1039e-04, 4.7207e-05, 5.1379e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([4.0174e-05, 1.7643e-05, 8.2433e-05, 6.3121e-05, 7.3791e-05, 3.1292e-05,
        9.9540e-06, 2.7299e-05, 4.2796e-05, 5.4419e-05, 5.6326e-05, 3.2544e-05,
        3.8564e-05, 7.4446e-05, 1.5676e-05, 6.0201e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.8120e-04, 8.9645e-05, 4.0174e-05],
        [6.0201e-05, 3.0816e-05, 1.7643e-05],
        [3.0994e-04, 1.6713e-04, 8.2433e-05],
        [1.3101e-04, 6.6876e-05, 6.3121e-05],
        [2.1076e-04, 9.5665e-05, 7.3791e-05],
        [9.6977e-05, 4.0472e-05, 3.1292e-05],
        [4.4882e-05, 2.9922e-05, 9.9540e-06],
        [9.1016e-05, 1.0943e-04, 2.7299e-05],
        [5.3596e-04, 1.3292e-04, 4.2796e-05],
        [2.0099e-04, 5.0962e-05, 5.4419e-05],
        [1.0484e-04, 9.8407e-05, 5.6326e-05],
        [5.3048e-05, 4.8101e-05, 3.2544e-05],
        [1.3804e-04, 9.0837e-05, 3.8564e-05],
        [3.1567e-04, 1.1039e-04, 7.4446e-05],
        [7.8380e-05, 4.7207e-05, 1.5676e-05],
        [1.0771e-04, 5.1379e-05, 6.0201e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.9407e-04],
        [9.3818e-05],
        [9.6440e-05],
        [7.4029e-05],
        [4.3809e-05],
        [1.3649e-04],
        [8.6427e-05],
        [1.0449e-04],
        [1.2100e-04],
        [4.2856e-05],
        [9.6977e-05],
        [1.4746e-04],
        [3.1352e-04],
        [4.1187e-05],
        [1.0085e-04],
        [1.8346e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.9407e-04, 9.3818e-05, 9.6440e-05, 7.4029e-05, 4.3809e-05, 1.3649e-04,
         8.6427e-05, 1.0449e-04, 1.2100e-04, 4.2856e-05, 9.6977e-05, 1.4746e-04,
         3.1352e-04, 4.1187e-05, 1.0085e-04, 1.8346e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([8.0466e-05, 3.8266e-05, 4.4167e-05, 6.0618e-05, 2.8431e-05, 7.3552e-05,
        4.1306e-05, 6.0439e-05, 4.6015e-05, 3.9220e-05, 4.7207e-05, 6.5029e-05,
        1.4746e-04, 2.0742e-05, 4.2856e-05, 1.0008e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([9.9123e-05, 2.6822e-05, 3.2187e-05, 3.1233e-05, 1.4186e-05, 2.9564e-05,
        2.4915e-05, 6.4671e-05, 2.3544e-05, 1.1325e-05, 3.0160e-05, 2.4199e-05,
        8.0764e-05, 1.3232e-05, 2.4199e-05, 4.2200e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.9407e-04, 8.0466e-05, 9.9123e-05],
        [9.3818e-05, 3.8266e-05, 2.6822e-05],
        [9.6440e-05, 4.4167e-05, 3.2187e-05],
        [7.4029e-05, 6.0618e-05, 3.1233e-05],
        [4.3809e-05, 2.8431e-05, 1.4186e-05],
        [1.3649e-04, 7.3552e-05, 2.9564e-05],
        [8.6427e-05, 4.1306e-05, 2.4915e-05],
        [1.0449e-04, 6.0439e-05, 6.4671e-05],
        [1.2100e-04, 4.6015e-05, 2.3544e-05],
        [4.2856e-05, 3.9220e-05, 1.1325e-05],
        [9.6977e-05, 4.7207e-05, 3.0160e-05],
        [1.4746e-04, 6.5029e-05, 2.4199e-05],
        [3.1352e-04, 1.4746e-04, 8.0764e-05],
        [4.1187e-05, 2.0742e-05, 1.3232e-05],
        [1.0085e-04, 4.2856e-05, 2.4199e-05],
        [1.8346e-04, 1.0008e-04, 4.2200e-05]], device='cuda:0')
acc:  0.3125
Time taken to execute the de NLI task with prompt type passive, variation 2 and batchsize 16: 0:02:46.092909
path ['42', 'de', 'llama', 'NLI', 'passive', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b NLI auxiliary 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 363.65it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[3.7849e-05],
        [2.2769e-04],
        [2.4724e-04],
        [3.9041e-05],
        [2.4796e-04],
        [8.4102e-05],
        [1.8895e-05],
        [1.0133e-04],
        [3.9601e-04],
        [2.9564e-05],
        [5.2547e-04],
        [4.3392e-05],
        [8.1420e-05],
        [7.9870e-05],
        [7.2896e-05],
        [7.2122e-05]], device='cuda:0', dtype=torch.float16)/tensor([[3.7849e-05, 2.2769e-04, 2.4724e-04, 3.9041e-05, 2.4796e-04, 8.4102e-05,
         1.8895e-05, 1.0133e-04, 3.9601e-04, 2.9564e-05, 5.2547e-04, 4.3392e-05,
         8.1420e-05, 7.9870e-05, 7.2896e-05, 7.2122e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([6.5088e-05, 1.5426e-04, 1.7846e-04, 4.1306e-05, 1.6284e-04, 5.6565e-05,
        3.1769e-05, 5.4002e-05, 3.1090e-04, 2.8014e-05, 3.2330e-04, 3.8981e-05,
        3.2902e-05, 6.2883e-05, 1.2517e-04, 4.8041e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.6212e-05, 7.6652e-05, 1.3435e-04, 8.2254e-06, 3.5167e-05, 7.7426e-05,
        8.9407e-06, 4.2439e-05, 1.0741e-04, 1.3709e-05, 8.5831e-05, 1.5378e-05,
        5.4419e-05, 3.0756e-05, 2.5988e-05, 2.5511e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[3.7849e-05, 6.5088e-05, 1.6212e-05],
        [2.2769e-04, 1.5426e-04, 7.6652e-05],
        [2.4724e-04, 1.7846e-04, 1.3435e-04],
        [3.9041e-05, 4.1306e-05, 8.2254e-06],
        [2.4796e-04, 1.6284e-04, 3.5167e-05],
        [8.4102e-05, 5.6565e-05, 7.7426e-05],
        [1.8895e-05, 3.1769e-05, 8.9407e-06],
        [1.0133e-04, 5.4002e-05, 4.2439e-05],
        [3.9601e-04, 3.1090e-04, 1.0741e-04],
        [2.9564e-05, 2.8014e-05, 1.3709e-05],
        [5.2547e-04, 3.2330e-04, 8.5831e-05],
        [4.3392e-05, 3.8981e-05, 1.5378e-05],
        [8.1420e-05, 3.2902e-05, 5.4419e-05],
        [7.9870e-05, 6.2883e-05, 3.0756e-05],
        [7.2896e-05, 1.2517e-04, 2.5988e-05],
        [7.2122e-05, 4.8041e-05, 2.5511e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[2.0742e-04],
        [2.5034e-04],
        [9.6917e-05],
        [2.6584e-05],
        [2.3484e-04],
        [2.7347e-04],
        [2.3997e-04],
        [3.8803e-05],
        [5.2512e-05],
        [9.0778e-05],
        [1.9729e-05],
        [7.6532e-05],
        [1.2457e-05],
        [1.0288e-04],
        [7.7307e-05],
        [1.1176e-04]], device='cuda:0', dtype=torch.float16)/tensor([[2.0742e-04, 2.5034e-04, 9.6917e-05, 2.6584e-05, 2.3484e-04, 2.7347e-04,
         2.3997e-04, 3.8803e-05, 5.2512e-05, 9.0778e-05, 1.9729e-05, 7.6532e-05,
         1.2457e-05, 1.0288e-04, 7.7307e-05, 1.1176e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.4436e-04, 2.1756e-04, 7.5817e-05, 3.9220e-05, 8.0168e-05, 3.1734e-04,
        2.2840e-04, 7.2241e-05, 4.0114e-05, 1.2231e-04, 1.6689e-05, 7.8082e-05,
        1.1861e-05, 7.8142e-05, 8.3864e-05, 1.0347e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([9.3997e-05, 8.7738e-05, 3.3855e-05, 1.2696e-05, 2.1458e-05, 8.9228e-05,
        8.5890e-05, 4.3809e-05, 2.0027e-05, 3.2902e-05, 5.3644e-06, 2.1935e-05,
        4.0531e-06, 2.8729e-05, 2.7001e-05, 4.2439e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.0742e-04, 1.4436e-04, 9.3997e-05],
        [2.5034e-04, 2.1756e-04, 8.7738e-05],
        [9.6917e-05, 7.5817e-05, 3.3855e-05],
        [2.6584e-05, 3.9220e-05, 1.2696e-05],
        [2.3484e-04, 8.0168e-05, 2.1458e-05],
        [2.7347e-04, 3.1734e-04, 8.9228e-05],
        [2.3997e-04, 2.2840e-04, 8.5890e-05],
        [3.8803e-05, 7.2241e-05, 4.3809e-05],
        [5.2512e-05, 4.0114e-05, 2.0027e-05],
        [9.0778e-05, 1.2231e-04, 3.2902e-05],
        [1.9729e-05, 1.6689e-05, 5.3644e-06],
        [7.6532e-05, 7.8082e-05, 2.1935e-05],
        [1.2457e-05, 1.1861e-05, 4.0531e-06],
        [1.0288e-04, 7.8142e-05, 2.8729e-05],
        [7.7307e-05, 8.3864e-05, 2.7001e-05],
        [1.1176e-04, 1.0347e-04, 4.2439e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.2070e-04],
        [9.8109e-05],
        [9.2685e-05],
        [1.7130e-04],
        [3.9756e-05],
        [8.7917e-05],
        [6.9082e-05],
        [4.2081e-05],
        [2.0564e-04],
        [9.9540e-06],
        [2.6822e-05],
        [1.5199e-04],
        [1.9252e-05],
        [6.6400e-05],
        [7.3075e-05],
        [3.1376e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.2070e-04, 9.8109e-05, 9.2685e-05, 1.7130e-04, 3.9756e-05, 8.7917e-05,
         6.9082e-05, 4.2081e-05, 2.0564e-04, 9.9540e-06, 2.6822e-05, 1.5199e-04,
         1.9252e-05, 6.6400e-05, 7.3075e-05, 3.1376e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([6.7115e-05, 1.1015e-04, 7.4565e-05, 1.2672e-04, 3.0279e-05, 4.8220e-05,
        5.9843e-05, 4.5002e-05, 1.4758e-04, 3.3557e-05, 3.9756e-05, 9.9123e-05,
        3.8147e-05, 8.5592e-05, 1.3340e-04, 2.4033e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([7.2420e-05, 4.7505e-05, 2.0385e-05, 7.6890e-05, 8.5235e-06, 1.0192e-05,
        6.2943e-05, 9.6560e-06, 6.2466e-05, 7.3314e-06, 8.8215e-06, 5.5909e-05,
        7.3314e-06, 2.4140e-05, 3.4809e-05, 1.4734e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.2070e-04, 6.7115e-05, 7.2420e-05],
        [9.8109e-05, 1.1015e-04, 4.7505e-05],
        [9.2685e-05, 7.4565e-05, 2.0385e-05],
        [1.7130e-04, 1.2672e-04, 7.6890e-05],
        [3.9756e-05, 3.0279e-05, 8.5235e-06],
        [8.7917e-05, 4.8220e-05, 1.0192e-05],
        [6.9082e-05, 5.9843e-05, 6.2943e-05],
        [4.2081e-05, 4.5002e-05, 9.6560e-06],
        [2.0564e-04, 1.4758e-04, 6.2466e-05],
        [9.9540e-06, 3.3557e-05, 7.3314e-06],
        [2.6822e-05, 3.9756e-05, 8.8215e-06],
        [1.5199e-04, 9.9123e-05, 5.5909e-05],
        [1.9252e-05, 3.8147e-05, 7.3314e-06],
        [6.6400e-05, 8.5592e-05, 2.4140e-05],
        [7.3075e-05, 1.3340e-04, 3.4809e-05],
        [3.1376e-04, 2.4033e-04, 1.4734e-04]], device='cuda:0')
acc:  0.25
Time taken to execute the de NLI task with prompt type auxiliary, variation 0 and batchsize 16: 0:02:46.007852
path ['42', 'de', 'llama', 'NLI', 'auxiliary', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI auxiliary 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 254.18it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.3769e-05],
        [4.1842e-05],
        [7.8440e-05],
        [7.8380e-05],
        [2.9385e-05],
        [4.8518e-05],
        [4.1127e-05],
        [8.1718e-05],
        [6.7353e-05],
        [1.9157e-04],
        [6.1333e-05],
        [6.2704e-05],
        [5.9366e-05],
        [2.4855e-05],
        [8.9467e-05],
        [1.9217e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.3769e-05, 4.1842e-05, 7.8440e-05, 7.8380e-05, 2.9385e-05, 4.8518e-05,
         4.1127e-05, 8.1718e-05, 6.7353e-05, 1.9157e-04, 6.1333e-05, 6.2704e-05,
         5.9366e-05, 2.4855e-05, 8.9467e-05, 1.9217e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.8372e-05, 3.8207e-05, 5.1022e-05, 4.0650e-05, 2.8491e-05, 4.2796e-05,
        2.3365e-05, 3.6359e-05, 4.6432e-05, 8.3983e-05, 5.0008e-05, 6.4254e-05,
        4.4823e-05, 2.3425e-05, 3.8445e-05, 8.9645e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([8.7619e-06, 9.0003e-06, 3.5882e-05, 7.7724e-05, 1.5438e-05, 1.1086e-05,
        8.2254e-06, 1.0908e-05, 2.2411e-05, 3.3975e-05, 2.0742e-05, 3.2902e-05,
        2.5928e-05, 8.4639e-06, 3.6240e-05, 6.0141e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.3769e-05, 2.8372e-05, 8.7619e-06],
        [4.1842e-05, 3.8207e-05, 9.0003e-06],
        [7.8440e-05, 5.1022e-05, 3.5882e-05],
        [7.8380e-05, 4.0650e-05, 7.7724e-05],
        [2.9385e-05, 2.8491e-05, 1.5438e-05],
        [4.8518e-05, 4.2796e-05, 1.1086e-05],
        [4.1127e-05, 2.3365e-05, 8.2254e-06],
        [8.1718e-05, 3.6359e-05, 1.0908e-05],
        [6.7353e-05, 4.6432e-05, 2.2411e-05],
        [1.9157e-04, 8.3983e-05, 3.3975e-05],
        [6.1333e-05, 5.0008e-05, 2.0742e-05],
        [6.2704e-05, 6.4254e-05, 3.2902e-05],
        [5.9366e-05, 4.4823e-05, 2.5928e-05],
        [2.4855e-05, 2.3425e-05, 8.4639e-06],
        [8.9467e-05, 3.8445e-05, 3.6240e-05],
        [1.9217e-04, 8.9645e-05, 6.0141e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[7.4327e-05],
        [1.6689e-05],
        [7.6115e-05],
        [1.9002e-04],
        [1.1593e-04],
        [2.2161e-04],
        [4.0948e-05],
        [2.2233e-05],
        [5.4359e-05],
        [4.5598e-05],
        [7.0751e-05],
        [2.2662e-04],
        [1.3530e-04],
        [3.0661e-04],
        [7.2479e-05],
        [1.5795e-04]], device='cuda:0', dtype=torch.float16)/tensor([[7.4327e-05, 1.6689e-05, 7.6115e-05, 1.9002e-04, 1.1593e-04, 2.2161e-04,
         4.0948e-05, 2.2233e-05, 5.4359e-05, 4.5598e-05, 7.0751e-05, 2.2662e-04,
         1.3530e-04, 3.0661e-04, 7.2479e-05, 1.5795e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.5942e-05, 1.1444e-05, 6.2585e-05, 8.0466e-05, 5.2691e-05, 1.1361e-04,
        5.3704e-05, 1.4007e-05, 4.4525e-05, 3.1412e-05, 7.4446e-05, 1.1057e-04,
        7.7665e-05, 1.0836e-04, 4.2260e-05, 5.8949e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([3.3379e-05, 5.1260e-06, 3.5882e-05, 2.3901e-05, 7.3135e-05, 1.2803e-04,
        5.3644e-05, 5.1260e-06, 5.5254e-05, 1.8239e-05, 2.5749e-05, 9.0599e-05,
        6.1750e-05, 5.6565e-05, 1.8716e-05, 5.9247e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[7.4327e-05, 3.5942e-05, 3.3379e-05],
        [1.6689e-05, 1.1444e-05, 5.1260e-06],
        [7.6115e-05, 6.2585e-05, 3.5882e-05],
        [1.9002e-04, 8.0466e-05, 2.3901e-05],
        [1.1593e-04, 5.2691e-05, 7.3135e-05],
        [2.2161e-04, 1.1361e-04, 1.2803e-04],
        [4.0948e-05, 5.3704e-05, 5.3644e-05],
        [2.2233e-05, 1.4007e-05, 5.1260e-06],
        [5.4359e-05, 4.4525e-05, 5.5254e-05],
        [4.5598e-05, 3.1412e-05, 1.8239e-05],
        [7.0751e-05, 7.4446e-05, 2.5749e-05],
        [2.2662e-04, 1.1057e-04, 9.0599e-05],
        [1.3530e-04, 7.7665e-05, 6.1750e-05],
        [3.0661e-04, 1.0836e-04, 5.6565e-05],
        [7.2479e-05, 4.2260e-05, 1.8716e-05],
        [1.5795e-04, 5.8949e-05, 5.9247e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[4.3929e-05],
        [2.2030e-04],
        [2.7156e-04],
        [6.0678e-05],
        [1.4293e-04],
        [5.9247e-05],
        [1.4853e-04],
        [1.2290e-04],
        [5.9128e-05],
        [2.4676e-05],
        [5.4300e-05],
        [3.7074e-05],
        [2.8205e-04],
        [7.3910e-05],
        [4.3571e-05],
        [6.9261e-05]], device='cuda:0', dtype=torch.float16)/tensor([[4.3929e-05, 2.2030e-04, 2.7156e-04, 6.0678e-05, 1.4293e-04, 5.9247e-05,
         1.4853e-04, 1.2290e-04, 5.9128e-05, 2.4676e-05, 5.4300e-05, 3.7074e-05,
         2.8205e-04, 7.3910e-05, 4.3571e-05, 6.9261e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([5.7220e-05, 1.0216e-04, 1.6034e-04, 3.4153e-05, 6.0499e-05, 1.9848e-05,
        5.2333e-05, 5.2392e-05, 3.8981e-05, 2.9862e-05, 3.5346e-05, 3.0875e-05,
        1.8537e-04, 4.7803e-05, 2.8968e-05, 6.4492e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.6689e-05, 1.2493e-04, 7.6592e-05, 1.4842e-05, 4.9710e-05, 3.9279e-05,
        5.1379e-05, 7.2360e-05, 2.2888e-05, 7.8678e-06, 1.1265e-05, 1.1921e-05,
        7.3910e-05, 2.8133e-05, 1.6928e-05, 2.3603e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[4.3929e-05, 5.7220e-05, 1.6689e-05],
        [2.2030e-04, 1.0216e-04, 1.2493e-04],
        [2.7156e-04, 1.6034e-04, 7.6592e-05],
        [6.0678e-05, 3.4153e-05, 1.4842e-05],
        [1.4293e-04, 6.0499e-05, 4.9710e-05],
        [5.9247e-05, 1.9848e-05, 3.9279e-05],
        [1.4853e-04, 5.2333e-05, 5.1379e-05],
        [1.2290e-04, 5.2392e-05, 7.2360e-05],
        [5.9128e-05, 3.8981e-05, 2.2888e-05],
        [2.4676e-05, 2.9862e-05, 7.8678e-06],
        [5.4300e-05, 3.5346e-05, 1.1265e-05],
        [3.7074e-05, 3.0875e-05, 1.1921e-05],
        [2.8205e-04, 1.8537e-04, 7.3910e-05],
        [7.3910e-05, 4.7803e-05, 2.8133e-05],
        [4.3571e-05, 2.8968e-05, 1.6928e-05],
        [6.9261e-05, 6.4492e-05, 2.3603e-05]], device='cuda:0')
acc:  0.2708333333333333
Time taken to execute the de NLI task with prompt type auxiliary, variation 1 and batchsize 16: 0:02:45.385561
path ['42', 'de', 'llama', 'NLI', 'auxiliary', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI auxiliary 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 323.48it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[4.7445e-05],
        [3.1352e-05],
        [6.8486e-05],
        [5.6088e-05],
        [8.7917e-05],
        [1.3471e-05],
        [1.3077e-04],
        [3.7730e-05],
        [6.4075e-05],
        [4.6670e-05],
        [6.2883e-05],
        [4.7386e-05],
        [2.7776e-04],
        [1.0312e-05],
        [2.1791e-04],
        [1.5986e-04]], device='cuda:0', dtype=torch.float16)/tensor([[4.7445e-05, 3.1352e-05, 6.8486e-05, 5.6088e-05, 8.7917e-05, 1.3471e-05,
         1.3077e-04, 3.7730e-05, 6.4075e-05, 4.6670e-05, 6.2883e-05, 4.7386e-05,
         2.7776e-04, 1.0312e-05, 2.1791e-04, 1.5986e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([5.1439e-05, 2.7478e-05, 4.5657e-05, 4.4048e-05, 5.2392e-05, 9.8944e-06,
        7.1287e-05, 2.9922e-05, 3.9041e-05, 4.8935e-05, 5.9307e-05, 2.2471e-05,
        1.0848e-04, 2.3305e-05, 1.0389e-04, 5.3763e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.7285e-05, 1.4424e-05, 2.4557e-05, 5.6386e-05, 1.9372e-05, 4.4107e-06,
        5.6028e-05, 6.3181e-06, 2.7120e-05, 9.7752e-06, 2.0683e-05, 9.9540e-06,
        4.9651e-05, 7.0333e-06, 1.1796e-04, 5.1975e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[4.7445e-05, 5.1439e-05, 1.7285e-05],
        [3.1352e-05, 2.7478e-05, 1.4424e-05],
        [6.8486e-05, 4.5657e-05, 2.4557e-05],
        [5.6088e-05, 4.4048e-05, 5.6386e-05],
        [8.7917e-05, 5.2392e-05, 1.9372e-05],
        [1.3471e-05, 9.8944e-06, 4.4107e-06],
        [1.3077e-04, 7.1287e-05, 5.6028e-05],
        [3.7730e-05, 2.9922e-05, 6.3181e-06],
        [6.4075e-05, 3.9041e-05, 2.7120e-05],
        [4.6670e-05, 4.8935e-05, 9.7752e-06],
        [6.2883e-05, 5.9307e-05, 2.0683e-05],
        [4.7386e-05, 2.2471e-05, 9.9540e-06],
        [2.7776e-04, 1.0848e-04, 4.9651e-05],
        [1.0312e-05, 2.3305e-05, 7.0333e-06],
        [2.1791e-04, 1.0389e-04, 1.1796e-04],
        [1.5986e-04, 5.3763e-05, 5.1975e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.0478e-04],
        [1.8632e-04],
        [2.6226e-05],
        [6.6698e-05],
        [4.5180e-05],
        [4.5121e-05],
        [2.3842e-05],
        [1.7953e-04],
        [1.7226e-04],
        [6.2287e-05],
        [1.2612e-04],
        [2.4557e-04],
        [2.0647e-04],
        [6.4969e-05],
        [7.7724e-05],
        [2.4068e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.0478e-04, 1.8632e-04, 2.6226e-05, 6.6698e-05, 4.5180e-05, 4.5121e-05,
         2.3842e-05, 1.7953e-04, 1.7226e-04, 6.2287e-05, 1.2612e-04, 2.4557e-04,
         2.0647e-04, 6.4969e-05, 7.7724e-05, 2.4068e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([4.1246e-05, 1.0622e-04, 2.7776e-05, 6.8367e-05, 3.0160e-05, 5.7101e-05,
        1.3649e-05, 7.0274e-05, 8.1778e-05, 3.2544e-05, 6.1452e-05, 1.0318e-04,
        8.6725e-05, 5.4300e-05, 3.6359e-05, 1.0699e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([6.3777e-05, 4.9293e-05, 1.0729e-05, 2.1338e-05, 1.5497e-05, 4.3750e-05,
        5.3644e-06, 5.3942e-05, 4.9353e-05, 2.5034e-05, 5.9783e-05, 1.1402e-04,
        3.4928e-05, 3.2246e-05, 2.7835e-05, 7.7367e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.0478e-04, 4.1246e-05, 6.3777e-05],
        [1.8632e-04, 1.0622e-04, 4.9293e-05],
        [2.6226e-05, 2.7776e-05, 1.0729e-05],
        [6.6698e-05, 6.8367e-05, 2.1338e-05],
        [4.5180e-05, 3.0160e-05, 1.5497e-05],
        [4.5121e-05, 5.7101e-05, 4.3750e-05],
        [2.3842e-05, 1.3649e-05, 5.3644e-06],
        [1.7953e-04, 7.0274e-05, 5.3942e-05],
        [1.7226e-04, 8.1778e-05, 4.9353e-05],
        [6.2287e-05, 3.2544e-05, 2.5034e-05],
        [1.2612e-04, 6.1452e-05, 5.9783e-05],
        [2.4557e-04, 1.0318e-04, 1.1402e-04],
        [2.0647e-04, 8.6725e-05, 3.4928e-05],
        [6.4969e-05, 5.4300e-05, 3.2246e-05],
        [7.7724e-05, 3.6359e-05, 2.7835e-05],
        [2.4068e-04, 1.0699e-04, 7.7367e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[6.1750e-05],
        [1.3983e-04],
        [3.4034e-05],
        [4.4405e-05],
        [5.6863e-05],
        [7.2956e-05],
        [2.0027e-05],
        [7.8380e-05],
        [2.6536e-04],
        [6.2048e-05],
        [9.8944e-05],
        [3.3498e-05],
        [2.6989e-04],
        [7.1228e-05],
        [7.5519e-05],
        [5.6088e-05]], device='cuda:0', dtype=torch.float16)/tensor([[6.1750e-05, 1.3983e-04, 3.4034e-05, 4.4405e-05, 5.6863e-05, 7.2956e-05,
         2.0027e-05, 7.8380e-05, 2.6536e-04, 6.2048e-05, 9.8944e-05, 3.3498e-05,
         2.6989e-04, 7.1228e-05, 7.5519e-05, 5.6088e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([6.4254e-05, 6.3121e-05, 3.7313e-05, 3.3677e-05, 2.0981e-05, 6.1274e-05,
        2.9266e-05, 4.6372e-05, 7.6354e-05, 3.5048e-05, 3.7730e-05, 2.7955e-05,
        1.7130e-04, 4.4882e-05, 3.7074e-05, 3.8981e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.7657e-05, 4.5657e-05, 9.4771e-06, 1.7107e-05, 4.3511e-05, 1.9610e-05,
        6.7949e-06, 2.6882e-05, 2.2233e-05, 1.3649e-05, 1.1921e-05, 1.1444e-05,
        6.4373e-05, 3.0696e-05, 7.3671e-05, 1.8895e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[6.1750e-05, 6.4254e-05, 2.7657e-05],
        [1.3983e-04, 6.3121e-05, 4.5657e-05],
        [3.4034e-05, 3.7313e-05, 9.4771e-06],
        [4.4405e-05, 3.3677e-05, 1.7107e-05],
        [5.6863e-05, 2.0981e-05, 4.3511e-05],
        [7.2956e-05, 6.1274e-05, 1.9610e-05],
        [2.0027e-05, 2.9266e-05, 6.7949e-06],
        [7.8380e-05, 4.6372e-05, 2.6882e-05],
        [2.6536e-04, 7.6354e-05, 2.2233e-05],
        [6.2048e-05, 3.5048e-05, 1.3649e-05],
        [9.8944e-05, 3.7730e-05, 1.1921e-05],
        [3.3498e-05, 2.7955e-05, 1.1444e-05],
        [2.6989e-04, 1.7130e-04, 6.4373e-05],
        [7.1228e-05, 4.4882e-05, 3.0696e-05],
        [7.5519e-05, 3.7074e-05, 7.3671e-05],
        [5.6088e-05, 3.8981e-05, 1.8895e-05]], device='cuda:0')
acc:  0.3125
Time taken to execute the de NLI task with prompt type auxiliary, variation 2 and batchsize 16: 0:02:45.488959
path ['42', 'de', 'llama', 'NLI', 'auxiliary', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b NLI modal 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 328.14it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.7691e-04],
        [6.2406e-05],
        [6.2168e-05],
        [4.8578e-05],
        [8.1599e-05],
        [1.9777e-04],
        [3.9995e-05],
        [3.1233e-05],
        [1.7822e-05],
        [2.4796e-05],
        [1.1837e-04],
        [3.9876e-05],
        [2.3961e-05],
        [4.8339e-05],
        [1.2243e-04],
        [1.9836e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.7691e-04, 6.2406e-05, 6.2168e-05, 4.8578e-05, 8.1599e-05, 1.9777e-04,
         3.9995e-05, 3.1233e-05, 1.7822e-05, 2.4796e-05, 1.1837e-04, 3.9876e-05,
         2.3961e-05, 4.8339e-05, 1.2243e-04, 1.9836e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.2302e-04, 6.2704e-05, 4.5359e-05, 5.8711e-05, 3.5107e-05, 8.4519e-05,
        2.0385e-05, 1.8239e-05, 1.9252e-05, 1.6630e-05, 2.5928e-05, 3.1412e-05,
        1.4782e-05, 1.9670e-05, 4.5478e-05, 1.1224e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([6.4611e-05, 3.1590e-05, 1.7405e-05, 3.7074e-05, 1.0133e-05, 8.6069e-05,
        9.2983e-06, 5.6028e-06, 3.9935e-06, 6.0797e-06, 1.5199e-05, 2.9385e-05,
        4.0531e-06, 8.6427e-06, 7.4148e-05, 4.1246e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.7691e-04, 1.2302e-04, 6.4611e-05],
        [6.2406e-05, 6.2704e-05, 3.1590e-05],
        [6.2168e-05, 4.5359e-05, 1.7405e-05],
        [4.8578e-05, 5.8711e-05, 3.7074e-05],
        [8.1599e-05, 3.5107e-05, 1.0133e-05],
        [1.9777e-04, 8.4519e-05, 8.6069e-05],
        [3.9995e-05, 2.0385e-05, 9.2983e-06],
        [3.1233e-05, 1.8239e-05, 5.6028e-06],
        [1.7822e-05, 1.9252e-05, 3.9935e-06],
        [2.4796e-05, 1.6630e-05, 6.0797e-06],
        [1.1837e-04, 2.5928e-05, 1.5199e-05],
        [3.9876e-05, 3.1412e-05, 2.9385e-05],
        [2.3961e-05, 1.4782e-05, 4.0531e-06],
        [4.8339e-05, 1.9670e-05, 8.6427e-06],
        [1.2243e-04, 4.5478e-05, 7.4148e-05],
        [1.9836e-04, 1.1224e-04, 4.1246e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[6.3658e-05],
        [6.8426e-05],
        [1.0240e-04],
        [6.1154e-05],
        [6.3896e-05],
        [4.0293e-05],
        [1.5438e-05],
        [3.8207e-05],
        [4.9889e-05],
        [3.5226e-05],
        [2.0027e-05],
        [1.9968e-05],
        [2.1040e-05],
        [5.6386e-05],
        [2.6584e-05],
        [8.4817e-05]], device='cuda:0', dtype=torch.float16)/tensor([[6.3658e-05, 6.8426e-05, 1.0240e-04, 6.1154e-05, 6.3896e-05, 4.0293e-05,
         1.5438e-05, 3.8207e-05, 4.9889e-05, 3.5226e-05, 2.0027e-05, 1.9968e-05,
         2.1040e-05, 5.6386e-05, 2.6584e-05, 8.4817e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.3855e-05, 2.4676e-05, 3.4034e-05, 1.8418e-05, 2.1815e-05, 1.1265e-05,
        2.0444e-05, 1.7643e-05, 2.4915e-05, 2.8849e-05, 1.2100e-05, 1.4961e-05,
        8.7619e-06, 4.2379e-05, 5.3644e-06, 3.3259e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.5749e-05, 4.1068e-05, 1.8835e-05, 2.0981e-05, 3.5048e-05, 1.7881e-05,
        6.9141e-06, 8.0466e-06, 4.5717e-05, 1.1802e-05, 4.7088e-06, 4.8280e-06,
        5.4836e-06, 3.8087e-05, 1.6928e-05, 3.5286e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[6.3658e-05, 3.3855e-05, 2.5749e-05],
        [6.8426e-05, 2.4676e-05, 4.1068e-05],
        [1.0240e-04, 3.4034e-05, 1.8835e-05],
        [6.1154e-05, 1.8418e-05, 2.0981e-05],
        [6.3896e-05, 2.1815e-05, 3.5048e-05],
        [4.0293e-05, 1.1265e-05, 1.7881e-05],
        [1.5438e-05, 2.0444e-05, 6.9141e-06],
        [3.8207e-05, 1.7643e-05, 8.0466e-06],
        [4.9889e-05, 2.4915e-05, 4.5717e-05],
        [3.5226e-05, 2.8849e-05, 1.1802e-05],
        [2.0027e-05, 1.2100e-05, 4.7088e-06],
        [1.9968e-05, 1.4961e-05, 4.8280e-06],
        [2.1040e-05, 8.7619e-06, 5.4836e-06],
        [5.6386e-05, 4.2379e-05, 3.8087e-05],
        [2.6584e-05, 5.3644e-06, 1.6928e-05],
        [8.4817e-05, 3.3259e-05, 3.5286e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[6.8188e-05],
        [3.5167e-05],
        [3.3319e-05],
        [1.0681e-04],
        [2.8253e-05],
        [5.9426e-05],
        [7.3373e-05],
        [1.0359e-04],
        [3.5584e-05],
        [3.7968e-05],
        [4.1962e-05],
        [1.4424e-05],
        [2.5690e-05],
        [2.3007e-05],
        [1.4424e-05],
        [9.8407e-05]], device='cuda:0', dtype=torch.float16)/tensor([[6.8188e-05, 3.5167e-05, 3.3319e-05, 1.0681e-04, 2.8253e-05, 5.9426e-05,
         7.3373e-05, 1.0359e-04, 3.5584e-05, 3.7968e-05, 4.1962e-05, 1.4424e-05,
         2.5690e-05, 2.3007e-05, 1.4424e-05, 9.8407e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.4796e-05, 3.0041e-05, 4.3690e-05, 6.9916e-05, 1.6510e-05, 2.7120e-05,
        4.5121e-05, 4.0948e-05, 1.5557e-05, 2.0027e-05, 1.3709e-05, 1.2994e-05,
        1.0371e-05, 2.1815e-05, 1.0252e-05, 5.1737e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.7001e-05, 1.6570e-05, 1.2755e-05, 4.1485e-05, 1.4305e-05, 1.7881e-05,
        2.3067e-05, 2.4498e-05, 1.3947e-05, 1.4722e-05, 1.0312e-05, 3.5167e-06,
        6.6757e-06, 7.4506e-06, 7.9274e-06, 7.3671e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[6.8188e-05, 2.4796e-05, 2.7001e-05],
        [3.5167e-05, 3.0041e-05, 1.6570e-05],
        [3.3319e-05, 4.3690e-05, 1.2755e-05],
        [1.0681e-04, 6.9916e-05, 4.1485e-05],
        [2.8253e-05, 1.6510e-05, 1.4305e-05],
        [5.9426e-05, 2.7120e-05, 1.7881e-05],
        [7.3373e-05, 4.5121e-05, 2.3067e-05],
        [1.0359e-04, 4.0948e-05, 2.4498e-05],
        [3.5584e-05, 1.5557e-05, 1.3947e-05],
        [3.7968e-05, 2.0027e-05, 1.4722e-05],
        [4.1962e-05, 1.3709e-05, 1.0312e-05],
        [1.4424e-05, 1.2994e-05, 3.5167e-06],
        [2.5690e-05, 1.0371e-05, 6.6757e-06],
        [2.3007e-05, 2.1815e-05, 7.4506e-06],
        [1.4424e-05, 1.0252e-05, 7.9274e-06],
        [9.8407e-05, 5.1737e-05, 7.3671e-05]], device='cuda:0')
acc:  0.2708333333333333
Time taken to execute the de NLI task with prompt type modal, variation 0 and batchsize 16: 0:02:45.837705
path ['42', 'de', 'llama', 'NLI', 'modal', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI modal 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 357.40it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[3.5882e-05],
        [2.6286e-05],
        [3.8028e-05],
        [8.7321e-05],
        [1.7226e-04],
        [2.4199e-05],
        [3.5822e-05],
        [4.9531e-05],
        [6.0856e-05],
        [3.4571e-05],
        [5.0306e-05],
        [3.9279e-05],
        [2.4855e-05],
        [3.5107e-05],
        [1.3936e-04],
        [1.2147e-04]], device='cuda:0', dtype=torch.float16)/tensor([[3.5882e-05, 2.6286e-05, 3.8028e-05, 8.7321e-05, 1.7226e-04, 2.4199e-05,
         3.5822e-05, 4.9531e-05, 6.0856e-05, 3.4571e-05, 5.0306e-05, 3.9279e-05,
         2.4855e-05, 3.5107e-05, 1.3936e-04, 1.2147e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.6836e-05, 4.2319e-06, 2.5749e-05, 5.3942e-05, 1.0300e-04, 2.6643e-05,
        1.1027e-05, 2.2769e-05, 3.4809e-05, 1.1146e-05, 1.8835e-05, 2.6226e-05,
        9.4175e-06, 1.6570e-05, 2.6464e-05, 3.8207e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.1027e-05, 1.6570e-05, 8.5235e-06, 2.5213e-05, 5.7042e-05, 1.0490e-05,
        1.3113e-05, 1.0312e-05, 3.6597e-05, 8.2850e-06, 1.1146e-05, 2.6166e-05,
        6.1393e-06, 1.7703e-05, 1.5736e-05, 3.2187e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[3.5882e-05, 3.6836e-05, 1.1027e-05],
        [2.6286e-05, 4.2319e-06, 1.6570e-05],
        [3.8028e-05, 2.5749e-05, 8.5235e-06],
        [8.7321e-05, 5.3942e-05, 2.5213e-05],
        [1.7226e-04, 1.0300e-04, 5.7042e-05],
        [2.4199e-05, 2.6643e-05, 1.0490e-05],
        [3.5822e-05, 1.1027e-05, 1.3113e-05],
        [4.9531e-05, 2.2769e-05, 1.0312e-05],
        [6.0856e-05, 3.4809e-05, 3.6597e-05],
        [3.4571e-05, 1.1146e-05, 8.2850e-06],
        [5.0306e-05, 1.8835e-05, 1.1146e-05],
        [3.9279e-05, 2.6226e-05, 2.6166e-05],
        [2.4855e-05, 9.4175e-06, 6.1393e-06],
        [3.5107e-05, 1.6570e-05, 1.7703e-05],
        [1.3936e-04, 2.6464e-05, 1.5736e-05],
        [1.2147e-04, 3.8207e-05, 3.2187e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[7.1347e-05],
        [1.9121e-04],
        [6.5088e-05],
        [6.2287e-05],
        [6.1154e-05],
        [5.9366e-05],
        [2.1696e-05],
        [5.8234e-05],
        [8.0407e-05],
        [1.0282e-04],
        [1.0687e-04],
        [6.4015e-05],
        [4.1008e-05],
        [1.1683e-04],
        [3.2783e-05],
        [4.4644e-05]], device='cuda:0', dtype=torch.float16)/tensor([[7.1347e-05, 1.9121e-04, 6.5088e-05, 6.2287e-05, 6.1154e-05, 5.9366e-05,
         2.1696e-05, 5.8234e-05, 8.0407e-05, 1.0282e-04, 1.0687e-04, 6.4015e-05,
         4.1008e-05, 1.1683e-04, 3.2783e-05, 4.4644e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.5882e-05, 7.2360e-05, 1.6630e-05, 3.2902e-05, 1.8835e-05, 2.0564e-05,
        1.5259e-05, 2.6405e-05, 2.5988e-05, 5.3525e-05, 4.3690e-05, 5.2094e-05,
        3.5286e-05, 5.4598e-05, 1.7405e-05, 8.8215e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.0729e-05, 8.1003e-05, 2.3603e-05, 1.8597e-05, 4.4942e-05, 3.3677e-05,
        4.5300e-06, 1.6391e-05, 2.7895e-05, 2.9564e-05, 1.9670e-05, 2.7835e-05,
        1.9312e-05, 2.7061e-05, 1.3351e-05, 1.3947e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[7.1347e-05, 3.5882e-05, 1.0729e-05],
        [1.9121e-04, 7.2360e-05, 8.1003e-05],
        [6.5088e-05, 1.6630e-05, 2.3603e-05],
        [6.2287e-05, 3.2902e-05, 1.8597e-05],
        [6.1154e-05, 1.8835e-05, 4.4942e-05],
        [5.9366e-05, 2.0564e-05, 3.3677e-05],
        [2.1696e-05, 1.5259e-05, 4.5300e-06],
        [5.8234e-05, 2.6405e-05, 1.6391e-05],
        [8.0407e-05, 2.5988e-05, 2.7895e-05],
        [1.0282e-04, 5.3525e-05, 2.9564e-05],
        [1.0687e-04, 4.3690e-05, 1.9670e-05],
        [6.4015e-05, 5.2094e-05, 2.7835e-05],
        [4.1008e-05, 3.5286e-05, 1.9312e-05],
        [1.1683e-04, 5.4598e-05, 2.7061e-05],
        [3.2783e-05, 1.7405e-05, 1.3351e-05],
        [4.4644e-05, 8.8215e-06, 1.3947e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.2112e-04],
        [2.2769e-05],
        [8.7380e-05],
        [4.8697e-05],
        [1.0341e-04],
        [6.1274e-05],
        [1.8358e-05],
        [9.6202e-05],
        [2.4796e-05],
        [4.0054e-05],
        [1.9729e-05],
        [1.1659e-04],
        [2.9862e-05],
        [3.7730e-05],
        [2.1636e-05],
        [4.0054e-05]], device='cuda:0', dtype=torch.float16)/tensor([[1.2112e-04, 2.2769e-05, 8.7380e-05, 4.8697e-05, 1.0341e-04, 6.1274e-05,
         1.8358e-05, 9.6202e-05, 2.4796e-05, 4.0054e-05, 1.9729e-05, 1.1659e-04,
         2.9862e-05, 3.7730e-05, 2.1636e-05, 4.0054e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([6.9916e-05, 1.6451e-05, 3.7193e-05, 2.0266e-05, 5.0247e-05, 6.2287e-05,
        1.1027e-05, 3.9220e-05, 1.7226e-05, 1.8597e-05, 1.7047e-05, 2.4259e-05,
        1.6451e-05, 2.0564e-05, 1.2755e-05, 2.9385e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([3.9339e-05, 5.5432e-06, 3.4273e-05, 4.1723e-05, 7.0453e-05, 3.7789e-05,
        1.0371e-05, 4.8935e-05, 8.1062e-06, 1.7047e-05, 3.3975e-06, 2.5272e-05,
        4.6492e-06, 6.4969e-06, 5.0068e-06, 1.1206e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.2112e-04, 6.9916e-05, 3.9339e-05],
        [2.2769e-05, 1.6451e-05, 5.5432e-06],
        [8.7380e-05, 3.7193e-05, 3.4273e-05],
        [4.8697e-05, 2.0266e-05, 4.1723e-05],
        [1.0341e-04, 5.0247e-05, 7.0453e-05],
        [6.1274e-05, 6.2287e-05, 3.7789e-05],
        [1.8358e-05, 1.1027e-05, 1.0371e-05],
        [9.6202e-05, 3.9220e-05, 4.8935e-05],
        [2.4796e-05, 1.7226e-05, 8.1062e-06],
        [4.0054e-05, 1.8597e-05, 1.7047e-05],
        [1.9729e-05, 1.7047e-05, 3.3975e-06],
        [1.1659e-04, 2.4259e-05, 2.5272e-05],
        [2.9862e-05, 1.6451e-05, 4.6492e-06],
        [3.7730e-05, 2.0564e-05, 6.4969e-06],
        [2.1636e-05, 1.2755e-05, 5.0068e-06],
        [4.0054e-05, 2.9385e-05, 1.1206e-05]], device='cuda:0')
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type modal, variation 1 and batchsize 16: 0:02:45.457683
path ['42', 'de', 'llama', 'NLI', 'modal', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI modal 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 333.60it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[2.9087e-05],
        [4.8161e-05],
        [2.1935e-05],
        [5.3108e-05],
        [7.8976e-05],
        [2.9981e-05],
        [4.3988e-05],
        [1.2338e-04],
        [5.1141e-05],
        [2.3723e-05],
        [1.6415e-04],
        [1.6451e-04],
        [5.2214e-05],
        [3.8266e-05],
        [4.6253e-05],
        [2.2948e-05]], device='cuda:0', dtype=torch.float16)/tensor([[2.9087e-05, 4.8161e-05, 2.1935e-05, 5.3108e-05, 7.8976e-05, 2.9981e-05,
         4.3988e-05, 1.2338e-04, 5.1141e-05, 2.3723e-05, 1.6415e-04, 1.6451e-04,
         5.2214e-05, 3.8266e-05, 4.6253e-05, 2.2948e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([4.9472e-06, 1.4663e-05, 1.3471e-05, 3.4273e-05, 3.1650e-05, 1.3351e-05,
        2.3425e-05, 6.5625e-05, 2.7239e-05, 1.4603e-05, 4.2140e-05, 3.2365e-05,
        2.3067e-05, 3.6657e-05, 3.6061e-05, 1.7881e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.8716e-05, 1.8299e-05, 1.0252e-05, 1.6809e-05, 1.0908e-05, 8.0466e-06,
        8.1062e-06, 4.5359e-05, 2.6226e-05, 5.9009e-06, 3.6895e-05, 1.8656e-05,
        1.2338e-05, 1.9372e-05, 2.5630e-05, 4.8876e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.9087e-05, 4.9472e-06, 1.8716e-05],
        [4.8161e-05, 1.4663e-05, 1.8299e-05],
        [2.1935e-05, 1.3471e-05, 1.0252e-05],
        [5.3108e-05, 3.4273e-05, 1.6809e-05],
        [7.8976e-05, 3.1650e-05, 1.0908e-05],
        [2.9981e-05, 1.3351e-05, 8.0466e-06],
        [4.3988e-05, 2.3425e-05, 8.1062e-06],
        [1.2338e-04, 6.5625e-05, 4.5359e-05],
        [5.1141e-05, 2.7239e-05, 2.6226e-05],
        [2.3723e-05, 1.4603e-05, 5.9009e-06],
        [1.6415e-04, 4.2140e-05, 3.6895e-05],
        [1.6451e-04, 3.2365e-05, 1.8656e-05],
        [5.2214e-05, 2.3067e-05, 1.2338e-05],
        [3.8266e-05, 3.6657e-05, 1.9372e-05],
        [4.6253e-05, 3.6061e-05, 2.5630e-05],
        [2.2948e-05, 1.7881e-05, 4.8876e-06]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[2.8491e-05],
        [5.4598e-05],
        [2.7275e-04],
        [7.2658e-05],
        [3.0696e-05],
        [4.7982e-05],
        [6.9678e-05],
        [1.3113e-04],
        [9.0420e-05],
        [5.4240e-05],
        [8.2552e-05],
        [1.2088e-04],
        [5.0902e-05],
        [8.2791e-05],
        [5.0008e-05],
        [7.2420e-05]], device='cuda:0', dtype=torch.float16)/tensor([[2.8491e-05, 5.4598e-05, 2.7275e-04, 7.2658e-05, 3.0696e-05, 4.7982e-05,
         6.9678e-05, 1.3113e-04, 9.0420e-05, 5.4240e-05, 8.2552e-05, 1.2088e-04,
         5.0902e-05, 8.2791e-05, 5.0008e-05, 7.2420e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.1325e-05, 2.8789e-05, 1.3590e-04, 2.6345e-05, 2.7657e-05, 2.0027e-05,
        6.5744e-05, 4.8697e-05, 4.5061e-05, 3.6299e-05, 3.6240e-05, 6.1631e-05,
        2.3305e-05, 5.0664e-05, 3.6478e-05, 1.9908e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([6.1393e-06, 4.9174e-05, 9.7156e-05, 4.0650e-05, 1.1504e-05, 2.6703e-05,
        7.9453e-05, 6.2108e-05, 3.2902e-05, 4.7207e-05, 2.6107e-05, 5.0545e-05,
        1.2875e-05, 3.4571e-05, 1.9670e-05, 3.5107e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.8491e-05, 1.1325e-05, 6.1393e-06],
        [5.4598e-05, 2.8789e-05, 4.9174e-05],
        [2.7275e-04, 1.3590e-04, 9.7156e-05],
        [7.2658e-05, 2.6345e-05, 4.0650e-05],
        [3.0696e-05, 2.7657e-05, 1.1504e-05],
        [4.7982e-05, 2.0027e-05, 2.6703e-05],
        [6.9678e-05, 6.5744e-05, 7.9453e-05],
        [1.3113e-04, 4.8697e-05, 6.2108e-05],
        [9.0420e-05, 4.5061e-05, 3.2902e-05],
        [5.4240e-05, 3.6299e-05, 4.7207e-05],
        [8.2552e-05, 3.6240e-05, 2.6107e-05],
        [1.2088e-04, 6.1631e-05, 5.0545e-05],
        [5.0902e-05, 2.3305e-05, 1.2875e-05],
        [8.2791e-05, 5.0664e-05, 3.4571e-05],
        [5.0008e-05, 3.6478e-05, 1.9670e-05],
        [7.2420e-05, 1.9908e-05, 3.5107e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[6.3002e-05],
        [2.1458e-05],
        [5.9307e-05],
        [5.0247e-05],
        [8.7023e-05],
        [3.3855e-05],
        [1.4174e-04],
        [8.8453e-05],
        [7.7784e-05],
        [2.0134e-04],
        [2.1040e-05],
        [8.5413e-05],
        [9.2208e-05],
        [1.2910e-04],
        [3.7432e-05],
        [2.0957e-04]], device='cuda:0', dtype=torch.float16)/tensor([[6.3002e-05, 2.1458e-05, 5.9307e-05, 5.0247e-05, 8.7023e-05, 3.3855e-05,
         1.4174e-04, 8.8453e-05, 7.7784e-05, 2.0134e-04, 2.1040e-05, 8.5413e-05,
         9.2208e-05, 1.2910e-04, 3.7432e-05, 2.0957e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.9458e-05, 1.3947e-05, 5.1320e-05, 1.8835e-05, 2.9087e-05, 2.0504e-05,
        4.7863e-05, 4.4763e-05, 4.6015e-05, 7.5519e-05, 2.6464e-05, 2.2411e-05,
        3.1233e-05, 4.3750e-05, 1.3113e-05, 8.9943e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.4021e-05, 5.8413e-06, 3.2425e-05, 1.2815e-05, 1.5855e-05, 7.2122e-06,
        3.5286e-05, 8.7976e-05, 4.8578e-05, 9.2804e-05, 1.4424e-05, 5.9307e-05,
        3.2425e-05, 9.0361e-05, 1.0192e-05, 5.3406e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[6.3002e-05, 3.9458e-05, 2.4021e-05],
        [2.1458e-05, 1.3947e-05, 5.8413e-06],
        [5.9307e-05, 5.1320e-05, 3.2425e-05],
        [5.0247e-05, 1.8835e-05, 1.2815e-05],
        [8.7023e-05, 2.9087e-05, 1.5855e-05],
        [3.3855e-05, 2.0504e-05, 7.2122e-06],
        [1.4174e-04, 4.7863e-05, 3.5286e-05],
        [8.8453e-05, 4.4763e-05, 8.7976e-05],
        [7.7784e-05, 4.6015e-05, 4.8578e-05],
        [2.0134e-04, 7.5519e-05, 9.2804e-05],
        [2.1040e-05, 2.6464e-05, 1.4424e-05],
        [8.5413e-05, 2.2411e-05, 5.9307e-05],
        [9.2208e-05, 3.1233e-05, 3.2425e-05],
        [1.2910e-04, 4.3750e-05, 9.0361e-05],
        [3.7432e-05, 1.3113e-05, 1.0192e-05],
        [2.0957e-04, 8.9943e-05, 5.3406e-05]], device='cuda:0')
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type modal, variation 2 and batchsize 16: 0:02:45.891556
path ['42', 'de', 'llama', 'NLI', 'modal', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b NLI rare_synonyms 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 251.43it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[9.8407e-05],
        [4.8816e-05],
        [1.0484e-04],
        [2.5690e-05],
        [3.9756e-05],
        [4.9710e-05],
        [3.7074e-05],
        [2.4438e-05],
        [6.3837e-05],
        [3.4809e-05],
        [8.2552e-05],
        [4.1783e-05],
        [3.7849e-05],
        [1.7047e-05],
        [6.2823e-05],
        [2.1636e-05]], device='cuda:0', dtype=torch.float16)/tensor([[9.8407e-05, 4.8816e-05, 1.0484e-04, 2.5690e-05, 3.9756e-05, 4.9710e-05,
         3.7074e-05, 2.4438e-05, 6.3837e-05, 3.4809e-05, 8.2552e-05, 4.1783e-05,
         3.7849e-05, 1.7047e-05, 6.2823e-05, 2.1636e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([5.2392e-05, 3.4690e-05, 5.4061e-05, 1.6570e-05, 1.7762e-05, 2.2531e-05,
        5.8651e-05, 1.4722e-05, 1.8358e-05, 4.5240e-05, 2.1577e-05, 2.6226e-05,
        1.9550e-05, 1.6391e-05, 2.4438e-05, 2.2233e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.8491e-05, 3.3677e-05, 7.0870e-05, 7.0333e-06, 8.9407e-06, 1.6510e-05,
        2.3127e-05, 4.4107e-06, 2.1636e-05, 1.1623e-05, 3.8922e-05, 1.3530e-05,
        6.1989e-06, 3.9339e-06, 9.7752e-06, 6.7353e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[9.8407e-05, 5.2392e-05, 2.8491e-05],
        [4.8816e-05, 3.4690e-05, 3.3677e-05],
        [1.0484e-04, 5.4061e-05, 7.0870e-05],
        [2.5690e-05, 1.6570e-05, 7.0333e-06],
        [3.9756e-05, 1.7762e-05, 8.9407e-06],
        [4.9710e-05, 2.2531e-05, 1.6510e-05],
        [3.7074e-05, 5.8651e-05, 2.3127e-05],
        [2.4438e-05, 1.4722e-05, 4.4107e-06],
        [6.3837e-05, 1.8358e-05, 2.1636e-05],
        [3.4809e-05, 4.5240e-05, 1.1623e-05],
        [8.2552e-05, 2.1577e-05, 3.8922e-05],
        [4.1783e-05, 2.6226e-05, 1.3530e-05],
        [3.7849e-05, 1.9550e-05, 6.1989e-06],
        [1.7047e-05, 1.6391e-05, 3.9339e-06],
        [6.2823e-05, 2.4438e-05, 9.7752e-06],
        [2.1636e-05, 2.2233e-05, 6.7353e-06]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[9.5129e-05],
        [1.2970e-04],
        [4.0352e-05],
        [1.2445e-04],
        [2.5034e-05],
        [6.4015e-05],
        [2.1040e-05],
        [1.4687e-04],
        [2.0266e-05],
        [3.9816e-05],
        [2.0885e-04],
        [1.7464e-05],
        [6.8605e-05],
        [6.7353e-05],
        [8.1003e-05],
        [2.0897e-04]], device='cuda:0', dtype=torch.float16)/tensor([[9.5129e-05, 1.2970e-04, 4.0352e-05, 1.2445e-04, 2.5034e-05, 6.4015e-05,
         2.1040e-05, 1.4687e-04, 2.0266e-05, 3.9816e-05, 2.0885e-04, 1.7464e-05,
         6.8605e-05, 6.7353e-05, 8.1003e-05, 2.0897e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.7730e-05, 5.1618e-05, 1.4663e-05, 5.5969e-05, 1.0908e-05, 2.5511e-05,
        1.1742e-05, 2.9922e-05, 1.8597e-05, 3.4094e-05, 8.4877e-05, 2.1160e-05,
        4.9174e-05, 4.6551e-05, 4.1366e-05, 1.3149e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([9.4771e-06, 3.0398e-05, 9.7752e-06, 4.8757e-05, 6.0797e-06, 5.0068e-05,
        4.2319e-06, 1.6332e-05, 5.0068e-06, 1.7166e-05, 8.4043e-05, 7.2718e-06,
        3.9995e-05, 1.7583e-05, 3.0279e-05, 6.4969e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[9.5129e-05, 3.7730e-05, 9.4771e-06],
        [1.2970e-04, 5.1618e-05, 3.0398e-05],
        [4.0352e-05, 1.4663e-05, 9.7752e-06],
        [1.2445e-04, 5.5969e-05, 4.8757e-05],
        [2.5034e-05, 1.0908e-05, 6.0797e-06],
        [6.4015e-05, 2.5511e-05, 5.0068e-05],
        [2.1040e-05, 1.1742e-05, 4.2319e-06],
        [1.4687e-04, 2.9922e-05, 1.6332e-05],
        [2.0266e-05, 1.8597e-05, 5.0068e-06],
        [3.9816e-05, 3.4094e-05, 1.7166e-05],
        [2.0885e-04, 8.4877e-05, 8.4043e-05],
        [1.7464e-05, 2.1160e-05, 7.2718e-06],
        [6.8605e-05, 4.9174e-05, 3.9995e-05],
        [6.7353e-05, 4.6551e-05, 1.7583e-05],
        [8.1003e-05, 4.1366e-05, 3.0279e-05],
        [2.0897e-04, 1.3149e-04, 6.4969e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.9264e-04],
        [3.5048e-05],
        [1.0997e-04],
        [4.3571e-05],
        [4.6670e-05],
        [6.6161e-05],
        [6.4909e-05],
        [1.5438e-05],
        [2.8729e-05],
        [4.7684e-05],
        [1.3041e-04],
        [8.4102e-05],
        [1.5676e-05],
        [1.5163e-04],
        [7.9453e-05],
        [2.0564e-05]], device='cuda:0', dtype=torch.float16)/tensor([[1.9264e-04, 3.5048e-05, 1.0997e-04, 4.3571e-05, 4.6670e-05, 6.6161e-05,
         6.4909e-05, 1.5438e-05, 2.8729e-05, 4.7684e-05, 1.3041e-04, 8.4102e-05,
         1.5676e-05, 1.5163e-04, 7.9453e-05, 2.0564e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.0240e-04, 3.1352e-05, 4.3750e-05, 2.1398e-05, 1.0967e-05, 2.9206e-05,
        5.4121e-05, 2.0087e-05, 5.3644e-06, 1.7822e-05, 4.6670e-05, 2.5630e-05,
        1.0252e-05, 5.4419e-05, 2.3484e-05, 9.0599e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([3.9220e-05, 1.1683e-05, 4.2558e-05, 1.0848e-05, 2.1815e-05, 1.8477e-05,
        3.0041e-05, 4.1127e-06, 2.1398e-05, 1.7047e-05, 7.1704e-05, 2.9981e-05,
        7.8678e-06, 3.4094e-05, 4.3213e-05, 5.4836e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.9264e-04, 1.0240e-04, 3.9220e-05],
        [3.5048e-05, 3.1352e-05, 1.1683e-05],
        [1.0997e-04, 4.3750e-05, 4.2558e-05],
        [4.3571e-05, 2.1398e-05, 1.0848e-05],
        [4.6670e-05, 1.0967e-05, 2.1815e-05],
        [6.6161e-05, 2.9206e-05, 1.8477e-05],
        [6.4909e-05, 5.4121e-05, 3.0041e-05],
        [1.5438e-05, 2.0087e-05, 4.1127e-06],
        [2.8729e-05, 5.3644e-06, 2.1398e-05],
        [4.7684e-05, 1.7822e-05, 1.7047e-05],
        [1.3041e-04, 4.6670e-05, 7.1704e-05],
        [8.4102e-05, 2.5630e-05, 2.9981e-05],
        [1.5676e-05, 1.0252e-05, 7.8678e-06],
        [1.5163e-04, 5.4419e-05, 3.4094e-05],
        [7.9453e-05, 2.3484e-05, 4.3213e-05],
        [2.0564e-05, 9.0599e-06, 5.4836e-06]], device='cuda:0')
acc:  0.25
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 0 and batchsize 16: 0:02:45.436660
path ['42', 'de', 'llama', 'NLI', 'rare_synonyms', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI rare_synonyms 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 355.64it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[4.9591e-05],
        [1.5664e-04],
        [1.4377e-04],
        [1.5295e-04],
        [1.1671e-04],
        [5.9962e-05],
        [3.0613e-04],
        [7.7248e-05],
        [1.0908e-04],
        [1.0598e-04],
        [3.7909e-05],
        [3.6478e-05],
        [4.4882e-05],
        [1.7285e-05],
        [2.2113e-05],
        [2.5773e-04]], device='cuda:0', dtype=torch.float16)/tensor([[4.9591e-05, 1.5664e-04, 1.4377e-04, 1.5295e-04, 1.1671e-04, 5.9962e-05,
         3.0613e-04, 7.7248e-05, 1.0908e-04, 1.0598e-04, 3.7909e-05, 3.6478e-05,
         4.4882e-05, 1.7285e-05, 2.2113e-05, 2.5773e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.9564e-05, 3.3498e-05, 6.2168e-05, 6.4433e-05, 6.6698e-05, 2.2948e-05,
        1.4484e-04, 8.5115e-05, 3.8624e-05, 3.9935e-05, 1.9193e-05, 2.8074e-05,
        1.9193e-05, 1.8597e-05, 1.2934e-05, 1.0580e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.3828e-05, 1.3113e-05, 4.2379e-05, 2.6345e-05, 7.7367e-05, 1.6510e-05,
        5.6982e-05, 3.2783e-05, 3.7670e-05, 4.1246e-05, 8.5831e-06, 1.2279e-05,
        1.3351e-05, 3.6955e-06, 4.0531e-06, 1.1343e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[4.9591e-05, 2.9564e-05, 1.3828e-05],
        [1.5664e-04, 3.3498e-05, 1.3113e-05],
        [1.4377e-04, 6.2168e-05, 4.2379e-05],
        [1.5295e-04, 6.4433e-05, 2.6345e-05],
        [1.1671e-04, 6.6698e-05, 7.7367e-05],
        [5.9962e-05, 2.2948e-05, 1.6510e-05],
        [3.0613e-04, 1.4484e-04, 5.6982e-05],
        [7.7248e-05, 8.5115e-05, 3.2783e-05],
        [1.0908e-04, 3.8624e-05, 3.7670e-05],
        [1.0598e-04, 3.9935e-05, 4.1246e-05],
        [3.7909e-05, 1.9193e-05, 8.5831e-06],
        [3.6478e-05, 2.8074e-05, 1.2279e-05],
        [4.4882e-05, 1.9193e-05, 1.3351e-05],
        [1.7285e-05, 1.8597e-05, 3.6955e-06],
        [2.2113e-05, 1.2934e-05, 4.0531e-06],
        [2.5773e-04, 1.0580e-04, 1.1343e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[5.1916e-05],
        [7.0751e-05],
        [2.9266e-05],
        [6.3241e-05],
        [1.7917e-04],
        [5.7578e-05],
        [8.3685e-05],
        [2.4855e-05],
        [4.3333e-05],
        [7.7963e-05],
        [6.0737e-05],
        [1.3411e-05],
        [1.8024e-04],
        [1.6391e-05],
        [4.8637e-05],
        [7.3254e-05]], device='cuda:0', dtype=torch.float16)/tensor([[5.1916e-05, 7.0751e-05, 2.9266e-05, 6.3241e-05, 1.7917e-04, 5.7578e-05,
         8.3685e-05, 2.4855e-05, 4.3333e-05, 7.7963e-05, 6.0737e-05, 1.3411e-05,
         1.8024e-04, 1.6391e-05, 4.8637e-05, 7.3254e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.5822e-05, 4.9472e-05, 1.6272e-05, 1.9610e-05, 1.2660e-04, 7.1466e-05,
        3.4690e-05, 1.5557e-05, 4.8697e-05, 4.1306e-05, 1.9908e-05, 2.0981e-05,
        7.0930e-05, 1.5557e-05, 2.2352e-05, 3.7849e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.6570e-05, 3.9935e-05, 5.9605e-06, 2.0385e-05, 5.3585e-05, 3.4213e-05,
        1.0788e-05, 4.5896e-06, 1.3232e-05, 1.2100e-05, 8.7023e-06, 5.0068e-06,
        8.7678e-05, 4.7088e-06, 5.3644e-06, 2.2113e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[5.1916e-05, 3.5822e-05, 1.6570e-05],
        [7.0751e-05, 4.9472e-05, 3.9935e-05],
        [2.9266e-05, 1.6272e-05, 5.9605e-06],
        [6.3241e-05, 1.9610e-05, 2.0385e-05],
        [1.7917e-04, 1.2660e-04, 5.3585e-05],
        [5.7578e-05, 7.1466e-05, 3.4213e-05],
        [8.3685e-05, 3.4690e-05, 1.0788e-05],
        [2.4855e-05, 1.5557e-05, 4.5896e-06],
        [4.3333e-05, 4.8697e-05, 1.3232e-05],
        [7.7963e-05, 4.1306e-05, 1.2100e-05],
        [6.0737e-05, 1.9908e-05, 8.7023e-06],
        [1.3411e-05, 2.0981e-05, 5.0068e-06],
        [1.8024e-04, 7.0930e-05, 8.7678e-05],
        [1.6391e-05, 1.5557e-05, 4.7088e-06],
        [4.8637e-05, 2.2352e-05, 5.3644e-06],
        [7.3254e-05, 3.7849e-05, 2.2113e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[2.1946e-04],
        [7.5221e-05],
        [5.0664e-05],
        [2.3186e-05],
        [3.6597e-05],
        [2.9147e-05],
        [1.1975e-04],
        [1.3685e-04],
        [2.7537e-04],
        [1.0520e-04],
        [5.3823e-05],
        [2.6762e-05],
        [4.2975e-05],
        [2.3961e-05],
        [9.5904e-05],
        [4.4107e-05]], device='cuda:0', dtype=torch.float16)/tensor([[2.1946e-04, 7.5221e-05, 5.0664e-05, 2.3186e-05, 3.6597e-05, 2.9147e-05,
         1.1975e-04, 1.3685e-04, 2.7537e-04, 1.0520e-04, 5.3823e-05, 2.6762e-05,
         4.2975e-05, 2.3961e-05, 9.5904e-05, 4.4107e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([7.6652e-05, 2.9385e-05, 3.4809e-05, 1.1742e-05, 2.0146e-05, 1.6332e-05,
        6.4492e-05, 4.4823e-05, 1.6928e-04, 6.6459e-05, 2.9206e-05, 1.8716e-05,
        1.1802e-05, 3.3438e-05, 4.6730e-05, 3.8624e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.7657e-05, 1.0669e-05, 3.3081e-05, 5.9009e-06, 7.0930e-06, 4.8876e-06,
        2.8253e-05, 5.4598e-05, 8.6248e-05, 2.7835e-05, 5.3644e-06, 5.1856e-06,
        1.4603e-05, 8.4639e-06, 4.7505e-05, 2.0266e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.1946e-04, 7.6652e-05, 2.7657e-05],
        [7.5221e-05, 2.9385e-05, 1.0669e-05],
        [5.0664e-05, 3.4809e-05, 3.3081e-05],
        [2.3186e-05, 1.1742e-05, 5.9009e-06],
        [3.6597e-05, 2.0146e-05, 7.0930e-06],
        [2.9147e-05, 1.6332e-05, 4.8876e-06],
        [1.1975e-04, 6.4492e-05, 2.8253e-05],
        [1.3685e-04, 4.4823e-05, 5.4598e-05],
        [2.7537e-04, 1.6928e-04, 8.6248e-05],
        [1.0520e-04, 6.6459e-05, 2.7835e-05],
        [5.3823e-05, 2.9206e-05, 5.3644e-06],
        [2.6762e-05, 1.8716e-05, 5.1856e-06],
        [4.2975e-05, 1.1802e-05, 1.4603e-05],
        [2.3961e-05, 3.3438e-05, 8.4639e-06],
        [9.5904e-05, 4.6730e-05, 4.7505e-05],
        [4.4107e-05, 3.8624e-05, 2.0266e-05]], device='cuda:0')
acc:  0.25
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 1 and batchsize 16: 0:02:45.787936
path ['42', 'de', 'llama', 'NLI', 'rare_synonyms', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI rare_synonyms 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 370.62it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.9765e-04],
        [7.0691e-05],
        [1.2636e-04],
        [5.4240e-05],
        [2.4021e-05],
        [7.2718e-05],
        [5.9009e-05],
        [1.5259e-05],
        [3.0935e-05],
        [5.0306e-05],
        [1.0395e-04],
        [7.7307e-05],
        [4.2915e-05],
        [7.3731e-05],
        [4.2498e-05],
        [1.6868e-05]], device='cuda:0', dtype=torch.float16)/tensor([[1.9765e-04, 7.0691e-05, 1.2636e-04, 5.4240e-05, 2.4021e-05, 7.2718e-05,
         5.9009e-05, 1.5259e-05, 3.0935e-05, 5.0306e-05, 1.0395e-04, 7.7307e-05,
         4.2915e-05, 7.3731e-05, 4.2498e-05, 1.6868e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([8.4579e-05, 5.4836e-05, 5.2631e-05, 8.2612e-05, 2.4736e-05, 3.9697e-05,
        4.3094e-05, 2.1219e-05, 1.9670e-05, 1.4305e-05, 5.1379e-05, 2.8789e-05,
        3.2067e-05, 2.4259e-05, 2.0385e-05, 1.2577e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([7.6175e-05, 1.8239e-05, 2.8074e-05, 2.1935e-05, 5.3644e-06, 2.7180e-05,
        3.8385e-05, 5.8413e-06, 5.4836e-06, 1.6034e-05, 7.6234e-05, 4.6968e-05,
        3.2425e-05, 2.7657e-05, 7.4506e-06, 9.5367e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.9765e-04, 8.4579e-05, 7.6175e-05],
        [7.0691e-05, 5.4836e-05, 1.8239e-05],
        [1.2636e-04, 5.2631e-05, 2.8074e-05],
        [5.4240e-05, 8.2612e-05, 2.1935e-05],
        [2.4021e-05, 2.4736e-05, 5.3644e-06],
        [7.2718e-05, 3.9697e-05, 2.7180e-05],
        [5.9009e-05, 4.3094e-05, 3.8385e-05],
        [1.5259e-05, 2.1219e-05, 5.8413e-06],
        [3.0935e-05, 1.9670e-05, 5.4836e-06],
        [5.0306e-05, 1.4305e-05, 1.6034e-05],
        [1.0395e-04, 5.1379e-05, 7.6234e-05],
        [7.7307e-05, 2.8789e-05, 4.6968e-05],
        [4.2915e-05, 3.2067e-05, 3.2425e-05],
        [7.3731e-05, 2.4259e-05, 2.7657e-05],
        [4.2498e-05, 2.0385e-05, 7.4506e-06],
        [1.6868e-05, 1.2577e-05, 9.5367e-06]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[3.5584e-05],
        [2.5034e-05],
        [7.1526e-05],
        [2.2388e-04],
        [2.2101e-04],
        [3.4392e-05],
        [3.0458e-05],
        [1.1104e-04],
        [3.4094e-05],
        [9.8586e-05],
        [6.3121e-05],
        [1.2875e-04],
        [4.8459e-05],
        [2.1935e-05],
        [3.0756e-05],
        [1.7941e-05]], device='cuda:0', dtype=torch.float16)/tensor([[3.5584e-05, 2.5034e-05, 7.1526e-05, 2.2388e-04, 2.2101e-04, 3.4392e-05,
         3.0458e-05, 1.1104e-04, 3.4094e-05, 9.8586e-05, 6.3121e-05, 1.2875e-04,
         4.8459e-05, 2.1935e-05, 3.0756e-05, 1.7941e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.4378e-05, 1.3411e-05, 2.6286e-05, 1.2743e-04, 1.4353e-04, 2.3246e-05,
        1.9670e-05, 4.5598e-05, 6.9141e-06, 5.4121e-05, 6.1452e-05, 4.4644e-05,
        2.2769e-05, 2.4796e-05, 4.4107e-05, 1.9014e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([1.3947e-05, 4.7684e-06, 3.2544e-05, 4.5240e-05, 7.1108e-05, 7.8082e-06,
        7.8678e-06, 4.4644e-05, 1.8716e-05, 2.7597e-05, 2.8968e-05, 6.6996e-05,
        1.5914e-05, 6.6757e-06, 1.0431e-05, 4.6492e-06], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[3.5584e-05, 2.4378e-05, 1.3947e-05],
        [2.5034e-05, 1.3411e-05, 4.7684e-06],
        [7.1526e-05, 2.6286e-05, 3.2544e-05],
        [2.2388e-04, 1.2743e-04, 4.5240e-05],
        [2.2101e-04, 1.4353e-04, 7.1108e-05],
        [3.4392e-05, 2.3246e-05, 7.8082e-06],
        [3.0458e-05, 1.9670e-05, 7.8678e-06],
        [1.1104e-04, 4.5598e-05, 4.4644e-05],
        [3.4094e-05, 6.9141e-06, 1.8716e-05],
        [9.8586e-05, 5.4121e-05, 2.7597e-05],
        [6.3121e-05, 6.1452e-05, 2.8968e-05],
        [1.2875e-04, 4.4644e-05, 6.6996e-05],
        [4.8459e-05, 2.2769e-05, 1.5914e-05],
        [2.1935e-05, 2.4796e-05, 6.6757e-06],
        [3.0756e-05, 4.4107e-05, 1.0431e-05],
        [1.7941e-05, 1.9014e-05, 4.6492e-06]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[6.6280e-05],
        [2.9325e-05],
        [1.4079e-04],
        [1.2207e-04],
        [2.8491e-05],
        [6.8188e-05],
        [8.1122e-05],
        [2.3782e-05],
        [2.3007e-05],
        [3.7253e-05],
        [1.1349e-04],
        [1.9908e-05],
        [1.6034e-05],
        [3.6240e-05],
        [3.1888e-05],
        [5.5790e-05]], device='cuda:0', dtype=torch.float16)/tensor([[6.6280e-05, 2.9325e-05, 1.4079e-04, 1.2207e-04, 2.8491e-05, 6.8188e-05,
         8.1122e-05, 2.3782e-05, 2.3007e-05, 3.7253e-05, 1.1349e-04, 1.9908e-05,
         1.6034e-05, 3.6240e-05, 3.1888e-05, 5.5790e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.9445e-05, 1.9133e-05, 4.9591e-05, 2.9981e-05, 1.7405e-05, 2.1994e-05,
        3.9101e-05, 1.1563e-05, 1.6510e-05, 1.5020e-05, 7.1645e-05, 9.7156e-06,
        2.3246e-05, 3.4332e-05, 2.7180e-05, 2.6822e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 325, 11381, 1428] -> tensor([2.0206e-05, 6.7949e-06, 3.1173e-05, 1.5378e-05, 7.3314e-06, 2.1756e-05,
        9.1791e-06, 5.7817e-06, 5.0664e-06, 1.4544e-05, 4.4465e-05, 5.6028e-06,
        4.5300e-06, 1.0908e-05, 1.6570e-05, 5.5134e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[6.6280e-05, 2.9445e-05, 2.0206e-05],
        [2.9325e-05, 1.9133e-05, 6.7949e-06],
        [1.4079e-04, 4.9591e-05, 3.1173e-05],
        [1.2207e-04, 2.9981e-05, 1.5378e-05],
        [2.8491e-05, 1.7405e-05, 7.3314e-06],
        [6.8188e-05, 2.1994e-05, 2.1756e-05],
        [8.1122e-05, 3.9101e-05, 9.1791e-06],
        [2.3782e-05, 1.1563e-05, 5.7817e-06],
        [2.3007e-05, 1.6510e-05, 5.0664e-06],
        [3.7253e-05, 1.5020e-05, 1.4544e-05],
        [1.1349e-04, 7.1645e-05, 4.4465e-05],
        [1.9908e-05, 9.7156e-06, 5.6028e-06],
        [1.6034e-05, 2.3246e-05, 4.5300e-06],
        [3.6240e-05, 3.4332e-05, 1.0908e-05],
        [3.1888e-05, 2.7180e-05, 1.6570e-05],
        [5.5790e-05, 2.6822e-05, 5.5134e-05]], device='cuda:0')
acc:  0.25
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 2 and batchsize 16: 0:02:45.124139
path ['42', 'de', 'llama', 'NLI', 'rare_synonyms', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA active 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 309.81it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.6737e-04],
        [2.3830e-04],
        [2.6588e-03],
        [6.0916e-05],
        [3.5477e-04],
        [8.0585e-05],
        [2.8944e-04],
        [8.6784e-04],
        [1.5175e-04],
        [6.4182e-04],
        [1.5316e-03],
        [2.0635e-04],
        [8.2016e-04],
        [4.2033e-04],
        [1.9436e-03],
        [2.2411e-03]], device='cuda:0', dtype=torch.float16)/tensor([[1.6737e-04, 2.3830e-04, 2.6588e-03, 6.0916e-05, 3.5477e-04, 8.0585e-05,
         2.8944e-04, 8.6784e-04, 1.5175e-04, 6.4182e-04, 1.5316e-03, 2.0635e-04,
         8.2016e-04, 4.2033e-04, 1.9436e-03, 2.2411e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([5.5969e-05, 1.2434e-04, 4.7541e-04, 1.0431e-05, 2.8193e-05, 1.8716e-05,
        2.4378e-05, 1.3471e-04, 2.1935e-05, 1.7464e-05, 2.4390e-04, 2.6643e-05,
        5.5611e-05, 4.5717e-05, 2.2435e-04, 7.6246e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.6737e-04, 5.5969e-05],
        [2.3830e-04, 1.2434e-04],
        [2.6588e-03, 4.7541e-04],
        [6.0916e-05, 1.0431e-05],
        [3.5477e-04, 2.8193e-05],
        [8.0585e-05, 1.8716e-05],
        [2.8944e-04, 2.4378e-05],
        [8.6784e-04, 1.3471e-04],
        [1.5175e-04, 2.1935e-05],
        [6.4182e-04, 1.7464e-05],
        [1.5316e-03, 2.4390e-04],
        [2.0635e-04, 2.6643e-05],
        [8.2016e-04, 5.5611e-05],
        [4.2033e-04, 4.5717e-05],
        [1.9436e-03, 2.2435e-04],
        [2.2411e-03, 7.6246e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[7.5483e-04],
        [4.9543e-04],
        [3.6287e-04],
        [3.3689e-04],
        [3.5906e-04],
        [8.2016e-04],
        [1.3952e-03],
        [6.3229e-04],
        [5.4455e-04],
        [1.2520e-02],
        [1.1391e-02],
        [8.3983e-05],
        [6.0654e-04],
        [2.0313e-03],
        [1.5354e-03],
        [6.8605e-05]], device='cuda:0', dtype=torch.float16)/tensor([[7.5483e-04, 4.9543e-04, 3.6287e-04, 3.3689e-04, 3.5906e-04, 8.2016e-04,
         1.3952e-03, 6.3229e-04, 5.4455e-04, 1.2520e-02, 1.1391e-02, 8.3983e-05,
         6.0654e-04, 2.0313e-03, 1.5354e-03, 6.8605e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([5.7399e-05, 1.3149e-04, 6.4313e-05, 1.3590e-05, 9.3818e-05, 5.4955e-05,
        3.4285e-04, 1.0461e-04, 1.8179e-05, 8.2254e-04, 1.5392e-03, 1.3351e-05,
        7.0632e-05, 1.3590e-04, 1.7357e-04, 1.5855e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[7.5483e-04, 5.7399e-05],
        [4.9543e-04, 1.3149e-04],
        [3.6287e-04, 6.4313e-05],
        [3.3689e-04, 1.3590e-05],
        [3.5906e-04, 9.3818e-05],
        [8.2016e-04, 5.4955e-05],
        [1.3952e-03, 3.4285e-04],
        [6.3229e-04, 1.0461e-04],
        [5.4455e-04, 1.8179e-05],
        [1.2520e-02, 8.2254e-04],
        [1.1391e-02, 1.5392e-03],
        [8.3983e-05, 1.3351e-05],
        [6.0654e-04, 7.0632e-05],
        [2.0313e-03, 1.3590e-04],
        [1.5354e-03, 1.7357e-04],
        [6.8605e-05, 1.5855e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0027],
        [0.0010],
        [0.0003],
        [0.0014],
        [0.0010],
        [0.0002],
        [0.0004],
        [0.0013],
        [0.0011],
        [0.0002],
        [0.0002],
        [0.0003],
        [0.0018],
        [0.0063],
        [0.0011],
        [0.0019]], device='cuda:0', dtype=torch.float16)/tensor([[0.0027, 0.0010, 0.0003, 0.0014, 0.0010, 0.0002, 0.0004, 0.0013, 0.0011,
         0.0002, 0.0002, 0.0003, 0.0018, 0.0063, 0.0011, 0.0019]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.7180e-04, 2.1470e-04, 1.1975e-04, 1.1325e-04, 2.2531e-04, 1.0478e-04,
        6.1691e-05, 3.3641e-04, 4.5090e-03, 5.0008e-05, 6.3956e-05, 1.4663e-04,
        4.4179e-04, 5.2166e-04, 1.4734e-04, 3.8564e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.7351e-03, 2.7180e-04],
        [9.7370e-04, 2.1470e-04],
        [3.4237e-04, 1.1975e-04],
        [1.4362e-03, 1.1325e-04],
        [9.5510e-04, 2.2531e-04],
        [2.3031e-04, 1.0478e-04],
        [3.5405e-04, 6.1691e-05],
        [1.2665e-03, 3.3641e-04],
        [1.1168e-03, 4.5090e-03],
        [2.0993e-04, 5.0008e-05],
        [2.3782e-04, 6.3956e-05],
        [2.9421e-04, 1.4663e-04],
        [1.7939e-03, 4.4179e-04],
        [6.2866e-03, 5.2166e-04],
        [1.1301e-03, 1.4734e-04],
        [1.8997e-03, 3.8564e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0008],
        [0.0002]], device='cuda:0', dtype=torch.float16)/tensor([[0.0008, 0.0002]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([2.7418e-05, 4.3988e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[8.0156e-04, 2.7418e-05],
        [2.3484e-04, 4.3988e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type active, variation 0 and batchsize 16: 0:03:07.010497
path ['42', 'de', 'llama', 'SA', 'active', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA active 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 193.71it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0010],
        [0.0004],
        [0.0140],
        [0.0013],
        [0.0015],
        [0.0002],
        [0.0004],
        [0.0022],
        [0.0011],
        [0.0020],
        [0.0016],
        [0.0045],
        [0.0002],
        [0.0008],
        [0.0014],
        [0.0032]], device='cuda:0', dtype=torch.float16)/tensor([[0.0010, 0.0004, 0.0140, 0.0013, 0.0015, 0.0002, 0.0004, 0.0022, 0.0011,
         0.0020, 0.0016, 0.0045, 0.0002, 0.0008, 0.0014, 0.0032]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.4961e-05, 2.4855e-05, 1.0414e-03, 7.8976e-05, 3.4256e-03, 1.6332e-05,
        2.2769e-05, 1.3232e-04, 5.2392e-05, 3.5286e-05, 2.0480e-04, 2.6584e-04,
        4.8995e-05, 1.0413e-04, 2.8372e-04, 4.7803e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.0366e-03, 1.4961e-05],
        [4.0483e-04, 2.4855e-05],
        [1.4000e-02, 1.0414e-03],
        [1.2980e-03, 7.8976e-05],
        [1.4505e-03, 3.4256e-03],
        [1.6212e-04, 1.6332e-05],
        [4.1175e-04, 2.2769e-05],
        [2.2316e-03, 1.3232e-04],
        [1.1101e-03, 5.2392e-05],
        [2.0065e-03, 3.5286e-05],
        [1.6022e-03, 2.0480e-04],
        [4.5395e-03, 2.6584e-04],
        [1.6999e-04, 4.8995e-05],
        [7.7295e-04, 1.0413e-04],
        [1.4362e-03, 2.8372e-04],
        [3.1605e-03, 4.7803e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[2.8920e-04],
        [3.3855e-04],
        [1.9848e-04],
        [1.0500e-03],
        [3.8338e-04],
        [4.5919e-04],
        [5.9366e-05],
        [1.0834e-03],
        [1.5717e-03],
        [1.0996e-03],
        [8.5473e-05],
        [2.8152e-03],
        [4.2272e-04],
        [3.7050e-04],
        [2.2447e-04],
        [7.5281e-05]], device='cuda:0', dtype=torch.float16)/tensor([[2.8920e-04, 3.3855e-04, 1.9848e-04, 1.0500e-03, 3.8338e-04, 4.5919e-04,
         5.9366e-05, 1.0834e-03, 1.5717e-03, 1.0996e-03, 8.5473e-05, 2.8152e-03,
         4.2272e-04, 3.7050e-04, 2.2447e-04, 7.5281e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.1057e-04, 9.0003e-06, 3.3915e-05, 1.9431e-05, 1.1724e-04, 7.6592e-05,
        9.6560e-06, 1.1593e-04, 2.9349e-04, 5.1856e-05, 1.8954e-05, 7.5102e-04,
        4.5002e-05, 5.5313e-05, 7.4923e-05, 1.4246e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.8920e-04, 1.1057e-04],
        [3.3855e-04, 9.0003e-06],
        [1.9848e-04, 3.3915e-05],
        [1.0500e-03, 1.9431e-05],
        [3.8338e-04, 1.1724e-04],
        [4.5919e-04, 7.6592e-05],
        [5.9366e-05, 9.6560e-06],
        [1.0834e-03, 1.1593e-04],
        [1.5717e-03, 2.9349e-04],
        [1.0996e-03, 5.1856e-05],
        [8.5473e-05, 1.8954e-05],
        [2.8152e-03, 7.5102e-04],
        [4.2272e-04, 4.5002e-05],
        [3.7050e-04, 5.5313e-05],
        [2.2447e-04, 7.4923e-05],
        [7.5281e-05, 1.4246e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.3459e-04],
        [4.1008e-04],
        [3.7313e-04],
        [2.6798e-04],
        [1.2039e-02],
        [6.0797e-04],
        [4.0817e-03],
        [1.0300e-03],
        [3.4404e-04],
        [1.1921e-03],
        [1.7328e-03],
        [1.2360e-03],
        [7.3910e-05],
        [4.8065e-04],
        [1.0014e-03],
        [3.6311e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.3459e-04, 4.1008e-04, 3.7313e-04, 2.6798e-04, 1.2039e-02, 6.0797e-04,
         4.0817e-03, 1.0300e-03, 3.4404e-04, 1.1921e-03, 1.7328e-03, 1.2360e-03,
         7.3910e-05, 4.8065e-04, 1.0014e-03, 3.6311e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.4246e-05, 1.0276e-04, 4.0650e-05, 5.8413e-05, 6.6662e-04, 1.5688e-04,
        3.1686e-04, 1.0520e-04, 3.2365e-05, 1.1599e-04, 2.3448e-04, 5.1916e-05,
        1.1563e-05, 9.4056e-05, 2.3663e-05, 7.3969e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.3459e-04, 1.4246e-05],
        [4.1008e-04, 1.0276e-04],
        [3.7313e-04, 4.0650e-05],
        [2.6798e-04, 5.8413e-05],
        [1.2039e-02, 6.6662e-04],
        [6.0797e-04, 1.5688e-04],
        [4.0817e-03, 3.1686e-04],
        [1.0300e-03, 1.0520e-04],
        [3.4404e-04, 3.2365e-05],
        [1.1921e-03, 1.1599e-04],
        [1.7328e-03, 2.3448e-04],
        [1.2360e-03, 5.1916e-05],
        [7.3910e-05, 1.1563e-05],
        [4.8065e-04, 9.4056e-05],
        [1.0014e-03, 2.3663e-05],
        [3.6311e-04, 7.3969e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0002],
        [0.0002]], device='cuda:0', dtype=torch.float16)/tensor([[0.0002, 0.0002]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([4.3750e-05, 2.7478e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[1.6117e-04, 4.3750e-05],
        [2.2495e-04, 2.7478e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type active, variation 1 and batchsize 16: 0:03:36.402585
path ['42', 'de', 'llama', 'SA', 'active', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA active 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 380.26it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0005],
        [0.0002],
        [0.0006],
        [0.0036],
        [0.0015],
        [0.0017],
        [0.0003],
        [0.0005],
        [0.0005],
        [0.0002],
        [0.0015],
        [0.0004],
        [0.0003],
        [0.0004],
        [0.0004],
        [0.0011]], device='cuda:0', dtype=torch.float16)/tensor([[0.0005, 0.0002, 0.0006, 0.0036, 0.0015, 0.0017, 0.0003, 0.0005, 0.0005,
         0.0002, 0.0015, 0.0004, 0.0003, 0.0004, 0.0004, 0.0011]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([9.1910e-05, 6.4135e-05, 1.4353e-04, 1.0004e-03, 2.3537e-03, 1.6451e-04,
        4.3452e-05, 5.2571e-05, 1.3471e-04, 7.2598e-05, 1.5581e-04, 5.1439e-05,
        7.8321e-05, 9.5367e-06, 3.7789e-05, 1.4591e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[5.3549e-04, 9.1910e-05],
        [2.3413e-04, 6.4135e-05],
        [5.8699e-04, 1.4353e-04],
        [3.6106e-03, 1.0004e-03],
        [1.5059e-03, 2.3537e-03],
        [1.6613e-03, 1.6451e-04],
        [3.4332e-04, 4.3452e-05],
        [4.7064e-04, 5.2571e-05],
        [4.6182e-04, 1.3471e-04],
        [1.6773e-04, 7.2598e-05],
        [1.4582e-03, 1.5581e-04],
        [3.7813e-04, 5.1439e-05],
        [2.9945e-04, 7.8321e-05],
        [3.7789e-04, 9.5367e-06],
        [4.3488e-04, 3.7789e-05],
        [1.0557e-03, 1.4591e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.0622e-04],
        [8.8024e-04],
        [1.0185e-03],
        [2.5539e-03],
        [2.8610e-03],
        [4.3631e-04],
        [8.4877e-04],
        [1.0977e-03],
        [3.1614e-04],
        [1.4477e-03],
        [1.6785e-03],
        [2.9325e-04],
        [1.7456e-02],
        [7.2002e-04],
        [2.6894e-04],
        [8.0049e-05]], device='cuda:0', dtype=torch.float16)/tensor([[1.0622e-04, 8.8024e-04, 1.0185e-03, 2.5539e-03, 2.8610e-03, 4.3631e-04,
         8.4877e-04, 1.0977e-03, 3.1614e-04, 1.4477e-03, 1.6785e-03, 2.9325e-04,
         1.7456e-02, 7.2002e-04, 2.6894e-04, 8.0049e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.8014e-05, 3.9577e-05, 2.0146e-05, 4.7207e-04, 2.6584e-04, 4.1902e-05,
        2.7180e-05, 2.8872e-04, 3.5048e-05, 9.4950e-05, 2.0325e-04, 1.0622e-04,
        1.7452e-03, 1.0842e-04, 4.4584e-05, 1.2279e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.0622e-04, 2.8014e-05],
        [8.8024e-04, 3.9577e-05],
        [1.0185e-03, 2.0146e-05],
        [2.5539e-03, 4.7207e-04],
        [2.8610e-03, 2.6584e-04],
        [4.3631e-04, 4.1902e-05],
        [8.4877e-04, 2.7180e-05],
        [1.0977e-03, 2.8872e-04],
        [3.1614e-04, 3.5048e-05],
        [1.4477e-03, 9.4950e-05],
        [1.6785e-03, 2.0325e-04],
        [2.9325e-04, 1.0622e-04],
        [1.7456e-02, 1.7452e-03],
        [7.2002e-04, 1.0842e-04],
        [2.6894e-04, 4.4584e-05],
        [8.0049e-05, 1.2279e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.2398e-03],
        [1.3084e-03],
        [9.7871e-05],
        [6.0797e-04],
        [7.4339e-04],
        [2.1887e-04],
        [3.6764e-04],
        [1.2741e-02],
        [5.0831e-04],
        [6.6280e-04],
        [1.9703e-03],
        [4.8101e-05],
        [1.6618e-04],
        [4.7569e-03],
        [1.4477e-03],
        [1.8561e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.2398e-03, 1.3084e-03, 9.7871e-05, 6.0797e-04, 7.4339e-04, 2.1887e-04,
         3.6764e-04, 1.2741e-02, 5.0831e-04, 6.6280e-04, 1.9703e-03, 4.8101e-05,
         1.6618e-04, 4.7569e-03, 1.4477e-03, 1.8561e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.1861e-04, 3.1054e-05, 1.7226e-05, 1.9372e-05, 4.2319e-05, 5.7042e-05,
        5.4002e-05, 4.7588e-04, 8.4996e-05, 3.6180e-05, 2.6846e-04, 1.5318e-05,
        1.7762e-05, 4.7731e-04, 3.1948e-04, 5.4717e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.2398e-03, 1.1861e-04],
        [1.3084e-03, 3.1054e-05],
        [9.7871e-05, 1.7226e-05],
        [6.0797e-04, 1.9372e-05],
        [7.4339e-04, 4.2319e-05],
        [2.1887e-04, 5.7042e-05],
        [3.6764e-04, 5.4002e-05],
        [1.2741e-02, 4.7588e-04],
        [5.0831e-04, 8.4996e-05],
        [6.6280e-04, 3.6180e-05],
        [1.9703e-03, 2.6846e-04],
        [4.8101e-05, 1.5318e-05],
        [1.6618e-04, 1.7762e-05],
        [4.7569e-03, 4.7731e-04],
        [1.4477e-03, 3.1948e-04],
        [1.8561e-04, 5.4717e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0011],
        [0.0016]], device='cuda:0', dtype=torch.float16)/tensor([[0.0011, 0.0016]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([9.8467e-05, 3.8242e-04], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[1.0834e-03, 9.8467e-05],
        [1.6022e-03, 3.8242e-04]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type active, variation 2 and batchsize 16: 0:03:37.375487
path ['42', 'de', 'llama', 'SA', 'active', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA passive 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 332.37it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0031],
        [0.0004],
        [0.0059],
        [0.0004],
        [0.0015],
        [0.0008],
        [0.0060],
        [0.0009],
        [0.0022],
        [0.0028],
        [0.0021],
        [0.0004],
        [0.0140],
        [0.0007],
        [0.0002],
        [0.0006]], device='cuda:0', dtype=torch.float16)/tensor([[0.0031, 0.0004, 0.0059, 0.0004, 0.0015, 0.0008, 0.0060, 0.0009, 0.0022,
         0.0028, 0.0021, 0.0004, 0.0140, 0.0007, 0.0002, 0.0006]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([8.8835e-04, 5.9426e-05, 5.5075e-04, 9.2328e-05, 1.5235e-04, 8.5711e-05,
        6.8932e-03, 9.2626e-05, 3.1281e-04, 2.1791e-04, 2.3913e-04, 1.0777e-04,
        1.3618e-03, 9.8228e-05, 3.5405e-05, 1.2779e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[3.1433e-03, 8.8835e-04],
        [3.8815e-04, 5.9426e-05],
        [5.8670e-03, 5.5075e-04],
        [3.9363e-04, 9.2328e-05],
        [1.5450e-03, 1.5235e-04],
        [8.2445e-04, 8.5711e-05],
        [5.9700e-03, 6.8932e-03],
        [8.7166e-04, 9.2626e-05],
        [2.2144e-03, 3.1281e-04],
        [2.8286e-03, 2.1791e-04],
        [2.0809e-03, 2.3913e-04],
        [4.1509e-04, 1.0777e-04],
        [1.4030e-02, 1.3618e-03],
        [6.6948e-04, 9.8228e-05],
        [2.4748e-04, 3.5405e-05],
        [5.6124e-04, 1.2779e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0018],
        [0.0021],
        [0.0003],
        [0.0007],
        [0.0036],
        [0.0001],
        [0.0006],
        [0.0002],
        [0.0024],
        [0.0020],
        [0.0005],
        [0.0026],
        [0.0010],
        [0.0019],
        [0.0011],
        [0.0003]], device='cuda:0', dtype=torch.float16)/tensor([[0.0018, 0.0021, 0.0003, 0.0007, 0.0036, 0.0001, 0.0006, 0.0002, 0.0024,
         0.0020, 0.0005, 0.0026, 0.0010, 0.0019, 0.0011, 0.0003]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.6263e-04, 5.6982e-05, 3.3677e-05, 3.9637e-05, 4.0770e-04, 3.8564e-05,
        1.2434e-04, 6.4909e-05, 5.1069e-04, 3.9959e-04, 1.5259e-04, 3.9387e-04,
        5.3346e-05, 1.4305e-04, 1.2279e-04, 8.8871e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.7900e-03, 3.6263e-04],
        [2.1420e-03, 5.6982e-05],
        [2.8825e-04, 3.3677e-05],
        [6.9809e-04, 3.9637e-05],
        [3.6259e-03, 4.0770e-04],
        [1.2505e-04, 3.8564e-05],
        [6.4707e-04, 1.2434e-04],
        [1.6940e-04, 6.4909e-05],
        [2.4242e-03, 5.1069e-04],
        [1.9627e-03, 3.9959e-04],
        [5.0545e-04, 1.5259e-04],
        [2.6474e-03, 3.9387e-04],
        [1.0395e-03, 5.3346e-05],
        [1.9140e-03, 1.4305e-04],
        [1.1234e-03, 1.2279e-04],
        [3.4046e-04, 8.8871e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.5440e-03],
        [2.7180e-05],
        [7.6342e-04],
        [7.2241e-05],
        [1.4542e-02],
        [4.4022e-03],
        [5.4502e-04],
        [3.5000e-04],
        [2.8610e-04],
        [1.0639e-04],
        [2.2459e-04],
        [2.8539e-04],
        [1.7147e-03],
        [4.4775e-04],
        [3.7527e-04],
        [1.7776e-03]], device='cuda:0', dtype=torch.float16)/tensor([[1.5440e-03, 2.7180e-05, 7.6342e-04, 7.2241e-05, 1.4542e-02, 4.4022e-03,
         5.4502e-04, 3.5000e-04, 2.8610e-04, 1.0639e-04, 2.2459e-04, 2.8539e-04,
         1.7147e-03, 4.4775e-04, 3.7527e-04, 1.7776e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([8.3625e-05, 7.2122e-06, 9.4652e-05, 1.4067e-05, 1.0433e-03, 5.8794e-04,
        1.0246e-04, 1.1402e-04, 7.2241e-05, 1.3649e-05, 4.7982e-05, 7.6950e-05,
        4.7863e-05, 1.3721e-04, 5.7876e-05, 2.1911e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.5440e-03, 8.3625e-05],
        [2.7180e-05, 7.2122e-06],
        [7.6342e-04, 9.4652e-05],
        [7.2241e-05, 1.4067e-05],
        [1.4542e-02, 1.0433e-03],
        [4.4022e-03, 5.8794e-04],
        [5.4502e-04, 1.0246e-04],
        [3.5000e-04, 1.1402e-04],
        [2.8610e-04, 7.2241e-05],
        [1.0639e-04, 1.3649e-05],
        [2.2459e-04, 4.7982e-05],
        [2.8539e-04, 7.6950e-05],
        [1.7147e-03, 4.7863e-05],
        [4.4775e-04, 1.3721e-04],
        [3.7527e-04, 5.7876e-05],
        [1.7776e-03, 2.1911e-04]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0007],
        [0.0008]], device='cuda:0', dtype=torch.float16)/tensor([[0.0007, 0.0008]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([2.1422e-04, 9.7096e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[7.0333e-04, 2.1422e-04],
        [7.9393e-04, 9.7096e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type passive, variation 0 and batchsize 16: 0:03:37.615482
path ['42', 'de', 'llama', 'SA', 'passive', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA passive 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 331.93it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[5.7316e-04],
        [3.0303e-04],
        [2.8362e-03],
        [2.8753e-04],
        [2.9335e-03],
        [5.8746e-03],
        [1.8892e-03],
        [6.4671e-05],
        [1.3220e-04],
        [9.1124e-04],
        [4.9210e-04],
        [1.0548e-03],
        [1.1196e-03],
        [4.2105e-04],
        [1.7349e-02],
        [1.4505e-03]], device='cuda:0', dtype=torch.float16)/tensor([[5.7316e-04, 3.0303e-04, 2.8362e-03, 2.8753e-04, 2.9335e-03, 5.8746e-03,
         1.8892e-03, 6.4671e-05, 1.3220e-04, 9.1124e-04, 4.9210e-04, 1.0548e-03,
         1.1196e-03, 4.2105e-04, 1.7349e-02, 1.4505e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.8203e-04, 9.2387e-06, 6.6185e-04, 1.2529e-04, 1.5295e-04, 3.7646e-04,
        4.5943e-04, 1.0371e-05, 1.5438e-05, 5.7399e-05, 8.4698e-05, 6.2644e-05,
        2.8074e-05, 4.4405e-05, 1.7958e-03, 2.1672e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[5.7316e-04, 1.8203e-04],
        [3.0303e-04, 9.2387e-06],
        [2.8362e-03, 6.6185e-04],
        [2.8753e-04, 1.2529e-04],
        [2.9335e-03, 1.5295e-04],
        [5.8746e-03, 3.7646e-04],
        [1.8892e-03, 4.5943e-04],
        [6.4671e-05, 1.0371e-05],
        [1.3220e-04, 1.5438e-05],
        [9.1124e-04, 5.7399e-05],
        [4.9210e-04, 8.4698e-05],
        [1.0548e-03, 6.2644e-05],
        [1.1196e-03, 2.8074e-05],
        [4.2105e-04, 4.4405e-05],
        [1.7349e-02, 1.7958e-03],
        [1.4505e-03, 2.1672e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0009],
        [0.0028],
        [0.0009],
        [0.0032],
        [0.0006],
        [0.0019],
        [0.0006],
        [0.0002],
        [0.0002],
        [0.0013],
        [0.0004],
        [0.0001],
        [0.0001],
        [0.0011],
        [0.0006],
        [0.0140]], device='cuda:0', dtype=torch.float16)/tensor([[0.0009, 0.0028, 0.0009, 0.0032, 0.0006, 0.0019, 0.0006, 0.0002, 0.0002,
         0.0013, 0.0004, 0.0001, 0.0001, 0.0011, 0.0006, 0.0140]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([9.7930e-05, 9.7847e-04, 1.6987e-05, 3.0684e-04, 1.2946e-04, 4.3917e-04,
        1.2529e-04, 1.7524e-05, 3.8385e-05, 1.3757e-04, 5.8651e-05, 1.9670e-05,
        4.2081e-05, 5.2750e-05, 3.4392e-05, 1.1311e-03], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[8.7118e-04, 9.7930e-05],
        [2.8000e-03, 9.7847e-04],
        [9.2888e-04, 1.6987e-05],
        [3.2291e-03, 3.0684e-04],
        [6.2132e-04, 1.2946e-04],
        [1.8864e-03, 4.3917e-04],
        [5.9271e-04, 1.2529e-04],
        [1.6069e-04, 1.7524e-05],
        [1.8454e-04, 3.8385e-05],
        [1.3275e-03, 1.3757e-04],
        [4.0269e-04, 5.8651e-05],
        [1.1289e-04, 1.9670e-05],
        [1.3101e-04, 4.2081e-05],
        [1.0672e-03, 5.2750e-05],
        [6.2466e-04, 3.4392e-05],
        [1.3969e-02, 1.1311e-03]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.6415e-04],
        [1.2779e-03],
        [9.9957e-05],
        [1.6184e-03],
        [4.7541e-04],
        [2.6569e-03],
        [3.7265e-04],
        [2.0638e-03],
        [1.5414e-04],
        [6.2895e-04],
        [1.0777e-03],
        [3.1042e-04],
        [1.0246e-04],
        [1.7567e-03],
        [4.6272e-03],
        [1.8525e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.6415e-04, 1.2779e-03, 9.9957e-05, 1.6184e-03, 4.7541e-04, 2.6569e-03,
         3.7265e-04, 2.0638e-03, 1.5414e-04, 6.2895e-04, 1.0777e-03, 3.1042e-04,
         1.0246e-04, 1.7567e-03, 4.6272e-03, 1.8525e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([9.0539e-05, 1.4710e-04, 1.5497e-05, 9.9778e-05, 2.5630e-05, 6.5660e-04,
        6.0022e-05, 2.8729e-04, 4.3392e-05, 6.2346e-05, 2.4199e-05, 8.9347e-05,
        2.1398e-05, 3.5346e-05, 5.9662e-03, 2.8610e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.6415e-04, 9.0539e-05],
        [1.2779e-03, 1.4710e-04],
        [9.9957e-05, 1.5497e-05],
        [1.6184e-03, 9.9778e-05],
        [4.7541e-04, 2.5630e-05],
        [2.6569e-03, 6.5660e-04],
        [3.7265e-04, 6.0022e-05],
        [2.0638e-03, 2.8729e-04],
        [1.5414e-04, 4.3392e-05],
        [6.2895e-04, 6.2346e-05],
        [1.0777e-03, 2.4199e-05],
        [3.1042e-04, 8.9347e-05],
        [1.0246e-04, 2.1398e-05],
        [1.7567e-03, 3.5346e-05],
        [4.6272e-03, 5.9662e-03],
        [1.8525e-04, 2.8610e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0022],
        [0.0005]], device='cuda:0', dtype=torch.float16)/tensor([[0.0022, 0.0005]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([0.0004, 0.0001], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[0.0022, 0.0004],
        [0.0005, 0.0001]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type passive, variation 1 and batchsize 16: 0:03:36.379964
path ['42', 'de', 'llama', 'SA', 'passive', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA passive 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 334.62it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0002],
        [0.0004],
        [0.0003],
        [0.0011],
        [0.0010],
        [0.0096],
        [0.0020],
        [0.0003],
        [0.0010],
        [0.0129],
        [0.0006],
        [0.0012],
        [0.0033],
        [0.0041],
        [0.0003],
        [0.0032]], device='cuda:0', dtype=torch.float16)/tensor([[0.0002, 0.0004, 0.0003, 0.0011, 0.0010, 0.0096, 0.0020, 0.0003, 0.0010,
         0.0129, 0.0006, 0.0012, 0.0033, 0.0041, 0.0003, 0.0032]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.7061e-05, 6.7234e-05, 5.6505e-05, 5.7936e-05, 2.4319e-05, 6.4802e-04,
        1.5688e-04, 1.1146e-05, 2.9206e-05, 2.4014e-03, 1.5926e-04, 2.9445e-05,
        5.3930e-04, 4.1413e-04, 1.3924e-04, 3.5191e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.0027e-04, 2.7061e-05],
        [4.3654e-04, 6.7234e-05],
        [2.8515e-04, 5.6505e-05],
        [1.0624e-03, 5.7936e-05],
        [1.0500e-03, 2.4319e-05],
        [9.5673e-03, 6.4802e-04],
        [2.0275e-03, 1.5688e-04],
        [3.2949e-04, 1.1146e-05],
        [9.7752e-04, 2.9206e-05],
        [1.2894e-02, 2.4014e-03],
        [6.1655e-04, 1.5926e-04],
        [1.1930e-03, 2.9445e-05],
        [3.3188e-03, 5.3930e-04],
        [4.0817e-03, 4.1413e-04],
        [3.4499e-04, 1.3924e-04],
        [3.2310e-03, 3.5191e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[3.4828e-03],
        [1.4699e-04],
        [1.4305e-03],
        [4.8065e-04],
        [9.1195e-05],
        [1.0567e-03],
        [1.6558e-04],
        [2.6274e-04],
        [1.1939e-04],
        [9.5940e-04],
        [6.4039e-04],
        [3.3903e-04],
        [1.6088e-03],
        [5.0020e-04],
        [2.7585e-04],
        [8.0185e-03]], device='cuda:0', dtype=torch.float16)/tensor([[3.4828e-03, 1.4699e-04, 1.4305e-03, 4.8065e-04, 9.1195e-05, 1.0567e-03,
         1.6558e-04, 2.6274e-04, 1.1939e-04, 9.5940e-04, 6.4039e-04, 3.3903e-04,
         1.6088e-03, 5.0020e-04, 2.7585e-04, 8.0185e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([9.8324e-04, 7.7426e-05, 1.6022e-04, 3.6955e-05, 1.3053e-05, 7.9632e-05,
        2.5511e-05, 7.4983e-05, 2.0385e-05, 4.8637e-05, 1.3399e-04, 1.3471e-04,
        1.9586e-04, 1.0931e-04, 4.2558e-05, 7.4997e-03], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[3.4828e-03, 9.8324e-04],
        [1.4699e-04, 7.7426e-05],
        [1.4305e-03, 1.6022e-04],
        [4.8065e-04, 3.6955e-05],
        [9.1195e-05, 1.3053e-05],
        [1.0567e-03, 7.9632e-05],
        [1.6558e-04, 2.5511e-05],
        [2.6274e-04, 7.4983e-05],
        [1.1939e-04, 2.0385e-05],
        [9.5940e-04, 4.8637e-05],
        [6.4039e-04, 1.3399e-04],
        [3.3903e-04, 1.3471e-04],
        [1.6088e-03, 1.9586e-04],
        [5.0020e-04, 1.0931e-04],
        [2.7585e-04, 4.2558e-05],
        [8.0185e-03, 7.4997e-03]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[4.2248e-04],
        [2.0084e-03],
        [1.5354e-04],
        [2.1515e-03],
        [1.2169e-03],
        [5.3287e-05],
        [6.5041e-04],
        [2.6917e-04],
        [1.1215e-03],
        [1.9064e-03],
        [5.6505e-04],
        [7.6628e-04],
        [1.3514e-03],
        [8.8978e-04],
        [1.3494e-04],
        [2.1386e-04]], device='cuda:0', dtype=torch.float16)/tensor([[4.2248e-04, 2.0084e-03, 1.5354e-04, 2.1515e-03, 1.2169e-03, 5.3287e-05,
         6.5041e-04, 2.6917e-04, 1.1215e-03, 1.9064e-03, 5.6505e-04, 7.6628e-04,
         1.3514e-03, 8.8978e-04, 1.3494e-04, 2.1386e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([7.3373e-05, 1.3721e-04, 5.7995e-05, 2.7585e-04, 2.6989e-04, 1.1563e-05,
        1.2672e-04, 8.8811e-05, 1.1075e-04, 4.5896e-05, 2.1541e-04, 3.0780e-04,
        1.8382e-04, 4.5300e-05, 3.5226e-05, 6.2406e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[4.2248e-04, 7.3373e-05],
        [2.0084e-03, 1.3721e-04],
        [1.5354e-04, 5.7995e-05],
        [2.1515e-03, 2.7585e-04],
        [1.2169e-03, 2.6989e-04],
        [5.3287e-05, 1.1563e-05],
        [6.5041e-04, 1.2672e-04],
        [2.6917e-04, 8.8811e-05],
        [1.1215e-03, 1.1075e-04],
        [1.9064e-03, 4.5896e-05],
        [5.6505e-04, 2.1541e-04],
        [7.6628e-04, 3.0780e-04],
        [1.3514e-03, 1.8382e-04],
        [8.8978e-04, 4.5300e-05],
        [1.3494e-04, 3.5226e-05],
        [2.1386e-04, 6.2406e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0026],
        [0.0004]], device='cuda:0', dtype=torch.float16)/tensor([[0.0026, 0.0004]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([2.0552e-04, 4.4823e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[2.5520e-03, 2.0552e-04],
        [4.4274e-04, 4.4823e-05]], device='cuda:0')
acc:  0.5
Time taken to execute the de SA task with prompt type passive, variation 2 and batchsize 16: 0:03:37.288375
path ['42', 'de', 'llama', 'SA', 'passive', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA auxiliary 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 322.56it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[3.8385e-04],
        [1.0929e-03],
        [2.3746e-03],
        [6.3705e-04],
        [1.6844e-04],
        [3.1137e-04],
        [1.1272e-03],
        [6.8843e-05],
        [4.9067e-04],
        [4.3130e-04],
        [2.4624e-03],
        [5.0116e-04],
        [4.5013e-03],
        [3.6407e-04],
        [2.6798e-04],
        [1.1986e-02]], device='cuda:0', dtype=torch.float16)/tensor([[3.8385e-04, 1.0929e-03, 2.3746e-03, 6.3705e-04, 1.6844e-04, 3.1137e-04,
         1.1272e-03, 6.8843e-05, 4.9067e-04, 4.3130e-04, 2.4624e-03, 5.0116e-04,
         4.5013e-03, 3.6407e-04, 2.6798e-04, 1.1986e-02]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([6.0380e-05, 1.2189e-04, 4.4680e-04, 4.4167e-05, 2.5213e-05, 3.3915e-05,
        2.0993e-04, 1.0550e-05, 1.1796e-04, 1.3936e-04, 1.3018e-04, 5.6624e-05,
        3.0613e-04, 2.6345e-05, 8.0407e-05, 7.4434e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[3.8385e-04, 6.0380e-05],
        [1.0929e-03, 1.2189e-04],
        [2.3746e-03, 4.4680e-04],
        [6.3705e-04, 4.4167e-05],
        [1.6844e-04, 2.5213e-05],
        [3.1137e-04, 3.3915e-05],
        [1.1272e-03, 2.0993e-04],
        [6.8843e-05, 1.0550e-05],
        [4.9067e-04, 1.1796e-04],
        [4.3130e-04, 1.3936e-04],
        [2.4624e-03, 1.3018e-04],
        [5.0116e-04, 5.6624e-05],
        [4.5013e-03, 3.0613e-04],
        [3.6407e-04, 2.6345e-05],
        [2.6798e-04, 8.0407e-05],
        [1.1986e-02, 7.4434e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[2.4068e-04],
        [1.3113e-04],
        [1.1263e-03],
        [2.8019e-03],
        [7.9691e-05],
        [1.5488e-03],
        [1.0405e-03],
        [1.5378e-04],
        [9.7418e-04],
        [2.7633e-04],
        [2.2089e-04],
        [6.8951e-04],
        [1.0614e-03],
        [1.5087e-03],
        [3.4189e-04],
        [2.4014e-03]], device='cuda:0', dtype=torch.float16)/tensor([[2.4068e-04, 1.3113e-04, 1.1263e-03, 2.8019e-03, 7.9691e-05, 1.5488e-03,
         1.0405e-03, 1.5378e-04, 9.7418e-04, 2.7633e-04, 2.2089e-04, 6.8951e-04,
         1.0614e-03, 1.5087e-03, 3.4189e-04, 2.4014e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.0550e-04, 2.3961e-05, 3.0780e-04, 9.2840e-04, 1.9550e-05, 2.2995e-04,
        1.2422e-04, 5.5552e-05, 5.7876e-05, 7.9036e-05, 9.3579e-06, 1.7464e-05,
        1.5724e-04, 1.4639e-04, 7.4148e-05, 5.5618e-03], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.4068e-04, 1.0550e-04],
        [1.3113e-04, 2.3961e-05],
        [1.1263e-03, 3.0780e-04],
        [2.8019e-03, 9.2840e-04],
        [7.9691e-05, 1.9550e-05],
        [1.5488e-03, 2.2995e-04],
        [1.0405e-03, 1.2422e-04],
        [1.5378e-04, 5.5552e-05],
        [9.7418e-04, 5.7876e-05],
        [2.7633e-04, 7.9036e-05],
        [2.2089e-04, 9.3579e-06],
        [6.8951e-04, 1.7464e-05],
        [1.0614e-03, 1.5724e-04],
        [1.5087e-03, 1.4639e-04],
        [3.4189e-04, 7.4148e-05],
        [2.4014e-03, 5.5618e-03]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.8585e-04],
        [1.3561e-03],
        [1.5867e-04],
        [3.5071e-04],
        [1.7824e-03],
        [1.4234e-04],
        [1.7920e-03],
        [1.1826e-04],
        [7.7903e-05],
        [1.1501e-03],
        [9.3031e-04],
        [1.1939e-04],
        [1.1276e-02],
        [8.5163e-04],
        [3.9673e-03],
        [2.9898e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.8585e-04, 1.3561e-03, 1.5867e-04, 3.5071e-04, 1.7824e-03, 1.4234e-04,
         1.7920e-03, 1.1826e-04, 7.7903e-05, 1.1501e-03, 9.3031e-04, 1.1939e-04,
         1.1276e-02, 8.5163e-04, 3.9673e-03, 2.9898e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([7.8380e-05, 9.6083e-05, 3.2365e-05, 2.5213e-05, 4.1938e-04, 1.6391e-05,
        3.4332e-05, 1.5497e-05, 1.4722e-05, 2.2054e-05, 5.8472e-05, 3.5524e-05,
        1.2541e-03, 2.5809e-05, 3.4571e-04, 4.7982e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.8585e-04, 7.8380e-05],
        [1.3561e-03, 9.6083e-05],
        [1.5867e-04, 3.2365e-05],
        [3.5071e-04, 2.5213e-05],
        [1.7824e-03, 4.1938e-04],
        [1.4234e-04, 1.6391e-05],
        [1.7920e-03, 3.4332e-05],
        [1.1826e-04, 1.5497e-05],
        [7.7903e-05, 1.4722e-05],
        [1.1501e-03, 2.2054e-05],
        [9.3031e-04, 5.8472e-05],
        [1.1939e-04, 3.5524e-05],
        [1.1276e-02, 1.2541e-03],
        [8.5163e-04, 2.5809e-05],
        [3.9673e-03, 3.4571e-04],
        [2.9898e-04, 4.7982e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0013],
        [0.0005]], device='cuda:0', dtype=torch.float16)/tensor([[0.0013, 0.0005]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([2.8777e-04, 8.4400e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[1.3199e-03, 2.8777e-04],
        [4.9400e-04, 8.4400e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type auxiliary, variation 0 and batchsize 16: 0:03:38.249258
path ['42', 'de', 'llama', 'SA', 'auxiliary', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA auxiliary 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 336.44it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.4246e-04],
        [2.4719e-03],
        [6.4492e-05],
        [2.8968e-04],
        [2.0447e-03],
        [6.5029e-05],
        [4.7755e-04],
        [1.1726e-02],
        [1.3876e-03],
        [2.0771e-03],
        [3.1137e-04],
        [1.0357e-03],
        [1.3113e-04],
        [1.3266e-03],
        [2.1458e-04],
        [2.0492e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.4246e-04, 2.4719e-03, 6.4492e-05, 2.8968e-04, 2.0447e-03, 6.5029e-05,
         4.7755e-04, 1.1726e-02, 1.3876e-03, 2.0771e-03, 3.1137e-04, 1.0357e-03,
         1.3113e-04, 1.3266e-03, 2.1458e-04, 2.0492e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.4690e-05, 1.6117e-04, 1.4007e-05, 5.5254e-05, 3.0923e-04, 1.0908e-05,
        6.8247e-05, 1.4429e-03, 3.8576e-04, 5.0926e-04, 2.8312e-05, 4.5509e-03,
        1.9372e-05, 1.5306e-04, 1.0818e-04, 1.1623e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.4246e-04, 3.4690e-05],
        [2.4719e-03, 1.6117e-04],
        [6.4492e-05, 1.4007e-05],
        [2.8968e-04, 5.5254e-05],
        [2.0447e-03, 3.0923e-04],
        [6.5029e-05, 1.0908e-05],
        [4.7755e-04, 6.8247e-05],
        [1.1726e-02, 1.4429e-03],
        [1.3876e-03, 3.8576e-04],
        [2.0771e-03, 5.0926e-04],
        [3.1137e-04, 2.8312e-05],
        [1.0357e-03, 4.5509e-03],
        [1.3113e-04, 1.9372e-05],
        [1.3266e-03, 1.5306e-04],
        [2.1458e-04, 1.0818e-04],
        [2.0492e-04, 1.1623e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0010],
        [0.0003],
        [0.0008],
        [0.0004],
        [0.0010],
        [0.0109],
        [0.0008],
        [0.0013],
        [0.0014],
        [0.0002],
        [0.0003],
        [0.0018],
        [0.0010],
        [0.0006],
        [0.0023],
        [0.0002]], device='cuda:0', dtype=torch.float16)/tensor([[0.0010, 0.0003, 0.0008, 0.0004, 0.0010, 0.0109, 0.0008, 0.0013, 0.0014,
         0.0002, 0.0003, 0.0018, 0.0010, 0.0006, 0.0023, 0.0002]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.7893e-04, 3.5644e-05, 1.8644e-04, 8.8573e-05, 1.2469e-04, 8.0252e-04,
        5.1856e-05, 2.9624e-05, 9.6560e-05, 7.3850e-05, 6.4850e-05, 4.0388e-04,
        7.4744e-05, 1.5485e-04, 4.8697e-05, 7.0632e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[9.8515e-04, 1.7893e-04],
        [2.7943e-04, 3.5644e-05],
        [8.2731e-04, 1.8644e-04],
        [3.5357e-04, 8.8573e-05],
        [1.0099e-03, 1.2469e-04],
        [1.0918e-02, 8.0252e-04],
        [8.1825e-04, 5.1856e-05],
        [1.3056e-03, 2.9624e-05],
        [1.4229e-03, 9.6560e-05],
        [2.3901e-04, 7.3850e-05],
        [3.4475e-04, 6.4850e-05],
        [1.7900e-03, 4.0388e-04],
        [1.0204e-03, 7.4744e-05],
        [5.5313e-04, 1.5485e-04],
        [2.2812e-03, 4.8697e-05],
        [1.7810e-04, 7.0632e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.4460e-04],
        [1.5507e-03],
        [8.0168e-05],
        [6.1321e-04],
        [4.6768e-03],
        [3.4785e-04],
        [3.3073e-03],
        [1.3232e-04],
        [1.5221e-03],
        [2.2316e-04],
        [8.2207e-04],
        [3.3073e-03],
        [2.1708e-04],
        [6.9237e-04],
        [4.2677e-04],
        [6.2656e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.4460e-04, 1.5507e-03, 8.0168e-05, 6.1321e-04, 4.6768e-03, 3.4785e-04,
         3.3073e-03, 1.3232e-04, 1.5221e-03, 2.2316e-04, 8.2207e-04, 3.3073e-03,
         2.1708e-04, 6.9237e-04, 4.2677e-04, 6.2656e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.9670e-05, 4.4632e-04, 2.2173e-05, 2.0683e-05, 3.7050e-04, 2.8551e-05,
        1.2817e-03, 4.4823e-05, 1.5914e-04, 4.0829e-05, 6.3121e-05, 3.2902e-04,
        1.1265e-04, 1.0896e-04, 1.5402e-04, 2.5094e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.4460e-04, 1.9670e-05],
        [1.5507e-03, 4.4632e-04],
        [8.0168e-05, 2.2173e-05],
        [6.1321e-04, 2.0683e-05],
        [4.6768e-03, 3.7050e-04],
        [3.4785e-04, 2.8551e-05],
        [3.3073e-03, 1.2817e-03],
        [1.3232e-04, 4.4823e-05],
        [1.5221e-03, 1.5914e-04],
        [2.2316e-04, 4.0829e-05],
        [8.2207e-04, 6.3121e-05],
        [3.3073e-03, 3.2902e-04],
        [2.1708e-04, 1.1265e-04],
        [6.9237e-04, 1.0896e-04],
        [4.2677e-04, 1.5402e-04],
        [6.2656e-04, 2.5094e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0002],
        [0.0001]], device='cuda:0', dtype=torch.float16)/tensor([[0.0002, 0.0001]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([8.1360e-05, 2.3425e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[2.4223e-04, 8.1360e-05],
        [1.1230e-04, 2.3425e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type auxiliary, variation 1 and batchsize 16: 0:03:07.511795
path ['42', 'de', 'llama', 'SA', 'auxiliary', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA auxiliary 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 366.14it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[5.2071e-04],
        [8.6188e-05],
        [1.7233e-03],
        [4.1318e-04],
        [8.3625e-05],
        [3.0279e-04],
        [7.6723e-04],
        [2.5921e-03],
        [1.8787e-04],
        [1.1311e-03],
        [1.2527e-02],
        [1.4436e-04],
        [7.0810e-05],
        [6.1560e-04],
        [1.6422e-03],
        [1.7105e-02]], device='cuda:0', dtype=torch.float16)/tensor([[5.2071e-04, 8.6188e-05, 1.7233e-03, 4.1318e-04, 8.3625e-05, 3.0279e-04,
         7.6723e-04, 2.5921e-03, 1.8787e-04, 1.1311e-03, 1.2527e-02, 1.4436e-04,
         7.0810e-05, 6.1560e-04, 1.6422e-03, 1.7105e-02]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.5450e-04, 2.2173e-05, 2.9683e-05, 6.2764e-05, 1.5259e-05, 8.6963e-05,
        5.1677e-05, 4.8518e-05, 3.4690e-05, 1.6606e-04, 7.9679e-04, 4.0054e-05,
        1.0610e-05, 6.2704e-05, 1.0943e-04, 1.6098e-03], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[5.2071e-04, 1.5450e-04],
        [8.6188e-05, 2.2173e-05],
        [1.7233e-03, 2.9683e-05],
        [4.1318e-04, 6.2764e-05],
        [8.3625e-05, 1.5259e-05],
        [3.0279e-04, 8.6963e-05],
        [7.6723e-04, 5.1677e-05],
        [2.5921e-03, 4.8518e-05],
        [1.8787e-04, 3.4690e-05],
        [1.1311e-03, 1.6606e-04],
        [1.2527e-02, 7.9679e-04],
        [1.4436e-04, 4.0054e-05],
        [7.0810e-05, 1.0610e-05],
        [6.1560e-04, 6.2704e-05],
        [1.6422e-03, 1.0943e-04],
        [1.7105e-02, 1.6098e-03]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0015],
        [0.0004],
        [0.0001],
        [0.0001],
        [0.0017],
        [0.0002],
        [0.0044],
        [0.0007],
        [0.0015],
        [0.0002],
        [0.0018],
        [0.0002],
        [0.0005],
        [0.0005],
        [0.0045],
        [0.0003]], device='cuda:0', dtype=torch.float16)/tensor([[0.0015, 0.0004, 0.0001, 0.0001, 0.0017, 0.0002, 0.0044, 0.0007, 0.0015,
         0.0002, 0.0018, 0.0002, 0.0005, 0.0005, 0.0045, 0.0003]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.5667e-04, 9.6560e-05, 1.6570e-05, 2.3782e-05, 4.0412e-04, 8.6784e-05,
        1.2808e-03, 1.5497e-04, 2.9445e-04, 3.0935e-05, 2.5964e-04, 5.5254e-05,
        9.0897e-05, 3.1710e-05, 3.8958e-04, 5.0247e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.4658e-03, 3.5667e-04],
        [3.5262e-04, 9.6560e-05],
        [1.2994e-04, 1.6570e-05],
        [1.4603e-04, 2.3782e-05],
        [1.7252e-03, 4.0412e-04],
        [2.0576e-04, 8.6784e-05],
        [4.3526e-03, 1.2808e-03],
        [7.0858e-04, 1.5497e-04],
        [1.4668e-03, 2.9445e-04],
        [2.2137e-04, 3.0935e-05],
        [1.8482e-03, 2.5964e-04],
        [1.6904e-04, 5.5254e-05],
        [5.4550e-04, 9.0897e-05],
        [4.5133e-04, 3.1710e-05],
        [4.5242e-03, 3.8958e-04],
        [3.1090e-04, 5.0247e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0003],
        [0.0004],
        [0.0008],
        [0.0034],
        [0.0010],
        [0.0003],
        [0.0014],
        [0.0017],
        [0.0012],
        [0.0004],
        [0.0022],
        [0.0001],
        [0.0012],
        [0.0025],
        [0.0012],
        [0.0004]], device='cuda:0', dtype=torch.float16)/tensor([[0.0003, 0.0004, 0.0008, 0.0034, 0.0010, 0.0003, 0.0014, 0.0017, 0.0012,
         0.0004, 0.0022, 0.0001, 0.0012, 0.0025, 0.0012, 0.0004]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.1075e-04, 2.8789e-05, 2.0266e-05, 1.7607e-04, 2.9862e-05, 1.0550e-05,
        1.4710e-04, 1.6856e-04, 6.3837e-05, 3.7134e-05, 4.7231e-04, 1.7524e-05,
        7.0035e-05, 6.1722e-03, 1.3518e-04, 7.6950e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.6417e-04, 1.1075e-04],
        [3.8624e-04, 2.8789e-05],
        [7.7486e-04, 2.0266e-05],
        [3.3550e-03, 1.7607e-04],
        [9.5463e-04, 2.9862e-05],
        [2.6059e-04, 1.0550e-05],
        [1.3571e-03, 1.4710e-04],
        [1.7042e-03, 1.6856e-04],
        [1.1578e-03, 6.3837e-05],
        [3.6502e-04, 3.7134e-05],
        [2.2259e-03, 4.7231e-04],
        [1.4794e-04, 1.7524e-05],
        [1.2360e-03, 7.0035e-05],
        [2.5158e-03, 6.1722e-03],
        [1.2341e-03, 1.3518e-04],
        [3.7575e-04, 7.6950e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0014],
        [0.0057]], device='cuda:0', dtype=torch.float16)/tensor([[0.0014, 0.0057]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([0.0002, 0.0004], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[0.0014, 0.0002],
        [0.0057, 0.0004]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type auxiliary, variation 2 and batchsize 16: 0:03:07.380752
path ['42', 'de', 'llama', 'SA', 'auxiliary', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA modal 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 354.80it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0012],
        [0.0119],
        [0.0022],
        [0.0002],
        [0.0160],
        [0.0004],
        [0.0022],
        [0.0005],
        [0.0016],
        [0.0018],
        [0.0001],
        [0.0016],
        [0.0007],
        [0.0007],
        [0.0004],
        [0.0015]], device='cuda:0', dtype=torch.float16)/tensor([[0.0012, 0.0119, 0.0022, 0.0002, 0.0160, 0.0004, 0.0022, 0.0005, 0.0016,
         0.0018, 0.0001, 0.0016, 0.0007, 0.0007, 0.0004, 0.0015]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.2948e-05, 5.9462e-04, 6.8741e-03, 4.4346e-05, 1.1749e-03, 1.0860e-04,
        3.4273e-05, 1.0204e-04, 3.6383e-04, 2.8563e-04, 2.0623e-05, 7.5042e-05,
        1.0842e-04, 3.1948e-05, 1.3292e-05, 2.3890e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.1969e-03, 2.2948e-05],
        [1.1887e-02, 5.9462e-04],
        [2.1553e-03, 6.8741e-03],
        [1.5736e-04, 4.4346e-05],
        [1.5991e-02, 1.1749e-03],
        [3.5262e-04, 1.0860e-04],
        [2.2068e-03, 3.4273e-05],
        [4.9782e-04, 1.0204e-04],
        [1.6136e-03, 3.6383e-04],
        [1.7748e-03, 2.8563e-04],
        [1.1820e-04, 2.0623e-05],
        [1.6098e-03, 7.5042e-05],
        [7.0572e-04, 1.0842e-04],
        [6.5279e-04, 3.1948e-05],
        [3.9411e-04, 1.3292e-05],
        [1.4753e-03, 2.3890e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0003],
        [0.0005],
        [0.0040],
        [0.0015],
        [0.0003],
        [0.0015],
        [0.0023],
        [0.0020],
        [0.0060],
        [0.0001],
        [0.0014],
        [0.0071],
        [0.0010],
        [0.0015],
        [0.0005],
        [0.0035]], device='cuda:0', dtype=torch.float16)/tensor([[0.0003, 0.0005, 0.0040, 0.0015, 0.0003, 0.0015, 0.0023, 0.0020, 0.0060,
         0.0001, 0.0014, 0.0071, 0.0010, 0.0015, 0.0005, 0.0035]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([4.4107e-05, 4.4286e-05, 5.5313e-05, 1.4400e-04, 1.1426e-04, 1.3804e-04,
        1.0836e-04, 2.3413e-04, 1.8826e-03, 1.4901e-05, 3.2604e-05, 3.6430e-04,
        9.0659e-05, 3.5214e-04, 9.8467e-05, 1.7929e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.9635e-04, 4.4107e-05],
        [4.9067e-04, 4.4286e-05],
        [3.9940e-03, 5.5313e-05],
        [1.5240e-03, 1.4400e-04],
        [2.6488e-04, 1.1426e-04],
        [1.4820e-03, 1.3804e-04],
        [2.3003e-03, 1.0836e-04],
        [1.9932e-03, 2.3413e-04],
        [5.9929e-03, 1.8826e-03],
        [1.0359e-04, 1.4901e-05],
        [1.3571e-03, 3.2604e-05],
        [7.0992e-03, 3.6430e-04],
        [9.9182e-04, 9.0659e-05],
        [1.5221e-03, 3.5214e-04],
        [4.5061e-04, 9.8467e-05],
        [3.5324e-03, 1.7929e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[5.6839e-04],
        [1.6236e-04],
        [1.5628e-04],
        [2.0275e-03],
        [1.2980e-03],
        [2.8300e-04],
        [3.3641e-04],
        [1.4381e-03],
        [1.8132e-04],
        [6.5136e-04],
        [1.0097e-04],
        [6.1417e-03],
        [4.0054e-04],
        [2.7485e-03],
        [9.7179e-04],
        [8.1778e-05]], device='cuda:0', dtype=torch.float16)/tensor([[5.6839e-04, 1.6236e-04, 1.5628e-04, 2.0275e-03, 1.2980e-03, 2.8300e-04,
         3.3641e-04, 1.4381e-03, 1.8132e-04, 6.5136e-04, 1.0097e-04, 6.1417e-03,
         4.0054e-04, 2.7485e-03, 9.7179e-04, 8.1778e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.1829e-05, 5.9068e-05, 1.8954e-05, 1.5104e-04, 6.0499e-05, 1.2767e-04,
        5.4419e-05, 7.6950e-05, 3.2604e-05, 1.8191e-04, 2.2471e-05, 4.0555e-04,
        6.6400e-05, 4.4751e-04, 2.1148e-04, 1.2040e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[5.6839e-04, 3.1829e-05],
        [1.6236e-04, 5.9068e-05],
        [1.5628e-04, 1.8954e-05],
        [2.0275e-03, 1.5104e-04],
        [1.2980e-03, 6.0499e-05],
        [2.8300e-04, 1.2767e-04],
        [3.3641e-04, 5.4419e-05],
        [1.4381e-03, 7.6950e-05],
        [1.8132e-04, 3.2604e-05],
        [6.5136e-04, 1.8191e-04],
        [1.0097e-04, 2.2471e-05],
        [6.1417e-03, 4.0555e-04],
        [4.0054e-04, 6.6400e-05],
        [2.7485e-03, 4.4751e-04],
        [9.7179e-04, 2.1148e-04],
        [8.1778e-05, 1.2040e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0016],
        [0.0002]], device='cuda:0', dtype=torch.float16)/tensor([[0.0016, 0.0002]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([4.6730e-04, 2.4676e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[1.5984e-03, 4.6730e-04],
        [2.2781e-04, 2.4676e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type modal, variation 0 and batchsize 16: 0:03:08.099849
path ['42', 'de', 'llama', 'SA', 'modal', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA modal 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 344.51it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.5669e-03],
        [3.2401e-04],
        [2.1400e-03],
        [1.1864e-03],
        [1.8001e-04],
        [3.1738e-03],
        [7.7069e-05],
        [3.2234e-03],
        [8.6689e-04],
        [1.4763e-03],
        [1.2579e-03],
        [1.6868e-04],
        [1.1780e-02],
        [3.9387e-04],
        [5.2786e-04],
        [3.4451e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.5669e-03, 3.2401e-04, 2.1400e-03, 1.1864e-03, 1.8001e-04, 3.1738e-03,
         7.7069e-05, 3.2234e-03, 8.6689e-04, 1.4763e-03, 1.2579e-03, 1.6868e-04,
         1.1780e-02, 3.9387e-04, 5.2786e-04, 3.4451e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([3.5381e-04, 1.2100e-05, 3.3522e-04, 3.0804e-04, 2.0146e-05, 5.9557e-04,
        1.4424e-05, 1.8907e-04, 1.9848e-04, 4.6654e-03, 7.4804e-05, 6.4015e-05,
        5.8651e-04, 1.3149e-04, 1.0669e-04, 5.7042e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.5669e-03, 3.5381e-04],
        [3.2401e-04, 1.2100e-05],
        [2.1400e-03, 3.3522e-04],
        [1.1864e-03, 3.0804e-04],
        [1.8001e-04, 2.0146e-05],
        [3.1738e-03, 5.9557e-04],
        [7.7069e-05, 1.4424e-05],
        [3.2234e-03, 1.8907e-04],
        [8.6689e-04, 1.9848e-04],
        [1.4763e-03, 4.6654e-03],
        [1.2579e-03, 7.4804e-05],
        [1.6868e-04, 6.4015e-05],
        [1.1780e-02, 5.8651e-04],
        [3.9387e-04, 1.3149e-04],
        [5.2786e-04, 1.0669e-04],
        [3.4451e-04, 5.7042e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.0228e-04],
        [1.0939e-03],
        [7.9870e-04],
        [6.6185e-04],
        [1.0481e-03],
        [5.7564e-03],
        [9.6262e-05],
        [2.4853e-03],
        [6.7024e-03],
        [8.3399e-04],
        [1.4542e-02],
        [3.4771e-03],
        [1.9588e-03],
        [2.4283e-04],
        [1.4429e-03],
        [1.4889e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.0228e-04, 1.0939e-03, 7.9870e-04, 6.6185e-04, 1.0481e-03, 5.7564e-03,
         9.6262e-05, 2.4853e-03, 6.7024e-03, 8.3399e-04, 1.4542e-02, 3.4771e-03,
         1.9588e-03, 2.4283e-04, 1.4429e-03, 1.4889e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.0027e-05, 6.7890e-05, 8.1182e-05, 3.9220e-05, 3.3259e-05, 4.2677e-04,
        1.8954e-05, 3.0398e-04, 4.2629e-04, 1.1760e-04, 1.2856e-03, 5.5552e-05,
        4.1842e-05, 8.1956e-05, 2.7835e-05, 2.9027e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.0228e-04, 2.0027e-05],
        [1.0939e-03, 6.7890e-05],
        [7.9870e-04, 8.1182e-05],
        [6.6185e-04, 3.9220e-05],
        [1.0481e-03, 3.3259e-05],
        [5.7564e-03, 4.2677e-04],
        [9.6262e-05, 1.8954e-05],
        [2.4853e-03, 3.0398e-04],
        [6.7024e-03, 4.2629e-04],
        [8.3399e-04, 1.1760e-04],
        [1.4542e-02, 1.2856e-03],
        [3.4771e-03, 5.5552e-05],
        [1.9588e-03, 4.1842e-05],
        [2.4283e-04, 8.1956e-05],
        [1.4429e-03, 2.7835e-05],
        [1.4889e-04, 2.9027e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.2696e-04],
        [2.9135e-04],
        [1.9569e-03],
        [1.5717e-03],
        [1.2808e-03],
        [7.0870e-05],
        [3.4451e-04],
        [5.2071e-04],
        [3.9244e-04],
        [1.3361e-03],
        [2.0278e-04],
        [3.7212e-03],
        [1.3769e-04],
        [1.6985e-03],
        [2.2354e-03],
        [1.6174e-03]], device='cuda:0', dtype=torch.float16)/tensor([[1.2696e-04, 2.9135e-04, 1.9569e-03, 1.5717e-03, 1.2808e-03, 7.0870e-05,
         3.4451e-04, 5.2071e-04, 3.9244e-04, 1.3361e-03, 2.0278e-04, 3.7212e-03,
         1.3769e-04, 1.6985e-03, 2.2354e-03, 1.6174e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([4.0531e-05, 4.8280e-05, 5.0068e-04, 1.5938e-04, 2.5010e-04, 1.0431e-05,
        6.0499e-05, 2.8968e-05, 4.3511e-05, 1.5759e-04, 1.0431e-04, 1.2789e-03,
        1.6928e-05, 1.4746e-04, 1.1545e-04, 9.3341e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.2696e-04, 4.0531e-05],
        [2.9135e-04, 4.8280e-05],
        [1.9569e-03, 5.0068e-04],
        [1.5717e-03, 1.5938e-04],
        [1.2808e-03, 2.5010e-04],
        [7.0870e-05, 1.0431e-05],
        [3.4451e-04, 6.0499e-05],
        [5.2071e-04, 2.8968e-05],
        [3.9244e-04, 4.3511e-05],
        [1.3361e-03, 1.5759e-04],
        [2.0278e-04, 1.0431e-04],
        [3.7212e-03, 1.2789e-03],
        [1.3769e-04, 1.6928e-05],
        [1.6985e-03, 1.4746e-04],
        [2.2354e-03, 1.1545e-04],
        [1.6174e-03, 9.3341e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0002],
        [0.0003]], device='cuda:0', dtype=torch.float16)/tensor([[0.0002, 0.0003]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([1.1879e-04, 7.2300e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[2.3043e-04, 1.1879e-04],
        [3.1376e-04, 7.2300e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type modal, variation 1 and batchsize 16: 0:03:07.719906
path ['42', 'de', 'llama', 'SA', 'modal', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA modal 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 295.96it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[2.3496e-04],
        [5.0640e-04],
        [3.5071e-04],
        [2.1577e-04],
        [1.4200e-03],
        [1.6193e-03],
        [6.2644e-05],
        [2.2526e-03],
        [1.8787e-03],
        [9.8801e-03],
        [9.8407e-05],
        [3.0828e-04],
        [1.2962e-02],
        [4.5657e-04],
        [2.7013e-04],
        [3.3360e-03]], device='cuda:0', dtype=torch.float16)/tensor([[2.3496e-04, 5.0640e-04, 3.5071e-04, 2.1577e-04, 1.4200e-03, 1.6193e-03,
         6.2644e-05, 2.2526e-03, 1.8787e-03, 9.8801e-03, 9.8407e-05, 3.0828e-04,
         1.2962e-02, 4.5657e-04, 2.7013e-04, 3.3360e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([8.2731e-05, 7.7724e-05, 5.5134e-05, 1.3173e-05, 2.0695e-04, 1.4591e-04,
        1.0908e-05, 4.9400e-04, 2.8372e-04, 5.6934e-04, 2.7716e-05, 6.3896e-05,
        1.5192e-03, 4.0412e-05, 1.5187e-04, 3.3426e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[2.3496e-04, 8.2731e-05],
        [5.0640e-04, 7.7724e-05],
        [3.5071e-04, 5.5134e-05],
        [2.1577e-04, 1.3173e-05],
        [1.4200e-03, 2.0695e-04],
        [1.6193e-03, 1.4591e-04],
        [6.2644e-05, 1.0908e-05],
        [2.2526e-03, 4.9400e-04],
        [1.8787e-03, 2.8372e-04],
        [9.8801e-03, 5.6934e-04],
        [9.8407e-05, 2.7716e-05],
        [3.0828e-04, 6.3896e-05],
        [1.2962e-02, 1.5192e-03],
        [4.5657e-04, 4.0412e-05],
        [2.7013e-04, 1.5187e-04],
        [3.3360e-03, 3.3426e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0001],
        [0.0013],
        [0.0003],
        [0.0009],
        [0.0011],
        [0.0006],
        [0.0003],
        [0.0004],
        [0.0001],
        [0.0005],
        [0.0001],
        [0.0038],
        [0.0003],
        [0.0001],
        [0.0014],
        [0.0006]], device='cuda:0', dtype=torch.float16)/tensor([[0.0001, 0.0013, 0.0003, 0.0009, 0.0011, 0.0006, 0.0003, 0.0004, 0.0001,
         0.0005, 0.0001, 0.0038, 0.0003, 0.0001, 0.0014, 0.0006]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.1338e-05, 3.1209e-04, 6.4135e-05, 8.6486e-05, 8.7321e-05, 1.1951e-04,
        5.0902e-05, 1.1963e-04, 1.8477e-05, 4.1366e-05, 4.6253e-05, 1.3447e-03,
        7.3314e-05, 3.7909e-05, 1.7118e-04, 2.3425e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.2398e-04, 2.1338e-05],
        [1.3475e-03, 3.1209e-04],
        [2.8586e-04, 6.4135e-05],
        [8.6069e-04, 8.6486e-05],
        [1.0729e-03, 8.7321e-05],
        [6.0892e-04, 1.1951e-04],
        [2.5249e-04, 5.0902e-05],
        [4.2343e-04, 1.1963e-04],
        [1.1343e-04, 1.8477e-05],
        [5.1022e-04, 4.1366e-05],
        [1.2541e-04, 4.6253e-05],
        [3.7556e-03, 1.3447e-03],
        [2.5797e-04, 7.3314e-05],
        [1.4555e-04, 3.7909e-05],
        [1.3638e-03, 1.7118e-04],
        [5.7220e-04, 2.3425e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0013],
        [0.0011],
        [0.0001],
        [0.0022],
        [0.0002],
        [0.0016],
        [0.0023],
        [0.0012],
        [0.0010],
        [0.0013],
        [0.0002],
        [0.0007],
        [0.0018],
        [0.0014],
        [0.0018],
        [0.0014]], device='cuda:0', dtype=torch.float16)/tensor([[0.0013, 0.0011, 0.0001, 0.0022, 0.0002, 0.0016, 0.0023, 0.0012, 0.0010,
         0.0013, 0.0002, 0.0007, 0.0018, 0.0014, 0.0018, 0.0014]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.7418e-04, 2.4819e-04, 2.9266e-05, 4.9710e-05, 6.4611e-05, 3.2365e-05,
        1.5354e-04, 9.6202e-05, 3.1471e-05, 4.9248e-03, 2.3425e-05, 2.8253e-05,
        4.7541e-04, 1.5974e-04, 3.1185e-04, 3.4142e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.2798e-03, 2.7418e-04],
        [1.1282e-03, 2.4819e-04],
        [1.2159e-04, 2.9266e-05],
        [2.2182e-03, 4.9710e-05],
        [1.6284e-04, 6.4611e-05],
        [1.6298e-03, 3.2365e-05],
        [2.3460e-03, 1.5354e-04],
        [1.1539e-03, 9.6202e-05],
        [1.0414e-03, 3.1471e-05],
        [1.3256e-03, 4.9248e-03],
        [1.5998e-04, 2.3425e-05],
        [7.1144e-04, 2.8253e-05],
        [1.7786e-03, 4.7541e-04],
        [1.3571e-03, 1.5974e-04],
        [1.7748e-03, 3.1185e-04],
        [1.3695e-03, 3.4142e-04]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0002],
        [0.0036]], device='cuda:0', dtype=torch.float16)/tensor([[0.0002, 0.0036]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([0.0001, 0.0004], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[0.0002, 0.0001],
        [0.0036, 0.0004]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type modal, variation 2 and batchsize 16: 0:03:07.565056
path ['42', 'de', 'llama', 'SA', 'modal', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA rare_synonyms 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 333.23it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[4.0436e-04],
        [3.8433e-03],
        [3.5934e-03],
        [6.6872e-03],
        [7.1573e-04],
        [2.2297e-03],
        [1.2531e-03],
        [1.8859e-04],
        [1.6117e-04],
        [2.4533e-04],
        [1.5793e-03],
        [3.6359e-04],
        [4.1056e-04],
        [2.6913e-03],
        [8.2374e-05],
        [1.3828e-03]], device='cuda:0', dtype=torch.float16)/tensor([[4.0436e-04, 3.8433e-03, 3.5934e-03, 6.6872e-03, 7.1573e-04, 2.2297e-03,
         1.2531e-03, 1.8859e-04, 1.6117e-04, 2.4533e-04, 1.5793e-03, 3.6359e-04,
         4.1056e-04, 2.6913e-03, 8.2374e-05, 1.3828e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([6.6578e-05, 5.0843e-05, 1.7405e-04, 4.1175e-04, 1.1009e-04, 3.1352e-05,
        2.4974e-05, 3.1888e-05, 1.9968e-05, 2.6703e-05, 2.3746e-04, 5.7817e-05,
        1.1683e-04, 4.7040e-04, 1.2219e-05, 3.1066e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[4.0436e-04, 6.6578e-05],
        [3.8433e-03, 5.0843e-05],
        [3.5934e-03, 1.7405e-04],
        [6.6872e-03, 4.1175e-04],
        [7.1573e-04, 1.1009e-04],
        [2.2297e-03, 3.1352e-05],
        [1.2531e-03, 2.4974e-05],
        [1.8859e-04, 3.1888e-05],
        [1.6117e-04, 1.9968e-05],
        [2.4533e-04, 2.6703e-05],
        [1.5793e-03, 2.3746e-04],
        [3.6359e-04, 5.7817e-05],
        [4.1056e-04, 1.1683e-04],
        [2.6913e-03, 4.7040e-04],
        [8.2374e-05, 1.2219e-05],
        [1.3828e-03, 3.1066e-04]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.7166e-03],
        [1.5121e-02],
        [6.0177e-04],
        [4.3774e-04],
        [1.6108e-03],
        [6.4468e-04],
        [9.6381e-05],
        [9.1028e-04],
        [2.1954e-03],
        [2.9564e-04],
        [1.6804e-03],
        [1.5125e-03],
        [3.3689e-04],
        [1.5318e-04],
        [5.6801e-03],
        [2.5058e-04]], device='cuda:0', dtype=torch.float16)/tensor([[1.7166e-03, 1.5121e-02, 6.0177e-04, 4.3774e-04, 1.6108e-03, 6.4468e-04,
         9.6381e-05, 9.1028e-04, 2.1954e-03, 2.9564e-04, 1.6804e-03, 1.5125e-03,
         3.3689e-04, 1.5318e-04, 5.6801e-03, 2.5058e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.7418e-04, 1.2093e-03, 3.2008e-05, 1.4722e-05, 1.5044e-04, 1.8263e-04,
        1.4663e-05, 1.9383e-04, 2.4319e-04, 4.2260e-05, 3.8600e-04, 7.7486e-05,
        1.4377e-04, 5.2333e-05, 1.7033e-03, 1.0097e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.7166e-03, 2.7418e-04],
        [1.5121e-02, 1.2093e-03],
        [6.0177e-04, 3.2008e-05],
        [4.3774e-04, 1.4722e-05],
        [1.6108e-03, 1.5044e-04],
        [6.4468e-04, 1.8263e-04],
        [9.6381e-05, 1.4663e-05],
        [9.1028e-04, 1.9383e-04],
        [2.1954e-03, 2.4319e-04],
        [2.9564e-04, 4.2260e-05],
        [1.6804e-03, 3.8600e-04],
        [1.5125e-03, 7.7486e-05],
        [3.3689e-04, 1.4377e-04],
        [1.5318e-04, 5.2333e-05],
        [5.6801e-03, 1.7033e-03],
        [2.5058e-04, 1.0097e-04]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0006],
        [0.0010],
        [0.0022],
        [0.0127],
        [0.0005],
        [0.0076],
        [0.0002],
        [0.0001],
        [0.0006],
        [0.0033],
        [0.0014],
        [0.0019],
        [0.0007],
        [0.0017],
        [0.0018],
        [0.0001]], device='cuda:0', dtype=torch.float16)/tensor([[0.0006, 0.0010, 0.0022, 0.0127, 0.0005, 0.0076, 0.0002, 0.0001, 0.0006,
         0.0033, 0.0014, 0.0019, 0.0007, 0.0017, 0.0018, 0.0001]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([4.7982e-05, 9.0957e-05, 1.4699e-04, 6.2609e-04, 1.0353e-04, 3.6597e-04,
        4.4644e-05, 2.0564e-05, 1.1790e-04, 7.9575e-03, 6.1095e-05, 4.7231e-04,
        3.3140e-05, 7.5400e-05, 1.6117e-04, 2.3067e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[5.6505e-04, 4.7982e-05],
        [1.0023e-03, 9.0957e-05],
        [2.1725e-03, 1.4699e-04],
        [1.2695e-02, 6.2609e-04],
        [5.0879e-04, 1.0353e-04],
        [7.5989e-03, 3.6597e-04],
        [1.6344e-04, 4.4644e-05],
        [1.2434e-04, 2.0564e-05],
        [5.8985e-04, 1.1790e-04],
        [3.3321e-03, 7.9575e-03],
        [1.3838e-03, 6.1095e-05],
        [1.8883e-03, 4.7231e-04],
        [6.9714e-04, 3.3140e-05],
        [1.6861e-03, 7.5400e-05],
        [1.7853e-03, 1.6117e-04],
        [1.0318e-04, 2.3067e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0024],
        [0.0016]], device='cuda:0', dtype=torch.float16)/tensor([[0.0024, 0.0016]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([1.1754e-04, 3.6418e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[2.3632e-03, 1.1754e-04],
        [1.5869e-03, 3.6418e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type rare_synonyms, variation 0 and batchsize 16: 0:03:07.960798
path ['42', 'de', 'llama', 'SA', 'rare_synonyms', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA rare_synonyms 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 293.83it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0040],
        [0.0018],
        [0.0005],
        [0.0004],
        [0.0004],
        [0.0004],
        [0.0007],
        [0.0002],
        [0.0006],
        [0.0085],
        [0.0078],
        [0.0001],
        [0.0004],
        [0.0005],
        [0.0031],
        [0.0002]], device='cuda:0', dtype=torch.float16)/tensor([[0.0040, 0.0018, 0.0005, 0.0004, 0.0004, 0.0004, 0.0007, 0.0002, 0.0006,
         0.0085, 0.0078, 0.0001, 0.0004, 0.0005, 0.0031, 0.0002]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.9622e-04, 8.6427e-05, 1.0067e-04, 1.0544e-04, 1.4293e-04, 6.0499e-05,
        1.0544e-04, 1.9431e-05, 1.7643e-05, 4.2582e-04, 2.0027e-03, 1.6868e-05,
        4.5300e-05, 6.7472e-05, 3.9995e-05, 2.4199e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[4.0245e-03, 1.9622e-04],
        [1.7519e-03, 8.6427e-05],
        [4.6468e-04, 1.0067e-04],
        [3.7217e-04, 1.0544e-04],
        [3.7217e-04, 1.4293e-04],
        [4.1604e-04, 6.0499e-05],
        [6.7472e-04, 1.0544e-04],
        [1.5950e-04, 1.9431e-05],
        [6.1750e-04, 1.7643e-05],
        [8.4763e-03, 4.2582e-04],
        [7.8278e-03, 2.0027e-03],
        [1.3530e-04, 1.6868e-05],
        [4.0245e-04, 4.5300e-05],
        [4.6515e-04, 6.7472e-05],
        [3.0937e-03, 3.9995e-05],
        [1.7262e-04, 2.4199e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0011],
        [0.0022],
        [0.0002],
        [0.0016],
        [0.0009],
        [0.0012],
        [0.0048],
        [0.0002],
        [0.0141],
        [0.0030],
        [0.0016],
        [0.0008],
        [0.0016],
        [0.0018],
        [0.0028],
        [0.0022]], device='cuda:0', dtype=torch.float16)/tensor([[0.0011, 0.0022, 0.0002, 0.0016, 0.0009, 0.0012, 0.0048, 0.0002, 0.0141,
         0.0030, 0.0016, 0.0008, 0.0016, 0.0018, 0.0028, 0.0022]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([9.0361e-05, 4.8459e-05, 3.4094e-05, 2.4819e-04, 4.1068e-05, 2.8074e-05,
        6.7055e-05, 5.1439e-05, 6.9189e-04, 2.0599e-04, 6.8247e-05, 4.1306e-05,
        3.5310e-04, 1.6487e-04, 7.0429e-04, 8.9049e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.0633e-03, 9.0361e-05],
        [2.1629e-03, 4.8459e-05],
        [2.0885e-04, 3.4094e-05],
        [1.6413e-03, 2.4819e-04],
        [9.2268e-04, 4.1068e-05],
        [1.2302e-03, 2.8074e-05],
        [4.8447e-03, 6.7055e-05],
        [1.9884e-04, 5.1439e-05],
        [1.4114e-02, 6.9189e-04],
        [2.9640e-03, 2.0599e-04],
        [1.5955e-03, 6.8247e-05],
        [8.3113e-04, 4.1306e-05],
        [1.6356e-03, 3.5310e-04],
        [1.8063e-03, 1.6487e-04],
        [2.8172e-03, 7.0429e-04],
        [2.1839e-03, 8.9049e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[9.7156e-05],
        [1.7428e-04],
        [1.0318e-04],
        [8.8348e-03],
        [7.9870e-04],
        [2.9736e-03],
        [5.0240e-03],
        [1.9550e-03],
        [2.6560e-04],
        [1.8875e-02],
        [6.1178e-04],
        [6.4373e-04],
        [2.7637e-03],
        [2.3804e-03],
        [1.1749e-03],
        [2.1820e-03]], device='cuda:0', dtype=torch.float16)/tensor([[9.7156e-05, 1.7428e-04, 1.0318e-04, 8.8348e-03, 7.9870e-04, 2.9736e-03,
         5.0240e-03, 1.9550e-03, 2.6560e-04, 1.8875e-02, 6.1178e-04, 6.4373e-04,
         2.7637e-03, 2.3804e-03, 1.1749e-03, 2.1820e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.2815e-05, 5.7220e-05, 2.3544e-05, 4.8137e-04, 2.0671e-04, 1.3733e-04,
        9.7885e-03, 3.0136e-04, 2.7001e-05, 1.4324e-03, 1.1635e-04, 4.9889e-05,
        4.8375e-04, 4.7255e-04, 2.1708e-04, 2.3961e-04], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[9.7156e-05, 1.2815e-05],
        [1.7428e-04, 5.7220e-05],
        [1.0318e-04, 2.3544e-05],
        [8.8348e-03, 4.8137e-04],
        [7.9870e-04, 2.0671e-04],
        [2.9736e-03, 1.3733e-04],
        [5.0240e-03, 9.7885e-03],
        [1.9550e-03, 3.0136e-04],
        [2.6560e-04, 2.7001e-05],
        [1.8875e-02, 1.4324e-03],
        [6.1178e-04, 1.1635e-04],
        [6.4373e-04, 4.9889e-05],
        [2.7637e-03, 4.8375e-04],
        [2.3804e-03, 4.7255e-04],
        [1.1749e-03, 2.1708e-04],
        [2.1820e-03, 2.3961e-04]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0024],
        [0.0003]], device='cuda:0', dtype=torch.float16)/tensor([[0.0024, 0.0003]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([1.8620e-04, 9.7513e-05], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[2.3861e-03, 1.8620e-04],
        [2.6655e-04, 9.7513e-05]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type rare_synonyms, variation 1 and batchsize 16: 0:03:08.077028
path ['42', 'de', 'llama', 'SA', 'rare_synonyms', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA rare_synonyms 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 358.26it/s]
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0013],
        [0.0074],
        [0.0021],
        [0.0002],
        [0.0003],
        [0.0185],
        [0.0013],
        [0.0006],
        [0.0030],
        [0.0079],
        [0.0007],
        [0.0025],
        [0.0045],
        [0.0019],
        [0.0090],
        [0.0002]], device='cuda:0', dtype=torch.float16)/tensor([[0.0013, 0.0074, 0.0021, 0.0002, 0.0003, 0.0185, 0.0013, 0.0006, 0.0030,
         0.0079, 0.0007, 0.0025, 0.0045, 0.0019, 0.0090, 0.0002]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([1.0765e-04, 1.9217e-03, 4.5109e-04, 5.2512e-05, 1.0896e-04, 1.5736e-03,
        2.2984e-04, 1.9252e-05, 1.4889e-04, 1.1162e-02, 5.3644e-05, 2.0218e-04,
        5.8353e-05, 3.0136e-04, 4.8304e-04, 2.7657e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.2779e-03, 1.0765e-04],
        [7.3853e-03, 1.9217e-03],
        [2.0714e-03, 4.5109e-04],
        [1.5795e-04, 5.2512e-05],
        [2.6393e-04, 1.0896e-04],
        [1.8539e-02, 1.5736e-03],
        [1.3390e-03, 2.2984e-04],
        [5.6648e-04, 1.9252e-05],
        [2.9602e-03, 1.4889e-04],
        [7.8583e-03, 1.1162e-02],
        [6.6662e-04, 5.3644e-05],
        [2.4662e-03, 2.0218e-04],
        [4.5433e-03, 5.8353e-05],
        [1.9264e-03, 3.0136e-04],
        [9.0408e-03, 4.8304e-04],
        [1.8716e-04, 2.7657e-05]], device='cuda:0')
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[1.3342e-03],
        [2.5082e-04],
        [6.3896e-04],
        [1.6344e-04],
        [4.3344e-04],
        [2.0332e-03],
        [3.8147e-04],
        [6.7949e-04],
        [1.9050e-04],
        [3.5906e-04],
        [2.9545e-03],
        [1.4758e-04],
        [1.3954e-02],
        [4.0221e-04],
        [1.5745e-03],
        [9.3937e-05]], device='cuda:0', dtype=torch.float16)/tensor([[1.3342e-03, 2.5082e-04, 6.3896e-04, 1.6344e-04, 4.3344e-04, 2.0332e-03,
         3.8147e-04, 6.7949e-04, 1.9050e-04, 3.5906e-04, 2.9545e-03, 1.4758e-04,
         1.3954e-02, 4.0221e-04, 1.5745e-03, 9.3937e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([2.9624e-05, 2.7001e-05, 1.0103e-04, 4.7207e-05, 6.5506e-05, 9.1910e-05,
        1.5497e-04, 1.9908e-04, 3.3557e-05, 1.0419e-04, 3.4928e-05, 1.9431e-05,
        7.1669e-04, 4.9651e-05, 3.4428e-04, 1.3053e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[1.3342e-03, 2.9624e-05],
        [2.5082e-04, 2.7001e-05],
        [6.3896e-04, 1.0103e-04],
        [1.6344e-04, 4.7207e-05],
        [4.3344e-04, 6.5506e-05],
        [2.0332e-03, 9.1910e-05],
        [3.8147e-04, 1.5497e-04],
        [6.7949e-04, 1.9908e-04],
        [1.9050e-04, 3.3557e-05],
        [3.5906e-04, 1.0419e-04],
        [2.9545e-03, 3.4928e-05],
        [1.4758e-04, 1.9431e-05],
        [1.3954e-02, 7.1669e-04],
        [4.0221e-04, 4.9651e-05],
        [1.5745e-03, 3.4428e-04],
        [9.3937e-05, 1.3053e-05]], device='cuda:0')
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([16, 1])
id: [12337] -> tensor([[0.0008],
        [0.0009],
        [0.0018],
        [0.0019],
        [0.0093],
        [0.0015],
        [0.0001],
        [0.0001],
        [0.0019],
        [0.0029],
        [0.0005],
        [0.0027],
        [0.0032],
        [0.0008],
        [0.0015],
        [0.0004]], device='cuda:0', dtype=torch.float16)/tensor([[0.0008, 0.0009, 0.0018, 0.0019, 0.0093, 0.0015, 0.0001, 0.0001, 0.0019,
         0.0029, 0.0005, 0.0027, 0.0032, 0.0008, 0.0015, 0.0004]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([16])
id: [1, 452, 262] -> tensor([4.2021e-05, 4.5955e-05, 9.1553e-05, 4.5717e-05, 4.5586e-04, 1.3924e-04,
        1.8120e-05, 2.5988e-05, 2.6846e-04, 3.1638e-04, 1.0645e-04, 5.1832e-04,
        7.7438e-04, 1.4448e-04, 7.4387e-05, 6.6042e-05], device='cuda:0',
       dtype=torch.float16), torch.Size([16])
answers_probs: tensor([[8.2684e-04, 4.2021e-05],
        [8.5306e-04, 4.5955e-05],
        [1.7872e-03, 9.1553e-05],
        [1.9484e-03, 4.5717e-05],
        [9.2926e-03, 4.5586e-04],
        [1.5383e-03, 1.3924e-04],
        [1.2982e-04, 1.8120e-05],
        [1.1086e-04, 2.5988e-05],
        [1.9054e-03, 2.6846e-04],
        [2.8992e-03, 3.1638e-04],
        [4.7255e-04, 1.0645e-04],
        [2.7122e-03, 5.1832e-04],
        [3.2196e-03, 7.7438e-04],
        [7.6437e-04, 1.4448e-04],
        [1.5268e-03, 7.4387e-05],
        [4.1747e-04, 6.6042e-05]], device='cuda:0')
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
probs_ shape torch.Size([2, 1])
id: [12337] -> tensor([[0.0042],
        [0.0030]], device='cuda:0', dtype=torch.float16)/tensor([[0.0042, 0.0030]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
probs_ shape torch.Size([2])
id: [1, 452, 262] -> tensor([0.0002, 0.0002], device='cuda:0', dtype=torch.float16), torch.Size([2])
answers_probs: tensor([[0.0042, 0.0002],
        [0.0030, 0.0002]], device='cuda:0')
acc:  0.52
Time taken to execute the de SA task with prompt type rare_synonyms, variation 2 and batchsize 16: 0:03:07.740270
path ['42', 'de', 'llama', 'SA', 'rare_synonyms', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v4.pickle' as a pickle file.
****End Time: 2023-05-22 01:01:33.386452 Duraction: 3:04:13.737629
