task  SA
self.device  cuda
Downloading builder script:   0%|          | 0.00/7.16k [00:00<?, ?B/s]Downloading builder script: 100%|██████████| 7.16k/7.16k [00:00<00:00, 4.33MB/s]
Downloading metadata:   0%|          | 0.00/37.4k [00:00<?, ?B/s]Downloading metadata: 100%|██████████| 37.4k/37.4k [00:00<00:00, 438kB/s]
Downloading readme:   0%|          | 0.00/15.0k [00:00<?, ?B/s]Downloading readme: 100%|██████████| 15.0k/15.0k [00:00<00:00, 6.85MB/s]
Downloading and preparing dataset amazon_reviews_multi/en to /home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609...
Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]
Downloading data:   0%|          | 0.00/82.0M [00:00<?, ?B/s][A
Downloading data:   0%|          | 2.05k/82.0M [00:00<2:20:25, 9.73kB/s][A
Downloading data:   0%|          | 52.2k/82.0M [00:00<09:30, 144kB/s]   [A
Downloading data:   0%|          | 104k/82.0M [00:00<07:09, 191kB/s] [A
Downloading data:   0%|          | 244k/82.0M [00:00<03:38, 375kB/s][A
Downloading data:   0%|          | 366k/82.0M [00:01<03:02, 447kB/s][A
Downloading data:   1%|          | 749k/82.0M [00:01<01:29, 910kB/s][A
Downloading data:   2%|▏         | 1.53M/82.0M [00:01<00:44, 1.82MB/s][A
Downloading data:   4%|▍         | 3.11M/82.0M [00:01<00:21, 3.62MB/s][A
Downloading data:   6%|▌         | 4.77M/82.0M [00:01<00:15, 4.93MB/s][A
Downloading data:   8%|▊         | 6.50M/82.0M [00:02<00:12, 5.94MB/s][A
Downloading data:  10%|█         | 8.24M/82.0M [00:02<00:11, 6.63MB/s][A
Downloading data:  12%|█▏        | 10.0M/82.0M [00:02<00:10, 7.15MB/s][A
Downloading data:  14%|█▍        | 11.8M/82.0M [00:02<00:09, 7.53MB/s][A
Downloading data:  17%|█▋        | 13.7M/82.0M [00:02<00:08, 7.92MB/s][A
Downloading data:  19%|█▉        | 15.6M/82.0M [00:03<00:07, 8.31MB/s][A
Downloading data:  22%|██▏       | 17.6M/82.0M [00:03<00:07, 8.67MB/s][A
Downloading data:  24%|██▍       | 19.7M/82.0M [00:03<00:06, 8.96MB/s][A
Downloading data:  27%|██▋       | 21.8M/82.0M [00:03<00:06, 9.22MB/s][A
Downloading data:  29%|██▉       | 23.9M/82.0M [00:04<00:06, 9.43MB/s][A
Downloading data:  32%|███▏      | 26.0M/82.0M [00:04<00:04, 11.4MB/s][A
Downloading data:  33%|███▎      | 27.3M/82.0M [00:04<00:04, 11.0MB/s][A
Downloading data:  35%|███▍      | 28.5M/82.0M [00:04<00:05, 9.33MB/s][A
Downloading data:  37%|███▋      | 30.5M/82.0M [00:04<00:05, 9.52MB/s][A
Downloading data:  40%|████      | 32.8M/82.0M [00:04<00:04, 12.1MB/s][A
Downloading data:  42%|████▏     | 34.2M/82.0M [00:04<00:04, 11.7MB/s][A
Downloading data:  43%|████▎     | 35.5M/82.0M [00:05<00:04, 9.86MB/s][A
Downloading data:  46%|████▌     | 37.8M/82.0M [00:05<00:04, 10.3MB/s][A
Downloading data:  49%|████▉     | 40.3M/82.0M [00:05<00:03, 13.1MB/s][A
Downloading data:  51%|█████     | 41.8M/82.0M [00:05<00:03, 12.6MB/s][A
Downloading data:  53%|█████▎    | 43.2M/82.0M [00:05<00:03, 10.6MB/s][A
Downloading data:  56%|█████▌    | 45.8M/82.0M [00:05<00:03, 11.3MB/s][A
Downloading data:  59%|█████▉    | 48.4M/82.0M [00:06<00:02, 14.2MB/s][A
Downloading data:  61%|██████    | 50.0M/82.0M [00:06<00:02, 13.1MB/s][A
Downloading data:  63%|██████▎   | 51.5M/82.0M [00:06<00:02, 11.6MB/s][A
Downloading data:  66%|██████▌   | 54.1M/82.0M [00:06<00:02, 12.0MB/s][A
Downloading data:  69%|██████▉   | 56.6M/82.0M [00:06<00:01, 14.6MB/s][A
Downloading data:  71%|███████   | 58.3M/82.0M [00:06<00:01, 13.7MB/s][A
Downloading data:  73%|███████▎  | 59.9M/82.0M [00:06<00:01, 12.0MB/s][A
Downloading data:  76%|███████▌  | 62.3M/82.0M [00:07<00:01, 14.7MB/s][A
Downloading data:  78%|███████▊  | 64.0M/82.0M [00:07<00:01, 11.9MB/s][A
Downloading data:  80%|███████▉  | 65.6M/82.0M [00:07<00:01, 12.4MB/s][A
Downloading data:  82%|████████▏ | 67.0M/82.0M [00:07<00:01, 12.3MB/s][A
Downloading data:  84%|████████▎ | 68.7M/82.0M [00:07<00:00, 13.4MB/s][A
Downloading data:  86%|████████▌ | 70.1M/82.0M [00:07<00:01, 10.7MB/s][A
Downloading data:  89%|████████▊ | 72.6M/82.0M [00:07<00:00, 13.9MB/s][A
Downloading data:  91%|█████████ | 74.2M/82.0M [00:08<00:00, 12.8MB/s][A
Downloading data:  92%|█████████▏| 75.7M/82.0M [00:08<00:00, 11.5MB/s][A
Downloading data:  94%|█████████▍| 77.4M/82.0M [00:08<00:00, 12.7MB/s][A
Downloading data:  96%|█████████▌| 78.8M/82.0M [00:08<00:00, 12.6MB/s][A
Downloading data:  98%|█████████▊| 80.2M/82.0M [00:08<00:00, 12.4MB/s][A
Downloading data: 100%|█████████▉| 81.9M/82.0M [00:08<00:00, 13.3MB/s][ADownloading data: 100%|██████████| 82.0M/82.0M [00:08<00:00, 9.41MB/s]
Downloading data files: 100%|██████████| 1/1 [00:11<00:00, 11.16s/it]Downloading data files: 100%|██████████| 1/1 [00:11<00:00, 11.16s/it]
Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 54.57it/s]
Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]
Downloading data:   0%|          | 0.00/2.06M [00:00<?, ?B/s][A
Downloading data:   1%|          | 16.4k/2.06M [00:00<00:21, 94.5kB/s][A
Downloading data:   2%|▏         | 51.2k/2.06M [00:00<00:12, 156kB/s] [A
Downloading data:   5%|▌         | 103k/2.06M [00:00<00:08, 221kB/s] [A
Downloading data:   7%|▋         | 138k/2.06M [00:00<00:09, 213kB/s][A
Downloading data:   8%|▊         | 173k/2.06M [00:00<00:09, 208kB/s][A
Downloading data:  11%|█         | 225k/2.06M [00:01<00:07, 239kB/s][A
Downloading data:  13%|█▎        | 278k/2.06M [00:01<00:06, 258kB/s][A
Downloading data:  15%|█▌        | 312k/2.06M [00:01<00:07, 239kB/s][A
Downloading data:  18%|█▊        | 365k/2.06M [00:01<00:06, 258kB/s][A
Downloading data:  27%|██▋       | 556k/2.06M [00:01<00:02, 516kB/s][A
Downloading data:  38%|███▊      | 782k/2.06M [00:01<00:01, 754kB/s][A
Downloading data:  64%|██████▍   | 1.32M/2.06M [00:02<00:00, 1.46MB/s][A
Downloading data:  93%|█████████▎| 1.91M/2.06M [00:02<00:00, 2.03MB/s][ADownloading data: 100%|██████████| 2.06M/2.06M [00:02<00:00, 902kB/s] 
Downloading data files: 100%|██████████| 1/1 [00:04<00:00,  4.03s/it]Downloading data files: 100%|██████████| 1/1 [00:04<00:00,  4.03s/it]
Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 172.76it/s]
Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]
Downloading data:   0%|          | 0.00/2.05M [00:00<?, ?B/s][A
Downloading data:   1%|          | 18.4k/2.05M [00:00<00:19, 105kB/s][A
Downloading data:   3%|▎         | 52.2k/2.05M [00:00<00:12, 155kB/s][A
Downloading data:   5%|▌         | 104k/2.05M [00:00<00:08, 219kB/s] [A
Downloading data:   8%|▊         | 162k/2.05M [00:00<00:07, 260kB/s][A
Downloading data:  10%|▉         | 195k/2.05M [00:00<00:07, 233kB/s][A
Downloading data:  13%|█▎        | 260k/2.05M [00:01<00:06, 278kB/s][A
Downloading data:  15%|█▍        | 305k/2.05M [00:01<00:06, 271kB/s][A
Downloading data:  22%|██▏       | 456k/2.05M [00:01<00:03, 455kB/s][A
Downloading data:  29%|██▉       | 602k/2.05M [00:01<00:02, 570kB/s][A
Downloading data:  50%|█████     | 1.03M/2.05M [00:01<00:00, 1.14MB/s][A
Downloading data:  92%|█████████▏| 1.89M/2.05M [00:01<00:00, 2.27MB/s][ADownloading data: 100%|██████████| 2.05M/2.05M [00:01<00:00, 1.04MB/s]
Downloading data files: 100%|██████████| 1/1 [00:03<00:00,  3.66s/it]Downloading data files: 100%|██████████| 1/1 [00:03<00:00,  3.66s/it]
Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]Extracting data files: 100%|██████████| 1/1 [00:00<00:00, 217.47it/s]
Generating train split:   0%|          | 0/200000 [00:00<?, ? examples/s]Generating train split:   0%|          | 1000/200000 [00:00<00:22, 9043.29 examples/s]Generating train split:   1%|▏         | 2769/200000 [00:00<00:14, 13912.55 examples/s]Generating train split:   2%|▏         | 4465/200000 [00:00<00:12, 15269.15 examples/s]Generating train split:   3%|▎         | 6158/200000 [00:00<00:12, 15911.27 examples/s]Generating train split:   4%|▍         | 7955/200000 [00:00<00:11, 16615.89 examples/s]Generating train split:   5%|▍         | 9670/200000 [00:00<00:11, 16792.11 examples/s]Generating train split:   6%|▌         | 12164/200000 [00:00<00:11, 16719.59 examples/s]Generating train split:   7%|▋         | 13979/200000 [00:00<00:10, 17124.81 examples/s]Generating train split:   8%|▊         | 15940/200000 [00:01<00:14, 12918.96 examples/s]Generating train split:   9%|▉         | 17646/200000 [00:01<00:13, 13872.20 examples/s]Generating train split:  10%|▉         | 19347/200000 [00:01<00:12, 14647.75 examples/s]Generating train split:  11%|█         | 21050/200000 [00:01<00:11, 15164.25 examples/s]Generating train split:  11%|█▏        | 22959/200000 [00:01<00:11, 16009.89 examples/s]Generating train split:  12%|█▏        | 24685/200000 [00:01<00:10, 16354.22 examples/s]Generating train split:  13%|█▎        | 26392/200000 [00:01<00:10, 16553.33 examples/s]Generating train split:  14%|█▍        | 28100/200000 [00:01<00:10, 16702.70 examples/s]Generating train split:  15%|█▍        | 29959/200000 [00:01<00:09, 17149.47 examples/s]Generating train split:  16%|█▋        | 32532/200000 [00:02<00:09, 17148.22 examples/s]Generating train split:  18%|█▊        | 35102/200000 [00:02<00:09, 17140.78 examples/s]Generating train split:  18%|█▊        | 36960/200000 [00:02<00:09, 17395.69 examples/s]Generating train split:  20%|█▉        | 39509/200000 [00:02<00:09, 17253.01 examples/s]Generating train split:  21%|██        | 42000/200000 [00:02<00:09, 16996.59 examples/s]Generating train split:  22%|██▏       | 43784/200000 [00:02<00:09, 17197.68 examples/s]Generating train split:  23%|██▎       | 46323/200000 [00:02<00:08, 17102.80 examples/s]Generating train split:  24%|██▍       | 48981/200000 [00:03<00:08, 17301.39 examples/s]Generating train split:  26%|██▌       | 51545/200000 [00:03<00:08, 17232.94 examples/s]Generating train split:  27%|██▋       | 54093/200000 [00:03<00:08, 17153.31 examples/s]Generating train split:  28%|██▊       | 55954/200000 [00:03<00:08, 17382.50 examples/s]Generating train split:  29%|██▉       | 58520/200000 [00:03<00:08, 17289.04 examples/s]Generating train split:  31%|███       | 61075/200000 [00:03<00:08, 17204.36 examples/s]Generating train split:  31%|███▏      | 62956/200000 [00:03<00:07, 17423.31 examples/s]Generating train split:  33%|███▎      | 65515/200000 [00:03<00:07, 17301.50 examples/s]Generating train split:  34%|███▍      | 68053/200000 [00:04<00:07, 17176.39 examples/s]Generating train split:  35%|███▍      | 69947/200000 [00:04<00:07, 17357.84 examples/s]Generating train split:  36%|███▌      | 72492/200000 [00:04<00:07, 17223.96 examples/s]Generating train split:  38%|███▊      | 75051/200000 [00:04<00:07, 17167.86 examples/s]Generating train split:  38%|███▊      | 76945/200000 [00:04<00:07, 17378.83 examples/s]Generating train split:  40%|███▉      | 79426/200000 [00:04<00:07, 17028.25 examples/s]Generating train split:  41%|████      | 82000/200000 [00:04<00:06, 17033.99 examples/s]Generating train split:  42%|████▏     | 83797/200000 [00:05<00:06, 17249.00 examples/s]Generating train split:  43%|████▎     | 86359/200000 [00:05<00:06, 17189.23 examples/s]Generating train split:  44%|████▍     | 88989/200000 [00:05<00:06, 17298.67 examples/s]Generating train split:  46%|████▌     | 91563/200000 [00:05<00:06, 17251.61 examples/s]Generating train split:  47%|████▋     | 94124/200000 [00:05<00:06, 17192.58 examples/s]Generating train split:  48%|████▊     | 95953/200000 [00:05<00:05, 17400.45 examples/s]Generating train split:  49%|████▉     | 98525/200000 [00:05<00:05, 17312.87 examples/s]Generating train split:  51%|█████     | 101095/200000 [00:06<00:05, 17252.87 examples/s]Generating train split:  51%|█████▏    | 102905/200000 [00:06<00:05, 17274.03 examples/s]Generating train split:  53%|█████▎    | 105325/200000 [00:06<00:05, 16893.85 examples/s]Generating train split:  54%|█████▎    | 107055/200000 [00:06<00:05, 16990.46 examples/s]Generating train split:  54%|█████▍    | 108922/200000 [00:06<00:05, 17189.41 examples/s]Generating train split:  56%|█████▌    | 111457/200000 [00:06<00:05, 17085.09 examples/s]Generating train split:  57%|█████▋    | 114008/200000 [00:06<00:05, 17053.57 examples/s]Generating train split:  58%|█████▊    | 115841/200000 [00:06<00:04, 17358.11 examples/s]Generating train split:  59%|█████▉    | 118333/200000 [00:07<00:04, 17101.16 examples/s]Generating train split:  60%|██████    | 121000/200000 [00:07<00:04, 17129.66 examples/s]Generating train split:  61%|██████▏   | 122795/200000 [00:07<00:04, 17320.91 examples/s]Generating train split:  63%|██████▎   | 125374/200000 [00:07<00:04, 17273.53 examples/s]Generating train split:  64%|██████▍   | 128000/200000 [00:07<00:04, 17266.11 examples/s]Generating train split:  65%|██████▍   | 129790/200000 [00:07<00:04, 17414.58 examples/s]Generating train split:  66%|██████▌   | 132255/200000 [00:07<00:03, 17081.57 examples/s]Generating train split:  67%|██████▋   | 133975/200000 [00:07<00:03, 17107.94 examples/s]Generating train split:  68%|██████▊   | 136534/200000 [00:08<00:03, 17088.06 examples/s]Generating train split:  70%|██████▉   | 139094/200000 [00:08<00:03, 17078.04 examples/s]Generating train split:  70%|███████   | 140961/200000 [00:08<00:03, 17348.58 examples/s]Generating train split:  72%|███████▏  | 143524/200000 [00:08<00:03, 17258.06 examples/s]Generating train split:  73%|███████▎  | 146098/200000 [00:08<00:03, 17222.67 examples/s]Generating train split:  74%|███████▍  | 147942/200000 [00:08<00:02, 17365.93 examples/s]Generating train split:  75%|███████▌  | 150404/200000 [00:08<00:02, 17042.48 examples/s]Generating train split:  76%|███████▌  | 152123/200000 [00:09<00:02, 17075.18 examples/s]Generating train split:  77%|███████▋  | 153940/200000 [00:09<00:02, 17292.30 examples/s]Generating train split:  78%|███████▊  | 156483/200000 [00:09<00:02, 17168.38 examples/s]Generating train split:  80%|███████▉  | 159056/200000 [00:09<00:02, 17160.26 examples/s]Generating train split:  80%|████████  | 160961/200000 [00:09<00:02, 17436.77 examples/s]Generating train split:  82%|████████▏ | 163539/200000 [00:09<00:02, 17349.12 examples/s]Generating train split:  83%|████████▎ | 166059/200000 [00:09<00:01, 17165.17 examples/s]Generating train split:  84%|████████▍ | 167964/200000 [00:09<00:01, 17429.43 examples/s]Generating train split:  85%|████████▌ | 170556/200000 [00:10<00:01, 17375.07 examples/s]Generating train split:  87%|████████▋ | 173096/200000 [00:10<00:01, 17228.31 examples/s]Generating train split:  87%|████████▋ | 174958/200000 [00:10<00:01, 17428.99 examples/s]Generating train split:  89%|████████▉ | 177541/200000 [00:10<00:01, 17355.53 examples/s]Generating train split:  90%|█████████ | 180121/200000 [00:10<00:01, 17302.64 examples/s]Generating train split:  91%|█████████▏| 182610/200000 [00:10<00:01, 16916.50 examples/s]Generating train split:  93%|█████████▎| 185089/200000 [00:10<00:00, 16792.82 examples/s]Generating train split:  93%|█████████▎| 186958/200000 [00:11<00:00, 17106.97 examples/s]Generating train split:  94%|█████████▍| 188685/200000 [00:11<00:00, 17145.14 examples/s]Generating train split:  96%|█████████▌| 191251/200000 [00:11<00:00, 17129.35 examples/s]Generating train split:  96%|█████████▋| 193000/200000 [00:11<00:00, 17186.52 examples/s]Generating train split:  97%|█████████▋| 194788/200000 [00:11<00:00, 17364.00 examples/s]Generating train split:  99%|█████████▊| 197366/200000 [00:11<00:00, 17296.87 examples/s]Generating train split: 100%|██████████| 200000/200000 [00:11<00:00, 17236.77 examples/s]                                        Dataset amazon_reviews_multi downloaded and prepared to /home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609. Subsequent calls will reuse this data.
                                                 Generating validation split:   0%|          | 0/5000 [00:00<?, ? examples/s]Generating validation split:  32%|███▏      | 1612/5000 [00:00<00:00, 15979.85 examples/s]Generating validation split:  66%|██████▋   | 3321/5000 [00:00<00:00, 16622.97 examples/s]                                                                                          Generating test split:   0%|          | 0/5000 [00:00<?, ? examples/s]Generating test split:  36%|███▌      | 1778/5000 [00:00<00:00, 17666.54 examples/s]Generating test split:  87%|████████▋ | 4358/5000 [00:00<00:00, 17342.19 examples/s]                                                                                      0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 30.02it/s]
Traceback (most recent call last):
  File "/home/lcur1101/ATCS_group3/code/pipeline_file.py", line 217, in <module>
    acc = pipeline(LM_model, task, prompt_generator)
  File "/home/lcur1101/ATCS_group3/code/pipeline_file.py", line 106, in pipeline
    train_dataloader = create_dataloader(batch_size)
  File "/home/lcur1101/ATCS_group3/code/dataloaders.py", line 90, in create_dataloader
    sample_texts, sample_labels = marc_dataset.get_random_sample(
  File "/home/lcur1101/ATCS_group3/code/dataloaders.py", line 76, in get_random_sample
    with open(self.data_path, 'r', encoding='utf-8') as f:
AttributeError: 'MARCDataset' object has no attribute 'data_path'
srun: error: r35n2: task 0: Exited with exit code 1
