Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
****Start Time: 2023-05-26_17-37-46
Using MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:01,  1.42it/s]100%|██████████| 3/3 [00:00<00:00,  4.20it/s]
loading model Duration: 0:00:03.397617
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
len of lowest cat:  38553
len of pos_reviews, neg_reviews:  38553 38553
len dataset  77106
len dataset  200
create dataloader Duration: 0:03:09.353675
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
load model Duration: 0:00:19.243051
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloom-560m SA null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[2.9496e-07, 4.8928e-09, 7.9932e-08, 8.5006e-07, 3.6456e-07, 2.3227e-07,
         6.9597e-07, 1.0045e-08, 9.4619e-07, 2.8516e-07, 4.2881e-06, 1.2664e-06,
         6.9202e-07, 8.3395e-07, 2.5469e-06, 1.7675e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[6.0821e-06, 8.0776e-08, 1.7523e-06, 1.0292e-05, 6.3184e-06, 1.0629e-06,
         1.3363e-06, 1.2237e-07, 1.2472e-05, 1.1077e-06, 1.8047e-05, 2.3350e-05,
         7.7682e-06, 1.2527e-06, 7.3223e-06, 5.3735e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:03.474833
summ of probs approach
id: [18260] -> tensor([[9.2519e-07, 5.9468e-09, 1.8733e-07, 3.3165e-08, 3.0188e-06, 3.1203e-08,
         1.7053e-07, 1.1142e-06, 2.1828e-07, 5.1768e-04, 2.1807e-07, 4.7086e-07,
         1.8137e-06, 6.8321e-09, 7.2061e-07, 2.1407e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.7901e-06, 8.6189e-09, 5.2580e-07, 4.0672e-07, 3.5988e-05, 2.1172e-07,
         1.7386e-06, 1.2739e-05, 9.2738e-07, 4.8300e-03, 1.0775e-06, 4.3663e-07,
         3.1771e-06, 7.6245e-06, 2.4414e-06, 9.6905e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.167297
summ of probs approach
id: [18260] -> tensor([[7.3500e-07, 5.7481e-07, 8.3196e-07, 4.2263e-07, 4.9454e-08, 8.9476e-08,
         5.4317e-08, 5.0616e-08, 1.7166e-06, 3.6780e-07, 3.8797e-06, 1.5525e-07,
         1.5636e-03, 6.8124e-07, 1.3496e-07, 4.0015e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[7.5588e-06, 3.5418e-06, 1.5157e-06, 3.1964e-06, 2.5641e-06, 9.9812e-07,
         1.3687e-07, 1.2767e-05, 1.4978e-05, 2.6258e-06, 3.5933e-05, 2.5485e-06,
         2.5415e-03, 1.0469e-05, 3.0997e-06, 3.3657e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.153020
summ of probs approach
id: [18260] -> tensor([[2.6612e-07, 1.3174e-07, 8.6245e-08, 1.1454e-06, 1.0742e-09, 7.4938e-09,
         1.0274e-06, 1.9720e-06, 2.1954e-06, 3.0999e-07, 1.8542e-08, 5.4112e-08,
         1.0953e-07, 5.7652e-07, 6.6511e-07, 1.0332e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.7173e-06, 2.3887e-06, 2.3417e-07, 5.9828e-06, 2.8500e-08, 4.1441e-08,
         3.6598e-05, 2.8043e-05, 8.0960e-05, 2.3883e-06, 3.7954e-07, 9.5870e-07,
         8.9398e-07, 1.1942e-05, 5.8062e-06, 2.8301e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.149553
summ of probs approach
id: [18260] -> tensor([[1.2044e-07, 1.0065e-07, 1.7174e-06, 5.4633e-09, 4.6795e-07, 6.0044e-08,
         1.1469e-06, 5.3299e-07, 2.8715e-07, 1.3875e-07, 2.1403e-09, 5.7937e-07,
         4.1416e-06, 9.0513e-09, 3.5867e-07, 3.8467e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[7.6980e-07, 3.0936e-06, 7.2380e-06, 3.4977e-07, 3.8878e-06, 1.8752e-07,
         3.8280e-06, 7.4536e-07, 9.6847e-06, 1.3321e-05, 7.0138e-08, 4.1086e-06,
         5.1913e-05, 1.7428e-07, 2.4015e-06, 3.2967e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.105926
summ of probs approach
id: [18260] -> tensor([[1.3485e-07, 3.2288e-07, 3.6833e-07, 4.7922e-04, 2.7939e-07, 7.7846e-07,
         3.3522e-07, 9.9947e-07, 7.2768e-07, 1.0594e-06, 2.3012e-07, 7.2727e-07,
         3.0974e-07, 9.6028e-07, 5.1756e-06, 1.7733e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[6.0229e-07, 3.7801e-06, 3.3925e-06, 9.2503e-04, 3.0320e-06, 3.6305e-06,
         1.1901e-06, 1.2804e-05, 2.9899e-06, 1.7655e-06, 1.4528e-06, 5.4897e-06,
         1.9860e-06, 1.1158e-05, 8.5097e-05, 1.6312e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.164075
summ of probs approach
id: [18260] -> tensor([[2.2428e-07, 3.6950e-08, 3.7206e-07, 8.4313e-09, 2.0414e-07, 1.8444e-07,
         2.7056e-07, 8.8021e-07, 7.7223e-07, 7.9710e-06, 2.6557e-07, 2.5285e-07,
         1.7077e-09, 2.8908e-07, 3.4076e-07, 1.1928e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.1619e-06, 2.1565e-07, 3.0667e-06, 2.1546e-07, 4.0386e-06, 3.7230e-06,
         1.7972e-06, 6.2327e-06, 5.4280e-06, 6.9467e-05, 2.5609e-07, 1.4911e-06,
         1.2964e-08, 3.2106e-06, 2.5884e-06, 1.1200e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.131691
summ of probs approach
id: [18260] -> tensor([[5.6904e-06, 2.5632e-06, 4.4595e-06, 4.5921e-06, 6.6235e-08, 1.6461e-09,
         3.8871e-08, 7.9484e-09, 3.4283e-07, 2.0894e-06, 1.1486e-06, 3.6064e-07,
         6.9553e-07, 2.9563e-07, 3.9281e-08, 3.9915e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[8.8534e-06, 1.3896e-05, 2.9335e-05, 2.3139e-05, 4.6018e-07, 1.8413e-07,
         7.0708e-07, 8.0693e-08, 9.2968e-07, 2.8134e-05, 1.2938e-06, 2.5484e-06,
         4.9586e-06, 1.3964e-06, 4.4096e-07, 4.0776e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.188462
summ of probs approach
id: [18260] -> tensor([[3.8557e-07, 2.4323e-07, 5.6437e-07, 1.3977e-06, 5.1981e-07, 4.5802e-08,
         4.5639e-07, 1.6046e-06, 3.7061e-05, 6.1099e-06, 5.2779e-07, 8.6633e-07,
         3.5556e-07, 3.6896e-07, 2.5766e-06, 4.8102e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.8304e-06, 2.9934e-06, 4.9002e-06, 5.0636e-06, 3.5170e-06, 2.8892e-07,
         6.7650e-06, 1.4091e-05, 3.7818e-04, 2.3309e-05, 3.9503e-06, 4.0737e-06,
         8.1390e-06, 2.0317e-06, 5.4547e-05, 2.8663e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.132310
summ of probs approach
id: [18260] -> tensor([[2.9101e-07, 1.0276e-07, 1.3601e-07, 5.9492e-07, 1.7878e-07, 5.0787e-07,
         9.8898e-07, 1.5216e-06, 7.6448e-07, 1.6734e-05, 4.1037e-07, 5.3769e-09,
         5.6637e-07, 3.7707e-07, 9.6819e-06, 2.9588e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.6103e-06, 5.3216e-06, 6.6821e-07, 2.6093e-06, 1.9651e-06, 2.2293e-06,
         1.0594e-05, 2.9891e-05, 1.2521e-05, 1.2959e-04, 9.7382e-07, 1.0618e-06,
         1.1952e-05, 2.0824e-06, 6.7059e-05, 2.2688e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.178096
summ of probs approach
id: [18260] -> tensor([[4.3791e-08, 3.6587e-08, 8.2886e-07, 3.9193e-06, 3.0554e-07, 3.2848e-07,
         1.6117e-07, 1.8189e-07, 2.6131e-05, 1.3676e-07, 7.8947e-07, 2.0462e-06,
         1.7732e-07, 1.3755e-07, 2.5209e-07, 9.8166e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.2786e-07, 1.2775e-06, 6.6278e-06, 8.3785e-06, 6.2803e-07, 9.8017e-07,
         9.4382e-07, 1.4158e-06, 5.8149e-05, 3.3707e-06, 5.6720e-06, 1.6518e-05,
         2.6355e-06, 8.2217e-07, 3.3320e-06, 3.1102e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.192821
summ of probs approach
id: [18260] -> tensor([[2.2140e-08, 9.5505e-08, 4.2447e-07, 1.9119e-07, 5.9599e-07, 3.1370e-06,
         2.9205e-07, 1.5739e-09, 6.6047e-07, 1.0046e-06, 2.2465e-07, 6.0874e-08,
         2.6272e-07, 2.7734e-06, 5.8345e-07, 2.6347e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.5901e-07, 3.8201e-07, 8.1883e-06, 1.5752e-06, 4.8079e-06, 9.9721e-06,
         1.7218e-06, 1.7871e-07, 4.8519e-06, 4.2885e-06, 1.6690e-06, 1.2213e-06,
         2.1968e-06, 2.7826e-05, 3.6134e-06, 1.2821e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.206300
summ of probs approach
id: [18260] -> tensor([[1.2137e-07, 4.2271e-08, 5.5820e-07, 1.8040e-09, 4.7668e-08, 4.4579e-07,
         1.2297e-07, 7.2249e-08]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [1936] -> tensor([[3.8353e-07, 9.6129e-07, 8.1000e-06, 2.6986e-07, 1.0201e-06, 2.1952e-06,
         5.1359e-07, 5.9849e-07]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.060422
acc:  0.5
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:05.320438
path ['42', 'en', 'bloom', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
load model Duration: 0:00:13.496833
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloomz-560m SA null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[1.1306e-05, 1.3988e-06, 5.0855e-07, 6.8506e-07, 3.0366e-07, 6.3113e-07,
         5.0951e-08, 3.8736e-08, 1.2437e-06, 2.6996e-08, 4.7970e-07, 4.4306e-06,
         2.4882e-07, 1.0258e-07, 3.9503e-07, 1.6502e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.0831e-05, 1.2321e-06, 1.2833e-05, 4.3681e-06, 4.1807e-06, 6.9470e-06,
         9.5646e-07, 4.6474e-07, 1.9341e-05, 5.4003e-07, 5.1180e-05, 1.3127e-05,
         1.0818e-05, 1.3926e-07, 4.8543e-06, 9.3623e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.216042
summ of probs approach
id: [18260] -> tensor([[2.2715e-06, 1.5087e-06, 2.2460e-08, 1.4549e-07, 6.8022e-07, 1.2799e-08,
         2.4278e-06, 1.6776e-06, 6.8525e-06, 1.3964e-06, 4.9773e-06, 4.8274e-07,
         7.4076e-10, 1.2424e-08, 2.4471e-06, 1.8759e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.2862e-04, 1.8596e-06, 2.1957e-08, 1.9573e-06, 1.3033e-06, 7.2491e-07,
         7.7536e-06, 1.2504e-05, 8.1083e-05, 1.3748e-05, 8.6932e-06, 4.7396e-06,
         2.9696e-07, 1.1646e-06, 1.0922e-05, 1.4012e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.194169
summ of probs approach
id: [18260] -> tensor([[8.6796e-10, 8.7657e-08, 5.0041e-07, 2.8502e-07, 4.7491e-08, 5.3154e-08,
         1.4648e-08, 3.9599e-08, 2.0577e-08, 3.4992e-08, 2.0364e-07, 2.3321e-07,
         2.8954e-07, 2.9883e-05, 4.1067e-08, 2.6884e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[6.2299e-08, 7.3988e-07, 7.2119e-06, 6.3786e-07, 4.8927e-07, 3.2097e-06,
         1.6003e-06, 3.0470e-07, 2.4604e-07, 1.8399e-06, 7.0746e-07, 1.3646e-06,
         9.0920e-06, 7.7313e-04, 8.3010e-07, 1.4390e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.152558
summ of probs approach
id: [18260] -> tensor([[3.5929e-07, 6.5757e-08, 7.2726e-07, 8.4952e-07, 1.5668e-07, 1.9433e-06,
         7.5002e-07, 6.2665e-08, 2.1181e-08, 1.5950e-07, 2.8862e-07, 8.6213e-07,
         6.5545e-06, 3.3720e-07, 1.0431e-08, 3.0053e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.8862e-06, 1.4405e-06, 3.0484e-06, 2.2369e-05, 3.7444e-06, 2.9650e-06,
         4.1321e-06, 1.8666e-07, 7.3217e-08, 1.4546e-06, 8.0038e-06, 2.4158e-06,
         6.0907e-05, 6.0259e-06, 1.3095e-07, 1.6437e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.204322
summ of probs approach
id: [18260] -> tensor([[1.2359e-06, 2.5937e-08, 3.5024e-06, 1.8345e-06, 2.8501e-08, 1.4054e-06,
         7.8590e-08, 7.5279e-06, 4.1583e-07, 1.0380e-07, 1.6488e-07, 1.7491e-07,
         2.2071e-06, 9.3822e-07, 1.4177e-06, 3.3185e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.5891e-06, 1.6378e-07, 8.7288e-05, 1.1305e-05, 1.2802e-06, 2.2447e-05,
         2.9834e-06, 2.7733e-05, 9.2242e-06, 4.5497e-07, 5.6783e-06, 8.4920e-06,
         1.2286e-05, 6.9840e-07, 1.7613e-06, 9.2105e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.166429
summ of probs approach
id: [18260] -> tensor([[3.1207e-07, 1.4427e-07, 2.4781e-07, 3.0944e-06, 6.7502e-07, 1.3835e-08,
         2.2897e-07, 4.1373e-08, 2.3619e-06, 1.7525e-07, 2.9167e-06, 1.3979e-06,
         1.4215e-08, 5.7934e-07, 2.9744e-07, 3.3203e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.1998e-05, 3.7630e-07, 7.2715e-06, 4.0157e-05, 1.0124e-05, 6.0579e-08,
         2.9426e-06, 3.5490e-07, 3.4543e-05, 4.6232e-07, 6.0055e-06, 3.1037e-06,
         1.8544e-06, 7.6954e-07, 3.3386e-06, 1.9373e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.189517
summ of probs approach
id: [18260] -> tensor([[1.1403e-09, 3.9767e-08, 2.3845e-07, 3.5656e-09, 8.2999e-07, 1.7274e-07,
         6.2047e-07, 1.7961e-06, 2.6558e-08, 1.6747e-08, 9.5444e-07, 3.6542e-07,
         8.2051e-09, 5.4545e-08, 7.7899e-09, 4.4887e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.7470e-07, 4.9859e-06, 2.6407e-05, 7.4507e-08, 4.2874e-06, 1.9536e-05,
         3.0112e-05, 1.6437e-05, 3.2480e-07, 3.6334e-07, 9.2493e-06, 6.2989e-06,
         9.6872e-08, 4.6179e-06, 1.6851e-06, 1.0961e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.120883
summ of probs approach
id: [18260] -> tensor([[1.3997e-06, 3.3928e-07, 1.1410e-06, 3.8302e-07, 3.8418e-07, 4.1296e-07,
         6.6354e-09, 4.2983e-06, 7.4837e-09, 2.9875e-06, 3.0806e-07, 2.5543e-08,
         2.6882e-07, 4.2445e-07, 4.7956e-05, 5.3228e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.5142e-05, 1.5350e-05, 5.3983e-06, 3.5372e-06, 1.7820e-05, 3.0610e-06,
         1.0002e-07, 1.5092e-05, 6.4703e-07, 2.9910e-06, 7.0821e-08, 5.1328e-08,
         3.3509e-06, 7.6796e-06, 1.1969e-04, 4.8494e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.147643
summ of probs approach
id: [18260] -> tensor([[8.0590e-07, 6.7345e-08, 6.2196e-06, 5.0893e-07, 1.3220e-07, 1.3633e-06,
         1.2596e-05, 1.0530e-06, 2.8977e-07, 7.6801e-08, 2.7818e-07, 8.1886e-06,
         3.2304e-07, 8.1473e-07, 2.9119e-04, 3.1076e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.0949e-05, 1.6306e-07, 1.8782e-05, 3.5602e-06, 7.1950e-07, 3.8111e-07,
         1.4785e-04, 2.1251e-05, 2.1690e-05, 2.0348e-06, 2.6856e-05, 5.9920e-05,
         3.2608e-06, 8.8803e-06, 1.9024e-04, 2.1967e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.130505
summ of probs approach
id: [18260] -> tensor([[1.1308e-05, 8.6957e-08, 4.1486e-08, 1.0444e-09, 3.1620e-08, 1.3021e-07,
         7.5595e-08, 1.2660e-07, 3.4337e-07, 6.1212e-07, 1.4648e-06, 1.1926e-06,
         1.1943e-06, 1.6256e-07, 4.5448e-07, 9.0281e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.8235e-04, 9.1567e-06, 5.5498e-07, 1.1051e-08, 3.9344e-06, 4.0027e-06,
         5.2883e-07, 1.4439e-06, 2.8405e-06, 2.4621e-06, 1.2716e-06, 1.0170e-05,
         2.8050e-06, 7.0120e-07, 4.4360e-06, 7.6653e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.104171
summ of probs approach
id: [18260] -> tensor([[2.4560e-06, 1.1262e-07, 3.4133e-08, 1.6127e-09, 4.4298e-07, 4.9532e-07,
         4.9183e-07, 1.0661e-06, 3.8673e-07, 8.2228e-08, 1.7283e-07, 2.7439e-08,
         5.7049e-08, 1.9985e-06, 4.6987e-06, 5.3479e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.0499e-05, 3.0101e-06, 2.4264e-06, 1.2378e-07, 7.1619e-06, 1.2222e-05,
         4.8999e-07, 4.2305e-06, 1.7942e-05, 1.4329e-06, 2.0353e-06, 2.7018e-07,
         4.7847e-07, 2.1554e-05, 2.2052e-05, 7.9953e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.151091
summ of probs approach
id: [18260] -> tensor([[7.5608e-08, 2.0121e-09, 6.5014e-07, 2.7550e-06, 6.7379e-10, 5.7799e-07,
         1.2256e-05, 5.9984e-07, 2.5209e-09, 1.1044e-06, 7.8652e-07, 2.9959e-06,
         9.9339e-07, 1.5736e-06, 1.2431e-04, 1.3569e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.7848e-07, 4.3945e-08, 5.9806e-06, 6.8708e-05, 1.2238e-07, 5.3056e-06,
         4.1364e-05, 1.6724e-06, 2.6431e-07, 7.6882e-06, 9.1794e-06, 1.6764e-05,
         2.5833e-06, 8.8465e-07, 1.6258e-03, 2.7100e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.248164
summ of probs approach
id: [18260] -> tensor([[5.1991e-08, 4.0748e-09, 9.2444e-08, 3.0965e-07, 9.7798e-08, 6.5842e-07,
         5.3297e-07, 1.6567e-07]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [1936] -> tensor([[4.3025e-06, 2.0227e-07, 2.5194e-07, 1.3508e-05, 1.5019e-06, 1.7760e-06,
         1.1000e-06, 9.1586e-07]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.062912
acc:  0.535
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:02.106903
path ['42', 'en', 'bloomz', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [4273, 1], 'attention_mask': [1, 1]}
id: [4273, 1] -> [4273]
answer  {'input_ids': [150, 1], 'attention_mask': [1, 1]}
id: [150, 1] -> [150]
load model Duration: 0:00:07.978676
prompt_type null has 1 prompts in it
----------- 42 en google/flan-t5-base SA null 0 200 16 --------------
summ of probs approach
id: [4273] -> tensor([[2.1575e-05, 2.3366e-05, 3.3169e-04, 1.9015e-04, 8.6222e-05, 8.0524e-05,
         6.7415e-04, 9.2667e-04, 2.6996e-05, 6.8852e-05, 2.9134e-03, 2.2025e-04,
         4.8232e-05, 2.7624e-03, 5.0363e-04, 1.2358e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[7.4801e-04, 1.2665e-03, 6.0911e-04, 1.2099e-03, 1.3602e-04, 6.0453e-05,
         1.9672e-02, 2.5787e-04, 4.1985e-04, 9.0375e-05, 3.0626e-03, 5.8871e-03,
         5.5478e-05, 3.8754e-03, 1.8554e-02, 9.2046e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.159244
summ of probs approach
id: [4273] -> tensor([[2.2123e-04, 3.8262e-04, 3.1021e-05, 6.7982e-06, 2.9110e-04, 2.2013e-05,
         2.5440e-05, 3.2350e-05, 9.1962e-04, 2.2830e-04, 8.5610e-06, 6.3005e-04,
         7.6297e-05, 1.3659e-03, 1.8550e-03, 2.6192e-02]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.1398e-03, 4.4527e-04, 3.8271e-04, 4.9863e-04, 1.2257e-03, 1.6047e-04,
         2.8982e-03, 4.0403e-05, 1.6186e-03, 3.0134e-03, 4.3738e-06, 6.2505e-04,
         7.6272e-04, 1.5489e-03, 1.2339e-02, 1.7426e-01]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.100630
summ of probs approach
id: [4273] -> tensor([[2.9373e-04, 6.9133e-05, 4.4467e-04, 1.1191e-04, 1.9891e-05, 7.2929e-05,
         4.0208e-05, 4.1937e-04, 5.9836e-07, 9.3248e-04, 5.0719e-04, 9.6730e-04,
         5.5659e-04, 6.9614e-06, 1.3186e-04, 8.7557e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[7.3362e-04, 6.4973e-05, 6.1144e-04, 5.3230e-03, 1.1227e-02, 6.2363e-05,
         4.5258e-03, 4.6704e-04, 8.3541e-05, 1.1472e-03, 6.0146e-04, 1.0601e-03,
         2.6196e-03, 5.1815e-06, 1.0899e-03, 5.7514e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.071282
summ of probs approach
id: [4273] -> tensor([[6.9364e-05, 4.0810e-04, 5.4322e-06, 2.3299e-03, 9.6447e-05, 2.2256e-04,
         5.2475e-03, 6.1953e-05, 7.2221e-06, 1.2135e-03, 1.2132e-04, 1.1756e-03,
         3.8902e-05, 4.2089e-05, 5.6048e-06, 5.1978e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[5.5968e-05, 9.8303e-03, 6.2235e-07, 9.4886e-04, 3.9122e-04, 1.7611e-04,
         3.0667e-02, 1.1061e-04, 3.5216e-05, 1.2277e-02, 2.0377e-04, 3.6209e-02,
         5.4918e-03, 3.0989e-05, 5.0932e-06, 7.0942e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.094908
summ of probs approach
id: [4273] -> tensor([[1.2345e-05, 6.6490e-04, 2.6113e-05, 1.2648e-03, 6.2093e-05, 2.2663e-04,
         2.0117e-05, 3.3567e-05, 4.0870e-05, 2.5988e-04, 8.1775e-04, 1.6940e-04,
         2.9291e-04, 1.4335e-03, 7.3167e-05, 6.5300e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.2538e-05, 7.9086e-03, 1.5842e-03, 2.7733e-03, 5.4123e-03, 2.7264e-04,
         5.6354e-03, 3.8151e-05, 5.7981e-04, 1.0002e-03, 8.0595e-03, 3.5387e-04,
         2.9980e-03, 6.4311e-04, 1.1862e-03, 1.1239e-02]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.062363
summ of probs approach
id: [4273] -> tensor([[3.6524e-04, 5.9665e-04, 1.4150e-05, 1.0193e-03, 1.9329e-04, 3.7039e-05,
         2.1936e-04, 1.6244e-03, 3.3858e-04, 7.9888e-04, 1.8866e-04, 5.0227e-05,
         6.4757e-07, 2.7806e-04, 4.9697e-05, 2.0711e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.5904e-02, 3.4674e-03, 4.4167e-04, 4.6354e-04, 1.9637e-04, 3.2458e-04,
         1.3841e-03, 2.4675e-02, 3.1073e-02, 2.7390e-04, 3.6244e-03, 1.2122e-03,
         1.4355e-06, 9.1990e-04, 2.3079e-03, 1.3278e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.141178
summ of probs approach
id: [4273] -> tensor([[2.1395e-04, 1.3886e-04, 2.1059e-04, 1.3033e-03, 4.1762e-05, 7.2712e-05,
         3.4267e-05, 1.0208e-05, 2.4831e-03, 1.2536e-04, 6.0653e-04, 8.9236e-06,
         2.3263e-06, 2.9942e-05, 7.8238e-05, 9.2868e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.3874e-04, 1.7096e-04, 1.3245e-04, 9.2499e-03, 3.9902e-03, 1.9427e-04,
         5.7481e-05, 4.2148e-05, 3.7571e-03, 3.2969e-04, 1.0120e-03, 5.3006e-05,
         9.4588e-06, 7.9672e-04, 2.5228e-02, 2.6496e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.093392
summ of probs approach
id: [4273] -> tensor([[3.8081e-04, 1.2209e-04, 1.5704e-04, 8.9913e-05, 2.5949e-03, 4.9451e-04,
         4.9547e-06, 1.0563e-05, 9.3383e-05, 1.2921e-04, 2.0260e-04, 4.4454e-03,
         5.2274e-04, 1.6167e-05, 6.3738e-04, 1.2475e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[7.4913e-04, 1.9563e-04, 7.7627e-03, 2.7602e-04, 2.0396e-02, 2.5867e-04,
         7.4299e-06, 2.2100e-05, 5.6912e-05, 2.9602e-04, 3.2439e-03, 4.6987e-02,
         3.3278e-04, 1.2356e-03, 3.0488e-02, 1.3007e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.073513
summ of probs approach
id: [4273] -> tensor([[6.6388e-06, 4.8648e-04, 3.0647e-04, 3.9787e-03, 2.9127e-03, 8.0753e-06,
         3.5077e-04, 4.9371e-06, 1.6746e-03, 5.2549e-05, 1.3572e-03, 1.4819e-04,
         2.9399e-04, 5.9038e-05, 3.4478e-03, 1.8190e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.2581e-06, 3.6400e-03, 7.4496e-03, 1.0147e-02, 2.0773e-03, 6.0087e-04,
         5.2866e-04, 1.6967e-04, 6.9735e-03, 3.9098e-05, 1.5540e-03, 1.4794e-03,
         1.4811e-03, 2.8932e-05, 3.7639e-03, 1.1520e-02]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.107169
summ of probs approach
id: [4273] -> tensor([[1.2744e-04, 3.2350e-06, 7.8910e-04, 4.9607e-04, 5.0564e-05, 1.1424e-04,
         1.2227e-02, 1.4573e-03, 7.9902e-07, 1.9924e-03, 4.9240e-05, 6.0081e-04,
         3.3850e-04, 2.6940e-04, 7.8494e-05, 2.0020e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.5589e-04, 8.9030e-06, 3.0705e-03, 2.2654e-04, 4.5942e-04, 4.0393e-03,
         3.6924e-03, 4.1991e-03, 9.4682e-06, 1.7095e-02, 2.9596e-03, 5.1388e-04,
         1.9270e-04, 2.0402e-02, 2.5520e-04, 1.2482e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.073407
summ of probs approach
id: [4273] -> tensor([[1.6919e-04, 5.5267e-05, 8.9641e-05, 4.6710e-05, 1.1436e-05, 1.7021e-03,
         9.3531e-05, 2.0491e-05, 3.4488e-05, 1.7808e-04, 1.1126e-02, 4.4601e-05,
         1.9988e-03, 1.7883e-04, 1.4796e-05, 1.1435e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.9398e-04, 4.3101e-05, 7.6526e-03, 5.3918e-04, 7.4010e-04, 2.5892e-03,
         1.5611e-02, 8.9942e-05, 3.7165e-05, 1.8492e-02, 6.6055e-02, 2.4706e-05,
         8.0317e-04, 9.3751e-04, 9.2751e-06, 1.4808e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.072460
summ of probs approach
id: [4273] -> tensor([[1.1271e-04, 2.0715e-05, 3.3483e-04, 1.6364e-05, 2.4611e-05, 5.3217e-05,
         3.9540e-04, 1.3069e-01, 1.9451e-04, 4.3653e-04, 5.4208e-04, 3.1231e-04,
         4.2751e-05, 1.5854e-03, 1.2696e-04, 5.1440e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.6249e-04, 8.3014e-04, 6.6974e-03, 4.9393e-05, 8.7450e-06, 1.4213e-03,
         6.6815e-03, 5.2370e-01, 3.4296e-04, 3.7409e-04, 1.3904e-02, 8.1156e-04,
         1.8047e-04, 2.9138e-03, 3.6918e-04, 3.3232e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.077126
summ of probs approach
id: [4273] -> tensor([[3.1238e-05, 1.3119e-06, 1.1126e-04, 2.8650e-04, 4.2636e-05, 2.4205e-03,
         2.1102e-06, 3.0978e-06]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [150] -> tensor([[1.6610e-04, 8.8457e-05, 1.6978e-04, 1.8436e-03, 4.6634e-05, 4.6268e-02,
         3.5361e-06, 8.9268e-07]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.045012
acc:  0.675
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.186755
path ['42', 'en', 'flan', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:44<00:44, 44.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:58<00:00, 26.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:58<00:00, 29.45s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 4874], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 4874] -> [4874]
answer  {'input_ids': [1, 694], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 694] -> [694]
load model Duration: 0:03:14.972062
prompt_type null has 1 prompts in it
----------- 42 en huggyllama/llama-7b SA null 0 200 16 --------------
summ of probs approach
id: [4874] -> tensor([[1.8561e-04, 1.5914e-05, 1.1504e-05, 1.7285e-06, 5.9605e-07, 1.5259e-05,
         1.8775e-05, 1.4901e-06, 1.4305e-06, 7.7486e-06, 4.7088e-06, 2.6226e-05,
         3.3259e-05, 4.4107e-06, 1.7881e-07, 1.9073e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.0395e-03, 3.9756e-05, 1.4579e-04, 2.6464e-04, 3.5167e-06, 3.4630e-05,
         1.3697e-04, 1.1504e-05, 1.6332e-05, 1.3101e-04, 4.1068e-05, 2.1338e-05,
         9.8324e-04, 4.5836e-05, 1.9610e-04, 1.0306e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.260032
summ of probs approach
id: [4874] -> tensor([[4.3511e-06, 1.5676e-05, 1.1861e-05, 8.9407e-07, 3.8147e-06, 3.5763e-06,
         1.0729e-06, 2.9802e-06, 1.1230e-04, 2.5034e-06, 6.5565e-07, 1.4901e-06,
         2.2054e-06, 3.4571e-06, 6.1393e-06, 5.5432e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[9.0003e-05, 8.2254e-05, 1.2577e-04, 1.9491e-05, 4.6301e-04, 7.8976e-05,
         3.1590e-05, 1.2994e-05, 3.8376e-03, 2.9862e-05, 3.6359e-06, 6.5625e-05,
         4.2856e-05, 4.9472e-05, 5.6922e-05, 1.5950e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.304369
summ of probs approach
id: [4874] -> tensor([[2.9206e-06, 1.3351e-05, 4.4107e-06, 1.4484e-05, 1.1206e-05, 5.9605e-07,
         4.4107e-06, 1.9073e-06, 2.7418e-06, 5.1856e-06, 1.6689e-06, 2.9802e-07,
         5.9009e-06, 6.8545e-06, 7.6294e-06, 2.5630e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[4.4703e-05, 1.5366e-04, 1.8311e-04, 2.8419e-04, 9.6679e-05, 3.6955e-05,
         8.2850e-06, 2.5988e-05, 3.7575e-04, 4.5836e-05, 1.1027e-05, 3.7551e-06,
         1.9324e-04, 7.3254e-05, 1.9491e-04, 9.7632e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.291427
summ of probs approach
id: [4874] -> tensor([[2.4438e-06, 8.3447e-07, 7.7486e-07, 3.5286e-05, 1.6987e-05, 1.2517e-06,
         1.1921e-07, 1.8477e-06, 5.7220e-06, 9.8944e-06, 7.1049e-05, 2.7418e-06,
         5.3644e-07, 2.0266e-06, 1.0133e-06, 8.6427e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[2.2173e-05, 3.5405e-05, 5.6028e-06, 2.0180e-03, 3.9172e-04, 2.5094e-05,
         2.9206e-06, 2.5272e-05, 3.1137e-04, 6.2275e-04, 1.1435e-03, 5.3525e-05,
         2.1577e-05, 5.5552e-05, 7.8630e-04, 5.0926e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.217732
summ of probs approach
id: [4874] -> tensor([[5.5432e-06, 7.7486e-07, 3.6955e-06, 2.8610e-06, 1.1921e-06, 9.5367e-07,
         1.2994e-05, 1.1921e-06, 4.1723e-07, 6.9737e-06, 9.2983e-06, 2.2054e-06,
         8.7917e-05, 5.3644e-07, 1.9670e-06, 5.3406e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[6.2883e-05, 2.1477e-03, 3.9101e-05, 8.0287e-05, 4.1723e-06, 9.3460e-05,
         1.1702e-03, 9.0003e-06, 3.5167e-06, 5.7459e-05, 1.9372e-05, 1.7059e-04,
         4.3273e-04, 1.1677e-04, 3.0339e-05, 8.5545e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.322721
summ of probs approach
id: [4874] -> tensor([[6.6757e-06, 3.6359e-06, 1.5497e-06, 1.6093e-06, 5.3644e-06, 2.3842e-07,
         3.2783e-06, 4.1723e-07, 8.1658e-06, 2.1458e-06, 1.2457e-05, 2.8312e-05,
         1.1325e-06, 1.1921e-06, 1.8060e-05, 3.5822e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[7.0095e-05, 9.9063e-05, 1.2183e-04, 1.2457e-05, 5.4717e-05, 8.9407e-06,
         2.7120e-05, 1.6570e-05, 2.0802e-05, 9.1612e-05, 9.2864e-05, 1.8024e-04,
         3.8445e-05, 1.0371e-04, 3.8314e-04, 2.6870e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.267149
summ of probs approach
id: [4874] -> tensor([[7.1526e-06, 1.7881e-06, 7.5102e-06, 3.2187e-06, 1.7881e-06, 2.6226e-06,
         2.6226e-06, 2.3842e-07, 8.9407e-07, 1.9670e-06, 1.8477e-06, 2.3842e-06,
         8.4043e-06, 4.3511e-06, 5.6624e-06, 2.3842e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.6117e-04, 2.7299e-05, 9.3997e-05, 4.0174e-05, 1.3888e-05, 9.4175e-06,
         6.1631e-05, 1.1742e-05, 1.1504e-05, 1.2457e-05, 4.4465e-05, 7.0989e-05,
         1.0848e-04, 1.8847e-04, 6.2823e-05, 6.3181e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.321692
summ of probs approach
id: [4874] -> tensor([[1.0550e-05, 2.7418e-06, 4.4227e-05, 3.8743e-06, 8.9407e-07, 1.3113e-06,
         2.9206e-06, 1.6093e-06, 6.5565e-07, 3.3975e-06, 1.1623e-05, 2.3842e-06,
         2.3246e-06, 6.3181e-06, 4.7684e-07, 9.1791e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[6.3241e-05, 2.3484e-05, 7.1955e-04, 1.4162e-04, 3.8185e-03, 1.0431e-05,
         5.6148e-05, 2.7776e-05, 8.7619e-06, 4.9770e-05, 4.4525e-05, 1.5354e-04,
         4.6968e-05, 3.2008e-05, 4.0531e-06, 6.4135e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.299142
summ of probs approach
id: [4874] -> tensor([[7.3910e-05, 2.1875e-05, 6.3777e-06, 4.0531e-06, 1.5497e-06, 3.5763e-07,
         1.1826e-03, 4.7684e-07, 1.6689e-06, 1.1921e-06, 2.8610e-06, 6.9737e-06,
         1.3411e-04, 4.2915e-06, 4.9829e-05, 1.1325e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[6.2981e-03, 6.4313e-05, 2.9981e-05, 1.4961e-05, 1.7560e-04, 9.5367e-07,
         4.9019e-03, 3.8743e-05, 3.0589e-04, 2.3246e-05, 2.3246e-06, 7.0906e-04,
         4.0588e-03, 2.0611e-04, 9.9421e-05, 2.6882e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.369073
summ of probs approach
id: [4874] -> tensor([[3.5763e-06, 1.5676e-05, 8.9407e-06, 2.5630e-06, 2.2471e-05, 3.0398e-06,
         4.1723e-07, 1.8120e-05, 5.9557e-04, 9.2387e-06, 5.3644e-07, 1.0133e-06,
         3.5763e-07, 2.9802e-06, 2.2888e-05, 3.8743e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[3.8326e-05, 6.3562e-04, 1.6201e-04, 2.0814e-04, 6.4135e-04, 7.1645e-05,
         8.5831e-06, 2.6107e-05, 3.6774e-03, 5.8889e-05, 6.4969e-06, 1.0192e-05,
         8.4043e-06, 2.8563e-04, 7.0858e-04, 1.2076e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.274362
summ of probs approach
id: [4874] -> tensor([[1.4842e-05, 2.3532e-04, 2.8014e-06, 2.3842e-07, 1.9073e-06, 8.3447e-07,
         3.1590e-05, 4.1544e-05, 7.5102e-06, 4.9472e-06, 5.9605e-08, 9.8944e-06,
         1.0729e-06, 1.2517e-06, 4.7684e-07, 1.3709e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[8.8930e-04, 1.0796e-03, 1.2755e-05, 2.7359e-05, 2.8014e-06, 6.9737e-06,
         2.2805e-04, 5.7697e-04, 1.0169e-04, 7.7903e-05, 8.0466e-06, 1.1712e-04,
         1.3888e-05, 7.5102e-06, 5.4836e-06, 2.8968e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.274253
summ of probs approach
id: [4874] -> tensor([[5.2333e-05, 1.0133e-06, 1.1921e-07, 1.3113e-06, 8.0466e-06, 3.1590e-06,
         1.3709e-06, 6.1989e-06, 6.7472e-05, 2.0862e-06, 6.8545e-06, 8.3447e-07,
         2.3246e-06, 2.2650e-06, 8.9109e-05, 3.7861e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[2.3880e-03, 8.1658e-06, 8.3447e-07, 1.1396e-03, 5.7757e-05, 2.1100e-05,
         1.1683e-05, 2.0087e-05, 4.7398e-04, 3.3379e-05, 5.5611e-05, 1.5378e-05,
         4.8578e-05, 6.3896e-05, 8.6069e-04, 3.3207e-03]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.307779
summ of probs approach
id: [4874] -> tensor([[2.8610e-06, 7.1526e-07, 7.1526e-07, 1.3709e-06, 6.1095e-05, 2.2709e-05,
         8.8811e-06, 9.5367e-07]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
summ of probs approach
id: [694] -> tensor([[1.3828e-05, 2.0003e-04, 2.4438e-06, 3.6955e-06, 1.2665e-03, 7.0572e-05,
         1.7238e-04, 4.8876e-06]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.272637
acc:  0.51
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:03.799161
path ['42', 'en', 'llama', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [36339, 1], 'attention_mask': [1, 1]}
id:[36339, 1]
answer  {'input_ids': [375, 1], 'attention_mask': [1, 1]}
id:[375, 1]
load model Duration: 0:00:09.179433
prompt_type null has 1 prompts in it
----------- 42 en bigscience/mt0-small SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([4.8590e-04, 1.4067e-03, 4.9197e-04, 7.9569e-04, 1.7808e-04, 7.2380e-04,
        2.3998e-04, 5.7075e-04, 9.4561e-01, 7.0344e-04, 5.7174e-04, 6.8342e-04,
        6.4930e-04, 3.0743e-03, 1.1260e-03, 1.5249e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.9849e-03, 1.7381e-03, 4.9439e-04, 2.6157e-03, 3.5102e-04, 5.9041e-03,
        5.4446e-04, 5.7179e-04, 9.4561e-01, 7.3666e-04, 5.7077e-04, 2.4234e-03,
        1.9716e-03, 1.7600e-02, 1.1115e-03, 1.4193e-03], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.140589
summ of probs approach
probs_ shape tensor([4.2735e-03, 1.9224e-03, 1.2057e-03, 7.0066e-04, 1.6170e-04, 6.3252e-04,
        1.0182e-03, 1.0801e-03, 1.6812e-03, 3.2603e-04, 8.8555e-01, 3.5262e-03,
        7.3376e-04, 6.8816e-04, 8.1157e-04, 5.4802e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.3036e-02, 3.9803e-03, 1.6576e-03, 2.7931e-03, 2.4609e-04, 1.4760e-03,
        9.5054e-04, 8.1658e-03, 3.5450e-03, 3.2258e-04, 8.8559e-01, 3.5290e-03,
        1.0968e-03, 6.3295e-04, 2.7689e-03, 1.6346e-03], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.071889
summ of probs approach
probs_ shape tensor([6.1176e-04, 6.3888e-03, 5.3294e-04, 7.1896e-04, 1.8539e-03, 4.3370e-04,
        2.5948e-04, 6.3552e-04, 9.0270e-01, 8.8991e-04, 8.7946e-04, 1.0118e-03,
        6.4124e-04, 4.7462e-04, 6.1221e-04, 4.2717e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.9565e-04, 5.4886e-02, 8.5151e-04, 1.2160e-03, 2.2974e-03, 4.5075e-04,
        4.7465e-04, 2.2876e-03, 9.0270e-01, 8.8953e-04, 1.4228e-03, 9.5308e-04,
        1.8647e-03, 2.7102e-03, 5.9289e-04, 4.1209e-04], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.097253
summ of probs approach
probs_ shape tensor([6.0414e-04, 3.0778e-04, 4.7454e-04, 6.4395e-04, 1.1686e-03, 2.4527e-04,
        9.3257e-01, 6.9355e-04, 1.2331e-03, 7.9091e-04, 7.8444e-04, 5.9556e-04,
        1.7107e-03, 9.3549e-04, 1.7858e-04, 8.2118e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.9074e-04, 2.9052e-04, 5.0125e-04, 6.3919e-04, 1.1427e-03, 2.5019e-04,
        9.3257e-01, 6.6662e-04, 1.9559e-03, 2.0075e-03, 3.4497e-03, 6.7308e-04,
        2.0288e-03, 9.0246e-04, 1.7797e-04, 1.7229e-03], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.060213
summ of probs approach
probs_ shape tensor([1.9895e-03, 8.8779e-04, 6.1615e-04, 1.0193e-03, 1.1974e-03, 3.9860e-04,
        1.7938e-04, 5.1971e-04, 7.9331e-01, 5.9767e-04, 1.3609e-03, 9.2621e-04,
        2.5526e-03, 5.3961e-04, 6.5259e-04, 5.3740e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.9408e-03, 8.9779e-04, 5.5236e-04, 2.2754e-03, 1.1955e-03, 3.7470e-04,
        2.9291e-04, 3.1909e-03, 7.9332e-01, 1.0846e-03, 1.3533e-03, 9.2671e-04,
        2.6220e-03, 6.1865e-04, 8.4761e-04, 5.9651e-04], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.075787
summ of probs approach
probs_ shape tensor([1.7747e-03, 1.3158e-03, 7.0224e-05, 8.0165e-04, 4.0161e-04, 7.7217e-04,
        3.8662e-04, 8.3750e-04, 6.4818e-04, 2.6040e-03, 1.1760e-03, 9.9379e-04,
        8.6114e-01, 7.6164e-04, 1.7591e-03, 1.4165e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.5508e-03, 1.6026e-03, 8.1332e-05, 1.2093e-03, 4.8329e-04, 1.1374e-03,
        4.0903e-04, 8.6269e-04, 1.3198e-03, 2.6783e-03, 1.0927e-02, 7.5799e-04,
        8.6115e-01, 3.0292e-03, 2.9849e-03, 1.3826e-03], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.074600
summ of probs approach
probs_ shape tensor([0.0004, 0.0004, 0.0006, 0.0009, 0.0019, 0.0013, 0.0003, 0.0046, 0.0014,
        0.0011, 0.0019, 0.0018, 0.0005, 0.0009, 0.0001, 0.0009],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0010, 0.0008, 0.0007, 0.0008, 0.0114, 0.0030, 0.0005, 0.0047, 0.0015,
        0.0026, 0.0106, 0.0020, 0.0020, 0.0009, 0.0009, 0.0009],
       device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.073071
summ of probs approach
probs_ shape tensor([1.0219e-03, 3.5629e-04, 2.2684e-03, 1.4747e-03, 1.6107e-03, 3.2539e-04,
        8.1316e-04, 1.1826e-03, 1.5892e-03, 2.6647e-04, 6.3207e-01, 2.4265e-04,
        5.2161e-04, 2.3447e-04, 5.3265e-03, 8.9489e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0206e-03, 7.3725e-04, 2.2801e-03, 1.5352e-03, 1.1004e-02, 5.8826e-04,
        8.1246e-04, 1.1642e-03, 1.4868e-03, 7.9707e-04, 6.3208e-01, 1.2392e-03,
        5.1546e-04, 3.6770e-04, 2.7579e-02, 1.6004e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.083993
summ of probs approach
probs_ shape tensor([6.4230e-04, 9.7272e-05, 1.2620e-03, 4.9303e-04, 1.5023e-03, 4.8225e-04,
        4.0618e-04, 2.6232e-04, 6.5941e-04, 1.7525e-04, 2.4045e-04, 1.9724e-03,
        8.9182e-01, 7.7899e-04, 1.2881e-03, 1.1597e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.1870e-04, 2.6252e-04, 1.2182e-03, 2.4509e-03, 1.4101e-03, 4.2976e-04,
        4.8538e-04, 2.6036e-04, 7.0092e-04, 1.8552e-04, 4.3524e-04, 2.5578e-03,
        8.9182e-01, 1.0433e-03, 2.1998e-03, 1.1465e-03], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.082066
summ of probs approach
probs_ shape tensor([8.7222e-01, 1.0038e-03, 1.3570e-04, 5.1001e-04, 5.3800e-04, 8.1094e-04,
        2.0794e-04, 1.0222e-03, 3.0854e-04, 1.2127e-03, 5.5482e-04, 7.7034e-04,
        9.3239e-04, 8.8407e-04, 5.5236e-04, 8.0938e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.7277e-01, 3.0270e-03, 2.3614e-04, 5.0636e-04, 7.3101e-04, 1.2118e-03,
        1.2786e-03, 2.4386e-03, 2.8244e-04, 1.2034e-03, 5.4363e-04, 7.3856e-04,
        2.5646e-03, 9.6949e-04, 5.5712e-04, 9.3593e-04], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.076192
summ of probs approach
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
probs_ shape tensor([9.6744e-04, 5.4233e-04, 1.2111e-03, 1.3686e-03, 5.9487e-04, 2.6316e-04,
        4.0508e-04, 2.6700e-03, 3.2060e-04, 9.6836e-01, 1.1299e-03, 6.9045e-04,
        7.8112e-04, 8.4222e-04, 7.3586e-04, 8.6264e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.1373e-04, 6.5537e-04, 4.4198e-03, 1.2974e-03, 5.9509e-04, 1.7355e-04,
        2.3945e-03, 3.3058e-03, 3.2464e-04, 9.6836e-01, 1.1333e-03, 1.5873e-03,
        7.9053e-04, 4.2783e-03, 1.0556e-03, 1.2544e-03], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.087836
summ of probs approach
probs_ shape tensor([2.4720e-03, 1.0527e-03, 7.3272e-04, 8.7134e-04, 5.3379e-04, 8.2744e-04,
        8.2491e-04, 8.4132e-04, 1.8801e-03, 1.7474e-04, 3.7048e-04, 5.9382e-04,
        5.0398e-04, 8.9826e-01, 1.2151e-03, 4.0853e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.2854e-03, 9.9311e-04, 7.2706e-04, 7.8484e-04, 1.7715e-03, 8.0817e-04,
        8.0430e-04, 9.3348e-04, 1.8345e-03, 2.7827e-04, 3.6555e-04, 1.0079e-03,
        7.6028e-04, 8.9826e-01, 1.2063e-03, 5.2097e-03], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.073756
summ of probs approach
probs_ shape tensor([7.5349e-04, 9.5085e-01, 3.1309e-04, 3.4994e-04, 1.7646e-02, 1.0422e-03,
        5.8258e-04, 9.8066e-04], device='cuda:0') torch.Size([8])
summ of probs approach
probs_ shape tensor([1.0569e-03, 9.5087e-01, 4.3204e-04, 6.0003e-04, 7.3557e-02, 6.9360e-03,
        4.8895e-04, 1.2062e-03], device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.044705
acc:  0.755
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.058053
path ['42', 'en', 't0', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Using NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:01,  1.90it/s]100%|██████████| 3/3 [00:00<00:00,  4.87it/s]
loading model Duration: 0:00:01.880093
filter data Duraction: 0:00:00.000003
use_neutral is  True
len of entail_examples , neutral_examples, contra_examples:  66 66 66
len dataset  198
random sample Duraction: 0:02:40.736270
create dataloader Duration: 0:02:42.705553
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
answer  {'input_ids': [137111], 'attention_mask': [1]}
id:[137111]
load model Duration: 0:00:08.520295
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloom-560m NLI null 0 200 16 --------------
Traceback (most recent call last):
  File "/home/lcur1101/ATCS_group3/src/main.py", line 184, in <module>
    pipeline(seed, lang, models, tasks, prompt_types,
  File "/home/lcur1101/ATCS_group3/src/main.py", line 140, in pipeline
    logits_dict_for_prompt = get_prompt_acc(
  File "/home/lcur1101/ATCS_group3/src/main.py", line 45, in get_prompt_acc
    prompts = [train_dataloader.prompt(
  File "/home/lcur1101/ATCS_group3/src/main.py", line 45, in <listcomp>
    prompts = [train_dataloader.prompt(
  File "/home/lcur1101/ATCS_group3/src/prompts/nli_prompt.py", line 15, in __call__
    prompt = template.format(premise=premise, hypothesis=hypothesis)
KeyError: 'content'
srun: error: r28n2: task 0: Exited with exit code 1
