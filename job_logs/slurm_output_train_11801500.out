****Start Time: 2023-05-21_12-18-52
Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.46s/it]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
----------- 42 de huggyllama/llama-7b NLI active 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  6.83it/s]100%|██████████| 3/3 [00:00<00:00, 19.51it/s]
/home/lcur1101/ATCS_group3/src/models/model.py:88: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  logits = torch.nn.functional.softmax(logits)
/home/lcur1101/ATCS_group3/src/models/model.py:162: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3571.)
  probs, dim=1).mean(dim=1).T
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.2902e-05, 1.4913e-04, 2.4617e-05, 3.2544e-05, 6.5470e-04, 9.6619e-05,
         7.3195e-05, 2.0707e-04, 9.5904e-05, 4.7016e-04, 4.2319e-05, 2.1362e-04,
         7.4387e-05, 4.4882e-05, 1.4627e-04, 6.2883e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.7638e-05],
        [2.0504e-04],
        [7.7724e-05],
        [6.8367e-05],
        [4.8470e-04],
        [1.2732e-04],
        [1.1909e-04],
        [2.7752e-04],
        [2.1076e-04],
        [2.0659e-04],
        [1.3041e-04],
        [2.5415e-04],
        [1.5402e-04],
        [1.0276e-04],
        [2.1958e-04],
        [1.3673e-04]], device='cuda:0', dtype=torch.float16), tensor([[7.4506e-06],
        [1.7405e-05],
        [1.4126e-05],
        [3.6955e-06],
        [3.9160e-05],
        [1.3769e-05],
        [9.7156e-06],
        [1.1027e-05],
        [1.4305e-05],
        [1.6630e-05],
        [4.2915e-06],
        [1.8954e-05],
        [1.4901e-05],
        [6.4373e-06],
        [7.9870e-06],
        [5.2452e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.1696e-05, 7.4148e-05, 3.0637e-05, 2.4021e-05, 1.7464e-04, 4.7028e-05,
        4.2915e-05, 9.6202e-05, 7.5042e-05, 7.4387e-05, 4.4882e-05, 9.1016e-05,
        5.6326e-05, 3.6418e-05, 7.5877e-05, 4.7326e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.4021e-05],
        [1.6093e-04],
        [5.4836e-05],
        [4.6968e-05],
        [2.7537e-04],
        [1.3065e-04],
        [6.8784e-05],
        [2.9659e-04],
        [1.0496e-04],
        [9.2089e-05],
        [1.2064e-04],
        [1.7238e-04],
        [1.1814e-04],
        [6.3300e-05],
        [2.1291e-04],
        [2.0218e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.3644e-07],
        [3.5763e-07],
        [4.1723e-07],
        [5.3644e-07],
        [2.9802e-06],
        [4.7684e-07],
        [5.9605e-07],
        [5.3644e-07],
        [5.9605e-07],
        [2.3842e-07],
        [4.1723e-07],
        [4.1723e-07],
        [4.7684e-07],
        [2.9802e-07],
        [4.1723e-07],
        [7.1526e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [4.7684e-07],
        [4.1723e-07],
        [5.9605e-07],
        [7.7486e-07],
        [4.1723e-07],
        [2.3842e-07],
        [2.3842e-07],
        [5.3644e-07],
        [1.7881e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.9802e-07],
        [2.9802e-07],
        [5.9605e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([6.2585e-06, 4.0412e-05, 1.3947e-05, 1.2040e-05, 6.9797e-05, 3.2902e-05,
        1.7405e-05, 7.4327e-05, 2.6524e-05, 2.3127e-05, 3.0398e-05, 4.3273e-05,
        2.9743e-05, 1.5974e-05, 5.3465e-05, 5.0843e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[7.2539e-05, 4.6194e-05, 1.0270e-04, 1.0151e-04, 2.0027e-04, 1.3888e-05,
         2.3782e-05, 4.0472e-05, 1.3888e-04, 1.7929e-04, 2.0278e-04, 2.9504e-05,
         9.8407e-05, 9.6321e-05, 4.2379e-05, 3.3617e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[9.5129e-05],
        [6.5267e-05],
        [1.2004e-04],
        [6.9499e-05],
        [2.2614e-04],
        [4.8101e-05],
        [1.0163e-04],
        [1.3018e-04],
        [1.1116e-04],
        [1.6844e-04],
        [2.3532e-04],
        [4.1902e-05],
        [1.4043e-04],
        [2.2316e-04],
        [8.2135e-05],
        [3.6335e-04]], device='cuda:0', dtype=torch.float16), tensor([[8.2850e-06],
        [6.3181e-06],
        [5.5432e-06],
        [1.7762e-05],
        [9.5963e-06],
        [1.6570e-05],
        [1.1683e-05],
        [8.5831e-06],
        [6.0797e-06],
        [5.7220e-06],
        [3.8147e-06],
        [1.1802e-05],
        [8.2254e-06],
        [8.0466e-06],
        [7.5698e-06],
        [9.4175e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.4451e-05, 2.3842e-05, 4.1842e-05, 2.9087e-05, 7.8559e-05, 2.1577e-05,
        3.7789e-05, 4.6253e-05, 3.9101e-05, 5.8055e-05, 7.9691e-05, 1.7881e-05,
        4.9531e-05, 7.7069e-05, 2.9922e-05, 1.2422e-04], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.8101e-05],
        [4.3094e-05],
        [1.5175e-04],
        [9.8228e-05],
        [2.0027e-04],
        [3.9637e-05],
        [3.5524e-05],
        [5.1200e-05],
        [4.4644e-05],
        [1.8871e-04],
        [1.4043e-04],
        [2.8014e-05],
        [8.2552e-05],
        [1.7893e-04],
        [1.1903e-04],
        [2.5129e-04]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [4.1723e-07],
        [1.1325e-06],
        [4.7684e-07],
        [8.3447e-07],
        [2.9802e-07],
        [3.5763e-07],
        [4.1723e-07],
        [3.5763e-07],
        [3.5763e-07],
        [5.3644e-07],
        [2.9802e-07],
        [5.9605e-07],
        [2.9802e-07],
        [3.5763e-07],
        [7.1526e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [1.7881e-07],
        [7.1526e-07],
        [5.3644e-07],
        [5.3644e-07],
        [3.5763e-07],
        [4.1723e-07],
        [7.7486e-07],
        [4.7684e-07],
        [2.9802e-07],
        [7.1526e-07],
        [6.5565e-07],
        [7.7486e-07],
        [7.1526e-07],
        [5.3644e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([1.2219e-05, 1.0908e-05, 3.8385e-05, 2.4796e-05, 5.0426e-05, 1.0073e-05,
        9.0599e-06, 1.3113e-05, 1.1384e-05, 4.7326e-05, 3.5405e-05, 7.2718e-06,
        2.0981e-05, 4.5002e-05, 2.9981e-05, 6.3121e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[5.7638e-05, 4.8280e-05, 6.0856e-05, 1.1539e-04, 1.5450e-04, 3.4451e-05,
         3.0041e-05, 8.7082e-05, 2.8014e-05, 2.4915e-04, 6.1870e-05, 7.1704e-05,
         1.3888e-04, 3.1471e-05, 1.6546e-04, 1.0544e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.4150e-04],
        [1.0228e-04],
        [1.4102e-04],
        [1.5140e-04],
        [1.8799e-04],
        [1.0508e-04],
        [8.4937e-05],
        [1.1766e-04],
        [5.5194e-05],
        [3.3140e-04],
        [6.7055e-05],
        [2.1839e-04],
        [1.5676e-04],
        [5.5254e-05],
        [1.5664e-04],
        [1.3757e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.5432e-06],
        [9.8944e-06],
        [4.7088e-06],
        [6.4373e-06],
        [1.8358e-05],
        [1.0908e-05],
        [3.1590e-06],
        [1.7822e-05],
        [4.3511e-06],
        [6.4969e-06],
        [8.4043e-06],
        [9.5963e-06],
        [4.8876e-06],
        [5.0664e-06],
        [8.4639e-06],
        [5.5432e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.8995e-05, 3.7372e-05, 4.8578e-05, 5.2631e-05, 6.8784e-05, 3.8683e-05,
        2.9385e-05, 4.5180e-05, 1.9848e-05, 1.1265e-04, 2.5153e-05, 7.5996e-05,
        5.3883e-05, 2.0087e-05, 5.5015e-05, 4.7684e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.0854e-04],
        [6.0380e-05],
        [4.6849e-05],
        [1.0550e-04],
        [1.0252e-04],
        [4.0650e-05],
        [2.5809e-05],
        [1.0407e-04],
        [4.8995e-05],
        [4.7112e-04],
        [9.2387e-05],
        [8.0824e-05],
        [2.2197e-04],
        [3.2246e-05],
        [1.9240e-04],
        [1.1539e-04]], device='cuda:0', dtype=torch.float16), tensor([[7.1526e-07],
        [3.5763e-07],
        [2.3842e-07],
        [5.9605e-07],
        [6.5565e-07],
        [2.9802e-07],
        [4.7684e-07],
        [4.7684e-07],
        [4.7684e-07],
        [6.5565e-07],
        [5.3644e-07],
        [3.5763e-07],
        [4.7684e-07],
        [4.7684e-07],
        [5.3644e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16), tensor([[8.3447e-07],
        [5.3644e-07],
        [3.5763e-07],
        [7.1526e-07],
        [5.9605e-07],
        [4.1723e-07],
        [6.5565e-07],
        [4.7684e-07],
        [5.3644e-07],
        [6.5565e-07],
        [5.3644e-07],
        [5.9605e-07],
        [5.3644e-07],
        [4.1723e-07],
        [3.5763e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([2.7537e-05, 1.5318e-05, 1.1861e-05, 2.6703e-05, 2.5928e-05, 1.0371e-05,
        6.7353e-06, 2.6226e-05, 1.2517e-05, 1.1814e-04, 2.3365e-05, 2.0444e-05,
        5.5730e-05, 8.2850e-06, 4.8339e-05, 2.9087e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type active, variation 0 and batchsize 16: 0:02:50.564086
path ['42', 'de', 'llama', 'NLI', 'active', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI active 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 242.14it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.0458e-05, 3.5286e-05, 1.6868e-05, 4.5240e-05, 5.0247e-05, 9.1732e-05,
         2.8908e-05, 6.5506e-05, 4.3333e-05, 6.9916e-05, 4.2617e-05, 3.1531e-05,
         5.8234e-05, 2.8372e-05, 3.5226e-05, 4.2975e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.8963e-05],
        [9.1374e-05],
        [6.5207e-05],
        [8.7023e-05],
        [8.6427e-05],
        [1.9681e-04],
        [4.1783e-05],
        [1.1677e-04],
        [9.9957e-05],
        [1.3745e-04],
        [8.3447e-05],
        [4.8220e-05],
        [1.2565e-04],
        [5.5552e-05],
        [8.2552e-05],
        [7.3373e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.3842e-06],
        [3.2187e-06],
        [2.3842e-06],
        [4.0531e-06],
        [2.6226e-06],
        [6.4969e-06],
        [1.6093e-06],
        [3.9935e-06],
        [2.2650e-06],
        [2.7418e-06],
        [2.7418e-06],
        [2.5034e-06],
        [2.5034e-06],
        [3.8743e-06],
        [4.1723e-06],
        [3.0994e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.3782e-05, 3.1531e-05, 2.2531e-05, 3.0339e-05, 2.9683e-05, 6.7770e-05,
        1.4484e-05, 4.0233e-05, 3.4094e-05, 4.6730e-05, 2.8729e-05, 1.6928e-05,
        4.2737e-05, 1.9789e-05, 2.8908e-05, 2.5511e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.6226e-05],
        [3.0398e-05],
        [1.8537e-05],
        [3.1531e-05],
        [1.5616e-05],
        [5.1737e-05],
        [2.2113e-05],
        [4.4644e-05],
        [3.3736e-05],
        [5.3823e-05],
        [4.5359e-05],
        [1.9550e-05],
        [3.7014e-05],
        [2.1040e-05],
        [2.6882e-05],
        [3.1352e-05]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [2.9802e-07],
        [1.7881e-07],
        [2.9802e-07],
        [2.3842e-07],
        [6.5565e-07],
        [4.7684e-07],
        [4.1723e-07],
        [3.5763e-07],
        [4.7684e-07],
        [4.7684e-07],
        [2.9802e-07],
        [1.7881e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.3842e-07]], device='cuda:0', dtype=torch.float16), tensor([[7.1526e-07],
        [6.5565e-07],
        [8.3447e-07],
        [6.5565e-07],
        [4.1723e-07],
        [1.0729e-06],
        [8.3447e-07],
        [7.7486e-07],
        [5.9605e-07],
        [7.1526e-07],
        [7.1526e-07],
        [8.3447e-07],
        [5.9605e-07],
        [6.5565e-07],
        [8.3447e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([6.7949e-06, 7.8678e-06, 4.8876e-06, 8.1062e-06, 4.0531e-06, 1.3351e-05,
        5.8413e-06, 1.1444e-05, 8.7023e-06, 1.3769e-05, 1.1623e-05, 5.1856e-06,
        9.4175e-06, 5.4836e-06, 7.0333e-06, 8.0466e-06], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[4.5478e-05, 3.7909e-05, 7.3910e-05, 1.3661e-04, 6.0916e-05, 3.3879e-04,
         2.5940e-04, 1.3590e-05, 4.8280e-05, 1.7905e-04, 4.2498e-05, 2.2352e-05,
         5.6386e-05, 8.6784e-05, 1.6332e-05, 8.1062e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.8009e-05],
        [7.9334e-05],
        [2.2769e-04],
        [1.5604e-04],
        [1.3518e-04],
        [5.3930e-04],
        [3.2163e-04],
        [2.4199e-05],
        [1.1712e-04],
        [1.5557e-04],
        [9.8467e-05],
        [4.1544e-05],
        [1.3316e-04],
        [9.2745e-05],
        [3.0875e-05],
        [1.6308e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.2452e-06],
        [2.3246e-06],
        [6.2585e-06],
        [4.2915e-06],
        [3.3975e-06],
        [9.8944e-06],
        [3.9935e-06],
        [2.3246e-06],
        [3.9935e-06],
        [2.3842e-06],
        [2.4438e-06],
        [2.0266e-06],
        [5.4240e-06],
        [4.3511e-06],
        [2.3842e-06],
        [3.2783e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.4438e-05, 2.7239e-05, 7.7963e-05, 5.3465e-05, 4.6194e-05, 1.8311e-04,
        1.0854e-04, 8.8215e-06, 4.0352e-05, 5.2631e-05, 3.3617e-05, 1.4544e-05,
        4.6194e-05, 3.2365e-05, 1.1086e-05, 5.5432e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.2961e-05],
        [2.3603e-05],
        [5.0306e-05],
        [1.3292e-04],
        [5.3763e-05],
        [1.5664e-04],
        [1.6356e-04],
        [8.5235e-06],
        [2.7359e-05],
        [1.0407e-04],
        [5.1081e-05],
        [1.3351e-05],
        [5.7042e-05],
        [6.0081e-05],
        [1.1802e-05],
        [1.0449e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [3.5763e-07],
        [8.3447e-07],
        [1.0729e-06],
        [5.3644e-07],
        [8.9407e-07],
        [5.3644e-07],
        [1.7881e-07],
        [3.5763e-07],
        [9.5367e-07],
        [4.7684e-07],
        [2.9802e-07],
        [5.9605e-07],
        [3.5763e-07],
        [2.3842e-07],
        [7.1526e-07]], device='cuda:0', dtype=torch.float16), tensor([[6.5565e-07],
        [7.1526e-07],
        [4.1723e-07],
        [8.3447e-07],
        [7.7486e-07],
        [7.7486e-07],
        [7.1526e-07],
        [7.1526e-07],
        [4.7684e-07],
        [6.5565e-07],
        [4.1723e-07],
        [4.7684e-07],
        [7.7486e-07],
        [5.3644e-07],
        [5.3644e-07],
        [6.5565e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([8.4639e-06, 6.1989e-06, 1.2875e-05, 3.3736e-05, 1.3769e-05, 3.9577e-05,
        4.1187e-05, 2.3842e-06, 7.0333e-06, 2.6405e-05, 1.2994e-05, 3.5167e-06,
        1.4603e-05, 1.5259e-05, 3.1590e-06, 2.6464e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[6.0141e-05, 2.7895e-05, 2.2173e-05, 5.0902e-05, 6.0558e-05, 1.3888e-04,
         7.5638e-05, 6.4254e-05, 3.7968e-05, 6.8426e-05, 7.0810e-05, 2.4915e-05,
         2.7835e-05, 6.1393e-05, 3.9220e-05, 2.0242e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[8.8871e-05],
        [7.2777e-05],
        [3.3319e-05],
        [1.0651e-04],
        [1.5926e-04],
        [1.9133e-04],
        [2.6202e-04],
        [8.4162e-05],
        [8.3864e-05],
        [2.0874e-04],
        [7.6592e-05],
        [4.8637e-05],
        [9.4116e-05],
        [9.5844e-05],
        [1.2326e-04],
        [2.8205e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.0664e-06],
        [2.8014e-06],
        [2.0862e-06],
        [2.4438e-06],
        [3.0398e-06],
        [5.9605e-06],
        [9.8348e-06],
        [1.8477e-06],
        [4.8876e-06],
        [4.2915e-06],
        [2.3842e-06],
        [2.8014e-06],
        [3.5763e-06],
        [5.3048e-06],
        [3.1590e-06],
        [4.2319e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.1292e-05, 2.5213e-05, 1.1802e-05, 3.6299e-05, 5.4121e-05, 6.5744e-05,
        9.0599e-05, 2.8670e-05, 2.9564e-05, 7.0989e-05, 2.6345e-05, 1.7166e-05,
        3.2544e-05, 3.3736e-05, 4.2140e-05, 9.5427e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.8949e-05],
        [1.8358e-05],
        [1.3709e-05],
        [3.3200e-05],
        [6.1393e-05],
        [3.2282e-04],
        [1.2445e-04],
        [5.8949e-05],
        [3.4094e-05],
        [4.3571e-05],
        [5.1618e-05],
        [1.6570e-05],
        [3.7909e-05],
        [4.7982e-05],
        [2.5511e-05],
        [1.8501e-04]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [3.5763e-07],
        [2.3842e-07],
        [4.1723e-07],
        [2.9802e-07],
        [2.9802e-07],
        [7.1526e-07],
        [5.3644e-07],
        [3.5763e-07],
        [5.3644e-07],
        [3.5763e-07],
        [2.9802e-07],
        [2.3842e-07],
        [3.5763e-07],
        [4.1723e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16), tensor([[7.1526e-07],
        [5.9605e-07],
        [4.7684e-07],
        [7.7486e-07],
        [8.3447e-07],
        [1.1921e-07],
        [7.7486e-07],
        [4.7684e-07],
        [5.3644e-07],
        [5.9605e-07],
        [4.1723e-07],
        [2.9802e-07],
        [5.9605e-07],
        [7.1526e-07],
        [6.5565e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([1.5020e-05, 4.8280e-06, 3.5763e-06, 8.5831e-06, 1.5616e-05, 8.0824e-05,
        3.1471e-05, 1.5020e-05, 8.7619e-06, 1.1206e-05, 1.3113e-05, 4.2915e-06,
        9.6560e-06, 1.2279e-05, 6.6757e-06, 4.6492e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.3541666666666667
Time taken to execute the de NLI task with prompt type active, variation 1 and batchsize 16: 0:02:49.194300
path ['42', 'de', 'llama', 'NLI', 'active', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI active 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 299.24it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0007, 0.0352, 0.0070, 0.0058, 0.0270, 0.0028, 0.0118, 0.0099, 0.0022,
         0.0050, 0.0048, 0.0035, 0.0008, 0.0167, 0.0036, 0.0012]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0011],
        [0.0081],
        [0.0058],
        [0.0036],
        [0.0115],
        [0.0016],
        [0.0046],
        [0.0043],
        [0.0023],
        [0.0025],
        [0.0032],
        [0.0030],
        [0.0011],
        [0.0055],
        [0.0034],
        [0.0021]], device='cuda:0', dtype=torch.float16), tensor([[4.5300e-06],
        [4.4107e-06],
        [3.6955e-06],
        [2.8610e-06],
        [4.5300e-06],
        [1.7285e-06],
        [3.2187e-06],
        [2.4438e-06],
        [4.9472e-06],
        [4.0531e-06],
        [2.5034e-06],
        [3.5763e-06],
        [2.8610e-06],
        [5.4836e-06],
        [3.8743e-06],
        [2.6822e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([0.0004, 0.0027, 0.0019, 0.0012, 0.0038, 0.0005, 0.0015, 0.0014, 0.0008,
        0.0008, 0.0011, 0.0010, 0.0004, 0.0018, 0.0011, 0.0007],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0003],
        [0.0009],
        [0.0006],
        [0.0003],
        [0.0017],
        [0.0002],
        [0.0011],
        [0.0011],
        [0.0005],
        [0.0004],
        [0.0005],
        [0.0003],
        [0.0002],
        [0.0007],
        [0.0006],
        [0.0002]], device='cuda:0', dtype=torch.float16), tensor([[8.3447e-07],
        [6.5565e-07],
        [5.3644e-07],
        [4.1723e-07],
        [1.3113e-06],
        [2.3842e-07],
        [1.2517e-06],
        [8.3447e-07],
        [1.0729e-06],
        [2.3842e-07],
        [4.1723e-07],
        [6.5565e-07],
        [7.7486e-07],
        [5.3644e-07],
        [5.9605e-07],
        [2.3842e-07]], device='cuda:0', dtype=torch.float16), tensor([[1.1325e-06],
        [1.9670e-06],
        [1.8477e-06],
        [1.1921e-06],
        [1.9073e-06],
        [1.7285e-06],
        [2.1458e-06],
        [2.2650e-06],
        [1.6689e-06],
        [1.5497e-06],
        [1.9670e-06],
        [1.8477e-06],
        [8.9407e-07],
        [2.7418e-06],
        [1.4901e-06],
        [2.3246e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([7.7665e-05, 2.2268e-04, 1.4091e-04, 8.7261e-05, 4.1628e-04, 4.8935e-05,
        2.7704e-04, 2.8276e-04, 1.3697e-04, 1.0300e-04, 1.1861e-04, 7.7724e-05,
        4.2558e-05, 1.8704e-04, 1.5497e-04, 4.2975e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0026, 0.0154, 0.0038, 0.0084, 0.0023, 0.0029, 0.0036, 0.0007, 0.0050,
         0.0452, 0.0246, 0.0157, 0.0068, 0.0173, 0.0040, 0.0043]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0022],
        [0.0069],
        [0.0022],
        [0.0050],
        [0.0031],
        [0.0030],
        [0.0033],
        [0.0011],
        [0.0043],
        [0.0129],
        [0.0072],
        [0.0090],
        [0.0053],
        [0.0082],
        [0.0018],
        [0.0037]], device='cuda:0', dtype=torch.float16), tensor([[4.3511e-06],
        [3.7551e-06],
        [1.7285e-06],
        [2.3842e-06],
        [5.9605e-06],
        [3.5167e-06],
        [3.1590e-06],
        [2.5034e-06],
        [3.8743e-06],
        [3.1590e-06],
        [2.5630e-06],
        [3.1590e-06],
        [4.1127e-06],
        [2.8014e-06],
        [1.6093e-06],
        [3.2783e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([0.0007, 0.0023, 0.0007, 0.0017, 0.0010, 0.0010, 0.0011, 0.0004, 0.0014,
        0.0043, 0.0024, 0.0030, 0.0018, 0.0028, 0.0006, 0.0012],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0003],
        [0.0021],
        [0.0004],
        [0.0007],
        [0.0004],
        [0.0007],
        [0.0003],
        [0.0001],
        [0.0004],
        [0.0013],
        [0.0016],
        [0.0007],
        [0.0008],
        [0.0007],
        [0.0004],
        [0.0004]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [8.9407e-07],
        [2.9802e-07],
        [3.5763e-07],
        [1.0133e-06],
        [9.5367e-07],
        [4.1723e-07],
        [2.9802e-07],
        [5.3644e-07],
        [5.9605e-07],
        [1.1325e-06],
        [1.0729e-06],
        [3.0398e-06],
        [2.9802e-07],
        [4.7684e-07],
        [8.3447e-07]], device='cuda:0', dtype=torch.float16), tensor([[1.7285e-06],
        [1.2517e-06],
        [1.1325e-06],
        [3.8147e-06],
        [1.4305e-06],
        [2.0266e-06],
        [1.7881e-06],
        [8.3447e-07],
        [1.1921e-06],
        [3.2187e-06],
        [3.2187e-06],
        [2.8610e-06],
        [2.2054e-06],
        [3.0398e-06],
        [9.5367e-07],
        [1.7881e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([7.7665e-05, 5.1737e-04, 9.2566e-05, 1.6367e-04, 1.1194e-04, 1.6522e-04,
        8.3804e-05, 2.8312e-05, 1.1140e-04, 3.1877e-04, 4.0436e-04, 1.6665e-04,
        2.1207e-04, 1.6546e-04, 9.7036e-05, 1.0318e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0024, 0.0575, 0.0058, 0.0022, 0.0023, 0.0897, 0.0172, 0.0357, 0.0215,
         0.0100, 0.0131, 0.0025, 0.0604, 0.0022, 0.0115, 0.0084]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0019],
        [0.0106],
        [0.0017],
        [0.0017],
        [0.0017],
        [0.0353],
        [0.0052],
        [0.0116],
        [0.0076],
        [0.0059],
        [0.0057],
        [0.0021],
        [0.0076],
        [0.0027],
        [0.0044],
        [0.0038]], device='cuda:0', dtype=torch.float16), tensor([[5.2452e-06],
        [3.4571e-06],
        [2.9206e-06],
        [2.3842e-06],
        [4.1127e-06],
        [5.9009e-06],
        [3.8147e-06],
        [4.2319e-06],
        [4.3511e-06],
        [3.0994e-06],
        [2.7418e-06],
        [3.0398e-06],
        [3.7551e-06],
        [2.9206e-06],
        [1.9073e-06],
        [1.6093e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([0.0006, 0.0035, 0.0006, 0.0006, 0.0006, 0.0118, 0.0017, 0.0039, 0.0025,
        0.0020, 0.0019, 0.0007, 0.0025, 0.0009, 0.0015, 0.0013],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0005],
        [0.0029],
        [0.0007],
        [0.0002],
        [0.0002],
        [0.0034],
        [0.0015],
        [0.0029],
        [0.0011],
        [0.0005],
        [0.0009],
        [0.0003],
        [0.0008],
        [0.0003],
        [0.0012],
        [0.0006]], device='cuda:0', dtype=torch.float16), tensor([[1.4305e-06],
        [6.5565e-07],
        [1.0729e-06],
        [4.1723e-07],
        [3.5763e-07],
        [1.5497e-06],
        [2.3246e-06],
        [1.1921e-06],
        [7.1526e-07],
        [5.9605e-07],
        [3.5763e-07],
        [7.7486e-07],
        [4.1723e-07],
        [4.1723e-07],
        [4.7684e-07],
        [5.9605e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.1458e-06],
        [1.8477e-06],
        [1.7285e-06],
        [1.9670e-06],
        [8.9407e-07],
        [3.8147e-06],
        [2.8610e-06],
        [2.3246e-06],
        [2.9802e-06],
        [1.4901e-06],
        [4.0531e-06],
        [1.3709e-06],
        [1.0729e-06],
        [2.4438e-06],
        [2.4438e-06],
        [1.6689e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.3304e-04, 7.2479e-04, 1.8239e-04, 4.6134e-05, 4.7743e-05, 8.6117e-04,
        3.6907e-04, 7.3671e-04, 2.8586e-04, 1.3161e-04, 2.2149e-04, 8.4221e-05,
        1.9050e-04, 7.8201e-05, 3.0899e-04, 1.5736e-04], device='cuda:0',
       dtype=torch.float16)
acc:  0.3333333333333333
Time taken to execute the de NLI task with prompt type active, variation 2 and batchsize 16: 0:02:49.494530
path ['42', 'de', 'llama', 'NLI', 'active', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b NLI passive 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 176.51it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[8.8811e-05, 2.1446e-04, 1.3554e-04, 1.9765e-04, 2.8348e-04, 8.6188e-05,
         1.6165e-04, 5.3227e-05, 2.7442e-04, 3.6359e-04, 9.6738e-05, 9.3281e-05,
         3.0851e-04, 4.5252e-04, 6.9916e-05, 1.4544e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.7514e-04],
        [2.3735e-04],
        [1.9681e-04],
        [2.8419e-04],
        [2.8133e-04],
        [1.4591e-04],
        [1.8024e-04],
        [1.2767e-04],
        [3.8695e-04],
        [5.4789e-04],
        [1.0049e-04],
        [6.3062e-05],
        [3.4547e-04],
        [6.1226e-04],
        [1.3793e-04],
        [2.5272e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.2709e-05],
        [6.6757e-06],
        [1.6332e-05],
        [1.3530e-05],
        [1.3947e-05],
        [1.2815e-05],
        [1.2100e-05],
        [4.0174e-05],
        [2.0146e-05],
        [8.3447e-06],
        [6.1393e-06],
        [1.6451e-05],
        [2.6345e-05],
        [2.9027e-05],
        [1.1563e-05],
        [1.7166e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([9.9301e-05, 8.1360e-05, 7.1049e-05, 9.9242e-05, 9.8407e-05, 5.2929e-05,
        6.4135e-05, 5.5969e-05, 1.3566e-04, 1.8537e-04, 3.5524e-05, 2.6524e-05,
        1.2398e-04, 2.1374e-04, 4.9829e-05, 8.9943e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.0282e-04],
        [3.5095e-04],
        [1.9133e-04],
        [2.1327e-04],
        [2.0182e-04],
        [1.9217e-04],
        [2.8300e-04],
        [1.2362e-04],
        [2.6917e-04],
        [5.7983e-04],
        [1.2243e-04],
        [1.0329e-04],
        [1.3661e-04],
        [3.6073e-04],
        [6.8784e-05],
        [1.4746e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [5.9605e-07],
        [5.9605e-07],
        [5.9605e-07],
        [7.7486e-07],
        [2.9802e-07],
        [6.5565e-07],
        [2.9802e-07],
        [2.9802e-07],
        [5.3644e-07],
        [1.7881e-07],
        [3.5763e-07],
        [7.7486e-07],
        [8.9407e-07],
        [4.1723e-07],
        [8.3447e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [6.5565e-07],
        [4.7684e-07],
        [2.9802e-07],
        [5.3644e-07],
        [6.5565e-07],
        [2.3842e-07],
        [5.3644e-07],
        [5.3644e-07],
        [1.4901e-06],
        [4.1723e-07],
        [3.5763e-07],
        [7.1526e-07],
        [4.1723e-07],
        [7.7486e-07],
        [7.7486e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([2.5868e-05, 8.8036e-05, 4.8101e-05, 5.3525e-05, 5.0783e-05, 4.8280e-05,
        7.0989e-05, 3.1114e-05, 6.7472e-05, 1.4544e-04, 3.0756e-05, 2.5988e-05,
        3.4511e-05, 9.0480e-05, 1.7524e-05, 3.7253e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.1849e-04, 2.1708e-04, 9.0480e-05, 3.7193e-05, 1.8096e-04, 1.8227e-04,
         1.6356e-04, 4.1723e-04, 1.0556e-04, 1.2791e-04, 4.2677e-04, 1.1629e-04,
         1.0157e-04, 7.0930e-05, 1.3864e-04, 1.9526e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.0684e-04],
        [1.7130e-04],
        [3.3712e-04],
        [8.8036e-05],
        [2.9945e-04],
        [3.1567e-04],
        [2.5725e-04],
        [2.7370e-04],
        [1.0246e-04],
        [1.1897e-04],
        [4.5419e-04],
        [1.8585e-04],
        [1.0622e-04],
        [1.3697e-04],
        [1.3196e-04],
        [1.3900e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.8060e-05],
        [2.6226e-05],
        [2.5034e-05],
        [1.1861e-05],
        [2.4855e-05],
        [1.0133e-05],
        [1.6928e-05],
        [1.3411e-05],
        [8.5831e-06],
        [9.4771e-06],
        [1.4842e-05],
        [1.2815e-05],
        [1.4603e-05],
        [9.0003e-06],
        [2.0087e-05],
        [7.5698e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.0830e-04, 6.5863e-05, 1.2070e-04, 3.3319e-05, 1.0812e-04, 1.0860e-04,
        9.1374e-05, 9.5725e-05, 3.7014e-05, 4.2796e-05, 1.5640e-04, 6.6221e-05,
        4.0293e-05, 4.8637e-05, 5.0664e-05, 4.8876e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.2435e-04],
        [1.4710e-04],
        [1.4365e-04],
        [7.3433e-05],
        [3.0732e-04],
        [2.1648e-04],
        [1.3852e-04],
        [4.7469e-04],
        [1.3375e-04],
        [1.1355e-04],
        [5.1260e-04],
        [2.0850e-04],
        [7.8321e-05],
        [1.2255e-04],
        [9.4712e-05],
        [2.0981e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.3644e-07],
        [4.7684e-07],
        [4.7684e-07],
        [2.3842e-07],
        [7.7486e-07],
        [4.7684e-07],
        [2.9802e-07],
        [5.3644e-07],
        [2.3842e-07],
        [4.7684e-07],
        [7.1526e-07],
        [4.7684e-07],
        [2.9802e-07],
        [4.7684e-07],
        [2.9802e-07],
        [9.5367e-07]], device='cuda:0', dtype=torch.float16), tensor([[8.9407e-07],
        [2.9802e-07],
        [4.1723e-07],
        [2.3842e-07],
        [3.5763e-07],
        [7.1526e-07],
        [2.9802e-07],
        [3.5763e-07],
        [4.7684e-07],
        [1.7881e-07],
        [5.3644e-07],
        [7.7486e-07],
        [4.7684e-07],
        [4.7684e-07],
        [5.3644e-07],
        [5.9605e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([5.6446e-05, 3.6955e-05, 3.6120e-05, 1.8477e-05, 7.7128e-05, 5.4419e-05,
        3.4809e-05, 1.1891e-04, 3.3617e-05, 2.8551e-05, 1.2851e-04, 5.2452e-05,
        1.9789e-05, 3.0875e-05, 2.3901e-05, 5.2810e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.3580e-04, 1.2851e-04, 1.3506e-04, 1.1444e-04, 2.9469e-04, 2.9683e-04,
         1.2004e-04, 7.7820e-04, 8.8036e-05, 9.8884e-05, 6.5923e-05, 1.0675e-04,
         5.0354e-04, 1.9586e-04, 5.4598e-05, 1.2171e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.7633e-04],
        [1.8394e-04],
        [1.2672e-04],
        [1.0639e-04],
        [3.0398e-04],
        [3.9625e-04],
        [6.0737e-05],
        [1.1683e-03],
        [1.2314e-04],
        [1.2696e-04],
        [1.1748e-04],
        [1.9848e-04],
        [3.6979e-04],
        [2.8014e-04],
        [9.7275e-05],
        [1.3995e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.1325e-05],
        [1.7107e-05],
        [2.2829e-05],
        [1.5438e-05],
        [2.8014e-05],
        [2.1875e-05],
        [2.3484e-05],
        [1.1563e-05],
        [1.7941e-05],
        [8.7023e-06],
        [1.1563e-05],
        [1.2577e-05],
        [1.2755e-05],
        [2.2471e-05],
        [9.8348e-06],
        [1.1086e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([9.5904e-05, 6.6996e-05, 4.9829e-05, 4.0591e-05, 1.1069e-04, 1.3936e-04,
        2.8074e-05, 3.9339e-04, 4.7028e-05, 4.5240e-05, 4.3035e-05, 7.0333e-05,
        1.2755e-04, 1.0085e-04, 3.5703e-05, 5.0366e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.2377e-04],
        [1.3661e-04],
        [1.1027e-04],
        [1.4174e-04],
        [1.7595e-04],
        [2.9397e-04],
        [6.5386e-05],
        [1.0719e-03],
        [9.1672e-05],
        [2.1100e-04],
        [5.7578e-05],
        [1.5008e-04],
        [1.8668e-04],
        [1.6606e-04],
        [7.2241e-05],
        [2.4354e-04]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.3842e-07],
        [7.1526e-07],
        [8.3447e-07],
        [4.1723e-07],
        [5.9605e-07],
        [3.5763e-07],
        [5.9605e-07],
        [2.9802e-07],
        [6.5565e-07],
        [8.3447e-07],
        [2.3842e-07],
        [2.9802e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[7.1526e-07],
        [4.7684e-07],
        [3.5763e-07],
        [3.5763e-07],
        [5.9605e-07],
        [7.1526e-07],
        [1.0133e-06],
        [8.9407e-07],
        [4.1723e-07],
        [4.7684e-07],
        [2.3842e-07],
        [5.9605e-07],
        [4.7684e-07],
        [4.1723e-07],
        [2.9802e-07],
        [5.9605e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([8.1241e-05, 3.4332e-05, 2.7776e-05, 3.5584e-05, 4.4346e-05, 7.3910e-05,
        1.6689e-05, 2.6846e-04, 2.3127e-05, 5.3048e-05, 1.4544e-05, 3.7849e-05,
        4.6968e-05, 4.1664e-05, 1.8239e-05, 6.1095e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.3125
Time taken to execute the de NLI task with prompt type passive, variation 0 and batchsize 16: 0:03:07.868914
path ['42', 'de', 'llama', 'NLI', 'passive', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI passive 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 172.59it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.1398e-05, 3.8445e-05, 2.2233e-05, 2.3007e-05, 3.3319e-05, 1.1921e-05,
         4.1664e-05, 1.8716e-05, 2.2352e-05, 6.0141e-05, 1.7226e-05, 5.9605e-05,
         2.4736e-05, 2.0862e-05, 6.4373e-06, 2.6166e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.3186e-05],
        [6.5386e-05],
        [6.9261e-05],
        [2.5272e-05],
        [3.7670e-05],
        [3.0160e-05],
        [6.8247e-05],
        [2.3365e-05],
        [5.4002e-05],
        [9.5367e-05],
        [3.0637e-05],
        [8.0824e-05],
        [3.0458e-05],
        [3.6478e-05],
        [1.1444e-05],
        [1.1861e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.7088e-06],
        [5.6028e-06],
        [4.3511e-06],
        [4.8876e-06],
        [2.6226e-06],
        [5.0068e-06],
        [6.1989e-06],
        [2.1458e-06],
        [3.5763e-06],
        [7.3910e-06],
        [1.6689e-06],
        [8.2850e-06],
        [3.0994e-06],
        [3.5167e-06],
        [1.6093e-06],
        [2.5034e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([9.2983e-06, 2.3663e-05, 2.4557e-05, 1.0073e-05, 1.3411e-05, 1.1742e-05,
        2.4796e-05, 8.5235e-06, 1.9193e-05, 3.4273e-05, 1.0788e-05, 2.9683e-05,
        1.1206e-05, 1.3351e-05, 4.3511e-06, 4.7684e-06], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.6478e-05],
        [9.4831e-05],
        [1.5736e-05],
        [2.6286e-05],
        [4.2021e-05],
        [2.0444e-05],
        [3.9458e-05],
        [1.9491e-05],
        [2.5928e-05],
        [8.5533e-05],
        [1.0908e-05],
        [1.0419e-04],
        [3.1948e-05],
        [1.3471e-05],
        [7.0930e-06],
        [4.0412e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [5.9605e-07],
        [4.1723e-07],
        [4.7684e-07],
        [2.3842e-07],
        [4.7684e-07],
        [5.3644e-07],
        [4.1723e-07],
        [4.7684e-07],
        [5.3644e-07],
        [2.9802e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.3842e-07],
        [7.1526e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.1723e-07],
        [3.5763e-07],
        [3.5763e-07],
        [1.1921e-07],
        [4.7684e-07],
        [2.3842e-07],
        [2.9802e-07],
        [1.7881e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.9802e-07],
        [2.3842e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([9.2387e-06, 2.4021e-05, 4.1127e-06, 6.7949e-06, 1.0669e-05, 5.3048e-06,
        1.0073e-05, 5.0068e-06, 6.7353e-06, 2.1577e-05, 2.8610e-06, 2.6166e-05,
        8.1658e-06, 3.5763e-06, 1.9670e-06, 1.0252e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.4928e-05, 1.3471e-05, 1.3649e-05, 3.0756e-05, 1.4961e-05, 1.7166e-05,
         3.1471e-05, 1.3232e-05, 1.8954e-05, 1.5259e-05, 3.0041e-05, 1.4961e-05,
         2.1517e-05, 1.6332e-05, 1.5199e-05, 3.3200e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.5942e-05],
        [2.0087e-05],
        [3.3379e-05],
        [3.6836e-05],
        [2.5332e-05],
        [3.9339e-05],
        [4.9412e-05],
        [2.5809e-05],
        [3.4809e-05],
        [2.8431e-05],
        [3.5882e-05],
        [3.1650e-05],
        [6.1333e-05],
        [2.9385e-05],
        [3.0756e-05],
        [9.2089e-05]], device='cuda:0', dtype=torch.float16), tensor([[9.1791e-06],
        [2.8014e-06],
        [2.7418e-06],
        [4.6492e-06],
        [2.5034e-06],
        [5.1260e-06],
        [3.9339e-06],
        [2.8610e-06],
        [3.5167e-06],
        [2.7418e-06],
        [3.8147e-06],
        [3.6955e-06],
        [4.0531e-06],
        [4.2915e-06],
        [2.5034e-06],
        [7.6890e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.5020e-05, 7.6294e-06, 1.2040e-05, 1.3828e-05, 9.2983e-06, 1.4842e-05,
        1.7762e-05, 9.5367e-06, 1.2755e-05, 1.0371e-05, 1.3232e-05, 1.1802e-05,
        2.1815e-05, 1.1206e-05, 1.1086e-05, 3.3259e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.1022e-05],
        [1.0967e-05],
        [1.5378e-05],
        [3.1233e-05],
        [1.2457e-05],
        [3.0339e-05],
        [3.4869e-05],
        [1.6391e-05],
        [2.9802e-05],
        [2.0921e-05],
        [2.6405e-05],
        [1.4901e-05],
        [2.9862e-05],
        [1.3709e-05],
        [1.1325e-05],
        [8.5771e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [2.9802e-07],
        [2.9802e-07],
        [6.5565e-07],
        [3.5763e-07],
        [4.1723e-07],
        [5.3644e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.1723e-07],
        [5.9605e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [4.7684e-07],
        [3.5763e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.9802e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.3842e-07],
        [3.5763e-07],
        [4.1723e-07],
        [1.7881e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([1.2934e-05, 2.9206e-06, 3.9935e-06, 8.0466e-06, 3.2783e-06, 7.8082e-06,
        8.9407e-06, 4.2915e-06, 7.6294e-06, 5.4240e-06, 6.8545e-06, 3.8743e-06,
        7.6294e-06, 3.5763e-06, 2.9802e-06, 2.1696e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.2471e-05, 2.2352e-05, 1.8120e-05, 1.6570e-05, 1.3709e-05, 1.0312e-05,
         1.7965e-04, 1.4186e-05, 5.5015e-05, 1.1623e-05, 1.5068e-04, 1.3828e-05,
         7.8976e-05, 2.6405e-05, 1.1623e-05, 1.2219e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.3035e-05],
        [2.6226e-05],
        [5.1022e-05],
        [2.1398e-05],
        [2.4021e-05],
        [1.7643e-05],
        [2.2984e-04],
        [1.9729e-05],
        [7.3016e-05],
        [2.2113e-05],
        [7.5519e-05],
        [3.0518e-05],
        [5.9724e-05],
        [5.1916e-05],
        [1.8299e-05],
        [3.3081e-05]], device='cuda:0', dtype=torch.float16), tensor([[5.3048e-06],
        [4.5300e-06],
        [8.5831e-06],
        [1.8477e-06],
        [3.2783e-06],
        [2.8610e-06],
        [7.1526e-06],
        [2.5630e-06],
        [8.4639e-06],
        [2.2650e-06],
        [8.1658e-06],
        [3.2783e-06],
        [4.7684e-06],
        [7.3910e-06],
        [2.3842e-06],
        [4.5300e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.6093e-05, 1.0252e-05, 1.9848e-05, 7.7486e-06, 9.1195e-06, 6.8545e-06,
        7.8976e-05, 7.4506e-06, 2.7180e-05, 8.1062e-06, 2.7895e-05, 1.1265e-05,
        2.1517e-05, 1.9789e-05, 6.9141e-06, 1.2517e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.9312e-05],
        [2.6047e-05],
        [3.5644e-05],
        [1.3053e-05],
        [1.5140e-05],
        [1.4663e-05],
        [3.7599e-04],
        [1.3232e-05],
        [2.6584e-05],
        [1.0133e-05],
        [5.0187e-05],
        [1.1265e-05],
        [2.8491e-05],
        [3.2425e-05],
        [1.5736e-05],
        [1.8537e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [3.5763e-07],
        [3.5763e-07],
        [8.9407e-07],
        [4.1723e-07],
        [7.7486e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [5.3644e-07],
        [7.1526e-07],
        [3.5763e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [2.9802e-07],
        [2.9802e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [7.1526e-07],
        [2.9802e-07],
        [2.3842e-07],
        [2.9802e-07],
        [3.5763e-07],
        [4.1723e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.3842e-07],
        [2.3842e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([5.0068e-06, 6.6757e-06, 9.0599e-06, 3.4571e-06, 3.9339e-06, 3.8743e-06,
        9.4414e-05, 3.4571e-06, 6.9141e-06, 2.6822e-06, 1.2696e-05, 2.9802e-06,
        7.3910e-06, 8.4043e-06, 4.0531e-06, 4.8280e-06], device='cuda:0',
       dtype=torch.float16)
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type passive, variation 1 and batchsize 16: 0:02:49.461063
path ['42', 'de', 'llama', 'NLI', 'passive', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI passive 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 315.09it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.9813e-04, 8.2374e-05, 1.0967e-04, 3.5524e-04, 1.1081e-04, 4.2737e-05,
         4.1306e-05, 2.4605e-04, 1.3101e-04, 1.0484e-04, 1.3721e-04, 5.3596e-04,
         1.8120e-04, 3.1567e-04, 9.6500e-05, 2.0099e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.0174e-04],
        [1.4353e-04],
        [1.1814e-04],
        [2.6298e-04],
        [1.7917e-04],
        [1.0455e-04],
        [4.9174e-05],
        [2.4366e-04],
        [1.8883e-04],
        [2.7728e-04],
        [2.0432e-04],
        [3.8457e-04],
        [2.4939e-04],
        [3.1233e-04],
        [1.2624e-04],
        [1.4567e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.1683e-05],
        [1.2457e-05],
        [1.7524e-05],
        [1.5438e-05],
        [1.1444e-05],
        [1.3113e-05],
        [1.2934e-05],
        [2.3484e-05],
        [1.1802e-05],
        [1.8001e-05],
        [1.7762e-05],
        [1.4305e-05],
        [1.9610e-05],
        [1.8775e-05],
        [1.5199e-05],
        [7.2718e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.3781e-04, 5.1975e-05, 4.5240e-05, 9.2804e-05, 6.3539e-05, 3.9220e-05,
        2.0683e-05, 8.9049e-05, 6.6876e-05, 9.8407e-05, 7.4029e-05, 1.3292e-04,
        8.9645e-05, 1.1039e-04, 4.7147e-05, 5.0962e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.0599e-04],
        [6.7890e-05],
        [1.0222e-04],
        [3.7527e-04],
        [1.1885e-04],
        [4.4703e-05],
        [5.2273e-05],
        [1.8251e-04],
        [2.5105e-04],
        [2.2388e-04],
        [1.1826e-04],
        [1.6963e-04],
        [1.5998e-04],
        [2.9659e-04],
        [1.1951e-04],
        [2.1601e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.3644e-07],
        [4.7684e-07],
        [3.5763e-07],
        [6.5565e-07],
        [7.1526e-07],
        [2.9802e-07],
        [2.9802e-07],
        [5.9605e-07],
        [5.9605e-07],
        [6.5565e-07],
        [3.5763e-07],
        [1.0133e-06],
        [3.5763e-07],
        [7.1526e-07],
        [4.7684e-07],
        [1.0729e-06]], device='cuda:0', dtype=torch.float16), tensor([[7.7486e-07],
        [7.1526e-07],
        [4.7684e-07],
        [2.9802e-07],
        [7.7486e-07],
        [1.7881e-07],
        [3.5763e-07],
        [5.9605e-07],
        [8.3447e-07],
        [7.7486e-07],
        [2.3842e-07],
        [5.9605e-07],
        [4.7684e-07],
        [4.1723e-07],
        [5.3644e-07],
        [5.9605e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([5.1856e-05, 1.7285e-05, 2.5749e-05, 9.4056e-05, 3.0100e-05, 1.1325e-05,
        1.3232e-05, 4.5896e-05, 6.3121e-05, 5.6326e-05, 2.9683e-05, 4.2796e-05,
        4.0174e-05, 7.4446e-05, 3.0160e-05, 5.4419e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.0085e-04, 1.0271e-03, 1.9407e-04, 9.6440e-05, 5.9009e-05, 2.0540e-04,
         1.3793e-04, 8.5652e-05, 1.0061e-04, 8.6427e-05, 6.0081e-05, 3.1352e-04,
         1.2124e-04, 1.4746e-04, 5.7101e-05, 4.4942e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.1903e-04],
        [1.5173e-03],
        [2.3496e-04],
        [1.1039e-04],
        [3.7014e-05],
        [2.1434e-04],
        [2.5868e-04],
        [1.5032e-04],
        [2.6870e-04],
        [1.0252e-04],
        [7.9572e-05],
        [4.0793e-04],
        [1.2171e-04],
        [1.6475e-04],
        [9.9480e-05],
        [7.8440e-05]], device='cuda:0', dtype=torch.float16), tensor([[9.4771e-06],
        [1.5974e-05],
        [6.4373e-06],
        [2.2054e-05],
        [1.2934e-05],
        [1.6153e-05],
        [1.3530e-05],
        [1.0133e-05],
        [2.0146e-05],
        [2.1458e-05],
        [1.2577e-05],
        [3.4571e-05],
        [1.2279e-05],
        [3.0279e-05],
        [7.9870e-06],
        [1.1086e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([4.2856e-05, 5.1117e-04, 8.0466e-05, 4.4167e-05, 1.6630e-05, 7.6830e-05,
        9.0718e-05, 5.3465e-05, 9.6262e-05, 4.1306e-05, 3.0696e-05, 1.4746e-04,
        4.4644e-05, 6.5029e-05, 3.5822e-05, 2.9862e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[9.6023e-05],
        [9.7227e-04],
        [3.9506e-04],
        [1.2803e-04],
        [4.6551e-05],
        [1.1748e-04],
        [1.5235e-04],
        [7.5161e-05],
        [1.2231e-04],
        [9.8765e-05],
        [6.9797e-05],
        [3.2139e-04],
        [1.5175e-04],
        [9.5785e-05],
        [9.5665e-05],
        [3.8981e-05]], device='cuda:0', dtype=torch.float16), tensor([[5.9605e-07],
        [5.9605e-07],
        [7.7486e-07],
        [2.9802e-07],
        [2.3842e-07],
        [1.0729e-06],
        [7.7486e-07],
        [4.7684e-07],
        [2.9802e-07],
        [4.7684e-07],
        [3.5763e-07],
        [8.9407e-07],
        [3.5763e-07],
        [4.7684e-07],
        [5.3644e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[1.7881e-07],
        [8.9407e-07],
        [5.9605e-07],
        [4.1723e-07],
        [5.3644e-07],
        [5.9605e-07],
        [7.1526e-07],
        [5.9605e-07],
        [3.5763e-07],
        [3.5763e-07],
        [3.5763e-07],
        [7.7486e-07],
        [5.3644e-07],
        [5.9605e-07],
        [4.1723e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([2.4199e-05, 2.4343e-04, 9.9123e-05, 3.2187e-05, 1.1802e-05, 2.9802e-05,
        3.8445e-05, 1.9073e-05, 3.0756e-05, 2.4915e-05, 1.7643e-05, 8.0764e-05,
        3.8147e-05, 2.4199e-05, 2.4140e-05, 9.9540e-06], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[9.6917e-05, 1.8930e-04, 9.3341e-05, 3.1042e-04, 7.7963e-05, 1.3244e-04,
         5.3346e-05, 9.0837e-05, 1.0800e-04, 2.1052e-04, 4.8018e-04, 1.0377e-04,
         1.2100e-04, 4.3690e-05, 7.4327e-05, 1.8311e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.1444e-04],
        [2.9159e-04],
        [9.8586e-05],
        [4.6945e-04],
        [1.2469e-04],
        [2.1613e-04],
        [1.0324e-04],
        [3.0446e-04],
        [1.4532e-04],
        [2.7657e-04],
        [7.2527e-04],
        [1.5867e-04],
        [1.0377e-04],
        [7.6413e-05],
        [1.6618e-04],
        [2.8467e-04]], device='cuda:0', dtype=torch.float16), tensor([[6.6757e-06],
        [2.0981e-05],
        [1.5974e-05],
        [2.9802e-05],
        [1.6630e-05],
        [2.3067e-05],
        [4.1723e-05],
        [2.3425e-05],
        [9.1195e-06],
        [1.1921e-05],
        [1.0610e-05],
        [2.1994e-05],
        [3.4213e-05],
        [8.3447e-06],
        [1.6332e-05],
        [1.5974e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([4.0352e-05, 1.0419e-04, 3.8207e-05, 1.6642e-04, 4.7088e-05, 7.9751e-05,
        4.8339e-05, 1.0931e-04, 5.1498e-05, 9.6142e-05, 2.4533e-04, 6.0201e-05,
        4.6015e-05, 2.8253e-05, 6.0856e-05, 1.0020e-04], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.2469e-04],
        [1.4043e-04],
        [1.0675e-04],
        [3.2711e-04],
        [6.1870e-05],
        [2.9850e-04],
        [1.2994e-04],
        [1.0860e-04],
        [2.3961e-04],
        [2.9612e-04],
        [6.4516e-04],
        [2.5749e-04],
        [9.3639e-05],
        [5.5671e-05],
        [1.2398e-04],
        [1.6737e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.3842e-07],
        [2.3842e-07],
        [3.5763e-07],
        [8.3447e-07],
        [4.1723e-07],
        [7.7486e-07],
        [2.9802e-07],
        [5.3644e-07],
        [6.5565e-07],
        [4.1723e-07],
        [5.9605e-07],
        [7.7486e-07],
        [4.7684e-07],
        [2.9802e-07],
        [3.5763e-07],
        [6.5565e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [4.7684e-07],
        [4.1723e-07],
        [4.7684e-07],
        [4.1723e-07],
        [4.7684e-07],
        [5.9605e-07],
        [1.3113e-06],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [6.5565e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([3.1352e-05, 3.5286e-05, 2.6882e-05, 8.2076e-05, 1.5676e-05, 7.4923e-05,
        3.2663e-05, 2.7418e-05, 6.0201e-05, 7.4267e-05, 1.6177e-04, 6.4671e-05,
        2.3603e-05, 1.4067e-05, 3.1233e-05, 4.2081e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.3125
Time taken to execute the de NLI task with prompt type passive, variation 2 and batchsize 16: 0:03:07.195371
path ['42', 'de', 'llama', 'NLI', 'passive', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b NLI auxiliary 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 233.64it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[9.9540e-06, 5.2118e-04, 8.7917e-05, 4.3333e-05, 7.7307e-05, 9.8407e-05,
         1.9729e-05, 2.7347e-04, 3.8803e-05, 2.4676e-04, 2.6584e-05, 1.8895e-05,
         4.1962e-05, 2.6882e-05, 1.7202e-04, 7.6532e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[8.6665e-05],
        [9.5892e-04],
        [1.3888e-04],
        [1.1057e-04],
        [2.4068e-04],
        [3.2520e-04],
        [4.2558e-05],
        [9.2697e-04],
        [2.1303e-04],
        [5.3072e-04],
        [1.0616e-04],
        [9.1612e-05],
        [1.3030e-04],
        [1.1063e-04],
        [3.7265e-04],
        [2.2984e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.3947e-05],
        [9.2983e-06],
        [5.7220e-06],
        [6.4969e-06],
        [1.0967e-05],
        [5.0664e-06],
        [7.4506e-06],
        [2.4915e-05],
        [3.6955e-06],
        [5.4836e-06],
        [1.1563e-05],
        [4.1723e-06],
        [3.8147e-06],
        [8.8215e-06],
        [7.6294e-06],
        [4.4107e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.3557e-05, 3.2282e-04, 4.8220e-05, 3.9041e-05, 8.3864e-05, 1.1009e-04,
        1.6689e-05, 3.1734e-04, 7.2241e-05, 1.7869e-04, 3.9220e-05, 3.1948e-05,
        4.4703e-05, 3.9816e-05, 1.2672e-04, 7.8082e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.8729e-05],
        [3.3927e-04],
        [3.9697e-05],
        [6.0976e-05],
        [1.0711e-04],
        [1.8895e-04],
        [2.0504e-05],
        [3.5596e-04],
        [1.7452e-04],
        [5.3501e-04],
        [4.9949e-05],
        [3.5226e-05],
        [3.8207e-05],
        [3.4571e-05],
        [3.0661e-04],
        [8.6725e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.3842e-07],
        [7.1526e-07],
        [4.1723e-07],
        [2.9802e-07],
        [4.7684e-07],
        [7.1526e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.1723e-07],
        [7.1526e-07],
        [3.5763e-07],
        [2.9802e-07],
        [1.7881e-07],
        [2.9802e-07],
        [3.5763e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [5.9605e-07],
        [4.7684e-07],
        [3.5763e-07],
        [4.1723e-07],
        [8.9407e-07],
        [5.9605e-07],
        [4.7684e-07],
        [3.5763e-07],
        [7.1526e-07],
        [5.3644e-07],
        [4.1723e-07],
        [3.5763e-07],
        [3.5763e-07],
        [5.9605e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([7.3314e-06, 8.5115e-05, 1.0133e-05, 1.5378e-05, 2.7001e-05, 4.7624e-05,
        5.3644e-06, 8.9228e-05, 4.3809e-05, 1.3411e-04, 1.2696e-05, 9.0003e-06,
        9.6560e-06, 8.8215e-06, 7.6890e-05, 2.1935e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.4605e-04, 3.9935e-05, 1.0329e-04, 2.9385e-05, 2.3496e-04, 6.6400e-05,
         1.0109e-04, 1.1241e-04, 7.3135e-05, 2.2817e-04, 2.0480e-04, 2.4104e-04,
         9.6977e-05, 1.2076e-04, 7.2122e-05, 7.3135e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.6968e-04],
        [8.5652e-05],
        [2.2578e-04],
        [7.8976e-05],
        [2.3496e-04],
        [2.5010e-04],
        [1.5688e-04],
        [2.9612e-04],
        [3.6860e-04],
        [4.5919e-04],
        [4.3178e-04],
        [6.8140e-04],
        [2.1183e-04],
        [1.9181e-04],
        [1.3912e-04],
        [3.9387e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.6809e-05],
        [5.1856e-06],
        [1.0014e-05],
        [3.8147e-06],
        [7.4506e-06],
        [7.1526e-06],
        [4.3511e-06],
        [1.4901e-05],
        [8.2254e-06],
        [6.3777e-06],
        [5.7817e-06],
        [8.1658e-06],
        [1.6689e-05],
        [9.5963e-06],
        [4.7684e-06],
        [6.8545e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.6212e-04, 3.0279e-05, 7.8619e-05, 2.7597e-05, 8.0824e-05, 8.5771e-05,
        5.3763e-05, 1.0365e-04, 1.2565e-04, 1.5521e-04, 1.4591e-04, 2.2984e-04,
        7.6175e-05, 6.7115e-05, 4.7982e-05, 1.3351e-04], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.3804e-04],
        [3.3677e-05],
        [1.1498e-04],
        [5.3823e-05],
        [8.5771e-05],
        [9.5844e-05],
        [1.6832e-04],
        [1.6940e-04],
        [1.0276e-04],
        [3.0708e-04],
        [2.4700e-04],
        [3.4404e-04],
        [1.3435e-04],
        [2.9087e-04],
        [1.0175e-04],
        [1.3852e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.1921e-06],
        [3.5763e-07],
        [3.5763e-07],
        [2.3842e-07],
        [2.3842e-07],
        [4.7684e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.7684e-07],
        [6.5565e-07],
        [4.7684e-07],
        [8.9407e-07],
        [5.9605e-07],
        [5.9605e-07],
        [4.1723e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[5.9605e-07],
        [1.7881e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.3842e-07],
        [5.9605e-07],
        [5.3644e-07],
        [4.1723e-07],
        [7.7486e-07],
        [8.3447e-07],
        [3.5763e-07],
        [7.7486e-07],
        [3.5763e-07],
        [6.5565e-07],
        [4.1723e-07],
        [5.9605e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([3.4928e-05, 8.5831e-06, 2.8968e-05, 1.3590e-05, 2.1577e-05, 2.4199e-05,
        4.2319e-05, 4.2558e-05, 2.5988e-05, 7.7128e-05, 6.1989e-05, 8.6427e-05,
        3.3855e-05, 7.3016e-05, 2.5630e-05, 3.4869e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.0826e-04, 2.5082e-04, 6.8963e-05, 1.9312e-05, 9.3102e-05, 3.9220e-05,
         8.3625e-05, 1.2457e-05, 3.7670e-05, 3.1447e-04, 3.9649e-04, 1.5199e-04,
         8.0228e-05, 8.1301e-05, 5.2512e-05, 9.0837e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.3416e-04],
        [6.4039e-04],
        [1.7464e-04],
        [1.0729e-04],
        [2.1350e-04],
        [1.1879e-04],
        [1.5962e-04],
        [3.3140e-05],
        [1.8668e-04],
        [7.0858e-04],
        [9.3269e-04],
        [2.9111e-04],
        [1.7321e-04],
        [8.7082e-05],
        [1.1551e-04],
        [3.6073e-04]], device='cuda:0', dtype=torch.float16), tensor([[4.0531e-06],
        [1.3113e-05],
        [4.5300e-06],
        [7.5698e-06],
        [1.0610e-05],
        [5.6028e-06],
        [9.4175e-06],
        [2.2650e-06],
        [8.4639e-06],
        [1.1086e-05],
        [4.5300e-06],
        [7.8678e-06],
        [1.6212e-05],
        [1.1802e-05],
        [3.8147e-06],
        [5.6028e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.4603e-04, 2.1780e-04, 5.9724e-05, 3.8266e-05, 7.4685e-05, 4.1485e-05,
        5.6326e-05, 1.1802e-05, 6.5029e-05, 2.3985e-04, 3.1233e-04, 9.9659e-05,
        6.3121e-05, 3.2961e-05, 3.9756e-05, 1.2207e-04], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.7575e-04],
        [3.4952e-04],
        [2.5010e-04],
        [2.8729e-05],
        [8.0585e-05],
        [3.1948e-05],
        [3.0756e-04],
        [1.5497e-05],
        [6.4254e-05],
        [5.8746e-04],
        [4.2701e-04],
        [2.2280e-04],
        [1.2231e-04],
        [2.1768e-04],
        [7.8797e-05],
        [1.3089e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.1325e-06],
        [7.1526e-07],
        [7.1526e-07],
        [2.9802e-07],
        [5.3644e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.9802e-07],
        [2.9802e-07],
        [5.9605e-07],
        [5.3644e-07],
        [5.3644e-07],
        [4.7684e-07],
        [4.1723e-07],
        [5.9605e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16), tensor([[7.7486e-07],
        [1.0729e-06],
        [4.7684e-07],
        [3.5763e-07],
        [5.3644e-07],
        [4.7684e-07],
        [5.3644e-07],
        [4.7684e-07],
        [4.7684e-07],
        [1.7881e-07],
        [7.7486e-07],
        [4.1723e-07],
        [3.5763e-07],
        [5.9605e-07],
        [6.5565e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([9.4414e-05, 8.7857e-05, 6.2823e-05, 7.3314e-06, 2.0385e-05, 8.2254e-06,
        7.7128e-05, 4.0531e-06, 1.6272e-05, 1.4710e-04, 1.0705e-04, 5.5909e-05,
        3.0756e-05, 5.4657e-05, 2.0027e-05, 3.2902e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.25
Time taken to execute the de NLI task with prompt type auxiliary, variation 0 and batchsize 16: 0:03:10.568576
path ['42', 'de', 'llama', 'NLI', 'auxiliary', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI auxiliary 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 277.96it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.9217e-04, 4.3571e-05, 6.2704e-05, 1.1587e-04, 6.7353e-05, 1.3769e-05,
         8.9467e-05, 2.9385e-05, 1.4246e-04, 3.7313e-05, 6.1333e-05, 4.0948e-05,
         4.1127e-05, 7.3850e-05, 1.5783e-04, 5.9068e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.6274e-04],
        [8.1062e-05],
        [1.8680e-04],
        [1.4901e-04],
        [1.3030e-04],
        [7.4625e-05],
        [1.0127e-04],
        [8.1420e-05],
        [1.7190e-04],
        [8.4043e-05],
        [1.4603e-04],
        [1.5640e-04],
        [6.5506e-05],
        [1.3685e-04],
        [1.7202e-04],
        [4.7624e-05]], device='cuda:0', dtype=torch.float16), tensor([[6.1989e-06],
        [6.2585e-06],
        [6.0201e-06],
        [9.7156e-06],
        [9.0003e-06],
        [1.0431e-05],
        [1.4007e-05],
        [3.9935e-06],
        [9.4771e-06],
        [9.1195e-06],
        [3.9935e-06],
        [3.9935e-06],
        [4.5896e-06],
        [6.4373e-06],
        [4.8876e-06],
        [1.1921e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([8.9645e-05, 2.9087e-05, 6.4254e-05, 5.2929e-05, 4.6432e-05, 2.8372e-05,
        3.8445e-05, 2.8491e-05, 6.0439e-05, 3.1054e-05, 5.0008e-05, 5.3465e-05,
        2.3365e-05, 4.7743e-05, 5.8949e-05, 1.9848e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.3925e-04],
        [6.7174e-05],
        [1.3089e-04],
        [2.9469e-04],
        [8.8871e-05],
        [3.4571e-05],
        [1.4400e-04],
        [6.1214e-05],
        [1.9670e-04],
        [4.7207e-05],
        [8.1897e-05],
        [2.1291e-04],
        [3.2485e-05],
        [1.1194e-04],
        [2.3603e-04],
        [1.5628e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.9605e-07],
        [2.9802e-07],
        [2.3842e-07],
        [4.7684e-07],
        [4.1723e-07],
        [2.3842e-07],
        [5.3644e-07],
        [2.9802e-07],
        [7.7486e-07],
        [2.9802e-07],
        [5.3644e-07],
        [4.1723e-07],
        [3.5763e-07],
        [5.3644e-07],
        [4.7684e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[7.1526e-07],
        [4.1723e-07],
        [5.9605e-07],
        [6.5565e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [2.9802e-07],
        [5.3644e-07],
        [5.3644e-07],
        [4.7684e-07],
        [4.1723e-07],
        [1.1921e-07],
        [2.3842e-07],
        [2.9802e-07],
        [6.5565e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([6.0141e-05, 1.6987e-05, 3.2902e-05, 7.3969e-05, 2.2411e-05, 8.7619e-06,
        3.6240e-05, 1.5438e-05, 4.9472e-05, 1.2040e-05, 2.0742e-05, 5.3406e-05,
        8.2254e-06, 2.8193e-05, 5.9187e-05, 3.9339e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[4.1783e-05, 1.3518e-04, 2.4796e-05, 6.9261e-05, 2.4557e-05, 5.4359e-05,
         7.8678e-05, 6.0856e-05, 7.0393e-05, 2.2066e-04, 4.3988e-05, 4.6194e-05,
         1.6630e-05, 5.8889e-05, 1.9073e-04, 7.4208e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.0705e-04],
        [2.2638e-04],
        [6.5207e-05],
        [1.8680e-04],
        [8.3029e-05],
        [1.0115e-04],
        [1.4198e-04],
        [9.4831e-05],
        [2.1517e-04],
        [3.0160e-04],
        [1.6475e-04],
        [9.1195e-05],
        [3.1829e-05],
        [1.1307e-04],
        [2.3472e-04],
        [1.0484e-04]], device='cuda:0', dtype=torch.float16), tensor([[7.5102e-06],
        [7.2718e-06],
        [5.0664e-06],
        [6.2585e-06],
        [6.6757e-06],
        [5.0068e-06],
        [1.1623e-05],
        [7.7486e-06],
        [8.1062e-06],
        [5.4240e-06],
        [7.6294e-06],
        [3.5167e-06],
        [2.4438e-06],
        [3.8743e-06],
        [1.6391e-05],
        [2.9206e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.8207e-05, 7.7903e-05, 2.3425e-05, 6.4373e-05, 2.9922e-05, 3.5405e-05,
        5.1200e-05, 3.4213e-05, 7.4446e-05, 1.0234e-04, 5.7459e-05, 3.1590e-05,
        1.1444e-05, 3.8981e-05, 8.3685e-05, 3.5942e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.5167e-05],
        [2.4676e-04],
        [3.2842e-05],
        [9.3043e-05],
        [3.0994e-05],
        [4.4167e-05],
        [1.4246e-04],
        [5.8472e-05],
        [1.0163e-04],
        [4.9543e-04],
        [6.6042e-05],
        [7.2718e-05],
        [1.9848e-05],
        [9.0122e-05],
        [1.3399e-04],
        [1.3208e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.7684e-07],
        [2.9802e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.9802e-07],
        [5.3644e-07],
        [6.5565e-07],
        [3.5763e-07],
        [5.9605e-07],
        [3.5763e-07],
        [4.1723e-07],
        [1.2517e-06],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [5.3644e-07],
        [4.1723e-07],
        [5.9605e-07],
        [3.5763e-07],
        [4.7684e-07],
        [4.7684e-07],
        [4.7684e-07],
        [7.1526e-07],
        [6.5565e-07],
        [4.7684e-07],
        [6.5565e-07],
        [4.1723e-07],
        [4.1723e-07],
        [5.3644e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([8.9407e-06, 6.1929e-05, 8.4043e-06, 2.3544e-05, 7.9274e-06, 1.1265e-05,
        3.5822e-05, 1.4782e-05, 2.5749e-05, 1.2422e-04, 1.6689e-05, 1.8477e-05,
        5.1260e-06, 2.2769e-05, 3.3975e-05, 3.3259e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[8.1718e-05, 2.2352e-05, 5.9307e-05, 1.9026e-04, 4.8816e-05, 2.2113e-04,
         2.8205e-04, 1.2290e-04, 7.8261e-05, 5.4717e-05, 7.2658e-05, 7.6294e-05,
         2.7156e-04, 3.0589e-04, 2.2542e-04, 1.4853e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.0329e-04],
        [3.5703e-05],
        [1.2189e-04],
        [2.3401e-04],
        [1.2469e-04],
        [3.3069e-04],
        [5.5218e-04],
        [1.5414e-04],
        [1.1408e-04],
        [1.3030e-04],
        [1.1921e-04],
        [1.8442e-04],
        [4.5657e-04],
        [3.1734e-04],
        [3.1900e-04],
        [1.5116e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.8413e-06],
        [6.6757e-06],
        [1.2755e-05],
        [6.7353e-06],
        [3.8743e-06],
        [1.0848e-05],
        [3.8147e-06],
        [2.9802e-06],
        [8.2254e-06],
        [4.2915e-06],
        [8.3447e-06],
        [4.3511e-06],
        [2.4557e-05],
        [6.6757e-06],
        [1.2279e-05],
        [5.7817e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.6359e-05, 1.4126e-05, 4.4882e-05, 8.0228e-05, 4.2856e-05, 1.1384e-04,
        1.8537e-04, 5.2392e-05, 4.0770e-05, 4.4882e-05, 4.2498e-05, 6.2943e-05,
        1.6034e-04, 1.0800e-04, 1.1045e-04, 5.2333e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.2915e-05],
        [1.9550e-05],
        [1.0288e-04],
        [9.4712e-05],
        [4.3571e-05],
        [5.1212e-04],
        [2.9445e-04],
        [2.8801e-04],
        [3.0899e-04],
        [2.1982e-04],
        [7.4148e-05],
        [1.4305e-04],
        [3.0541e-04],
        [2.2471e-04],
        [3.6025e-04],
        [2.0456e-04]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [2.9802e-07],
        [4.1723e-07],
        [2.3842e-07],
        [2.9802e-07],
        [5.9605e-07],
        [5.3644e-07],
        [8.9407e-07],
        [3.5763e-07],
        [6.5565e-07],
        [4.1723e-07],
        [6.5565e-07],
        [4.1723e-07],
        [5.3644e-07],
        [7.1526e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [5.9605e-07],
        [4.1723e-07],
        [2.9802e-07],
        [3.5763e-07],
        [1.7881e-07],
        [7.7486e-07],
        [6.5565e-07],
        [5.3644e-07],
        [4.7684e-07],
        [4.7684e-07],
        [7.7486e-07],
        [4.7684e-07],
        [4.1723e-07],
        [1.0133e-06],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([1.0967e-05, 5.1260e-06, 2.5928e-05, 2.3842e-05, 1.1086e-05, 1.2827e-04,
        7.3910e-05, 7.2360e-05, 7.7486e-05, 5.5254e-05, 1.8775e-05, 3.6120e-05,
        7.6592e-05, 5.6386e-05, 9.0480e-05, 5.1379e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.2708333333333333
Time taken to execute the de NLI task with prompt type auxiliary, variation 1 and batchsize 16: 0:03:07.536237
path ['42', 'de', 'llama', 'NLI', 'auxiliary', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI auxiliary 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 322.95it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.8656e-04, 2.3782e-05, 6.2764e-05, 2.0587e-04, 2.0027e-05, 4.6670e-05,
         1.3983e-04, 6.1989e-05, 1.3053e-04, 7.1526e-05, 4.7147e-05, 3.4153e-05,
         4.4107e-05, 4.5061e-05, 6.4194e-05, 1.3530e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.1352e-04],
        [3.3379e-05],
        [1.7226e-04],
        [2.4211e-04],
        [7.9811e-05],
        [1.4377e-04],
        [1.8024e-04],
        [9.7752e-05],
        [2.0695e-04],
        [1.2350e-04],
        [6.2466e-05],
        [1.0455e-04],
        [9.3341e-05],
        [8.6844e-05],
        [1.1402e-04],
        [2.7657e-05]], device='cuda:0', dtype=torch.float16), tensor([[3.0398e-06],
        [7.5698e-06],
        [5.5432e-06],
        [1.8358e-05],
        [7.3314e-06],
        [3.5167e-06],
        [9.2387e-06],
        [7.2718e-06],
        [6.4969e-06],
        [1.1146e-05],
        [4.9472e-06],
        [7.5102e-06],
        [7.3910e-06],
        [3.3975e-06],
        [3.2187e-06],
        [1.9670e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.0550e-04, 1.3649e-05, 5.9247e-05, 8.6844e-05, 2.9027e-05, 4.9114e-05,
        6.3181e-05, 3.4988e-05, 7.1168e-05, 4.4882e-05, 2.2471e-05, 3.7372e-05,
        3.3557e-05, 3.0100e-05, 3.9101e-05, 9.8944e-06], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.9550e-04],
        [2.0623e-05],
        [8.1539e-05],
        [1.3745e-04],
        [2.6166e-05],
        [3.8564e-05],
        [1.8132e-04],
        [5.3465e-05],
        [2.2376e-04],
        [1.2165e-04],
        [3.9160e-05],
        [3.7134e-05],
        [6.7413e-05],
        [6.1095e-05],
        [1.0711e-04],
        [1.6689e-05]], device='cuda:0', dtype=torch.float16), tensor([[5.3644e-07],
        [2.9802e-07],
        [4.7684e-07],
        [1.3709e-06],
        [2.9802e-07],
        [2.3842e-07],
        [7.7486e-07],
        [3.5763e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [3.5763e-07],
        [3.5763e-07],
        [5.3644e-07],
        [4.1723e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[7.1526e-07],
        [5.9605e-07],
        [5.3644e-07],
        [6.5565e-07],
        [4.1723e-07],
        [3.5763e-07],
        [5.3644e-07],
        [4.7684e-07],
        [4.7684e-07],
        [3.5763e-07],
        [1.1921e-07],
        [2.9802e-07],
        [4.1723e-07],
        [5.9605e-07],
        [3.5763e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([4.9174e-05, 5.3644e-06, 2.0623e-05, 3.4869e-05, 6.7353e-06, 9.7752e-06,
        4.5657e-05, 1.3590e-05, 5.6148e-05, 3.0577e-05, 9.8944e-06, 9.4175e-06,
        1.7047e-05, 1.5557e-05, 2.6941e-05, 4.3511e-06], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.6536e-04, 3.7611e-05, 2.6989e-04, 1.7941e-04, 4.4942e-05, 7.7724e-05,
         6.4731e-05, 7.8380e-05, 6.1750e-05, 1.2565e-04, 1.0502e-04, 2.1827e-04,
         2.6107e-05, 8.8453e-05, 5.6863e-05, 6.8426e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.2173e-04],
        [8.3685e-05],
        [4.9067e-04],
        [2.0409e-04],
        [1.6749e-04],
        [1.0562e-04],
        [1.5903e-04],
        [1.3030e-04],
        [1.8692e-04],
        [1.7929e-04],
        [1.1492e-04],
        [3.0780e-04],
        [7.8321e-05],
        [1.5020e-04],
        [5.3227e-05],
        [1.2481e-04]], device='cuda:0', dtype=torch.float16), tensor([[7.3314e-06],
        [5.4240e-06],
        [2.3305e-05],
        [5.6624e-06],
        [3.7551e-06],
        [3.4571e-06],
        [4.0531e-06],
        [8.8811e-06],
        [5.7817e-06],
        [3.6955e-06],
        [9.0599e-06],
        [5.5432e-06],
        [4.7684e-06],
        [7.6890e-06],
        [9.7752e-06],
        [1.2457e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([7.6354e-05, 2.9683e-05, 1.7130e-04, 6.9916e-05, 5.7101e-05, 3.6359e-05,
        5.4359e-05, 4.6372e-05, 6.4254e-05, 6.0976e-05, 4.1306e-05, 1.0443e-04,
        2.7716e-05, 5.2631e-05, 2.0981e-05, 4.5776e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[8.8394e-05],
        [2.4259e-05],
        [2.5654e-04],
        [2.1386e-04],
        [1.7488e-04],
        [1.1045e-04],
        [1.2779e-04],
        [1.0675e-04],
        [1.0991e-04],
        [2.3746e-04],
        [2.5249e-04],
        [4.7302e-04],
        [4.1842e-05],
        [7.6890e-05],
        [1.7309e-04],
        [9.7215e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.3842e-07],
        [4.7684e-07],
        [4.1723e-07],
        [4.1723e-07],
        [4.1723e-07],
        [4.1723e-07],
        [6.5565e-07],
        [4.7684e-07],
        [2.3842e-07],
        [1.0133e-06],
        [5.3644e-07],
        [7.1526e-07],
        [4.1723e-07],
        [4.7684e-07],
        [4.1723e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.3842e-07],
        [4.7684e-07],
        [4.7684e-07],
        [3.5763e-07],
        [3.5763e-07],
        [5.3644e-07],
        [7.1526e-07],
        [3.5763e-07],
        [5.9605e-07],
        [7.1526e-07],
        [5.9605e-07],
        [6.5565e-07],
        [4.7684e-07],
        [5.3644e-07],
        [6.5565e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([2.2233e-05, 6.3181e-06, 6.4373e-05, 5.3644e-05, 4.3929e-05, 2.7835e-05,
        3.2306e-05, 2.6882e-05, 2.7657e-05, 5.9783e-05, 6.3419e-05, 1.1861e-04,
        1.0669e-05, 1.9491e-05, 4.3511e-05, 2.4498e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[6.2287e-05, 2.4068e-04, 7.2956e-05, 2.4557e-04, 2.7823e-04, 5.6326e-05,
         7.5936e-05, 4.7505e-05, 9.9182e-05, 1.5974e-04, 3.3557e-05, 3.1114e-05,
         5.6326e-05, 6.6698e-05, 1.0312e-05, 1.7226e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[8.4877e-05],
        [3.0899e-04],
        [1.7989e-04],
        [2.9969e-04],
        [3.1900e-04],
        [1.2887e-04],
        [1.0276e-04],
        [1.4746e-04],
        [1.0896e-04],
        [1.5545e-04],
        [7.4685e-05],
        [7.7307e-05],
        [1.1140e-04],
        [1.9693e-04],
        [5.7578e-05],
        [2.4009e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.2696e-05],
        [1.2040e-05],
        [3.2783e-06],
        [9.7752e-06],
        [6.9141e-06],
        [4.2319e-06],
        [8.5831e-06],
        [6.9141e-06],
        [4.9472e-06],
        [6.0201e-06],
        [9.1195e-06],
        [4.4703e-06],
        [5.7220e-06],
        [8.1062e-06],
        [1.2457e-05],
        [5.3048e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.2544e-05, 1.0699e-04, 6.1035e-05, 1.0318e-04, 1.0866e-04, 4.4346e-05,
        3.7134e-05, 5.1439e-05, 3.7968e-05, 5.3823e-05, 2.7955e-05, 2.7239e-05,
        3.9041e-05, 6.8367e-05, 2.3365e-05, 8.1778e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[9.9182e-05],
        [3.0780e-04],
        [7.7069e-05],
        [4.5538e-04],
        [1.9777e-04],
        [2.2280e-04],
        [2.9325e-04],
        [6.8307e-05],
        [4.6670e-05],
        [2.0802e-04],
        [4.5061e-05],
        [5.7042e-05],
        [7.4923e-05],
        [8.4043e-05],
        [2.7657e-05],
        [1.9598e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.3644e-07],
        [7.1526e-07],
        [5.3644e-07],
        [5.9605e-07],
        [6.5565e-07],
        [7.7486e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [4.7684e-07],
        [2.9802e-07],
        [2.9802e-07],
        [5.9605e-07],
        [4.7684e-07],
        [2.3842e-07],
        [5.9605e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [9.5367e-07],
        [5.3644e-07],
        [1.7881e-07],
        [5.3644e-07],
        [4.1723e-07],
        [4.7684e-07],
        [5.3644e-07],
        [4.1723e-07],
        [3.5763e-07],
        [5.3644e-07],
        [2.3842e-07],
        [2.9802e-07],
        [7.1526e-07],
        [2.3842e-07],
        [7.1526e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([2.5034e-05, 7.7367e-05, 1.9550e-05, 1.1402e-04, 4.9710e-05, 5.6028e-05,
        7.3552e-05, 1.7285e-05, 1.1861e-05, 5.2214e-05, 1.1444e-05, 1.4424e-05,
        1.8954e-05, 2.1338e-05, 7.0333e-06, 4.9353e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type auxiliary, variation 2 and batchsize 16: 0:03:06.950314
path ['42', 'de', 'llama', 'NLI', 'auxiliary', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b NLI modal 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 318.55it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.2243e-04, 1.9836e-04, 2.3961e-05, 2.4796e-05, 3.3259e-05, 2.5451e-05,
         1.7691e-04, 1.7822e-05, 1.4424e-05, 2.6584e-05, 6.2168e-05, 8.1599e-05,
         6.8367e-05, 1.9777e-04, 2.8193e-05, 5.9664e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.2922e-04],
        [3.1877e-04],
        [4.1068e-05],
        [4.7088e-05],
        [1.2660e-04],
        [2.6941e-05],
        [3.5048e-04],
        [5.4002e-05],
        [2.7835e-05],
        [1.3351e-05],
        [1.3220e-04],
        [1.0234e-04],
        [7.1108e-05],
        [2.4819e-04],
        [4.6670e-05],
        [7.3552e-05]], device='cuda:0', dtype=torch.float16), tensor([[7.2718e-06],
        [1.7941e-05],
        [3.2187e-06],
        [2.8014e-06],
        [4.2915e-06],
        [4.0531e-06],
        [1.8656e-05],
        [3.8147e-06],
        [2.8014e-06],
        [2.7418e-06],
        [3.8743e-06],
        [2.9802e-06],
        [3.5763e-06],
        [5.4240e-06],
        [3.0994e-06],
        [7.9870e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.5478e-05, 1.1224e-04, 1.4782e-05, 1.6630e-05, 4.3631e-05, 1.0312e-05,
        1.2302e-04, 1.9252e-05, 1.0192e-05, 5.3644e-06, 4.5359e-05, 3.5107e-05,
        2.4915e-05, 8.4519e-05, 1.6570e-05, 2.7180e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.9588e-04],
        [1.6379e-04],
        [1.5676e-05],
        [2.3425e-05],
        [5.0366e-05],
        [2.6047e-05],
        [2.5749e-04],
        [1.5259e-05],
        [3.1114e-05],
        [6.7294e-05],
        [6.8843e-05],
        [3.9637e-05],
        [1.0717e-04],
        [3.4308e-04],
        [5.6505e-05],
        [7.0930e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [7.1526e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.7684e-07],
        [2.3842e-07],
        [4.1723e-07],
        [2.9802e-07],
        [3.5763e-07],
        [2.9802e-07],
        [5.3644e-07],
        [4.7684e-07],
        [4.1723e-07],
        [7.1526e-07],
        [3.5763e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [5.9605e-07],
        [1.7881e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.9802e-07],
        [1.7881e-07],
        [2.3842e-07],
        [4.7684e-07],
        [2.9802e-07],
        [3.5763e-07],
        [2.9802e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([7.4148e-05, 4.1246e-05, 4.0531e-06, 6.0797e-06, 1.2815e-05, 6.6757e-06,
        6.4611e-05, 3.9935e-06, 7.9274e-06, 1.6928e-05, 1.7405e-05, 1.0133e-05,
        2.6941e-05, 8.6069e-05, 1.4305e-05, 1.7881e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[5.6386e-05, 6.2704e-05, 6.3896e-05, 4.8757e-05, 1.9968e-05, 8.4817e-05,
         3.5107e-05, 1.5438e-05, 9.8586e-05, 4.8220e-05, 1.4365e-05, 1.0729e-04,
         1.0312e-04, 6.1154e-05, 6.3658e-05, 3.9935e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.2028e-04],
        [1.8430e-04],
        [5.8532e-05],
        [1.7130e-04],
        [4.0412e-05],
        [9.1732e-05],
        [8.4221e-05],
        [5.5432e-05],
        [1.4853e-04],
        [5.3406e-05],
        [3.6299e-05],
        [2.0361e-04],
        [1.1915e-04],
        [4.7445e-05],
        [8.6486e-05],
        [5.6386e-05]], device='cuda:0', dtype=torch.float16), tensor([[6.9141e-06],
        [3.8743e-06],
        [6.8545e-06],
        [4.9472e-06],
        [4.4703e-06],
        [8.0466e-06],
        [6.0797e-06],
        [5.8413e-06],
        [6.9141e-06],
        [5.5432e-06],
        [2.6822e-06],
        [6.3181e-06],
        [4.1723e-06],
        [7.7486e-06],
        [1.5140e-05],
        [4.7088e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.2379e-05, 6.2704e-05, 2.1815e-05, 5.8770e-05, 1.4961e-05, 3.3259e-05,
        3.0100e-05, 2.0444e-05, 5.1796e-05, 1.9670e-05, 1.2994e-05, 6.9976e-05,
        4.1127e-05, 1.8418e-05, 3.3855e-05, 2.0385e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.5140e-04],
        [1.2469e-04],
        [1.3936e-04],
        [1.4818e-04],
        [1.8537e-05],
        [1.4007e-04],
        [6.5565e-05],
        [2.7001e-05],
        [2.9325e-04],
        [3.3796e-05],
        [1.3292e-05],
        [1.6677e-04],
        [9.6858e-05],
        [8.3148e-05],
        [1.0216e-04],
        [3.6359e-05]], device='cuda:0', dtype=torch.float16), tensor([[5.9605e-07],
        [2.3842e-07],
        [5.3644e-07],
        [4.7684e-07],
        [3.5763e-07],
        [5.9605e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.7684e-07],
        [4.7684e-07],
        [2.9802e-07],
        [2.3842e-07],
        [5.9605e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [4.7684e-07],
        [4.1723e-07],
        [3.5763e-07],
        [3.5763e-07],
        [3.5763e-07],
        [2.3842e-07],
        [2.9802e-07],
        [1.7881e-07],
        [2.9802e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.7684e-07],
        [2.3842e-07],
        [4.7684e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([3.8087e-05, 3.1352e-05, 3.5048e-05, 3.7253e-05, 4.8280e-06, 3.5286e-05,
        1.6570e-05, 6.9141e-06, 7.3493e-05, 8.6427e-06, 3.4571e-06, 4.1842e-05,
        2.4498e-05, 2.0981e-05, 2.5749e-05, 9.2983e-06], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[5.0128e-05, 2.2948e-05, 7.3135e-05, 4.0293e-05, 2.1100e-05, 4.0174e-05,
         3.7968e-05, 3.5524e-05, 3.8326e-05, 3.4928e-05, 1.9908e-05, 3.1114e-05,
         1.0180e-04, 6.8486e-05, 1.1849e-04, 4.2021e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.8724e-05],
        [6.1512e-05],
        [1.2839e-04],
        [2.7359e-05],
        [2.1279e-05],
        [9.0122e-05],
        [5.4538e-05],
        [4.4048e-05],
        [4.5478e-05],
        [8.3447e-05],
        [3.4034e-05],
        [5.0604e-05],
        [9.6381e-05],
        [7.1228e-05],
        [7.2777e-05],
        [3.5822e-05]], device='cuda:0', dtype=torch.float16), tensor([[6.3181e-06],
        [4.0531e-06],
        [6.5565e-06],
        [6.6757e-06],
        [5.1856e-06],
        [4.3511e-06],
        [5.4836e-06],
        [2.8014e-06],
        [7.3910e-06],
        [2.9802e-06],
        [2.1458e-06],
        [3.9339e-06],
        [5.1856e-06],
        [2.6226e-06],
        [5.0664e-06],
        [5.4240e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.5034e-05, 2.1875e-05, 4.5002e-05, 1.1325e-05, 8.8215e-06, 3.1471e-05,
        2.0027e-05, 1.5616e-05, 1.7643e-05, 2.8789e-05, 1.2040e-05, 1.8179e-05,
        3.3855e-05, 2.4617e-05, 2.5928e-05, 1.3769e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.8287e-04],
        [2.8968e-05],
        [9.1374e-05],
        [7.0632e-05],
        [2.1279e-05],
        [1.1760e-04],
        [5.8174e-05],
        [5.5075e-05],
        [3.1471e-05],
        [4.5896e-05],
        [1.7941e-05],
        [2.1756e-05],
        [7.4208e-05],
        [1.6308e-04],
        [5.9962e-05],
        [4.0591e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.3842e-07],
        [5.3644e-07],
        [4.7684e-07],
        [3.5763e-07],
        [3.5763e-07],
        [5.9605e-07],
        [4.1723e-07],
        [2.3842e-07],
        [4.1723e-07],
        [1.0729e-06],
        [2.3842e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.1723e-07],
        [2.9802e-07],
        [3.5763e-07],
        [4.7684e-07],
        [4.1723e-07],
        [4.7684e-07],
        [4.7684e-07],
        [2.9802e-07],
        [4.7684e-07],
        [3.5763e-07],
        [1.7881e-07],
        [2.3842e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([4.5896e-05, 7.3910e-06, 2.3007e-05, 1.7822e-05, 5.4836e-06, 2.9624e-05,
        1.4782e-05, 1.3947e-05, 8.0466e-06, 1.1742e-05, 4.7088e-06, 5.6028e-06,
        1.8775e-05, 4.1127e-05, 1.5080e-05, 1.0252e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.2708333333333333
Time taken to execute the de NLI task with prompt type modal, variation 0 and batchsize 16: 0:03:06.917443
path ['42', 'de', 'llama', 'NLI', 'modal', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI modal 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 303.14it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.1636e-05, 3.7730e-05, 9.6202e-05, 3.9279e-05, 1.0288e-04, 6.4969e-05,
         8.0764e-05, 1.8358e-05, 6.1154e-05, 2.4140e-05, 5.7876e-05, 3.4451e-05,
         2.4796e-05, 3.8147e-05, 1.2165e-04, 4.4525e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.5942e-05],
        [5.7340e-05],
        [1.1158e-04],
        [7.4863e-05],
        [1.5450e-04],
        [4.1783e-05],
        [7.3552e-05],
        [3.0100e-05],
        [5.3525e-05],
        [7.3195e-05],
        [7.2360e-05],
        [2.8908e-05],
        [4.7982e-05],
        [7.4089e-05],
        [1.1033e-04],
        [2.1219e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.2650e-06],
        [4.4107e-06],
        [6.0797e-06],
        [4.2319e-06],
        [6.1989e-06],
        [7.9274e-06],
        [4.4107e-06],
        [2.9802e-06],
        [2.9206e-06],
        [6.4969e-06],
        [6.5565e-06],
        [4.3511e-06],
        [3.6359e-06],
        [3.3379e-06],
        [4.5300e-06],
        [5.1856e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.2755e-05, 2.0564e-05, 3.9220e-05, 2.6345e-05, 5.3585e-05, 1.6570e-05,
        2.5988e-05, 1.1027e-05, 1.8835e-05, 2.6584e-05, 2.6286e-05, 1.1086e-05,
        1.7226e-05, 2.5809e-05, 3.8266e-05, 8.8215e-06], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.9073e-05],
        [2.5392e-05],
        [1.9503e-04],
        [1.0395e-04],
        [1.1659e-04],
        [9.3699e-05],
        [1.1086e-04],
        [4.0770e-05],
        [1.7905e-04],
        [4.1306e-05],
        [6.4671e-05],
        [3.2306e-05],
        [3.1710e-05],
        [3.3259e-05],
        [1.2743e-04],
        [5.5015e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [2.3842e-07],
        [3.5763e-07],
        [5.9605e-07],
        [5.3644e-07],
        [4.7684e-07],
        [4.1723e-07],
        [4.1723e-07],
        [1.0729e-06],
        [3.5763e-07],
        [4.1723e-07],
        [2.9802e-07],
        [3.5763e-07],
        [4.7684e-07],
        [6.5565e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [2.9802e-07],
        [2.9802e-07],
        [2.9802e-07],
        [3.5763e-07],
        [2.3842e-07],
        [2.9802e-07],
        [2.9802e-07],
        [3.5763e-07],
        [3.5763e-07],
        [2.9802e-07],
        [2.9802e-07],
        [3.5763e-07],
        [5.3644e-07],
        [4.7684e-07],
        [1.7881e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([5.0068e-06, 6.4969e-06, 4.8935e-05, 2.6226e-05, 2.9385e-05, 2.3603e-05,
        2.7895e-05, 1.0371e-05, 4.5121e-05, 1.0490e-05, 1.6332e-05, 8.2254e-06,
        8.1062e-06, 8.5831e-06, 3.2127e-05, 1.3888e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.5822e-05, 2.2888e-05, 8.7321e-05, 1.9670e-05, 4.0114e-05, 4.0174e-05,
         6.0856e-05, 6.3896e-05, 1.0353e-04, 1.1671e-04, 6.0976e-05, 1.1581e-04,
         1.3936e-04, 1.2124e-04, 8.7976e-05, 1.7226e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.4974e-05],
        [4.4882e-05],
        [1.5748e-04],
        [4.8041e-05],
        [8.4102e-05],
        [5.2869e-05],
        [9.8705e-05],
        [1.5211e-04],
        [1.4424e-04],
        [1.4853e-04],
        [1.8120e-04],
        [6.6757e-05],
        [7.2837e-05],
        [2.0456e-04],
        [1.0300e-04],
        [2.9540e-04]], device='cuda:0', dtype=torch.float16), tensor([[8.1658e-06],
        [4.6492e-06],
        [4.2915e-06],
        [3.0398e-06],
        [4.1127e-06],
        [2.8610e-06],
        [5.7817e-06],
        [3.9339e-06],
        [6.6161e-06],
        [1.5438e-05],
        [5.2452e-06],
        [6.0201e-06],
        [6.6161e-06],
        [5.2452e-06],
        [9.4175e-06],
        [1.3649e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([1.1027e-05, 1.6510e-05, 5.3942e-05, 1.7047e-05, 2.9385e-05, 1.8597e-05,
        3.4809e-05, 5.2035e-05, 5.0306e-05, 5.4657e-05, 6.2168e-05, 2.4259e-05,
        2.6464e-05, 6.9916e-05, 3.7491e-05, 1.0300e-04], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.1737e-05],
        [2.1458e-05],
        [9.9897e-05],
        [1.2934e-05],
        [4.3809e-05],
        [6.7115e-05],
        [1.4532e-04],
        [1.1063e-04],
        [2.8133e-04],
        [1.0705e-04],
        [1.5020e-04],
        [1.0043e-04],
        [6.2346e-05],
        [1.5748e-04],
        [1.3649e-04],
        [2.2733e-04]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [4.1723e-07],
        [6.5565e-07],
        [2.9802e-07],
        [5.3644e-07],
        [4.1723e-07],
        [6.5565e-07],
        [3.5763e-07],
        [5.3644e-07],
        [7.1526e-07],
        [4.7684e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.3842e-07],
        [6.5565e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [4.7684e-07],
        [4.1723e-07],
        [4.1723e-07],
        [4.1723e-07],
        [1.7881e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [1.7881e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([1.3113e-05, 5.5432e-06, 2.5213e-05, 3.3975e-06, 1.1206e-05, 1.6987e-05,
        3.6597e-05, 2.7835e-05, 7.0512e-05, 2.7061e-05, 3.7789e-05, 2.5332e-05,
        1.5736e-05, 3.9518e-05, 3.4392e-05, 5.7042e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[4.8816e-05, 6.2287e-05, 2.1696e-05, 4.9353e-05, 1.0687e-04, 3.5167e-05,
         7.1347e-05, 5.9366e-05, 2.4974e-05, 2.6166e-05, 2.9802e-05, 1.9121e-04,
         5.0128e-05, 3.6001e-05, 3.2783e-05, 4.1008e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.5313e-05],
        [8.8990e-05],
        [4.2498e-05],
        [6.3539e-05],
        [1.2279e-04],
        [4.3690e-05],
        [1.0467e-04],
        [5.5432e-05],
        [2.3305e-05],
        [9.7156e-06],
        [4.6372e-05],
        [2.1255e-04],
        [4.8399e-05],
        [1.0663e-04],
        [4.8935e-05],
        [9.9897e-05]], device='cuda:0', dtype=torch.float16), tensor([[5.7220e-06],
        [9.7156e-06],
        [3.2783e-06],
        [4.6492e-06],
        [8.3447e-06],
        [5.9009e-06],
        [2.9802e-06],
        [6.1989e-06],
        [5.1260e-06],
        [2.9206e-06],
        [2.9802e-06],
        [4.4703e-06],
        [8.0466e-06],
        [4.1127e-06],
        [3.2187e-06],
        [5.9009e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.0325e-05, 3.2902e-05, 1.5259e-05, 2.2709e-05, 4.3690e-05, 1.6510e-05,
        3.5882e-05, 2.0564e-05, 9.4771e-06, 4.2319e-06, 1.6451e-05, 7.2360e-05,
        1.8835e-05, 3.6895e-05, 1.7405e-05, 3.5286e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.6749e-04],
        [7.3493e-05],
        [1.7345e-05],
        [4.0650e-05],
        [7.7724e-05],
        [7.0393e-05],
        [4.1783e-05],
        [1.3375e-04],
        [2.3901e-05],
        [6.5744e-05],
        [1.8179e-05],
        [3.2282e-04],
        [4.3809e-05],
        [4.3273e-05],
        [5.2691e-05],
        [7.6890e-05]], device='cuda:0', dtype=torch.float16), tensor([[5.3644e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07],
        [7.1526e-07],
        [4.7684e-07],
        [4.7684e-07],
        [5.9605e-07],
        [2.9802e-07],
        [2.3842e-07],
        [3.5763e-07],
        [7.7486e-07],
        [4.1723e-07],
        [5.9605e-07],
        [4.1723e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [5.3644e-07],
        [2.9802e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07],
        [5.3644e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.3842e-07],
        [1.7881e-07],
        [3.5763e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.3842e-07],
        [1.7881e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([4.2081e-05, 1.8597e-05, 4.5300e-06, 1.0371e-05, 1.9670e-05, 1.7762e-05,
        1.0729e-05, 3.3677e-05, 6.1393e-06, 1.6570e-05, 4.6492e-06, 8.1003e-05,
        1.1146e-05, 1.1086e-05, 1.3351e-05, 1.9312e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type modal, variation 1 and batchsize 16: 0:03:07.280400
path ['42', 'de', 'llama', 'NLI', 'modal', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI modal 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 280.58it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[5.0008e-05, 6.3002e-05, 2.1875e-05, 7.2598e-05, 5.1379e-05, 1.2910e-04,
         5.4717e-05, 2.7466e-04, 5.0247e-05, 1.4174e-04, 5.3227e-05, 1.3161e-04,
         3.3855e-05, 1.6499e-04, 8.7023e-05, 7.9215e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.0550e-04],
        [1.0973e-04],
        [3.6061e-05],
        [7.0930e-05],
        [7.7248e-05],
        [1.2565e-04],
        [8.0407e-05],
        [3.8743e-04],
        [5.0485e-05],
        [1.3840e-04],
        [9.8646e-05],
        [1.3602e-04],
        [5.7757e-05],
        [9.1136e-05],
        [7.9572e-05],
        [9.1195e-05]], device='cuda:0', dtype=torch.float16), tensor([[3.9935e-06],
        [8.7023e-06],
        [4.2319e-06],
        [7.8678e-06],
        [4.5896e-06],
        [5.6028e-06],
        [6.2585e-06],
        [2.3544e-05],
        [5.9605e-06],
        [5.1260e-06],
        [4.2915e-06],
        [9.6560e-06],
        [3.7551e-06],
        [6.4373e-06],
        [7.7486e-06],
        [4.4703e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.6478e-05, 3.9458e-05, 1.3411e-05, 2.6286e-05, 2.7299e-05, 4.3750e-05,
        2.8908e-05, 1.3697e-04, 1.8835e-05, 4.7863e-05, 3.4332e-05, 4.8578e-05,
        2.0504e-05, 3.2544e-05, 2.9087e-05, 3.1888e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[7.8380e-05],
        [9.5189e-05],
        [4.0233e-05],
        [1.6069e-04],
        [1.0413e-04],
        [3.6073e-04],
        [1.9634e-04],
        [3.9029e-04],
        [5.0724e-05],
        [1.4007e-04],
        [6.6221e-05],
        [2.4676e-04],
        [2.8372e-05],
        [7.4446e-05],
        [6.2585e-05],
        [4.2677e-05]], device='cuda:0', dtype=torch.float16), tensor([[5.3644e-07],
        [4.1723e-07],
        [2.9802e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.9802e-07],
        [5.9605e-07],
        [4.7684e-07],
        [6.5565e-07],
        [2.9802e-07],
        [2.3842e-07],
        [4.7684e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [4.1723e-07],
        [2.9802e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [4.7684e-07],
        [2.3842e-07],
        [4.7684e-07],
        [5.3644e-07],
        [3.5763e-07],
        [1.7881e-07],
        [1.7881e-07],
        [2.9802e-07],
        [5.3644e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([1.9848e-05, 2.4021e-05, 1.0192e-05, 4.0412e-05, 2.6226e-05, 9.0361e-05,
        4.9293e-05, 9.7811e-05, 1.2815e-05, 3.5286e-05, 1.6809e-05, 6.1929e-05,
        7.2122e-06, 1.8716e-05, 1.5855e-05, 1.0908e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.1338e-05, 2.3901e-05, 3.7491e-05, 2.1064e-04, 3.8326e-05, 5.2035e-05,
         2.1100e-05, 7.8082e-05, 7.2718e-05, 2.8908e-05, 4.8339e-05, 1.2386e-04,
         8.8930e-05, 8.2195e-05, 5.1141e-05, 3.0041e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.7849e-05],
        [3.9458e-05],
        [3.4094e-05],
        [2.5249e-04],
        [1.0544e-04],
        [6.0022e-05],
        [7.2479e-05],
        [1.2982e-04],
        [5.0783e-05],
        [1.2517e-05],
        [3.4869e-05],
        [1.8990e-04],
        [1.2791e-04],
        [9.8944e-05],
        [6.4373e-05],
        [3.7551e-05]], device='cuda:0', dtype=torch.float16), tensor([[3.7551e-06],
        [4.5896e-06],
        [5.1260e-06],
        [1.8179e-05],
        [4.7088e-06],
        [9.2387e-06],
        [7.0930e-06],
        [8.4043e-06],
        [8.8215e-06],
        [2.3842e-06],
        [9.0003e-06],
        [8.5235e-06],
        [6.6757e-06],
        [9.3579e-06],
        [5.4836e-06],
        [2.6226e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.3888e-05, 1.4663e-05, 1.3053e-05, 9.0241e-05, 3.6716e-05, 2.3067e-05,
        2.6524e-05, 4.6074e-05, 1.9848e-05, 4.9472e-06, 1.4603e-05, 6.6161e-05,
        4.4882e-05, 3.6120e-05, 2.3305e-05, 1.3411e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.2709e-05],
        [2.3186e-05],
        [4.0054e-05],
        [2.1267e-04],
        [7.6830e-05],
        [4.8399e-05],
        [5.7340e-05],
        [1.9336e-04],
        [1.3936e-04],
        [7.4327e-05],
        [7.2837e-05],
        [1.8132e-04],
        [3.4904e-04],
        [1.0329e-04],
        [5.0545e-05],
        [3.1233e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [2.9802e-07],
        [2.3842e-07],
        [6.5565e-07],
        [4.7684e-07],
        [2.9802e-07],
        [2.3842e-07],
        [5.9605e-07],
        [4.1723e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.7684e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.3842e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [3.5763e-07],
        [3.5763e-07],
        [5.9605e-07],
        [4.1723e-07],
        [4.1723e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.3842e-07],
        [1.7881e-07],
        [2.9802e-07],
        [4.1723e-07],
        [1.7881e-07],
        [3.5763e-07],
        [4.1723e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([5.8413e-06, 5.9605e-06, 1.0133e-05, 5.3465e-05, 1.9431e-05, 1.2279e-05,
        1.4484e-05, 4.8578e-05, 3.4988e-05, 1.8716e-05, 1.8358e-05, 4.5538e-05,
        8.7440e-05, 2.5988e-05, 1.2815e-05, 8.0466e-06], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.2118e-04, 3.0935e-05, 5.3883e-05, 2.8729e-05, 4.8220e-05, 6.9976e-05,
         5.9426e-05, 4.4227e-05, 8.5235e-05, 1.6487e-04, 2.3067e-05, 9.2626e-05,
         2.0111e-04, 8.2493e-05, 4.6730e-05, 9.0837e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.7905e-04],
        [7.7903e-05],
        [1.0389e-04],
        [2.8789e-05],
        [5.7280e-05],
        [1.9181e-04],
        [1.5056e-04],
        [6.6221e-05],
        [6.4611e-05],
        [1.2040e-04],
        [4.9651e-05],
        [8.9765e-05],
        [2.2185e-04],
        [1.4651e-04],
        [1.0121e-04],
        [1.2189e-04]], device='cuda:0', dtype=torch.float16), tensor([[6.1393e-06],
        [5.5432e-06],
        [4.7088e-06],
        [5.3048e-06],
        [3.1590e-06],
        [6.3181e-06],
        [3.6955e-06],
        [4.3511e-06],
        [2.8014e-06],
        [6.9737e-06],
        [4.0531e-06],
        [4.2915e-06],
        [5.3644e-06],
        [5.0068e-06],
        [7.5102e-06],
        [1.3530e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([6.1750e-05, 2.7835e-05, 3.6180e-05, 1.1384e-05, 2.0146e-05, 6.6042e-05,
        5.1439e-05, 2.3544e-05, 2.2471e-05, 4.2439e-05, 1.7881e-05, 3.1352e-05,
        7.5758e-05, 5.0485e-05, 3.6240e-05, 4.5121e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.0218e-04],
        [4.5478e-05],
        [1.8740e-04],
        [2.3901e-05],
        [1.0616e-04],
        [3.1734e-04],
        [1.2982e-04],
        [3.1948e-05],
        [2.3627e-04],
        [1.4782e-04],
        [1.9073e-05],
        [1.2958e-04],
        [3.6860e-04],
        [1.3757e-04],
        [1.0240e-04],
        [1.3077e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.3842e-07],
        [2.9802e-07],
        [6.5565e-07],
        [2.3842e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.3842e-07],
        [2.3842e-07],
        [9.5367e-07],
        [4.1723e-07],
        [2.3842e-07],
        [4.1723e-07],
        [5.9605e-07],
        [5.3644e-07],
        [3.5763e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [4.7684e-07],
        [2.9802e-07],
        [4.7684e-07],
        [4.7684e-07],
        [3.5763e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [2.3842e-07],
        [2.3842e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([5.0664e-05, 1.1563e-05, 4.7088e-05, 6.1393e-06, 2.6762e-05, 7.9513e-05,
        3.2604e-05, 8.1062e-06, 5.9366e-05, 3.7193e-05, 4.8876e-06, 3.2544e-05,
        9.2387e-05, 3.4571e-05, 2.5749e-05, 3.2902e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.2916666666666667
Time taken to execute the de NLI task with prompt type modal, variation 2 and batchsize 16: 0:03:07.056959
path ['42', 'de', 'llama', 'NLI', 'modal', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b NLI rare_synonyms 0 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 336.14it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.5616e-05, 4.0233e-05, 1.2970e-04, 3.6895e-05, 2.5749e-05, 6.7532e-05,
         2.0385e-05, 1.1039e-04, 8.2254e-05, 3.9637e-05, 2.0266e-05, 9.4652e-05,
         1.2374e-04, 1.5557e-05, 8.3923e-05, 2.0730e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.8014e-05],
        [3.8087e-05],
        [1.5104e-04],
        [1.7118e-04],
        [4.6611e-05],
        [1.3530e-04],
        [2.1875e-05],
        [1.2290e-04],
        [5.6982e-05],
        [9.5010e-05],
        [5.1260e-05],
        [1.0848e-04],
        [1.6010e-04],
        [5.6446e-05],
        [7.3195e-05],
        [3.6955e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.6226e-06],
        [5.9009e-06],
        [4.4703e-06],
        [4.5300e-06],
        [2.8014e-06],
        [4.1127e-06],
        [5.1260e-06],
        [8.5831e-06],
        [7.5102e-06],
        [6.7949e-06],
        [4.6492e-06],
        [4.5300e-06],
        [6.1393e-06],
        [4.1723e-06],
        [3.2783e-06],
        [2.1935e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([1.0192e-05, 1.4663e-05, 5.1856e-05, 5.8591e-05, 1.6451e-05, 4.6492e-05,
        9.0003e-06, 4.3809e-05, 2.1517e-05, 3.3915e-05, 1.8656e-05, 3.7670e-05,
        5.5432e-05, 2.0206e-05, 2.5511e-05, 1.3053e-04], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.0816e-05],
        [3.8445e-05],
        [1.2046e-04],
        [9.2328e-05],
        [2.7061e-05],
        [6.9678e-05],
        [2.0981e-05],
        [1.6963e-04],
        [1.5485e-04],
        [6.8188e-05],
        [1.9312e-05],
        [3.6895e-05],
        [1.9312e-04],
        [1.5855e-05],
        [1.1879e-04],
        [2.5892e-04]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [2.9802e-07],
        [6.5565e-07],
        [5.3644e-07],
        [4.7684e-07],
        [5.3644e-07],
        [2.3842e-07],
        [6.5565e-07],
        [5.3644e-07],
        [3.5763e-07],
        [4.1723e-07],
        [4.7684e-07],
        [2.9802e-07],
        [3.5763e-07],
        [4.7684e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [2.3842e-07],
        [5.9605e-07],
        [3.5763e-07],
        [4.7684e-07],
        [2.3842e-07],
        [4.7684e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.1723e-07],
        [5.3644e-07],
        [3.5763e-07],
        [4.1723e-07],
        [3.5763e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([7.8678e-06, 9.7752e-06, 3.0398e-05, 2.3305e-05, 7.0333e-06, 1.7643e-05,
        5.4240e-06, 4.2677e-05, 3.8922e-05, 1.7226e-05, 5.0068e-06, 9.4771e-06,
        4.8459e-05, 4.1723e-06, 2.9922e-05, 6.4969e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.1517e-05, 4.6670e-05, 3.5048e-05, 1.7047e-05, 1.9324e-04, 4.9770e-05,
         2.4378e-05, 3.9637e-05, 3.7849e-05, 2.1040e-05, 6.5267e-05, 2.0885e-04,
         6.8605e-05, 9.8109e-05, 3.4690e-05, 4.1842e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.2168e-05],
        [2.5988e-05],
        [9.0241e-05],
        [4.6670e-05],
        [2.8968e-04],
        [6.1691e-05],
        [4.1366e-05],
        [4.5717e-05],
        [5.4896e-05],
        [3.3081e-05],
        [1.5903e-04],
        [2.4891e-04],
        [1.3912e-04],
        [1.5020e-04],
        [1.3137e-04],
        [7.3969e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.4107e-06],
        [7.0333e-06],
        [3.3379e-06],
        [2.5630e-06],
        [1.9073e-05],
        [6.1989e-06],
        [2.9802e-06],
        [7.4506e-06],
        [4.0531e-06],
        [2.0862e-06],
        [4.2319e-06],
        [5.7220e-06],
        [8.4043e-06],
        [6.4373e-06],
        [4.4703e-06],
        [4.4703e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.2173e-05, 1.1027e-05, 3.1173e-05, 1.6391e-05, 1.0294e-04, 2.2650e-05,
        1.4782e-05, 1.7703e-05, 1.9670e-05, 1.1742e-05, 5.4419e-05, 8.4877e-05,
        4.9174e-05, 5.2214e-05, 4.5300e-05, 2.6166e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.6226e-05],
        [8.6248e-05],
        [4.5180e-05],
        [1.4961e-05],
        [1.5616e-04],
        [6.5267e-05],
        [1.7285e-05],
        [3.4690e-05],
        [2.4199e-05],
        [1.6034e-05],
        [1.1963e-04],
        [3.3498e-04],
        [1.5891e-04],
        [1.1295e-04],
        [4.5538e-05],
        [5.3525e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [4.1723e-07],
        [5.9605e-07],
        [2.9802e-07],
        [6.5565e-07],
        [5.3644e-07],
        [2.9802e-07],
        [3.5763e-07],
        [2.3842e-07],
        [4.1723e-07],
        [2.9802e-07],
        [7.7486e-07],
        [5.9605e-07],
        [4.1723e-07],
        [4.7684e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.1723e-07],
        [2.9802e-07],
        [4.7684e-07],
        [4.1723e-07],
        [5.3644e-07],
        [4.1723e-07],
        [1.1921e-07],
        [4.1723e-07],
        [3.5763e-07],
        [4.1723e-07],
        [4.7684e-07],
        [4.1723e-07],
        [4.7684e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([6.7353e-06, 2.1756e-05, 1.1563e-05, 3.9339e-06, 3.9339e-05, 1.6570e-05,
        4.4107e-06, 8.8811e-06, 6.1989e-06, 4.2319e-06, 3.0100e-05, 8.4043e-05,
        3.9995e-05, 2.8431e-05, 1.1623e-05, 1.3530e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[6.4433e-05, 4.7684e-05, 2.5213e-05, 1.0443e-04, 4.3571e-05, 6.2823e-05,
         7.9453e-05, 8.1003e-05, 6.3717e-05, 1.5163e-04, 4.8935e-05, 1.4675e-04,
         1.7405e-05, 6.6161e-05, 1.3041e-04, 2.8729e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[7.0393e-05],
        [5.0724e-05],
        [2.8849e-05],
        [1.5497e-04],
        [5.9128e-05],
        [6.5684e-05],
        [6.7711e-05],
        [1.0908e-04],
        [4.7088e-05],
        [1.5819e-04],
        [9.9242e-05],
        [8.4043e-05],
        [5.6565e-05],
        [7.9632e-05],
        [1.3256e-04],
        [1.3947e-05]], device='cuda:0', dtype=torch.float16), tensor([[6.6757e-06],
        [2.8014e-06],
        [4.0531e-06],
        [7.3314e-06],
        [5.1260e-06],
        [7.5698e-06],
        [2.7418e-06],
        [1.5616e-05],
        [7.9274e-06],
        [5.0068e-06],
        [4.7088e-06],
        [5.3048e-06],
        [6.6757e-06],
        [7.9274e-06],
        [7.5102e-06],
        [2.1458e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.5690e-05, 1.7822e-05, 1.0967e-05, 5.4121e-05, 2.1398e-05, 2.4438e-05,
        2.3484e-05, 4.1544e-05, 1.8358e-05, 5.4419e-05, 3.4630e-05, 2.9802e-05,
        2.1100e-05, 2.9206e-05, 4.6670e-05, 5.3644e-06], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.0051e-04],
        [6.7472e-05],
        [2.3723e-05],
        [2.8276e-04],
        [4.2737e-05],
        [3.8147e-05],
        [1.7154e-04],
        [1.2028e-04],
        [8.5354e-05],
        [1.3530e-04],
        [1.3351e-04],
        [6.5148e-05],
        [2.8312e-05],
        [7.3254e-05],
        [2.8610e-04],
        [8.5115e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [3.5763e-07],
        [2.3842e-07],
        [4.7684e-07],
        [2.9802e-07],
        [5.9605e-07],
        [9.5367e-07],
        [4.1723e-07],
        [4.1723e-07],
        [5.3644e-07],
        [5.9605e-07],
        [2.3842e-07],
        [2.9802e-07],
        [4.1723e-07],
        [2.9802e-07],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [4.1723e-07],
        [3.5763e-07],
        [1.7881e-07],
        [4.7684e-07],
        [2.9802e-07],
        [3.5763e-07],
        [5.3644e-07],
        [2.3842e-07],
        [5.3644e-07],
        [2.9802e-07],
        [1.7881e-07],
        [3.5763e-07],
        [3.5763e-07],
        [3.5763e-07],
        [1.7881e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([5.0306e-05, 1.7047e-05, 6.0797e-06, 7.0870e-05, 1.0848e-05, 9.7752e-06,
        4.3213e-05, 3.0279e-05, 2.1517e-05, 3.4094e-05, 3.3617e-05, 1.6391e-05,
        7.2718e-06, 1.8477e-05, 7.1704e-05, 2.1398e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.25
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 0 and batchsize 16: 0:03:02.872161
path ['42', 'de', 'llama', 'NLI', 'rare_synonyms', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b NLI rare_synonyms 1 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 283.33it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[6.0141e-05, 1.0586e-04, 4.8637e-05, 1.3411e-05, 1.0896e-04, 1.5342e-04,
         7.7248e-05, 6.3241e-05, 2.2173e-05, 7.0751e-05, 3.6359e-05, 1.8024e-04,
         7.3254e-05, 4.3988e-05, 2.9147e-05, 7.7963e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.6280e-05],
        [1.1182e-04],
        [6.2943e-05],
        [5.5730e-05],
        [1.1241e-04],
        [1.8942e-04],
        [2.5129e-04],
        [5.2571e-05],
        [3.6657e-05],
        [1.3959e-04],
        [5.5373e-05],
        [2.0421e-04],
        [1.0157e-04],
        [1.0926e-04],
        [4.6194e-05],
        [1.1796e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.4438e-06],
        [8.1062e-06],
        [4.1723e-06],
        [7.1526e-06],
        [3.3975e-06],
        [4.2915e-06],
        [4.0531e-06],
        [6.2585e-06],
        [2.2054e-06],
        [8.7619e-06],
        [4.9472e-06],
        [8.6427e-06],
        [1.1981e-05],
        [6.2585e-06],
        [2.8014e-06],
        [5.9605e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.2888e-05, 3.9995e-05, 2.2352e-05, 2.0981e-05, 3.8624e-05, 6.4552e-05,
        8.5115e-05, 1.9610e-05, 1.2934e-05, 4.9472e-05, 2.0087e-05, 7.0930e-05,
        3.7849e-05, 3.8505e-05, 1.6332e-05, 4.1306e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.5267e-05],
        [1.6403e-04],
        [2.0862e-05],
        [1.9491e-05],
        [1.4889e-04],
        [1.0502e-04],
        [1.3030e-04],
        [8.0824e-05],
        [1.5438e-05],
        [1.5879e-04],
        [2.7657e-05],
        [3.5000e-04],
        [8.7619e-05],
        [8.0585e-05],
        [1.9133e-05],
        [4.7684e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [4.7684e-07],
        [2.9802e-07],
        [2.3842e-07],
        [4.7684e-07],
        [5.3644e-07],
        [2.3842e-07],
        [4.1723e-07],
        [4.1723e-07],
        [5.9605e-07],
        [2.9802e-07],
        [3.5763e-07],
        [3.5763e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.9802e-07],
        [4.1723e-07],
        [5.3644e-07],
        [4.7684e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.7684e-07],
        [3.5763e-07],
        [4.1723e-07],
        [5.3644e-07],
        [3.5763e-07],
        [1.1921e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([1.6510e-05, 4.1246e-05, 5.3644e-06, 5.0068e-06, 3.7432e-05, 2.6524e-05,
        3.2783e-05, 2.0385e-05, 4.0531e-06, 3.9935e-05, 7.0930e-06, 8.7678e-05,
        2.2113e-05, 2.0325e-05, 4.8876e-06, 1.2100e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[4.3452e-05, 4.4882e-05, 2.3246e-05, 6.0499e-05, 4.3511e-05, 9.5844e-05,
         2.6762e-05, 1.1945e-04, 3.6478e-05, 1.6391e-05, 2.5773e-04, 1.1671e-04,
         2.9385e-05, 2.3901e-05, 1.0556e-04, 4.9591e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.4138e-04],
        [4.9412e-05],
        [3.0220e-05],
        [5.4717e-05],
        [3.3081e-05],
        [1.3340e-04],
        [5.3644e-05],
        [1.8799e-04],
        [8.1599e-05],
        [4.3631e-05],
        [3.1233e-04],
        [1.9169e-04],
        [4.5121e-05],
        [9.4175e-05],
        [1.9491e-04],
        [8.4043e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.5300e-06],
        [8.1658e-06],
        [5.0664e-06],
        [4.5300e-06],
        [2.5034e-06],
        [6.8545e-06],
        [2.6226e-06],
        [5.7817e-06],
        [2.6822e-06],
        [2.9802e-06],
        [5.1260e-06],
        [8.3447e-06],
        [3.5167e-06],
        [5.4240e-06],
        [4.3511e-06],
        [4.6492e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.8637e-05, 1.9193e-05, 1.1742e-05, 1.9729e-05, 1.1861e-05, 4.6730e-05,
        1.8775e-05, 6.4611e-05, 2.8074e-05, 1.5557e-05, 1.0580e-04, 6.6698e-05,
        1.6212e-05, 3.3200e-05, 6.6400e-05, 2.9564e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.1975e-05],
        [5.2512e-05],
        [2.3067e-05],
        [3.3796e-05],
        [5.8293e-05],
        [1.8954e-04],
        [2.0206e-05],
        [1.1182e-04],
        [4.8339e-05],
        [1.8001e-05],
        [4.5252e-04],
        [3.0875e-04],
        [2.3246e-05],
        [3.2961e-05],
        [1.1063e-04],
        [5.4479e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [4.7684e-07],
        [2.3842e-07],
        [4.7684e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.1723e-07],
        [2.9802e-07],
        [2.9802e-07],
        [7.7486e-07],
        [4.7684e-07],
        [2.9802e-07],
        [2.3842e-07],
        [4.7684e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [3.5763e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.3842e-07],
        [4.1723e-07],
        [2.9802e-07],
        [4.1723e-07],
        [3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.3842e-07],
        [3.5763e-07],
        [3.5763e-07],
        [2.3842e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([1.3232e-05, 1.3351e-05, 5.9605e-06, 8.6427e-06, 1.4722e-05, 4.7565e-05,
        5.1856e-06, 2.8133e-05, 1.2279e-05, 4.6492e-06, 1.1343e-04, 7.7367e-05,
        5.9605e-06, 8.4043e-06, 2.7835e-05, 1.3828e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[5.0664e-05, 7.5221e-05, 1.5712e-04, 2.5153e-05, 2.7537e-04, 3.7968e-05,
         3.0661e-04, 1.7929e-04, 5.7638e-05, 1.4365e-04, 5.2214e-05, 5.3823e-05,
         8.3864e-05, 2.1946e-04, 1.7285e-05, 1.3685e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[9.9957e-05],
        [8.3923e-05],
        [9.6798e-05],
        [4.3333e-05],
        [4.8518e-04],
        [5.4777e-05],
        [4.1556e-04],
        [3.7098e-04],
        [2.0838e-04],
        [1.7953e-04],
        [1.0508e-04],
        [8.4460e-05],
        [1.0115e-04],
        [2.2471e-04],
        [5.2333e-05],
        [1.3113e-04]], device='cuda:0', dtype=torch.float16), tensor([[4.4107e-06],
        [4.1723e-06],
        [3.9339e-06],
        [3.5167e-06],
        [2.2590e-05],
        [2.9206e-06],
        [1.7524e-05],
        [9.1195e-06],
        [5.3048e-06],
        [7.2122e-06],
        [2.6226e-06],
        [3.2187e-06],
        [3.0398e-06],
        [5.3048e-06],
        [3.4571e-06],
        [3.3975e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.4809e-05, 2.9385e-05, 3.3557e-05, 1.5616e-05, 1.6928e-04, 1.9252e-05,
        1.4436e-04, 1.2672e-04, 7.1228e-05, 6.2227e-05, 3.5882e-05, 2.9206e-05,
        3.4750e-05, 7.6652e-05, 1.8597e-05, 4.4823e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.3137e-04],
        [4.1902e-05],
        [5.2214e-05],
        [1.7822e-05],
        [3.4404e-04],
        [3.3498e-05],
        [2.2650e-04],
        [2.1386e-04],
        [1.3566e-04],
        [1.6856e-04],
        [6.5207e-05],
        [2.0921e-05],
        [4.2319e-05],
        [1.0949e-04],
        [1.4067e-05],
        [2.1696e-04]], device='cuda:0', dtype=torch.float16), tensor([[5.9605e-07],
        [2.3842e-07],
        [2.3842e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.7684e-07],
        [6.5565e-07],
        [2.3842e-07],
        [4.1723e-07],
        [5.9605e-07],
        [5.9605e-07],
        [2.3842e-07],
        [4.1723e-07],
        [4.1723e-07],
        [2.9802e-07],
        [1.0729e-06]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [4.7684e-07],
        [1.7881e-07],
        [3.5763e-07],
        [4.7684e-07],
        [4.7684e-07],
        [6.5565e-07],
        [4.1723e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.7684e-07],
        [3.5763e-07],
        [5.3644e-07],
        [5.9605e-07],
        [4.1723e-07],
        [4.7684e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([3.3081e-05, 1.0669e-05, 1.3173e-05, 4.6492e-06, 8.6248e-05, 8.5831e-06,
        5.6982e-05, 5.3644e-05, 3.4094e-05, 4.2379e-05, 1.6570e-05, 5.3644e-06,
        1.0848e-05, 2.7657e-05, 3.6955e-06, 5.4598e-05], device='cuda:0',
       dtype=torch.float16)
acc:  0.25
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 1 and batchsize 16: 0:03:02.199338
path ['42', 'de', 'llama', 'NLI', 'rare_synonyms', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b NLI rare_synonyms 2 50 16 --------------
Loading NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 297.66it/s]
NLI dataset loaded
len of entail_examples , neutral_examples, contra_examples:  16 16 16
len dataset  48
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.8670e-05, 4.2915e-05, 2.2388e-04, 2.3842e-05, 3.7193e-05, 7.0453e-05,
         9.8586e-05, 3.0458e-05, 2.2101e-04, 1.6809e-05, 1.2875e-04, 1.2684e-04,
         7.2598e-05, 1.1104e-04, 6.8367e-05, 3.4094e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.9889e-05],
        [9.2208e-05],
        [3.6407e-04],
        [3.0696e-05],
        [4.2319e-05],
        [1.5998e-04],
        [1.5450e-04],
        [5.4717e-05],
        [4.0960e-04],
        [3.4690e-05],
        [1.2672e-04],
        [1.5366e-04],
        [1.0520e-04],
        [1.2839e-04],
        [5.6982e-05],
        [1.8477e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.6226e-06],
        [4.3511e-06],
        [1.8120e-05],
        [4.0531e-06],
        [2.6822e-06],
        [3.9935e-06],
        [7.8678e-06],
        [4.2319e-06],
        [2.1040e-05],
        [2.8014e-06],
        [7.2718e-06],
        [4.2319e-06],
        [1.4067e-05],
        [8.4043e-06],
        [9.1195e-06],
        [2.3246e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.7524e-05, 3.2187e-05, 1.2743e-04, 1.1563e-05, 1.5020e-05, 5.4657e-05,
        5.4121e-05, 1.9670e-05, 1.4353e-04, 1.2517e-05, 4.4644e-05, 5.2631e-05,
        3.9756e-05, 4.5598e-05, 2.2054e-05, 6.9141e-06], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.8431e-05],
        [1.2898e-04],
        [1.7953e-04],
        [2.2531e-05],
        [5.7161e-05],
        [7.1824e-05],
        [1.0955e-04],
        [3.0935e-05],
        [2.8372e-04],
        [3.7074e-05],
        [2.6727e-04],
        [1.1110e-04],
        [1.0705e-04],
        [1.7750e-04],
        [8.6427e-05],
        [7.4267e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [6.5565e-07],
        [7.7486e-07],
        [2.9802e-07],
        [4.1723e-07],
        [5.9605e-07],
        [5.3644e-07],
        [2.9802e-07],
        [4.1723e-07],
        [4.1723e-07],
        [3.5763e-07],
        [5.9605e-07],
        [4.1723e-07],
        [7.7486e-07],
        [4.7684e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [2.9802e-07],
        [5.9605e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.3842e-07],
        [2.9802e-07],
        [3.5763e-07],
        [3.5763e-07],
        [2.9802e-07],
        [3.5763e-07],
        [5.3644e-07],
        [4.1723e-07],
        [3.5763e-07],
        [2.3842e-07],
        [1.7881e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([7.3314e-06, 3.2485e-05, 4.5240e-05, 5.7817e-06, 1.4484e-05, 1.8179e-05,
        2.7597e-05, 7.8678e-06, 7.1108e-05, 9.4175e-06, 6.6996e-05, 2.8074e-05,
        2.6941e-05, 4.4644e-05, 2.1815e-05, 1.8716e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.1408e-04, 5.5671e-05, 2.4021e-05, 3.4273e-05, 6.5923e-05, 1.5259e-05,
         5.0306e-05, 1.7822e-05, 2.1875e-05, 3.0518e-05, 3.6001e-05, 1.9765e-04,
         4.2498e-05, 5.4240e-05, 2.2948e-05, 1.5914e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.0814e-04],
        [7.4089e-05],
        [7.0035e-05],
        [6.4552e-05],
        [8.0287e-05],
        [5.8830e-05],
        [3.6180e-05],
        [5.4300e-05],
        [7.0453e-05],
        [1.2696e-04],
        [9.9421e-05],
        [2.4796e-04],
        [5.6088e-05],
        [2.4414e-04],
        [4.7088e-05],
        [6.5625e-05]], device='cuda:0', dtype=torch.float16), tensor([[6.2585e-06],
        [6.4373e-06],
        [4.1723e-06],
        [5.1260e-06],
        [8.1062e-06],
        [4.7684e-06],
        [6.7949e-06],
        [2.3842e-06],
        [3.7551e-06],
        [4.3511e-06],
        [3.2187e-06],
        [5.8413e-06],
        [5.0664e-06],
        [3.6359e-06],
        [2.3842e-06],
        [4.0531e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([7.1466e-05, 2.6822e-05, 2.4736e-05, 2.3246e-05, 2.9445e-05, 2.1219e-05,
        1.4305e-05, 1.8895e-05, 2.4736e-05, 4.3750e-05, 3.4213e-05, 8.4579e-05,
        2.0385e-05, 8.2612e-05, 1.6510e-05, 2.3246e-05], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.7810e-04],
        [2.2149e-04],
        [2.0623e-05],
        [3.0518e-05],
        [7.9811e-05],
        [2.2769e-05],
        [6.3419e-05],
        [1.8060e-05],
        [2.6107e-05],
        [4.0710e-05],
        [4.2439e-05],
        [3.0375e-04],
        [2.8908e-05],
        [8.7023e-05],
        [1.9491e-05],
        [1.7285e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.9802e-07],
        [4.7684e-07],
        [4.1723e-07],
        [3.5763e-07],
        [4.7684e-07],
        [2.9802e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.7684e-07],
        [6.5565e-07],
        [7.1526e-07],
        [5.9605e-07],
        [5.3644e-07],
        [4.1723e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16), tensor([[3.5763e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.9802e-07],
        [2.9802e-07],
        [2.9802e-07],
        [2.3842e-07],
        [3.5763e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.7684e-07],
        [3.5763e-07],
        [2.9802e-07],
        [2.3842e-07],
        [4.1723e-07],
        [3.5763e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([4.4703e-05, 5.5552e-05, 5.3644e-06, 7.8082e-06, 2.0146e-05, 5.8413e-06,
        1.6034e-05, 4.7088e-06, 6.6757e-06, 1.0371e-05, 1.0908e-05, 7.6175e-05,
        7.4506e-06, 2.1935e-05, 5.0664e-06, 4.5300e-06], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.0383e-04, 4.8280e-05, 8.1599e-05, 3.1114e-05, 3.2067e-05, 7.1943e-05,
         1.2255e-04, 5.8711e-05, 3.5524e-05, 2.4796e-05, 6.3002e-05, 7.3910e-05,
         1.4079e-04, 2.9504e-05, 7.7188e-05, 1.9729e-05]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.4758e-04],
        [6.2585e-05],
        [1.1504e-04],
        [5.4657e-05],
        [7.5996e-05],
        [7.2658e-05],
        [8.5354e-05],
        [1.2195e-04],
        [7.0393e-05],
        [3.7134e-05],
        [1.7941e-04],
        [6.9439e-05],
        [1.4472e-04],
        [5.1677e-05],
        [8.3804e-05],
        [2.3782e-05]], device='cuda:0', dtype=torch.float16), tensor([[6.4969e-06],
        [5.6028e-06],
        [2.5630e-06],
        [4.5896e-06],
        [5.5432e-06],
        [6.7949e-06],
        [5.0664e-06],
        [6.7353e-06],
        [2.6226e-06],
        [2.9206e-06],
        [3.8743e-06],
        [3.3379e-06],
        [4.1127e-06],
        [5.9605e-06],
        [2.8014e-06],
        [5.3644e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([5.1379e-05, 2.2709e-05, 3.9220e-05, 1.9729e-05, 2.7180e-05, 2.6464e-05,
        3.0160e-05, 4.2915e-05, 2.4319e-05, 1.3351e-05, 6.1095e-05, 2.4259e-05,
        4.9591e-05, 1.9193e-05, 2.8849e-05, 9.7156e-06], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id: [1, 325, 11381, 1428] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.0637e-04],
        [6.2585e-05],
        [3.6061e-05],
        [2.1577e-05],
        [6.6042e-05],
        [1.2994e-04],
        [6.1154e-05],
        [1.5175e-04],
        [5.5075e-05],
        [1.8537e-05],
        [1.1408e-04],
        [1.0961e-04],
        [1.2469e-04],
        [2.6286e-05],
        [1.8585e-04],
        [2.1398e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.7684e-07],
        [4.7684e-07],
        [4.7684e-07],
        [2.3842e-07],
        [2.9802e-07],
        [4.7684e-07],
        [2.9802e-07],
        [5.9605e-07],
        [2.9802e-07],
        [3.5763e-07],
        [2.3842e-07],
        [4.7684e-07],
        [5.3644e-07],
        [4.1723e-07],
        [1.1921e-06],
        [2.9802e-07]], device='cuda:0', dtype=torch.float16), tensor([[1.7881e-07],
        [3.5763e-07],
        [4.1723e-07],
        [2.9802e-07],
        [2.3842e-07],
        [3.5763e-07],
        [1.7881e-07],
        [4.1723e-07],
        [2.9802e-07],
        [1.1921e-07],
        [3.5763e-07],
        [2.9802e-07],
        [4.7684e-07],
        [3.5763e-07],
        [4.1723e-07],
        [4.1723e-07]], device='cuda:0', dtype=torch.float16)] -> tensor([7.6771e-05, 1.5855e-05, 9.2387e-06, 5.5432e-06, 1.6630e-05, 3.2663e-05,
        1.5378e-05, 3.8207e-05, 1.3947e-05, 4.7684e-06, 2.8670e-05, 2.7597e-05,
        3.1412e-05, 6.7949e-06, 4.6849e-05, 5.5432e-06], device='cuda:0',
       dtype=torch.float16)
acc:  0.25
Time taken to execute the de NLI task with prompt type rare_synonyms, variation 2 and batchsize 16: 0:03:01.011603
path ['42', 'de', 'llama', 'NLI', 'rare_synonyms', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA active 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  9.14it/s]100%|██████████| 3/3 [00:00<00:00, 25.28it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.3711e-04, 9.7561e-04, 8.2016e-04, 4.9543e-04, 1.1415e-03, 2.3568e-04,
         8.3983e-05, 2.7313e-03, 1.9522e-03, 1.1196e-03, 2.0313e-03, 1.2770e-03,
         6.2943e-03, 1.1391e-02, 6.0916e-05, 2.6493e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.6812e-04],
        [6.3610e-04],
        [1.5986e-04],
        [3.8266e-04],
        [4.3511e-04],
        [1.3065e-04],
        [3.6716e-05],
        [8.0109e-04],
        [6.6423e-04],
        [1.3588e-02],
        [4.0007e-04],
        [1.0023e-03],
        [1.5039e-03],
        [4.5662e-03],
        [1.9610e-05],
        [1.4181e-03]], device='cuda:0', dtype=torch.float16), tensor([[6.0797e-06],
        [1.0252e-05],
        [5.0068e-06],
        [1.1861e-05],
        [8.0466e-06],
        [1.6093e-06],
        [3.2783e-06],
        [1.0252e-05],
        [9.2983e-06],
        [1.1325e-05],
        [7.4506e-06],
        [1.4246e-05],
        [6.2466e-05],
        [5.2214e-05],
        [1.1802e-05],
        [9.2983e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.2469e-04, 2.1541e-04, 5.4955e-05, 1.3149e-04, 1.4770e-04, 4.4107e-05,
        1.3351e-05, 2.7037e-04, 2.2447e-04, 4.5319e-03, 1.3590e-04, 3.3879e-04,
        5.2214e-04, 1.5392e-03, 1.0490e-05, 4.7588e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0005, 0.0004, 0.0014, 0.0019, 0.0009, 0.0004, 0.0008, 0.0003, 0.0002,
         0.0003, 0.0014, 0.0003, 0.0002, 0.0002, 0.0015, 0.0018]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.9710e-05],
        [1.8227e-04],
        [3.2926e-04],
        [1.0759e-04],
        [3.9864e-04],
        [2.7227e-04],
        [7.5042e-05],
        [6.7532e-05],
        [1.4257e-04],
        [4.3297e-04],
        [1.0147e-03],
        [3.5119e-04],
        [1.8132e-04],
        [3.0923e-04],
        [7.1955e-04],
        [1.3227e-03]], device='cuda:0', dtype=torch.float16), tensor([[5.0664e-06],
        [2.7418e-06],
        [1.0431e-05],
        [8.0466e-06],
        [6.4969e-06],
        [8.2850e-06],
        [7.4506e-06],
        [5.3048e-06],
        [7.4506e-06],
        [6.7353e-06],
        [1.1742e-05],
        [8.1062e-06],
        [1.0550e-05],
        [5.1260e-06],
        [1.1265e-05],
        [2.3842e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.8239e-05, 6.1691e-05, 1.1325e-04, 3.8564e-05, 1.3506e-04, 9.3520e-05,
        2.7478e-05, 2.4259e-05, 5.0008e-05, 1.4663e-04, 3.4213e-04, 1.1975e-04,
        6.3956e-05, 1.0478e-04, 2.4366e-04, 4.4179e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.3522e-04, 1.5247e-04, 6.3801e-04, 8.2207e-04, 1.5268e-03, 3.5787e-04,
         6.0511e-04, 3.6168e-04, 2.2564e-03, 8.0764e-05, 9.6273e-04, 2.0587e-04,
         6.2943e-04, 6.8724e-05, 7.5388e-04, 1.6689e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.7253e-05],
        [6.2943e-05],
        [5.0187e-05],
        [1.6248e-04],
        [5.1737e-04],
        [7.9989e-05],
        [2.0671e-04],
        [1.8835e-04],
        [2.2736e-03],
        [5.2452e-05],
        [6.6710e-04],
        [7.6473e-05],
        [3.0613e-04],
        [4.2439e-05],
        [1.6880e-04],
        [1.6332e-04]], device='cuda:0', dtype=torch.float16), tensor([[3.5167e-06],
        [2.9802e-06],
        [2.5630e-06],
        [3.6359e-06],
        [2.3246e-06],
        [5.5432e-06],
        [4.7088e-06],
        [4.2915e-06],
        [2.5392e-05],
        [3.8147e-06],
        [1.1802e-05],
        [3.6955e-06],
        [7.9274e-06],
        [4.8876e-06],
        [3.0994e-06],
        [4.3511e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.3590e-05, 2.1994e-05, 1.7583e-05, 5.5373e-05, 1.7321e-04, 2.8491e-05,
        7.0453e-05, 6.4194e-05, 7.6628e-04, 1.8775e-05, 2.2626e-04, 2.6703e-05,
        1.0467e-04, 1.5795e-05, 5.7280e-05, 5.5909e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0004, 0.0125]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0001],
        [0.0024]], device='cuda:0', dtype=torch.float16), tensor([[6.3777e-06],
        [1.1146e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([4.5419e-05, 8.1825e-04], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type active, variation 0 and batchsize 16: 0:03:36.086059
path ['42', 'de', 'llama', 'SA', 'active', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA active 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 308.37it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[4.0507e-04, 2.8920e-04, 1.4210e-03, 5.9366e-05, 3.3855e-04, 1.0500e-03,
         1.2001e-02, 4.1127e-04, 3.4499e-04, 1.0309e-03, 1.9848e-04, 3.7050e-04,
         7.6723e-04, 2.2373e-03, 4.5919e-04, 1.4023e-02]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.9678e-05],
        [3.2711e-04],
        [8.3542e-04],
        [1.6272e-05],
        [2.4438e-05],
        [5.2929e-05],
        [1.9894e-03],
        [6.3121e-05],
        [9.1493e-05],
        [4.2498e-05],
        [9.4056e-05],
        [1.6117e-04],
        [3.0470e-04],
        [3.9005e-04],
        [2.2292e-04],
        [3.0804e-03]], device='cuda:0', dtype=torch.float16), tensor([[5.2452e-06],
        [4.5300e-06],
        [1.0431e-05],
        [1.2696e-05],
        [2.5034e-06],
        [5.3048e-06],
        [1.0073e-05],
        [4.7088e-06],
        [5.8413e-06],
        [2.3842e-06],
        [7.6890e-06],
        [4.7088e-06],
        [6.7949e-06],
        [6.3777e-06],
        [6.8545e-06],
        [5.6505e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([2.4974e-05, 1.1057e-04, 2.8205e-04, 9.6560e-06, 9.0003e-06, 1.9431e-05,
        6.6662e-04, 2.2590e-05, 3.2425e-05, 1.4961e-05, 3.3915e-05, 5.5313e-05,
        1.0383e-04, 1.3208e-04, 7.6592e-05, 1.0452e-03], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.4420e-03, 1.6022e-03, 3.8028e-04, 1.6224e-04, 1.2360e-03, 1.5850e-03,
         4.8065e-04, 1.0910e-03, 1.6868e-04, 1.1139e-03, 1.7328e-03, 4.1008e-04,
         1.9970e-03, 4.0817e-03, 7.3910e-05, 4.5624e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.0292e-02],
        [6.0606e-04],
        [3.3975e-04],
        [4.6492e-05],
        [1.5140e-04],
        [8.7214e-04],
        [2.7442e-04],
        [1.5020e-04],
        [1.4186e-04],
        [1.5545e-04],
        [6.9475e-04],
        [3.0184e-04],
        [9.7930e-05],
        [9.0933e-04],
        [3.1412e-05],
        [7.9250e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.0312e-05],
        [1.0014e-05],
        [1.0490e-05],
        [2.7418e-06],
        [4.3511e-06],
        [1.1921e-05],
        [7.8082e-06],
        [4.1127e-06],
        [4.3511e-06],
        [2.7418e-06],
        [8.6427e-06],
        [6.4373e-06],
        [7.5698e-06],
        [4.1306e-05],
        [3.2783e-06],
        [8.2850e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.4332e-03, 2.0540e-04, 1.1677e-04, 1.6391e-05, 5.1916e-05, 2.9469e-04,
        9.4056e-05, 5.1439e-05, 4.8757e-05, 5.2750e-05, 2.3448e-04, 1.0276e-04,
        3.5167e-05, 3.1686e-04, 1.1563e-05, 2.6703e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.8114e-03, 1.3506e-04, 2.2709e-04, 4.1938e-04, 3.1567e-03, 2.6917e-04,
         6.0606e-04, 9.9468e-04, 2.2328e-04, 1.6129e-04, 7.5102e-05, 8.5175e-05,
         1.1902e-03, 1.0357e-03, 3.7098e-04, 1.0862e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.2240e-03],
        [4.0054e-05],
        [8.1420e-05],
        [1.2994e-04],
        [1.4334e-03],
        [1.6594e-04],
        [4.5300e-04],
        [6.4671e-05],
        [2.1768e-04],
        [1.2708e-04],
        [3.8266e-05],
        [5.2631e-05],
        [3.3903e-04],
        [3.0780e-04],
        [1.1903e-04],
        [3.4428e-04]], device='cuda:0', dtype=torch.float16), tensor([[3.0875e-05],
        [2.7418e-06],
        [1.3709e-06],
        [4.3511e-06],
        [3.8743e-06],
        [9.5963e-06],
        [1.6212e-05],
        [5.7817e-06],
        [5.9605e-06],
        [3.6359e-06],
        [4.4703e-06],
        [4.3511e-06],
        [8.5831e-06],
        [9.0599e-06],
        [2.2054e-06],
        [2.3842e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([7.5150e-04, 1.4246e-05, 2.7597e-05, 4.4763e-05, 4.7898e-04, 5.8532e-05,
        1.5640e-04, 2.3484e-05, 7.4565e-05, 4.3571e-05, 1.4246e-05, 1.9014e-05,
        1.1587e-04, 1.0562e-04, 4.0412e-05, 1.1557e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0013, 0.0004]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0002],
        [0.0002]], device='cuda:0', dtype=torch.float16), tensor([[9.8348e-06],
        [1.6272e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([7.8678e-05, 7.4446e-05], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type active, variation 1 and batchsize 16: 0:03:33.341137
path ['42', 'de', 'llama', 'SA', 'active', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA active 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 344.17it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0020, 0.0002, 0.0003, 0.0002, 0.0011, 0.0005, 0.0004, 0.0048, 0.0007,
         0.0006, 0.0017, 0.0003, 0.0005, 0.0003, 0.0003, 0.0016]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0008],
        [0.0002],
        [0.0001],
        [0.0002],
        [0.0003],
        [0.0002],
        [0.0002],
        [0.0014],
        [0.0003],
        [0.0004],
        [0.0006],
        [0.0002],
        [0.0003],
        [0.0003],
        [0.0001],
        [0.0011]], device='cuda:0', dtype=torch.float16), tensor([[1.2398e-05],
        [4.2319e-06],
        [3.8743e-06],
        [1.1802e-05],
        [7.5102e-06],
        [2.2054e-06],
        [5.4240e-06],
        [6.9261e-05],
        [8.4639e-06],
        [9.1195e-06],
        [1.1206e-05],
        [1.8418e-05],
        [1.4544e-05],
        [5.7220e-06],
        [7.9274e-06],
        [1.8418e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([2.6846e-04, 5.4717e-05, 3.4988e-05, 6.4075e-05, 9.7930e-05, 5.2691e-05,
        5.4002e-05, 4.7731e-04, 1.0842e-04, 1.4341e-04, 2.0349e-04, 7.7963e-05,
        9.2030e-05, 1.0651e-04, 4.3154e-05, 3.8028e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.5030e-03, 1.0672e-03, 1.4305e-03, 1.2749e-02, 8.0049e-05, 1.2302e-03,
         4.3750e-04, 1.6623e-03, 4.6492e-04, 1.7456e-02, 1.4477e-03, 6.6233e-04,
         1.0977e-03, 3.6449e-03, 6.0701e-04, 2.1899e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[7.0076e-03],
        [4.3631e-04],
        [9.3842e-04],
        [1.4105e-03],
        [3.3379e-05],
        [3.4046e-04],
        [1.0824e-04],
        [4.7994e-04],
        [3.9315e-04],
        [5.1765e-03],
        [2.7537e-04],
        [9.8825e-05],
        [8.4209e-04],
        [2.9869e-03],
        [5.0902e-05],
        [1.6665e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.4305e-05],
        [2.9206e-06],
        [1.3113e-05],
        [1.2338e-05],
        [3.3975e-06],
        [1.5080e-05],
        [6.2585e-06],
        [1.1981e-05],
        [1.3888e-05],
        [5.9724e-05],
        [9.4175e-06],
        [9.8944e-06],
        [2.4378e-05],
        [3.7432e-05],
        [6.3777e-06],
        [5.2452e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.3403e-03, 1.4639e-04, 3.1710e-04, 4.7421e-04, 1.2279e-05, 1.1849e-04,
        3.8147e-05, 1.6403e-04, 1.3566e-04, 1.7452e-03, 9.4950e-05, 3.6240e-05,
        2.8872e-04, 1.0080e-03, 1.9073e-05, 5.7280e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[4.3535e-04, 3.7575e-04, 2.8572e-03, 2.6822e-04, 1.3132e-03, 2.5444e-03,
         9.8765e-05, 7.4768e-04, 8.5068e-04, 1.6665e-04, 1.6546e-04, 8.7643e-04,
         4.8339e-05, 5.0592e-04, 1.0604e-04, 1.0204e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.1855e-04],
        [2.6047e-05],
        [7.8726e-04],
        [1.2374e-04],
        [8.3089e-05],
        [1.4162e-03],
        [4.4942e-05],
        [1.2422e-04],
        [7.6950e-05],
        [2.1183e-04],
        [4.9710e-05],
        [1.1361e-04],
        [2.5332e-05],
        [2.4176e-04],
        [7.5519e-05],
        [5.7459e-05]], device='cuda:0', dtype=torch.float16), tensor([[7.3314e-06],
        [2.4438e-06],
        [8.5831e-06],
        [9.9540e-06],
        [1.0371e-05],
        [5.5432e-06],
        [6.7949e-06],
        [3.3975e-06],
        [5.2452e-06],
        [5.7817e-06],
        [3.5167e-06],
        [5.0068e-06],
        [2.0802e-05],
        [1.2636e-05],
        [8.8811e-06],
        [3.1590e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.1962e-05, 9.4771e-06, 2.6536e-04, 4.4584e-05, 3.1173e-05, 4.7398e-04,
        1.7226e-05, 4.2558e-05, 2.7418e-05, 7.2539e-05, 1.7762e-05, 3.9518e-05,
        1.5378e-05, 8.4817e-05, 2.8133e-05, 2.0206e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0015, 0.0004]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0005],
        [0.0002]], device='cuda:0', dtype=torch.float16), tensor([[1.1206e-05],
        [3.3379e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.5581e-04, 5.1439e-05], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type active, variation 2 and batchsize 16: 0:03:35.870572
path ['42', 'de', 'llama', 'SA', 'active', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA passive 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 373.99it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0004, 0.0020, 0.0006, 0.0008, 0.0007, 0.0004, 0.0022, 0.0028, 0.0044,
         0.0004, 0.0026, 0.0008, 0.0036, 0.0024, 0.0003, 0.0007]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0003],
        [0.0012],
        [0.0004],
        [0.0003],
        [0.0003],
        [0.0003],
        [0.0009],
        [0.0006],
        [0.0017],
        [0.0003],
        [0.0012],
        [0.0003],
        [0.0012],
        [0.0015],
        [0.0003],
        [0.0001]], device='cuda:0', dtype=torch.float16), tensor([[1.4246e-05],
        [3.7551e-06],
        [9.3579e-06],
        [5.9605e-06],
        [5.7220e-06],
        [9.2983e-06],
        [1.1921e-05],
        [9.1195e-06],
        [6.7949e-06],
        [5.4240e-06],
        [1.6093e-05],
        [9.7752e-06],
        [8.4043e-06],
        [8.4639e-06],
        [1.1325e-05],
        [9.0599e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([9.2387e-05, 3.9959e-04, 1.2851e-04, 9.6500e-05, 9.8765e-05, 1.0890e-04,
        3.1400e-04, 2.1827e-04, 5.8508e-04, 1.1408e-04, 3.9387e-04, 9.4831e-05,
        4.0770e-04, 5.1069e-04, 8.8871e-05, 3.9637e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.7527e-04, 2.4652e-04, 6.5041e-04, 5.8327e-03, 1.7238e-04, 3.8791e-04,
         1.7776e-03, 5.4502e-04, 2.1305e-03, 7.2241e-05, 1.7786e-03, 4.4775e-04,
         1.0639e-04, 1.2565e-04, 5.9738e-03, 1.4542e-02]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.6236e-04],
        [9.9957e-05],
        [3.6407e-04],
        [1.5888e-03],
        [1.8573e-04],
        [1.7262e-04],
        [6.4993e-04],
        [2.9755e-04],
        [1.5831e-04],
        [3.7372e-05],
        [1.0700e-03],
        [3.9840e-04],
        [3.7014e-05],
        [1.0961e-04],
        [2.0615e-02],
        [3.1204e-03]], device='cuda:0', dtype=torch.float16), tensor([[1.1265e-05],
        [6.0797e-06],
        [8.4639e-06],
        [5.7757e-05],
        [1.1623e-05],
        [5.4836e-06],
        [7.4506e-06],
        [9.7752e-06],
        [1.2159e-05],
        [4.7684e-06],
        [1.4901e-05],
        [1.3351e-05],
        [3.9935e-06],
        [6.7949e-06],
        [9.1791e-06],
        [9.3579e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([5.7876e-05, 3.5346e-05, 1.2422e-04, 5.4884e-04, 6.5804e-05, 5.9366e-05,
        2.1911e-04, 1.0246e-04, 5.6803e-05, 1.4067e-05, 3.6168e-04, 1.3721e-04,
        1.3649e-05, 3.8803e-05, 6.8741e-03, 1.0433e-03], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.0733e-03, 1.1282e-03, 2.8515e-04, 3.1910e-03, 1.7042e-03, 2.6882e-05,
         1.5383e-03, 8.7500e-04, 1.0443e-03, 8.1778e-04, 5.0592e-04, 2.8920e-04,
         2.2388e-04, 1.5421e-03, 7.0095e-04, 2.8563e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.9332e-04],
        [3.5024e-04],
        [2.2542e-04],
        [2.6608e-03],
        [1.3506e-04],
        [1.2934e-05],
        [2.4199e-04],
        [2.7537e-04],
        [1.5545e-04],
        [2.4557e-04],
        [4.4847e-04],
        [9.7096e-05],
        [1.3530e-04],
        [4.4346e-04],
        [6.2943e-04],
        [2.0981e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.0325e-05],
        [1.8120e-05],
        [4.6492e-06],
        [3.8326e-05],
        [7.7486e-06],
        [8.6427e-06],
        [7.5698e-06],
        [2.4438e-06],
        [5.5432e-06],
        [1.0192e-05],
        [6.6757e-06],
        [4.3511e-06],
        [8.7023e-06],
        [7.5102e-06],
        [1.1146e-05],
        [7.8082e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.3794e-04, 1.2279e-04, 7.6711e-05, 8.9979e-04, 4.7624e-05, 7.2122e-06,
        8.3208e-05, 9.2626e-05, 5.3644e-05, 8.5235e-05, 1.5175e-04, 3.3796e-05,
        4.7982e-05, 1.5032e-04, 2.1350e-04, 7.2539e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0140, 0.0019]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0040],
        [0.0004]], device='cuda:0', dtype=torch.float16), tensor([[6.4075e-05],
        [4.5896e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([0.0014, 0.0001], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type passive, variation 0 and batchsize 16: 0:03:32.907855
path ['42', 'de', 'llama', 'SA', 'passive', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA passive 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 350.80it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.6684e-03, 2.0523e-03, 2.1648e-03, 1.1196e-03, 5.7316e-04, 1.6463e-04,
         6.2180e-04, 6.4671e-05, 4.8370e-03, 1.3266e-03, 2.8133e-03, 1.4505e-03,
         9.9540e-05, 2.8362e-03, 1.6127e-03, 1.7567e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.9741e-03],
        [8.5068e-04],
        [1.1673e-03],
        [7.9215e-05],
        [5.3310e-04],
        [2.6631e-04],
        [9.7454e-05],
        [2.7835e-05],
        [1.8250e-02],
        [4.0698e-04],
        [2.9202e-03],
        [6.4135e-04],
        [3.1948e-05],
        [1.9722e-03],
        [2.9087e-04],
        [9.6500e-05]], device='cuda:0', dtype=torch.float16), tensor([[3.5167e-06],
        [1.0073e-05],
        [1.1504e-05],
        [5.0664e-06],
        [1.3053e-05],
        [6.3777e-06],
        [5.4836e-06],
        [3.2187e-06],
        [1.3053e-05],
        [7.7486e-06],
        [3.9995e-05],
        [8.8215e-06],
        [1.4305e-05],
        [1.3530e-05],
        [8.8215e-06],
        [9.4771e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([6.5899e-04, 2.8682e-04, 3.9291e-04, 2.8074e-05, 1.8203e-04, 9.0897e-05,
        3.4332e-05, 1.0371e-05, 6.0883e-03, 1.3828e-04, 9.8705e-04, 2.1672e-04,
        1.5438e-05, 6.6185e-04, 9.9897e-05, 3.5346e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0001, 0.0139, 0.0005, 0.0006, 0.0006, 0.0003, 0.0032, 0.0011, 0.0009,
         0.0174, 0.0011, 0.0002, 0.0019, 0.0005, 0.0011, 0.0002]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.3452e-05],
        [3.3760e-03],
        [7.2896e-05],
        [3.6168e-04],
        [1.8120e-04],
        [2.5535e-04],
        [8.8358e-04],
        [1.5354e-04],
        [4.8876e-05],
        [5.2986e-03],
        [1.8394e-04],
        [4.9233e-05],
        [1.3657e-03],
        [2.4652e-04],
        [6.6400e-05],
        [1.2553e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.6822e-06],
        [9.7752e-06],
        [3.9935e-06],
        [1.5616e-05],
        [4.8876e-06],
        [1.1623e-05],
        [4.0114e-05],
        [4.4107e-06],
        [2.1458e-06],
        [5.5134e-05],
        [2.5630e-06],
        [3.2187e-06],
        [1.7762e-05],
        [6.5565e-06],
        [6.1393e-06],
        [4.0531e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.5378e-05, 1.1282e-03, 2.5630e-05, 1.2577e-04, 6.2048e-05, 8.8990e-05,
        3.0780e-04, 5.2631e-05, 1.6987e-05, 1.7843e-03, 6.2168e-05, 1.7464e-05,
        4.6110e-04, 8.4341e-05, 2.4199e-05, 4.3213e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0002, 0.0004, 0.0006, 0.0005, 0.0059, 0.0004, 0.0004, 0.0001, 0.0029,
         0.0003, 0.0001, 0.0001, 0.0013, 0.0003, 0.0002, 0.0009]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[8.4639e-05],
        [1.2600e-04],
        [3.7956e-04],
        [4.0174e-04],
        [1.1148e-03],
        [1.7428e-04],
        [1.7512e-04],
        [5.8770e-05],
        [4.5252e-04],
        [3.7098e-04],
        [1.2243e-04],
        [5.3644e-05],
        [4.3225e-04],
        [2.5213e-05],
        [1.0741e-04],
        [1.6844e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.1921e-06],
        [6.0797e-06],
        [9.1791e-06],
        [7.0333e-06],
        [7.8082e-06],
        [2.3842e-06],
        [4.8876e-06],
        [5.4836e-06],
        [7.2122e-06],
        [6.0797e-06],
        [3.6359e-06],
        [5.4836e-06],
        [8.9407e-06],
        [2.6822e-06],
        [7.8678e-06],
        [4.2319e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.8610e-05, 4.4048e-05, 1.2958e-04, 1.3626e-04, 3.7432e-04, 5.8889e-05,
        6.0022e-05, 2.1398e-05, 1.5330e-04, 1.2565e-04, 4.2021e-05, 1.9729e-05,
        1.4710e-04, 9.2983e-06, 3.8445e-05, 5.7578e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0009, 0.0019]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0003],
        [0.0013]], device='cuda:0', dtype=torch.float16), tensor([[1.9670e-06],
        [1.5736e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([9.7990e-05, 4.3702e-04], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type passive, variation 1 and batchsize 16: 0:03:33.656052
path ['42', 'de', 'llama', 'SA', 'passive', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA passive 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 359.81it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.8930e-03, 8.0185e-03, 2.0039e-04, 2.6274e-04, 2.0161e-03, 1.3456e-03,
         3.2520e-03, 9.1195e-05, 1.4699e-04, 1.2074e-03, 4.4894e-04, 2.1374e-04,
         1.1892e-03, 7.6818e-04, 5.6458e-04, 9.5940e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.2469e-04],
        [2.2491e-02],
        [7.6950e-05],
        [2.0671e-04],
        [4.5609e-04],
        [5.4550e-04],
        [1.0481e-03],
        [3.5405e-05],
        [2.2507e-04],
        [7.9203e-04],
        [1.2815e-04],
        [1.8179e-04],
        [8.5473e-05],
        [9.0647e-04],
        [6.2370e-04],
        [1.4114e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.2279e-05],
        [1.1981e-05],
        [3.9935e-06],
        [1.8179e-05],
        [1.4365e-05],
        [3.5167e-06],
        [1.1206e-05],
        [3.6955e-06],
        [7.1526e-06],
        [1.3113e-05],
        [7.8082e-06],
        [5.3644e-06],
        [2.9802e-06],
        [1.9193e-05],
        [2.2233e-05],
        [4.7684e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.5657e-05, 7.4997e-03, 2.7001e-05, 7.4983e-05, 1.5688e-04, 1.8299e-04,
        3.5310e-04, 1.3053e-05, 7.7426e-05, 2.6846e-04, 4.5300e-05, 6.2406e-05,
        2.9504e-05, 3.0851e-04, 2.1529e-04, 4.8637e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0014, 0.0003, 0.0002, 0.0002, 0.0003, 0.0011, 0.0004, 0.0096, 0.0001,
         0.0010, 0.0005, 0.0016, 0.0022, 0.0005, 0.0009, 0.0011]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.6897e-04],
        [4.0293e-04],
        [1.6832e-04],
        [7.2479e-05],
        [3.1054e-05],
        [2.3448e-04],
        [1.9848e-04],
        [1.9360e-03],
        [9.8228e-05],
        [8.2791e-05],
        [3.1590e-04],
        [5.7745e-04],
        [8.2064e-04],
        [1.0508e-04],
        [1.2863e-04],
        [1.7107e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.2755e-05],
        [1.4424e-05],
        [4.4703e-06],
        [3.8147e-06],
        [2.3842e-06],
        [5.4836e-06],
        [3.1590e-06],
        [1.4544e-05],
        [7.2718e-06],
        [4.8876e-06],
        [1.2040e-05],
        [1.2100e-05],
        [9.2983e-06],
        [6.2585e-06],
        [7.0930e-06],
        [3.7551e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.6057e-04, 1.3912e-04, 5.7578e-05, 2.5451e-05, 1.1146e-05, 7.9989e-05,
        6.7234e-05, 6.5041e-04, 3.5167e-05, 2.9206e-05, 1.0931e-04, 1.9646e-04,
        2.7657e-04, 3.7134e-05, 4.5240e-05, 5.8293e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.3073e-03, 2.8563e-04, 3.4714e-03, 3.3808e-04, 1.1855e-04, 1.0509e-03,
         4.0588e-03, 1.2939e-02, 2.7823e-04, 2.5692e-03, 1.1234e-03, 5.3704e-05,
         2.0008e-03, 6.3992e-04, 6.4945e-04, 2.7013e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.5993e-03],
        [1.6057e-04],
        [2.8954e-03],
        [3.9768e-04],
        [5.3942e-05],
        [6.5148e-05],
        [1.1950e-03],
        [7.1754e-03],
        [1.2684e-04],
        [6.0558e-04],
        [3.2496e-04],
        [2.2411e-05],
        [4.0174e-04],
        [3.8743e-04],
        [3.6788e-04],
        [2.5535e-04]], device='cuda:0', dtype=torch.float16), tensor([[6.1989e-06],
        [9.5963e-06],
        [3.3975e-05],
        [4.5300e-06],
        [6.7949e-06],
        [7.8678e-06],
        [4.8697e-05],
        [5.7518e-05],
        [1.8477e-06],
        [1.2875e-05],
        [6.9737e-06],
        [1.2398e-05],
        [9.0599e-06],
        [1.2755e-05],
        [8.5831e-06],
        [1.2159e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([5.3501e-04, 5.6744e-05, 9.7656e-04, 1.3411e-04, 2.0266e-05, 2.4319e-05,
        4.1461e-04, 2.4109e-03, 4.2915e-05, 2.0611e-04, 1.1063e-04, 1.1623e-05,
        1.3697e-04, 1.3340e-04, 1.2553e-04, 8.9169e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0004, 0.0006]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0002],
        [0.0005]], device='cuda:0', dtype=torch.float16), tensor([[7.0930e-06],
        [7.8678e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([7.3195e-05, 1.6057e-04], device='cuda:0', dtype=torch.float16)
acc:  0.5
Time taken to execute the de SA task with prompt type passive, variation 2 and batchsize 16: 0:03:31.918788
path ['42', 'de', 'llama', 'SA', 'passive', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA auxiliary 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 338.73it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.0017e-04, 1.6809e-04, 1.7776e-03, 1.4317e-04, 1.3199e-03, 7.9393e-05,
         6.8378e-04, 8.4734e-04, 1.8632e-04, 1.5819e-04, 3.1090e-04, 2.8000e-03,
         3.8123e-04, 1.0862e-03, 3.4356e-04, 4.9496e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.4126e-04],
        [7.4029e-05],
        [1.2436e-03],
        [4.5896e-05],
        [8.5402e-04],
        [5.3644e-05],
        [4.9829e-05],
        [7.0095e-05],
        [2.2912e-04],
        [8.9169e-05],
        [9.4593e-05],
        [2.7294e-03],
        [1.7512e-04],
        [3.5524e-04],
        [2.1338e-04],
        [2.4652e-04]], device='cuda:0', dtype=torch.float16), tensor([[2.7418e-06],
        [1.4305e-06],
        [1.4305e-05],
        [3.4571e-06],
        [1.2755e-05],
        [4.9472e-06],
        [2.9206e-06],
        [7.3314e-06],
        [6.1393e-06],
        [7.5698e-06],
        [6.5565e-06],
        [4.8518e-05],
        [5.4836e-06],
        [1.0610e-05],
        [1.0073e-05],
        [6.9737e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.7982e-05, 2.5153e-05, 4.1938e-04, 1.6451e-05, 2.8896e-04, 1.9550e-05,
        1.7583e-05, 2.5809e-05, 7.8440e-05, 3.2246e-05, 3.3736e-05, 9.2602e-04,
        6.0201e-05, 1.2195e-04, 7.4506e-05, 8.4519e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.5516e-03, 2.6798e-04, 1.1148e-03, 1.5163e-03, 2.7800e-04, 2.3746e-03,
         2.3880e-03, 2.4164e-04, 3.5381e-04, 7.8201e-05, 4.5013e-03, 1.1986e-02,
         1.7958e-03, 1.3101e-04, 6.8843e-05, 6.3705e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[6.7520e-04],
        [2.3317e-04],
        [8.9598e-04],
        [4.3106e-04],
        [2.2590e-04],
        [1.3371e-03],
        [1.6510e-02],
        [3.1018e-04],
        [6.8665e-05],
        [2.7597e-05],
        [9.0742e-04],
        [2.2221e-03],
        [9.4175e-05],
        [6.5804e-05],
        [2.8312e-05],
        [1.2743e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.0431e-05],
        [7.9870e-06],
        [2.0742e-05],
        [9.5963e-06],
        [1.1623e-05],
        [3.4571e-06],
        [1.1384e-05],
        [6.2585e-06],
        [7.1526e-06],
        [1.6689e-05],
        [1.0669e-05],
        [1.0967e-05],
        [8.7619e-06],
        [6.4373e-06],
        [3.3379e-06],
        [5.0664e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([2.2852e-04, 8.0407e-05, 3.0565e-04, 1.4687e-04, 7.9155e-05, 4.4680e-04,
        5.5084e-03, 1.0550e-04, 2.5272e-05, 1.4782e-05, 3.0613e-04, 7.4434e-04,
        3.4332e-05, 2.4080e-05, 1.0550e-05, 4.4167e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0002, 0.0112, 0.0005, 0.0004, 0.0025, 0.0002, 0.0014, 0.0010, 0.0011,
         0.0012, 0.0005, 0.0001, 0.0009, 0.0004, 0.0010, 0.0001]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[2.5034e-05],
        [3.6793e-03],
        [3.3689e-04],
        [7.3016e-05],
        [3.8171e-04],
        [1.6189e-04],
        [2.7609e-04],
        [1.6868e-04],
        [6.1560e-04],
        [6.0558e-05],
        [1.6510e-04],
        [1.0216e-04],
        [1.7238e-04],
        [4.0460e-04],
        [3.7003e-04],
        [4.3809e-05]], device='cuda:0', dtype=torch.float16), tensor([[3.0994e-06],
        [6.6817e-05],
        [1.6749e-05],
        [5.7220e-06],
        [8.1062e-06],
        [4.5300e-06],
        [1.2636e-05],
        [5.7220e-06],
        [1.2159e-05],
        [6.1989e-06],
        [5.4836e-06],
        [4.4107e-06],
        [3.5167e-06],
        [1.4424e-05],
        [2.2650e-06],
        [2.7418e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([9.3579e-06, 1.2484e-03, 1.1790e-04, 2.6226e-05, 1.2994e-04, 5.5492e-05,
        9.6262e-05, 5.8115e-05, 2.0921e-04, 2.2233e-05, 5.6863e-05, 3.5524e-05,
        5.8651e-05, 1.3971e-04, 1.2410e-04, 1.5497e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0040, 0.0011]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0010],
        [0.0005]], device='cuda:0', dtype=torch.float16), tensor([[5.3883e-05],
        [1.0788e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([0.0003, 0.0002], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type auxiliary, variation 0 and batchsize 16: 0:03:34.467638
path ['42', 'de', 'llama', 'SA', 'auxiliary', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA auxiliary 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 333.74it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.1565e-04, 2.3901e-04, 1.5583e-03, 2.7943e-04, 2.8896e-04, 3.4475e-04,
         1.3056e-03, 6.1178e-04, 8.2111e-04, 8.1825e-04, 4.7779e-04, 6.4194e-05,
         1.3077e-04, 4.6844e-03, 2.4681e-03, 5.5313e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[3.1805e-04],
        [2.1172e-04],
        [1.3533e-03],
        [1.0043e-04],
        [1.6177e-04],
        [1.8907e-04],
        [8.1956e-05],
        [5.9187e-05],
        [1.8430e-04],
        [1.5140e-04],
        [2.0003e-04],
        [2.5451e-05],
        [5.5134e-05],
        [1.1129e-03],
        [4.7660e-04],
        [4.4775e-04]], device='cuda:0', dtype=torch.float16), tensor([[6.7949e-06],
        [9.8944e-06],
        [2.2054e-06],
        [6.4373e-06],
        [2.7418e-06],
        [5.4836e-06],
        [6.8545e-06],
        [2.8014e-06],
        [5.4836e-06],
        [4.1127e-06],
        [5.0068e-06],
        [1.6391e-05],
        [2.9206e-06],
        [1.0312e-05],
        [7.3314e-06],
        [1.6928e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([1.0830e-04, 7.3850e-05, 4.5180e-04, 3.5644e-05, 5.4836e-05, 6.4850e-05,
        2.9624e-05, 2.0683e-05, 6.3241e-05, 5.1856e-05, 6.8367e-05, 1.3947e-05,
        1.9372e-05, 3.7432e-04, 1.6129e-04, 1.5485e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.3244e-04, 2.0447e-03, 6.5029e-05, 8.0645e-05, 1.1726e-02, 1.0128e-03,
         2.2304e-04, 2.0771e-03, 1.4246e-04, 1.0109e-03, 6.3038e-04, 1.5211e-03,
         2.2831e-03, 1.3876e-03, 9.8991e-04, 2.0492e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.3018e-04],
        [9.1791e-04],
        [2.9385e-05],
        [6.1810e-05],
        [4.2725e-03],
        [2.2173e-04],
        [1.2082e-04],
        [1.5135e-03],
        [9.6560e-05],
        [3.6550e-04],
        [6.7770e-05],
        [4.6825e-04],
        [1.3733e-04],
        [1.1368e-03],
        [5.2786e-04],
        [3.1412e-05]], device='cuda:0', dtype=torch.float16), tensor([[4.2319e-06],
        [1.0073e-05],
        [3.3975e-06],
        [5.1260e-06],
        [5.7280e-05],
        [3.6359e-06],
        [1.6689e-06],
        [1.5020e-05],
        [7.5102e-06],
        [1.0133e-05],
        [7.7486e-06],
        [8.8811e-06],
        [8.9407e-06],
        [2.0802e-05],
        [9.4771e-06],
        [3.5167e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.4823e-05, 3.0923e-04, 1.0908e-05, 2.2292e-05, 1.4429e-03, 7.5102e-05,
        4.0829e-05, 5.0926e-04, 3.4690e-05, 1.2517e-04, 2.5153e-05, 1.5903e-04,
        4.8757e-05, 3.8576e-04, 1.7905e-04, 1.1623e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0003, 0.0010, 0.0013, 0.0002, 0.0109, 0.0004, 0.0002, 0.0001, 0.0008,
         0.0003, 0.0007, 0.0001, 0.0014, 0.0033, 0.0004, 0.0018]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[7.9095e-05],
        [1.3779e-02],
        [4.5824e-04],
        [3.3212e-04],
        [2.3880e-03],
        [2.5821e-04],
        [2.3687e-04],
        [5.5254e-05],
        [5.4741e-04],
        [7.8797e-05],
        [3.1972e-04],
        [6.4552e-05],
        [2.8014e-04],
        [3.7823e-03],
        [4.4751e-04],
        [1.2140e-03]], device='cuda:0', dtype=torch.float16), tensor([[6.4969e-06],
        [1.1802e-05],
        [2.5034e-06],
        [6.3777e-06],
        [1.0192e-05],
        [8.7023e-06],
        [7.8678e-06],
        [3.6359e-06],
        [1.0490e-05],
        [6.0201e-06],
        [7.3910e-06],
        [5.9009e-06],
        [1.0967e-05],
        [5.3227e-05],
        [1.2875e-05],
        [1.0192e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([2.8551e-05, 4.5967e-03, 1.5354e-04, 1.1283e-04, 7.9918e-04, 8.8990e-05,
        8.1599e-05, 1.9610e-05, 1.8597e-04, 2.8253e-05, 1.0902e-04, 2.3484e-05,
        9.7036e-05, 1.2789e-03, 1.5342e-04, 4.0817e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0033, 0.0002]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0009],
        [0.0002]], device='cuda:0', dtype=torch.float16), tensor([[4.6968e-05],
        [4.4107e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.2902e-04, 7.0453e-05], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type auxiliary, variation 1 and batchsize 16: 0:03:33.514280
path ['42', 'de', 'llama', 'SA', 'auxiliary', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA auxiliary 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 300.01it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0005, 0.0001, 0.0026, 0.0005, 0.0022, 0.0015, 0.0014, 0.0001, 0.0002,
         0.0057, 0.0003, 0.0015, 0.0008, 0.0044, 0.0001, 0.0005]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[8.7321e-05],
        [4.8876e-05],
        [1.3733e-04],
        [4.4703e-04],
        [1.4219e-03],
        [8.7214e-04],
        [6.7806e-04],
        [6.5088e-05],
        [2.5368e-04],
        [1.1234e-03],
        [2.8491e-05],
        [1.0481e-03],
        [1.4830e-04],
        [3.7880e-03],
        [1.1623e-04],
        [2.6536e-04]], device='cuda:0', dtype=torch.float16), tensor([[7.8678e-06],
        [3.8743e-06],
        [8.9407e-06],
        [1.4484e-05],
        [2.5630e-06],
        [1.1444e-05],
        [1.1921e-05],
        [6.1989e-06],
        [6.6161e-06],
        [1.0550e-05],
        [3.3379e-06],
        [2.1994e-05],
        [5.4836e-06],
        [5.3167e-05],
        [4.8876e-06],
        [7.3910e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.1710e-05, 1.7583e-05, 4.8757e-05, 1.5378e-04, 4.7493e-04, 2.9445e-04,
        2.2995e-04, 2.3782e-05, 8.6784e-05, 3.7789e-04, 1.0610e-05, 3.5667e-04,
        5.1260e-05, 1.2808e-03, 4.0352e-05, 9.0897e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.1161e-04, 1.1253e-03, 3.6645e-04, 8.6010e-05, 1.6922e-02, 1.7281e-03,
         3.7837e-04, 7.7581e-04, 1.2512e-02, 1.6460e-03, 6.1226e-04, 3.0327e-04,
         9.4604e-04, 4.1199e-04, 7.2145e-04, 1.3113e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.4806e-04],
        [4.8399e-04],
        [1.0550e-04],
        [6.0499e-05],
        [4.7340e-03],
        [1.1950e-03],
        [2.2113e-04],
        [5.7876e-05],
        [2.3785e-03],
        [3.1614e-04],
        [1.8203e-04],
        [2.5392e-04],
        [8.2374e-05],
        [1.8167e-04],
        [4.4799e-04],
        [4.7266e-05]], device='cuda:0', dtype=torch.float16), tensor([[2.7418e-06],
        [1.1563e-05],
        [6.6757e-06],
        [5.3644e-06],
        [6.0916e-05],
        [1.4782e-05],
        [1.0490e-05],
        [3.0994e-06],
        [1.0312e-05],
        [1.2457e-05],
        [5.4240e-06],
        [7.9274e-06],
        [7.1526e-06],
        [5.4836e-06],
        [1.8954e-05],
        [2.8014e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([5.0247e-05, 1.6522e-04, 3.7372e-05, 2.1935e-05, 1.5984e-03, 4.0317e-04,
        7.7188e-05, 2.0325e-05, 7.9632e-04, 1.0955e-04, 6.2466e-05, 8.7261e-05,
        2.9862e-05, 6.2406e-05, 1.5569e-04, 1.6689e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[1.7157e-03, 3.5310e-04, 1.7233e-03, 3.8743e-04, 1.2379e-03, 1.6952e-04,
         1.1625e-03, 2.6536e-04, 1.3714e-03, 2.5597e-03, 8.3625e-05, 1.8787e-04,
         7.0810e-05, 4.4937e-03, 1.8520e-03, 1.2321e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.9829e-04],
        [2.7823e-04],
        [8.2672e-05],
        [8.0585e-05],
        [3.9554e-04],
        [1.6296e-04],
        [1.8609e-04],
        [3.2711e-04],
        [4.4012e-04],
        [1.8692e-02],
        [2.9266e-05],
        [9.6023e-05],
        [2.8312e-05],
        [1.1187e-03],
        [7.7057e-04],
        [2.0683e-04]], device='cuda:0', dtype=torch.float16), tensor([[9.5963e-06],
        [1.1921e-05],
        [6.3777e-06],
        [6.0797e-06],
        [1.1027e-05],
        [4.3511e-06],
        [5.6028e-06],
        [6.0797e-06],
        [2.3842e-06],
        [1.1683e-05],
        [1.6451e-05],
        [8.0466e-06],
        [3.4571e-06],
        [4.9353e-05],
        [9.7752e-06],
        [3.4571e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.6928e-04, 9.6738e-05, 2.9683e-05, 2.8908e-05, 1.3554e-04, 5.5790e-05,
        6.3896e-05, 1.1104e-04, 1.4746e-04, 6.2332e-03, 1.5259e-05, 3.4690e-05,
        1.0610e-05, 3.8934e-04, 2.6011e-04, 7.0095e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0034, 0.0002]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.2261e-04],
        [9.1672e-05]], device='cuda:0', dtype=torch.float16), tensor([[7.9274e-06],
        [1.4305e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.7691e-04, 3.1054e-05], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type auxiliary, variation 2 and batchsize 16: 0:03:34.080029
path ['42', 'de', 'llama', 'SA', 'auxiliary', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA modal 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 364.98it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[3.5172e-03, 1.6031e-03, 1.9894e-03, 1.6236e-04, 3.9978e-03, 2.6631e-04,
         4.9210e-04, 1.4811e-03, 8.1778e-05, 7.0047e-04, 1.4782e-03, 1.1940e-03,
         2.3174e-03, 6.5184e-04, 6.1417e-03, 4.0054e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.3310e-04],
        [1.4038e-03],
        [6.8998e-04],
        [1.7285e-04],
        [1.5748e-04],
        [3.3784e-04],
        [1.2624e-04],
        [7.0763e-04],
        [3.2783e-05],
        [3.1519e-04],
        [4.1199e-04],
        [6.6042e-05],
        [3.1734e-04],
        [8.9943e-05],
        [1.1673e-03],
        [1.9467e-04]], device='cuda:0', dtype=torch.float16), tensor([[6.6757e-06],
        [2.1458e-06],
        [8.5235e-06],
        [4.3511e-06],
        [8.1062e-06],
        [6.0201e-06],
        [6.4969e-06],
        [1.1623e-05],
        [3.3975e-06],
        [7.6294e-06],
        [2.4438e-06],
        [3.0994e-06],
        [1.0848e-05],
        [6.0797e-06],
        [4.9293e-05],
        [4.5896e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.7989e-04, 4.6873e-04, 2.3282e-04, 5.9068e-05, 5.5194e-05, 1.1462e-04,
        4.4227e-05, 2.3973e-04, 1.2040e-05, 1.0759e-04, 1.3816e-04, 2.3067e-05,
        1.0937e-04, 3.2008e-05, 4.0555e-04, 6.6400e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0015, 0.0005, 0.0022, 0.0018, 0.0013, 0.0016, 0.0004, 0.0160, 0.0002,
         0.0006, 0.0001, 0.0006, 0.0003, 0.0014, 0.0015, 0.0014]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.0529e-03],
        [2.8563e-04],
        [9.6202e-05],
        [8.4639e-04],
        [1.7750e-04],
        [1.0710e-03],
        [3.6061e-05],
        [3.4637e-03],
        [9.0301e-05],
        [5.3215e-04],
        [5.6386e-05],
        [8.9049e-05],
        [1.5962e-04],
        [2.2793e-04],
        [4.2248e-04],
        [9.0361e-05]], device='cuda:0', dtype=torch.float16), tensor([[1.0312e-05],
        [1.1206e-05],
        [6.6161e-06],
        [1.0312e-05],
        [4.0531e-06],
        [2.0325e-05],
        [3.8147e-06],
        [6.1333e-05],
        [7.2122e-06],
        [1.2934e-05],
        [5.4836e-06],
        [6.2585e-06],
        [2.6822e-06],
        [3.2783e-06],
        [9.5963e-06],
        [6.9737e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([3.5429e-04, 9.8944e-05, 3.4273e-05, 2.8563e-04, 6.0499e-05, 3.6383e-04,
        1.3292e-05, 1.1749e-03, 3.2485e-05, 1.8167e-04, 2.0623e-05, 3.1769e-05,
        5.4121e-05, 7.7069e-05, 1.4400e-04, 3.2425e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0003, 0.0004, 0.0016, 0.0027, 0.0021, 0.0003, 0.0119, 0.0010, 0.0010,
         0.0002, 0.0002, 0.0001, 0.0071, 0.0060, 0.0001, 0.0002]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.3053e-04],
        [3.1805e-04],
        [2.1839e-04],
        [1.3285e-03],
        [2.0462e-02],
        [3.7527e-04],
        [1.7710e-03],
        [2.6703e-04],
        [6.1941e-04],
        [1.2958e-04],
        [5.4121e-05],
        [6.2764e-05],
        [1.0843e-03],
        [5.5962e-03],
        [2.9325e-05],
        [7.0155e-05]], device='cuda:0', dtype=torch.float16), tensor([[1.7285e-06],
        [7.8082e-06],
        [5.4836e-06],
        [1.3351e-05],
        [1.1802e-05],
        [5.9009e-06],
        [9.7156e-06],
        [4.9472e-06],
        [1.4484e-05],
        [3.9339e-06],
        [2.9206e-06],
        [4.5896e-06],
        [8.2254e-06],
        [5.2929e-05],
        [1.5378e-05],
        [3.8147e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.4107e-05, 1.0860e-04, 7.4625e-05, 4.4727e-04, 6.8245e-03, 1.2708e-04,
        5.9366e-04, 9.0659e-05, 2.1124e-04, 4.4525e-05, 1.9014e-05, 2.2471e-05,
        3.6430e-04, 1.8826e-03, 1.4901e-05, 2.4676e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0020, 0.0005]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0004],
        [0.0003]], device='cuda:0', dtype=torch.float16), tensor([[7.6294e-06],
        [8.1658e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([0.0002, 0.0001], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type modal, variation 0 and batchsize 16: 0:03:33.205191
path ['42', 'de', 'llama', 'SA', 'modal', 'prompt_id_0']
----------- 42 de huggyllama/llama-7b SA modal 1 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 350.17it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[6.6833e-03, 6.6233e-04, 7.0870e-05, 2.3091e-04, 2.1420e-03, 3.2520e-04,
         1.9569e-03, 1.7977e-04, 1.5717e-03, 1.0910e-03, 9.6560e-05, 3.4599e-03,
         3.9649e-04, 1.6985e-03, 1.4481e-02, 1.3769e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.2608e-03],
        [1.1152e-04],
        [2.8193e-05],
        [3.4928e-04],
        [9.9277e-04],
        [3.2842e-05],
        [1.5001e-03],
        [5.6744e-05],
        [4.7565e-04],
        [1.9872e-04],
        [5.2214e-05],
        [1.5712e-04],
        [3.8218e-04],
        [4.3440e-04],
        [3.7708e-03],
        [4.8041e-05]], device='cuda:0', dtype=torch.float16), tensor([[9.2983e-06],
        [5.7220e-06],
        [3.0994e-06],
        [6.4373e-06],
        [1.0788e-05],
        [3.3975e-06],
        [2.5034e-06],
        [3.5763e-06],
        [2.5630e-06],
        [4.5896e-06],
        [4.5300e-06],
        [9.0003e-06],
        [1.2517e-05],
        [8.1062e-06],
        [6.3479e-05],
        [2.7418e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.2343e-04, 3.9101e-05, 1.0431e-05, 1.1855e-04, 3.3450e-04, 1.2100e-05,
        5.0068e-04, 2.0087e-05, 1.5938e-04, 6.7770e-05, 1.8895e-05, 5.5373e-05,
        1.3161e-04, 1.4746e-04, 1.2779e-03, 1.6928e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[8.6641e-04, 8.0109e-04, 7.7486e-05, 3.9029e-04, 1.6174e-03, 5.2929e-04,
         1.4381e-03, 1.1833e-02, 1.9798e-03, 1.3361e-03, 8.3971e-04, 1.4889e-04,
         1.2846e-03, 5.8098e-03, 3.2177e-03, 1.1816e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[5.8174e-04],
        [2.3818e-04],
        [2.7359e-05],
        [1.2350e-04],
        [2.7561e-04],
        [3.1185e-04],
        [8.0347e-05],
        [1.7586e-03],
        [1.1849e-04],
        [4.5991e-04],
        [3.4595e-04],
        [8.0466e-05],
        [7.3767e-04],
        [1.2341e-03],
        [5.5695e-04],
        [8.9550e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.5795e-05],
        [5.1260e-06],
        [1.6034e-05],
        [6.6757e-06],
        [5.4240e-06],
        [8.5235e-06],
        [2.9802e-06],
        [9.2387e-06],
        [6.9141e-06],
        [1.1086e-05],
        [7.2718e-06],
        [6.6161e-06],
        [1.2279e-05],
        [5.0187e-05],
        [6.9141e-06],
        [2.2113e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([1.9920e-04, 8.1122e-05, 1.4484e-05, 4.3392e-05, 9.3699e-05, 1.0681e-04,
        2.7776e-05, 5.8937e-04, 4.1783e-05, 1.5700e-04, 1.1772e-04, 2.9027e-05,
        2.4986e-04, 4.2820e-04, 1.8799e-04, 3.0589e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0015, 0.0002, 0.0003, 0.0002, 0.0025, 0.0005, 0.0013, 0.0003, 0.0016,
         0.0001, 0.0003, 0.0037, 0.0003, 0.0022, 0.0001, 0.0002]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.3832e-02],
        [3.0637e-04],
        [2.0802e-04],
        [1.8859e-04],
        [8.9931e-04],
        [8.0705e-05],
        [2.2101e-04],
        [1.7667e-04],
        [1.0471e-03],
        [5.3942e-05],
        [1.6952e-04],
        [3.7918e-03],
        [1.4377e-04],
        [3.3402e-04],
        [1.1784e-04],
        [2.3973e-04]], device='cuda:0', dtype=torch.float16), tensor([[1.3769e-05],
        [6.7353e-06],
        [9.4175e-06],
        [4.1723e-06],
        [8.1658e-06],
        [6.7949e-06],
        [3.2187e-06],
        [4.7684e-06],
        [9.3579e-06],
        [6.1393e-06],
        [2.5034e-06],
        [4.7624e-05],
        [1.7285e-06],
        [1.1504e-05],
        [3.9339e-06],
        [7.9274e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.6158e-03, 1.0437e-04, 7.2479e-05, 6.4254e-05, 3.0255e-04, 2.9147e-05,
        7.4744e-05, 6.0499e-05, 3.5214e-04, 2.0027e-05, 5.7340e-05, 1.2798e-03,
        4.8518e-05, 1.1516e-04, 4.0591e-05, 8.2552e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0011, 0.0032]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[9.3102e-05],
        [1.7633e-03]], device='cuda:0', dtype=torch.float16), tensor([[7.5102e-06],
        [1.4186e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([3.3557e-05, 5.9271e-04], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type modal, variation 1 and batchsize 16: 0:03:04.113071
path ['42', 'de', 'llama', 'SA', 'modal', 'prompt_id_1']
----------- 42 de huggyllama/llama-7b SA modal 2 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 316.77it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of  pos_reviews, neg_reviews:  39080 38908
len dataset  77988
len dataset  50
Batch: 0 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0001, 0.0018, 0.0022, 0.0129, 0.0002, 0.0016, 0.0014, 0.0001, 0.0019,
         0.0006, 0.0003, 0.0001, 0.0011, 0.0014, 0.0013, 0.0005]],
       device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[1.3316e-04],
        [9.2411e-04],
        [1.3888e-04],
        [4.4975e-03],
        [2.3913e-04],
        [8.8930e-05],
        [5.1117e-04],
        [3.7849e-05],
        [8.3637e-04],
        [3.5000e-04],
        [1.8835e-04],
        [8.0526e-05],
        [2.5511e-04],
        [4.6897e-04],
        [1.4763e-02],
        [1.1384e-04]], device='cuda:0', dtype=torch.float16), tensor([[4.7088e-06],
        [1.1742e-05],
        [1.0192e-05],
        [7.7724e-05],
        [8.5235e-06],
        [8.1062e-06],
        [2.9802e-06],
        [1.7583e-05],
        [1.1384e-05],
        [7.6294e-06],
        [3.2187e-06],
        [7.3314e-06],
        [6.0797e-06],
        [1.0073e-05],
        [1.3828e-05],
        [6.7949e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([4.5955e-05, 3.1185e-04, 4.9710e-05, 1.5249e-03, 8.2552e-05, 3.2365e-05,
        1.7142e-04, 1.8477e-05, 2.8253e-04, 1.1921e-04, 6.3837e-05, 2.9266e-05,
        8.7082e-05, 1.5974e-04, 4.9248e-03, 4.0233e-05], device='cuda:0',
       dtype=torch.float16)
Batch: 1 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[9.8825e-05, 7.1192e-04, 1.4124e-03, 2.8586e-04, 5.1022e-04, 1.1473e-03,
         2.0790e-04, 1.2398e-04, 1.2808e-03, 8.6069e-04, 4.2343e-04, 1.3714e-03,
         5.7220e-04, 2.5249e-04, 1.4555e-04, 1.6279e-03]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[7.6890e-05],
        [7.5579e-05],
        [6.0272e-04],
        [1.8668e-04],
        [1.1533e-04],
        [2.8324e-04],
        [3.0255e-04],
        [6.0558e-05],
        [8.0442e-04],
        [2.5249e-04],
        [3.4761e-04],
        [1.0109e-03],
        [6.8760e-04],
        [1.5068e-04],
        [1.0544e-04],
        [4.2129e-04]], device='cuda:0', dtype=torch.float16), tensor([[6.2585e-06],
        [9.0003e-06],
        [1.4782e-05],
        [5.6624e-06],
        [8.7023e-06],
        [4.7088e-06],
        [6.6161e-06],
        [3.5167e-06],
        [1.8597e-05],
        [6.9141e-06],
        [1.1265e-05],
        [1.0192e-05],
        [1.5080e-05],
        [2.0266e-06],
        [8.3447e-06],
        [1.6093e-05]], device='cuda:0', dtype=torch.float16)] -> tensor([2.7716e-05, 2.8193e-05, 2.0587e-04, 6.4135e-05, 4.1366e-05, 9.5963e-05,
        1.0306e-04, 2.1338e-05, 2.7442e-04, 8.6486e-05, 1.1963e-04, 3.4046e-04,
        2.3425e-04, 5.0902e-05, 3.7909e-05, 1.4579e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 2 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[2.3308e-03, 1.1215e-03, 9.8801e-03, 3.7518e-03, 1.7872e-03, 1.5926e-04,
         2.1577e-04, 6.2644e-05, 3.3360e-03, 3.5744e-03, 1.0357e-03, 3.5071e-04,
         2.2526e-03, 1.6284e-04, 2.5821e-04, 2.7013e-04]], device='cuda:0',
       dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[4.5109e-04],
        [7.2956e-04],
        [1.6966e-03],
        [3.9940e-03],
        [1.4029e-03],
        [6.5625e-05],
        [3.5942e-05],
        [2.9147e-05],
        [9.8991e-04],
        [1.1072e-03],
        [9.0182e-05],
        [1.5712e-04],
        [1.4639e-03],
        [1.8883e-04],
        [2.0909e-04],
        [4.4799e-04]], device='cuda:0', dtype=torch.float16), tensor([[8.4639e-06],
        [1.3113e-05],
        [1.1504e-05],
        [4.4882e-05],
        [2.9564e-05],
        [4.4703e-06],
        [3.5167e-06],
        [3.5763e-06],
        [1.2934e-05],
        [5.2273e-05],
        [3.9935e-06],
        [8.3447e-06],
        [1.8537e-05],
        [4.1723e-06],
        [1.0490e-05],
        [7.7486e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([1.5318e-04, 2.4748e-04, 5.6934e-04, 1.3466e-03, 4.7755e-04, 2.3365e-05,
        1.3173e-05, 1.0908e-05, 3.3426e-04, 3.8648e-04, 3.1412e-05, 5.5134e-05,
        4.9400e-04, 6.4313e-05, 7.3195e-05, 1.5187e-04], device='cuda:0',
       dtype=torch.float16)
Batch: 3 , batch size: 16, sample_size: 50
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [12337] -> [1, 12337] -> tensor([[0.0005, 0.0014]], device='cuda:0', dtype=torch.float16)
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id: [1, 452, 262] -> [tensor([[0.],
        [0.]], device='cuda:0', dtype=torch.float16), tensor([[0.0002],
        [0.0009]], device='cuda:0', dtype=torch.float16), tensor([[5.7220e-06],
        [2.7418e-06]], device='cuda:0', dtype=torch.float16)] -> tensor([7.7486e-05, 3.1281e-04], device='cuda:0', dtype=torch.float16)
acc:  0.52
Time taken to execute the de SA task with prompt type modal, variation 2 and batchsize 16: 0:03:04.005657
path ['42', 'de', 'llama', 'SA', 'modal', 'prompt_id_2']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v2.pickle' as a pickle file.
----------- 42 de huggyllama/llama-7b SA rare_synonyms 0 50 16 --------------
Loading MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 364.63it/s]
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 11801500 ON r29n1 CANCELLED AT 2023-05-21T13:49:28 ***
slurmstepd: error: *** STEP 11801500.0 ON r29n1 CANCELLED AT 2023-05-21T13:49:28 ***
