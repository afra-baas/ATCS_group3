Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
****Start Time: 2023-05-27_13-08-40
Using MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  4.08it/s]100%|██████████| 3/3 [00:00<00:00, 11.80it/s]
loading model Duration: 0:00:01.965710
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
len of lowest cat:  38553
len of pos_reviews, neg_reviews:  38553 38553
len dataset  77106
len dataset  200
create dataloader Duration: 0:03:08.182851
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
load model Duration: 0:00:17.153954
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloom-560m SA null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[5.4116e-08, 5.9601e-07, 9.0515e-09, 1.3676e-07, 2.7939e-07, 1.8444e-07,
         2.6273e-07, 6.0875e-08, 4.5920e-06, 4.4595e-06, 4.6791e-07, 4.2878e-06,
         1.2297e-07, 3.6782e-07, 3.9913e-07, 2.9205e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.5870e-07, 4.8084e-06, 1.7427e-07, 3.3706e-06, 3.0321e-06, 3.7230e-06,
         2.1966e-06, 1.2213e-06, 2.3140e-05, 2.9335e-05, 3.8882e-06, 1.8048e-05,
         5.1361e-07, 2.6258e-06, 4.0776e-06, 1.7219e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:02.498223
summ of probs approach
id: [18260] -> tensor([[2.2427e-07, 1.1486e-06, 3.7707e-07, 3.6950e-08, 1.3876e-07, 1.0045e-06,
         5.7655e-07, 2.1402e-09, 2.7056e-07, 8.5002e-07, 7.9713e-06, 4.8926e-09,
         5.6908e-06, 2.0895e-06, 4.2448e-07, 1.3755e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.1619e-06, 1.2939e-06, 2.0824e-06, 2.1565e-07, 1.3322e-05, 4.2883e-06,
         1.1942e-05, 7.0139e-08, 1.7973e-06, 1.0292e-05, 6.9469e-05, 8.0779e-08,
         8.8532e-06, 2.8131e-05, 8.1885e-06, 8.2219e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.175107
summ of probs approach
id: [18260] -> tensor([[3.3521e-07, 2.6558e-07, 3.1370e-06, 4.7920e-04, 1.7675e-07, 2.0461e-06,
         6.6047e-07, 9.6031e-07, 2.2465e-07, 9.8903e-07, 6.0045e-08, 4.5801e-08,
         2.5468e-06, 4.1036e-07, 4.4580e-07, 1.7078e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.1901e-06, 2.5608e-07, 9.9721e-06, 9.2500e-04, 5.3737e-06, 1.6519e-05,
         4.8519e-06, 1.1158e-05, 1.6690e-06, 1.0595e-05, 1.8753e-07, 2.8894e-07,
         7.3224e-06, 9.7380e-07, 2.1950e-06, 1.2964e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.206140
summ of probs approach
id: [18260] -> tensor([[5.8348e-07, 4.0015e-08, 2.5284e-07, 1.8137e-06, 2.1828e-07, 6.1099e-06,
         1.5636e-03, 1.1454e-06, 8.3196e-07, 1.0274e-06, 1.3173e-07, 2.6131e-05,
         3.1000e-07, 1.8190e-07, 2.9103e-07, 8.6239e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.6137e-06, 3.3657e-07, 1.4912e-06, 3.1771e-06, 9.2738e-07, 2.3310e-05,
         2.5415e-03, 5.9831e-06, 1.5157e-06, 3.6598e-05, 2.3887e-06, 5.8151e-05,
         2.3883e-06, 1.4158e-06, 1.6104e-06, 2.3416e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.157100
summ of probs approach
id: [18260] -> tensor([[7.2770e-07, 2.8516e-07, 1.7052e-07, 7.8957e-07, 1.2137e-07, 5.6443e-07,
         1.0045e-08, 3.8796e-06, 1.6118e-07, 1.8541e-08, 5.2783e-07, 7.9932e-08,
         5.9469e-09, 2.1407e-09, 6.6515e-07, 1.5216e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.9901e-06, 1.1077e-06, 1.7386e-06, 5.6721e-06, 3.8350e-07, 4.8999e-06,
         1.2237e-07, 3.5931e-05, 9.4384e-07, 3.7957e-07, 3.9507e-06, 1.7523e-06,
         8.6184e-09, 9.6915e-08, 5.8059e-06, 2.9890e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.248808
summ of probs approach
id: [18260] -> tensor([[1.3600e-07, 8.9476e-08, 6.6234e-08, 2.9562e-07, 8.6631e-07, 8.2891e-07,
         2.6612e-07, 2.9496e-07, 3.2288e-07, 2.4321e-07, 6.9199e-07, 2.0415e-07,
         2.3225e-07, 1.3976e-06, 3.8870e-08, 3.2850e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[6.6823e-07, 9.9812e-07, 4.6020e-07, 1.3963e-06, 4.0736e-06, 6.6280e-06,
         4.7172e-06, 6.0822e-06, 3.7801e-06, 2.9936e-06, 7.7684e-06, 4.0385e-06,
         1.0629e-06, 5.0637e-06, 7.0708e-07, 9.8020e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.180931
summ of probs approach
id: [18260] -> tensor([[4.2264e-07, 6.9552e-07, 3.0186e-06, 3.6062e-07, 5.1982e-07, 9.9946e-07,
         1.1927e-07, 7.9482e-09, 1.6460e-09, 7.6444e-07, 5.7940e-07, 1.7168e-06,
         2.9585e-07, 4.8099e-07, 1.7175e-06, 3.6834e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.1963e-06, 4.9585e-06, 3.5988e-05, 2.5484e-06, 3.5170e-06, 1.2804e-05,
         1.1200e-06, 8.0697e-08, 1.8413e-07, 1.2520e-05, 4.1084e-06, 1.4978e-05,
         2.2688e-07, 2.8662e-07, 7.2381e-06, 3.3925e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.149255
summ of probs approach
id: [18260] -> tensor([[4.2268e-08, 5.3295e-07, 5.0790e-07, 2.5210e-07, 3.6896e-07, 7.2727e-07,
         7.7848e-07, 7.4942e-09, 2.8908e-07, 2.1954e-06, 2.2138e-08, 3.8557e-07,
         6.8118e-07, 3.9278e-08, 7.2059e-07, 3.4076e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.6129e-07, 7.4537e-07, 2.2292e-06, 3.3321e-06, 2.0317e-06, 5.4894e-06,
         3.6306e-06, 4.1443e-08, 3.2106e-06, 8.0962e-05, 1.5899e-07, 1.8304e-06,
         1.0468e-05, 4.4094e-07, 2.4414e-06, 2.5884e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.120573
summ of probs approach
id: [18260] -> tensor([[8.4320e-09, 2.5766e-06, 6.8318e-09, 1.3485e-07, 5.0616e-08, 1.3497e-07,
         3.0554e-07, 5.6637e-07, 1.1470e-06, 1.0065e-07, 3.4283e-07, 9.4622e-07,
         1.0331e-08, 1.2043e-07, 1.7734e-07, 3.1202e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.1546e-07, 5.4546e-05, 7.6241e-06, 6.0227e-07, 1.2767e-05, 3.0997e-06,
         6.2803e-07, 1.1952e-05, 3.8277e-06, 3.0936e-06, 9.2968e-07, 1.2472e-05,
         2.8297e-07, 7.6981e-07, 1.6313e-06, 2.1172e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.190496
summ of probs approach
id: [18260] -> tensor([[9.2520e-07, 1.8734e-07, 5.3775e-09, 3.5868e-07, 2.8717e-07, 4.9448e-08,
         4.7668e-08, 3.3168e-08, 3.6594e-08, 1.0742e-09, 3.7204e-07, 3.6457e-07,
         1.7877e-07, 1.9720e-06, 1.0953e-07, 1.6048e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.7896e-06, 5.2580e-07, 1.0618e-06, 2.4017e-06, 9.6839e-06, 2.5641e-06,
         1.0199e-06, 4.0668e-07, 1.2775e-06, 2.8500e-08, 3.0668e-06, 6.3179e-06,
         1.9651e-06, 2.8043e-05, 8.9398e-07, 1.4091e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.150722
summ of probs approach
id: [18260] -> tensor([[1.7732e-07, 7.2250e-08, 2.6347e-08, 7.7224e-07, 8.3398e-07, 5.9492e-07,
         5.1769e-04, 4.5641e-07, 1.9118e-07, 1.2663e-06, 5.1754e-06, 2.5633e-06,
         5.4631e-09, 1.5738e-09, 9.8175e-08, 1.1143e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.6352e-06, 5.9848e-07, 1.2821e-07, 5.4281e-06, 1.2527e-06, 2.6093e-06,
         4.8304e-03, 6.7651e-06, 1.5752e-06, 2.3351e-05, 8.5099e-05, 1.3897e-05,
         3.4975e-07, 1.7871e-07, 3.1103e-07, 1.2739e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.179797
summ of probs approach
id: [18260] -> tensor([[3.5556e-07, 9.6819e-06, 3.9192e-06, 1.0276e-07, 2.7735e-06, 2.1806e-07,
         1.5526e-07, 1.8039e-09, 5.4312e-08, 7.3501e-07, 3.7060e-05, 1.0595e-06,
         3.0975e-07, 6.9597e-07, 4.1415e-06, 1.6734e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[8.1388e-06, 6.7059e-05, 8.3787e-06, 5.3216e-06, 2.7827e-05, 1.0775e-06,
         2.5485e-06, 2.6984e-07, 1.3687e-07, 7.5591e-06, 3.7818e-04, 1.7656e-06,
         1.9861e-06, 1.3363e-06, 5.1914e-05, 1.2959e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.164174
summ of probs approach
id: [18260] -> tensor([[5.5822e-07, 3.8470e-07, 4.3786e-08, 4.7087e-07, 9.5503e-08, 2.3009e-07,
         8.8029e-07, 5.7478e-07]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [1936] -> tensor([[8.0995e-06, 3.2967e-06, 4.2786e-07, 4.3662e-07, 3.8199e-07, 1.4528e-06,
         6.2326e-06, 3.5420e-06]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.055020
acc:  0.5
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:04.500515
path ['42', 'en', 'bloom', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
load model Duration: 0:00:11.737804
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloomz-560m SA null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[2.9875e-06, 6.2197e-06, 1.7274e-07, 1.4548e-07, 2.3619e-06, 1.1402e-09,
         2.2071e-06, 2.2716e-06, 2.0365e-07, 2.8859e-07, 8.6217e-07, 2.4277e-06,
         3.8420e-07, 2.9162e-06, 3.3929e-07, 1.1309e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.9911e-06, 1.8784e-05, 1.9536e-05, 1.9572e-06, 3.4543e-05, 1.7469e-07,
         1.2286e-05, 1.2860e-04, 7.0749e-07, 8.0036e-06, 2.4160e-06, 7.7534e-06,
         1.7819e-05, 6.0049e-06, 1.5350e-05, 1.8235e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.200046
summ of probs approach
id: [18260] -> tensor([[9.9337e-07, 1.2257e-05, 2.6997e-08, 3.8734e-08, 3.9602e-08, 1.9433e-06,
         1.3987e-06, 1.4054e-06, 1.4648e-08, 9.7799e-08, 1.0431e-08, 5.0854e-07,
         3.4990e-08, 7.8650e-07, 1.5087e-06, 3.5024e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.5834e-06, 4.1361e-05, 5.4001e-07, 4.6473e-07, 3.0471e-07, 2.9651e-06,
         1.2319e-06, 2.2447e-05, 1.6001e-06, 1.5020e-06, 1.3094e-07, 1.2833e-05,
         1.8399e-06, 9.1802e-06, 1.8596e-06, 8.7288e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.163459
summ of probs approach
id: [18260] -> tensor([[3.0053e-09, 7.5273e-06, 4.7955e-05, 7.2726e-07, 2.8502e-08, 1.9985e-06,
         6.7345e-08, 1.4178e-06, 9.5446e-07, 6.2665e-08, 1.6488e-07, 8.6965e-08,
         2.1181e-08, 1.0529e-06, 1.1045e-06, 4.6986e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.6437e-09, 2.7734e-05, 1.1969e-04, 3.0484e-06, 1.2803e-06, 2.1555e-05,
         1.6306e-07, 1.7613e-06, 9.2495e-06, 1.8666e-07, 5.6782e-06, 9.1573e-06,
         7.3217e-08, 2.1250e-05, 7.6880e-06, 2.2052e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.201618
summ of probs approach
id: [18260] -> tensor([[3.0942e-06, 2.4471e-06, 2.4783e-07, 5.0041e-07, 5.3480e-08, 9.2455e-08,
         2.2896e-07, 1.6747e-08, 7.7892e-09, 2.9962e-06, 1.1944e-06, 2.4882e-07,
         2.9741e-07, 5.0891e-07, 4.4300e-07, 2.3845e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.0154e-05, 1.0924e-05, 7.2719e-06, 7.2119e-06, 7.9957e-07, 2.5195e-07,
         2.9425e-06, 3.6336e-07, 1.6852e-06, 1.6767e-05, 2.8048e-06, 1.0817e-05,
         3.3389e-06, 3.5601e-06, 7.1626e-06, 2.6406e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.148218
summ of probs approach
id: [18260] -> tensor([[1.6567e-07, 6.7379e-10, 5.7798e-07, 6.5021e-07, 7.4077e-10, 1.2596e-05,
         1.3835e-08, 2.5211e-09, 3.1075e-06, 2.6560e-08, 4.0747e-09, 2.4560e-06,
         1.0257e-07, 8.2050e-09, 3.0808e-07, 5.3152e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.1589e-07, 1.2237e-07, 5.3050e-06, 5.9810e-06, 2.9696e-07, 1.4784e-04,
         6.0577e-08, 2.6432e-07, 2.1969e-05, 3.2481e-07, 2.0225e-07, 3.0499e-05,
         1.3926e-07, 9.6873e-08, 7.0830e-08, 3.2097e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.110357
summ of probs approach
id: [18260] -> tensor([[1.6503e-06, 1.7493e-07, 1.3964e-06, 1.0661e-06, 3.3717e-07, 2.6883e-07,
         8.1889e-06, 1.3570e-03, 2.5938e-08, 5.7934e-07, 3.1207e-07, 6.8525e-06,
         1.1409e-06, 1.5949e-07, 6.2042e-07, 1.0444e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.3622e-05, 8.4927e-06, 1.3748e-05, 4.2304e-06, 6.0255e-06, 1.4389e-07,
         5.9920e-05, 2.7101e-03, 1.6379e-07, 7.6954e-07, 1.1998e-05, 8.1083e-05,
         5.3982e-06, 1.4546e-06, 3.0110e-05, 1.1051e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.188213
summ of probs approach
id: [18260] -> tensor([[3.3203e-08, 1.1926e-06, 3.4333e-07, 3.6544e-07, 8.7657e-08, 1.6777e-06,
         4.1370e-08, 6.8507e-07, 2.9118e-04, 1.8760e-07, 3.0963e-07, 1.7522e-07,
         8.1483e-07, 5.3299e-07, 4.9530e-07, 1.2660e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.9372e-06, 1.0169e-05, 2.8405e-06, 6.2995e-06, 7.3988e-07, 1.2504e-05,
         3.5490e-07, 4.3679e-06, 1.9024e-04, 1.4013e-06, 1.3508e-05, 4.6232e-07,
         8.8798e-06, 1.1000e-06, 1.2222e-05, 1.4437e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.150364
summ of probs approach
id: [18260] -> tensor([[1.1262e-07, 1.3220e-07, 6.3113e-07, 3.0366e-07, 2.7820e-07, 1.4428e-07,
         1.6257e-07, 6.5845e-07, 2.9883e-05, 4.8273e-07, 4.9182e-07, 2.0121e-09,
         9.3834e-07, 5.4546e-08, 1.7961e-06, 7.4841e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.0100e-06, 7.1951e-07, 6.9470e-06, 4.1804e-06, 2.6857e-05, 3.7631e-07,
         7.0122e-07, 1.7761e-06, 7.7307e-04, 4.7398e-06, 4.8997e-07, 4.3945e-08,
         6.9838e-07, 4.6184e-06, 1.6436e-05, 6.4708e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.247201
summ of probs approach
id: [18260] -> tensor([[2.0577e-08, 1.2430e-04, 3.9504e-07, 6.5765e-08, 7.6801e-08, 3.8304e-07,
         5.1993e-08, 5.9984e-07, 4.1068e-08, 2.3320e-07, 4.4307e-06, 1.3980e-06,
         3.5654e-09, 8.2994e-07, 9.0277e-07, 2.5543e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.4603e-07, 1.6257e-03, 4.8541e-06, 1.4407e-06, 2.0348e-06, 3.5372e-06,
         4.3027e-06, 1.6725e-06, 8.3014e-07, 1.3645e-06, 1.3127e-05, 3.1036e-06,
         7.4507e-08, 4.2871e-06, 7.6652e-06, 5.1328e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.169601
summ of probs approach
id: [18260] -> tensor([[1.2359e-06, 2.8980e-07, 8.0591e-07, 4.2986e-06, 3.1617e-08, 1.2799e-08,
         5.3228e-08, 8.4952e-07, 3.9768e-08, 1.3021e-07, 6.8022e-07, 1.0379e-07,
         3.4132e-08, 2.8499e-07, 2.7440e-08, 4.7969e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.5888e-06, 2.1691e-05, 1.0949e-05, 1.5092e-05, 3.9347e-06, 7.2491e-07,
         4.8494e-07, 2.2369e-05, 4.9866e-06, 4.0026e-06, 1.3033e-06, 4.5497e-07,
         2.4263e-06, 6.3784e-07, 2.7018e-07, 5.1178e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.190999
summ of probs approach
id: [18260] -> tensor([[2.7551e-06, 1.3996e-06, 1.1305e-05, 4.1293e-07, 5.7051e-08, 7.8592e-08,
         4.7493e-08, 3.5930e-07, 7.5607e-08, 1.4219e-08, 1.5669e-07, 6.7504e-07,
         4.5449e-07, 1.4647e-06, 4.1577e-07, 7.4999e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[6.8706e-05, 2.5142e-05, 9.0824e-05, 3.0613e-06, 4.7844e-07, 2.9835e-06,
         4.8927e-07, 2.8859e-06, 1.7848e-07, 1.8546e-06, 3.7446e-06, 1.0124e-05,
         4.4361e-06, 1.2716e-06, 9.2234e-06, 4.1321e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.133464
summ of probs approach
id: [18260] -> tensor([[5.0953e-08, 1.3634e-06, 6.5549e-06, 3.8675e-07, 1.7283e-07, 6.6354e-09,
         1.2436e-06, 2.8954e-07, 1.8346e-06, 4.2445e-07, 8.6796e-10, 2.6882e-07,
         1.6129e-09, 4.4888e-07, 4.1488e-08, 8.2226e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.5640e-07, 3.8111e-07, 6.0908e-05, 1.7942e-05, 2.0353e-06, 1.0002e-07,
         1.9340e-05, 9.0920e-06, 1.1305e-05, 7.6796e-06, 6.2299e-08, 3.3509e-06,
         1.2380e-07, 1.0961e-05, 5.5496e-07, 1.4330e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.149090
summ of probs approach
id: [18260] -> tensor([[3.3184e-07, 2.2461e-08, 3.2302e-07, 6.1212e-07, 1.5734e-06, 4.9776e-06,
         1.2425e-08, 7.5595e-08]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [1936] -> tensor([[9.2096e-06, 2.1957e-08, 3.2610e-06, 2.4621e-06, 8.8461e-07, 8.6931e-06,
         1.1647e-06, 5.2883e-07]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.092274
acc:  0.535
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:02.168556
path ['42', 'en', 'bloomz', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [4273, 1], 'attention_mask': [1, 1]}
id: [4273, 1] -> [4273]
answer  {'input_ids': [150, 1], 'attention_mask': [1, 1]}
id: [150, 1] -> [150]
load model Duration: 0:00:05.737914
prompt_type null has 1 prompts in it
----------- 42 en google/flan-t5-base SA null 0 200 16 --------------
summ of probs approach
id: [4273] -> tensor([[3.3378e-03, 7.0271e-05, 1.0764e-05, 1.2064e-03, 4.1178e-04, 1.9595e-04,
         1.4519e-04, 3.8962e-04, 3.1370e-05, 4.8610e-05, 1.3328e-03, 7.8797e-05,
         2.0359e-04, 3.1447e-05, 1.2218e-03, 1.6867e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[6.3606e-03, 1.0812e-04, 8.6129e-04, 4.5583e-04, 8.1226e-04, 9.7889e-04,
         4.9961e-03, 1.0981e-04, 3.8644e-04, 6.3648e-04, 2.0618e-02, 2.5930e-02,
         3.2314e-03, 1.7532e-04, 9.2185e-03, 1.5400e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.118759
summ of probs approach
id: [4273] -> tensor([[2.4894e-04, 1.3038e-06, 2.4475e-05, 2.6039e-04, 1.2158e-04, 1.7073e-03,
         8.6471e-05, 4.2351e-05, 1.2619e-06, 1.2005e-04, 1.2719e-04, 1.1565e-04,
         2.5827e-03, 1.4173e-03, 2.0717e-05, 3.9595e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.2827e-04, 2.4500e-05, 1.2622e-03, 2.8361e-03, 1.9876e-04, 2.5871e-03,
         1.3654e-04, 4.6300e-05, 1.3231e-05, 3.0932e-04, 3.7351e-04, 1.3963e-04,
         2.0346e-02, 8.6610e-03, 7.0284e-04, 2.8635e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.093804
summ of probs approach
id: [4273] -> tensor([[1.0668e-03, 3.5620e-04, 3.0022e-05, 7.6083e-04, 6.4757e-07, 8.3732e-05,
         1.0672e-04, 1.0152e-04, 9.5024e-04, 2.5660e-04, 1.3317e-04, 1.5063e-04,
         2.4621e-03, 1.0054e-03, 5.3769e-05, 1.2318e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[9.4785e-04, 1.7798e-03, 6.0063e-06, 5.5258e-03, 1.4355e-06, 7.1535e-03,
         7.8822e-05, 1.7890e-04, 9.8505e-04, 2.3691e-02, 2.0934e-03, 1.6820e-04,
         2.9206e-03, 1.5257e-03, 6.8566e-04, 7.4428e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.140128
summ of probs approach
id: [4273] -> tensor([[3.2472e-05, 6.0035e-05, 2.9380e-04, 4.4577e-04, 1.0500e-04, 5.4653e-05,
         3.0353e-04, 2.3031e-05, 1.3701e-03, 2.7624e-03, 2.7281e-04, 2.5842e-05,
         8.0524e-05, 4.5311e-03, 1.7248e-03, 9.2667e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[4.0798e-05, 5.2160e-04, 1.2322e-03, 4.4122e-04, 8.9627e-03, 3.4291e-05,
         8.3665e-04, 2.9011e-05, 1.5528e-03, 3.8754e-03, 6.5835e-04, 9.9044e-06,
         6.0453e-05, 4.7871e-02, 7.4560e-04, 2.5787e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.095646
summ of probs approach
id: [4273] -> tensor([[3.5612e-04, 5.9038e-05, 1.4109e-03, 3.7665e-05, 7.3786e-07, 7.7356e-05,
         1.7666e-04, 6.6388e-06, 1.4716e-03, 4.6206e-05, 3.8121e-04, 1.4581e-04,
         1.6933e-05, 1.1078e-03, 5.7750e-04, 1.1180e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[4.8766e-03, 2.8932e-05, 1.3622e-02, 1.0260e-04, 9.8329e-05, 1.3075e-02,
         5.5310e-04, 3.2581e-06, 1.1078e-03, 1.1315e-03, 2.5102e-03, 3.6116e-03,
         2.1111e-05, 2.4194e-03, 2.4555e-03, 6.7165e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.106863
summ of probs approach
id: [4273] -> tensor([[4.3256e-04, 2.1707e-04, 9.1681e-06, 5.1504e-04, 1.5157e-03, 8.4714e-04,
         4.4793e-04, 8.0973e-05, 1.1002e-04, 5.8910e-04, 2.2405e-05, 3.8646e-04,
         3.4470e-04, 5.6048e-06, 3.2386e-04, 2.1157e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[5.8686e-04, 3.3528e-03, 5.4239e-05, 1.3067e-02, 6.7489e-03, 3.1447e-03,
         3.7284e-04, 2.7174e-04, 6.6998e-03, 2.7069e-02, 5.6072e-03, 6.4723e-03,
         1.9326e-04, 5.0932e-06, 2.1013e-02, 2.7744e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.095321
summ of probs approach
id: [4273] -> tensor([[9.6803e-05, 1.1227e-02, 1.8804e-04, 3.3463e-05, 8.5610e-06, 1.3817e-03,
         1.6250e-05, 2.0936e-04, 3.0532e-05, 5.0746e-04, 9.2575e-05, 4.1077e-04,
         8.1347e-04, 1.2387e-04, 5.2193e-03, 2.0491e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.9224e-04, 7.0396e-02, 1.1964e-03, 1.9190e-03, 4.3738e-06, 4.1043e-03,
         4.9030e-05, 1.2989e-04, 2.0641e-04, 2.7181e-04, 2.6612e-04, 9.8666e-03,
         7.8798e-03, 2.0412e-04, 3.0657e-02, 1.0392e-02]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.094746
summ of probs approach
id: [4273] -> tensor([[7.0404e-05, 1.7498e-04, 1.3370e-01, 5.2787e-05, 3.4988e-05, 1.5942e-03,
         3.4854e-04, 1.7708e-04, 3.7701e-05, 1.7440e-04, 7.8119e-06, 9.0890e-07,
         5.0656e-04, 1.4066e-05, 1.9203e-05, 1.2235e-02]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[6.6436e-05, 3.5279e-04, 5.2847e-01, 1.4085e-03, 8.2235e-04, 1.1534e-03,
         2.5537e-02, 1.6750e-02, 4.9164e-03, 9.9993e-04, 7.0529e-06, 1.0698e-05,
         6.9833e-04, 3.6155e-04, 1.2691e-03, 3.7273e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.082941
summ of probs approach
id: [4273] -> tensor([[5.1492e-04, 7.5845e-05, 5.9996e-05, 2.1784e-04, 2.0064e-03, 6.5544e-06,
         8.1134e-04, 3.8146e-05, 4.9531e-05, 2.2524e-04, 3.7664e-04, 6.0450e-04,
         3.6789e-05, 2.0405e-05, 2.1344e-05, 6.1277e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[6.0498e-04, 2.0044e-04, 5.2015e-03, 2.3704e-04, 1.7228e-02, 3.3226e-05,
         3.4611e-02, 7.7271e-05, 2.9267e-03, 1.4091e-04, 1.1375e-03, 5.1876e-04,
         4.1752e-05, 9.0699e-05, 1.6299e-04, 6.0002e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.073563
summ of probs approach
id: [4273] -> tensor([[8.5456e-04, 4.2580e-04, 1.0338e-05, 5.7112e-05, 2.0350e-03, 7.2502e-05,
         4.7392e-04, 7.1748e-05, 1.1385e-05, 1.3452e-06, 9.9381e-04, 1.4281e-04,
         1.1160e-04, 6.1966e-06, 3.9057e-04, 2.5141e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[8.2346e-03, 9.5570e-04, 4.2351e-05, 1.2445e-04, 3.5609e-03, 7.1434e-04,
         1.7945e-02, 5.1129e-05, 1.4942e-05, 8.8911e-05, 1.0550e-03, 1.1927e-03,
         1.6961e-04, 4.5353e-04, 4.5468e-04, 3.7152e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.082557
summ of probs approach
id: [4273] -> tensor([[1.9229e-03, 3.6534e-05, 7.5957e-04, 4.8612e-05, 2.0247e-04, 3.1871e-04,
         1.0755e-05, 1.9070e-03, 5.4082e-05, 3.3454e-04, 1.5871e-04, 1.8269e-05,
         2.0059e-06, 7.7793e-06, 1.0213e-05, 1.3280e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[7.9180e-04, 3.7139e-03, 2.9513e-03, 1.1320e-03, 5.4589e-03, 5.8309e-04,
         2.2125e-05, 1.2827e-02, 4.2690e-05, 6.6879e-03, 7.7122e-03, 1.3270e-03,
         3.3311e-06, 8.3413e-05, 6.8181e-04, 6.8081e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.077803
summ of probs approach
id: [4273] -> tensor([[3.5006e-05, 1.7071e-04, 5.0428e-04, 2.8212e-05, 1.5829e-04, 1.0922e-05,
         1.9325e-04, 2.3947e-04, 4.8002e-05, 4.9547e-06, 1.2656e-03, 7.7971e-05,
         1.9816e-04, 1.2921e-04, 7.8242e-05, 3.0683e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.7865e-05, 1.9765e-04, 2.2859e-04, 4.4467e-04, 1.1806e-04, 7.1461e-04,
         3.4132e-04, 2.7483e-04, 5.5170e-04, 7.4299e-06, 2.7209e-03, 6.7620e-05,
         1.0246e-03, 2.9602e-04, 2.5563e-04, 2.2893e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.073298
summ of probs approach
id: [4273] -> tensor([[7.8239e-04, 1.2690e-04, 1.2404e-03, 6.5131e-04, 3.1340e-05, 1.2373e-05,
         2.3884e-03, 1.9281e-05]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [150] -> tensor([[1.5413e-03, 1.8382e-04, 1.1420e-03, 1.1297e-02, 5.6248e-05, 3.2481e-05,
         4.6904e-02, 8.5477e-04]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.037066
acc:  0.675
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.188137
path ['42', 'en', 'flan', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:18<00:18, 18.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00,  9.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:22<00:00, 11.25s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 4874], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 4874] -> [4874]
answer  {'input_ids': [1, 694], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 694] -> [694]
load model Duration: 0:02:43.953317
prompt_type null has 1 prompts in it
----------- 42 en huggyllama/llama-7b SA null 0 200 16 --------------
summ of probs approach
id: [4874] -> tensor([[5.6624e-06, 3.5763e-07, 2.8610e-06, 1.0133e-06, 5.3644e-07, 1.4484e-05,
         2.5034e-06, 2.5630e-06, 6.0737e-05, 1.4901e-06, 1.5914e-05, 9.5367e-07,
         2.3246e-06, 1.2517e-06, 8.3447e-07, 1.3113e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[6.2764e-05, 8.4043e-06, 1.3828e-05, 1.0192e-05, 6.5565e-06, 2.8419e-04,
         2.9981e-05, 6.1512e-05, 1.2589e-03, 6.4790e-05, 3.9816e-05, 9.3460e-05,
         6.3956e-05, 2.5213e-05, 1.5378e-05, 1.1339e-03]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.311474
summ of probs approach
id: [4874] -> tensor([[3.6001e-05, 1.3709e-06, 1.0133e-06, 4.4107e-06, 2.2054e-06, 1.9073e-06,
         5.5432e-06, 1.7881e-07, 3.1590e-05, 1.3399e-04, 9.2387e-06, 7.5698e-06,
         1.2457e-05, 2.2709e-05, 1.2994e-05, 3.5763e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[2.6894e-04, 2.8968e-05, 8.1062e-06, 8.3447e-06, 4.2677e-05, 2.8014e-06,
         1.5950e-04, 1.9491e-04, 2.2805e-04, 4.0550e-03, 5.9247e-05, 9.3997e-05,
         9.2566e-05, 7.0477e-04, 1.1721e-03, 7.8440e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.273503
summ of probs approach
id: [4874] -> tensor([[1.8477e-06, 2.5630e-06, 1.8477e-06, 1.8001e-05, 3.4571e-06, 3.3975e-06,
         2.3842e-07, 8.3447e-07, 5.3644e-07, 2.2709e-05, 9.1791e-06, 2.7418e-06,
         5.9605e-07, 2.3842e-06, 3.8743e-06, 1.3709e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.0270e-04, 2.0802e-04, 4.4227e-05, 3.8147e-04, 4.9233e-05, 4.9770e-05,
         1.1742e-05, 1.1384e-05, 1.1605e-04, 7.0453e-05, 6.4135e-05, 2.3484e-05,
         3.7014e-05, 1.5366e-04, 1.2034e-04, 3.6955e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.507959
summ of probs approach
id: [4874] -> tensor([[4.1723e-07, 8.4043e-06, 7.8082e-06, 4.4107e-06, 6.3777e-06, 4.7684e-07,
         2.9206e-06, 6.5565e-07, 1.5497e-06, 2.2054e-06, 2.8014e-06, 1.1921e-06,
         2.6226e-05, 3.5763e-07, 5.5432e-06, 1.5914e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[3.5167e-06, 1.0884e-04, 1.3196e-04, 4.6074e-05, 2.9981e-05, 3.8743e-05,
         5.6326e-05, 3.6359e-06, 1.7560e-04, 1.6904e-04, 1.2755e-05, 9.0003e-06,
         2.1279e-05, 9.5367e-07, 6.2823e-05, 6.3992e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.368051
summ of probs approach
id: [4874] -> tensor([[1.8835e-05, 5.9462e-04, 1.1921e-06, 2.8610e-06, 1.2517e-06, 1.5676e-05,
         1.8477e-06, 8.9407e-06, 1.1921e-07, 1.1921e-07, 5.1260e-06, 3.5405e-05,
         1.1206e-05, 1.9073e-06, 9.8944e-06, 5.8413e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.3781e-04, 3.7003e-03, 2.6882e-05, 2.3246e-06, 7.5102e-06, 8.1599e-05,
         2.5332e-05, 1.6153e-04, 8.3447e-07, 2.9206e-06, 4.5896e-05, 2.0332e-03,
         9.7036e-05, 3.0220e-05, 1.1796e-04, 1.9312e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.307001
summ of probs approach
id: [4874] -> tensor([[6.7472e-05, 1.5318e-05, 1.4305e-06, 1.7285e-06, 7.1526e-07, 2.2471e-05,
         4.1723e-07, 4.1604e-05, 1.0133e-06, 6.1989e-06, 5.7220e-06, 6.9737e-06,
         1.3351e-05, 6.3181e-06, 3.7861e-04, 1.3113e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[4.7183e-04, 3.4511e-05, 1.6332e-05, 2.6441e-04, 2.4438e-06, 6.4135e-04,
         8.5831e-06, 5.7745e-04, 7.9489e-04, 5.7280e-05, 3.1114e-04, 5.7459e-05,
         1.5366e-04, 3.2008e-05, 3.3226e-03, 1.0431e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.275951
summ of probs approach
id: [4874] -> tensor([[2.5630e-06, 2.3246e-06, 3.8743e-06, 2.0862e-06, 1.8179e-05, 1.1921e-06,
         2.9802e-06, 4.7684e-07, 7.7486e-07, 5.2214e-05, 4.4227e-05, 8.0466e-06,
         3.6359e-06, 4.3511e-06, 4.1723e-07, 1.9670e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[9.7573e-05, 4.8459e-05, 1.4210e-04, 5.6326e-05, 2.6107e-05, 1.0377e-04,
         1.2994e-05, 5.4836e-06, 2.1420e-03, 2.3918e-03, 7.1955e-04, 5.7995e-05,
         9.9182e-05, 9.0003e-05, 1.6570e-05, 1.2517e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.304446
summ of probs approach
id: [4874] -> tensor([[7.7486e-07, 6.6757e-06, 3.8147e-06, 4.0531e-06, 2.3842e-07, 1.6093e-06,
         1.4901e-06, 4.4703e-06, 1.0729e-06, 3.3200e-05, 2.3842e-07, 1.1921e-06,
         1.1873e-03, 8.1062e-06, 3.6955e-06, 1.6689e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[5.6028e-06, 7.0512e-05, 4.6301e-04, 1.4961e-05, 8.9407e-06, 2.7895e-05,
         1.1444e-05, 1.8263e-04, 3.1710e-05, 9.7752e-04, 2.7597e-05, 2.3246e-05,
         4.9210e-03, 2.0862e-05, 3.9101e-05, 3.0589e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.324198
summ of probs approach
id: [4874] -> tensor([[1.0490e-05, 8.5831e-06, 1.5497e-06, 4.9472e-06, 1.6689e-06, 5.3644e-07,
         1.3113e-06, 8.9705e-05, 5.9605e-08, 6.9141e-06, 2.7418e-06, 5.4240e-06,
         1.4782e-05, 1.0729e-06, 6.2585e-06, 1.7881e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[6.3241e-05, 5.0545e-04, 1.2153e-04, 7.7844e-05, 1.1027e-05, 2.1458e-05,
         1.1563e-05, 8.6117e-04, 8.0466e-06, 5.5671e-05, 3.7575e-04, 5.5373e-05,
         8.8310e-04, 1.3888e-05, 2.0087e-05, 2.7239e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.196852
summ of probs approach
id: [4874] -> tensor([[3.0398e-06, 2.6822e-06, 3.1590e-06, 2.3842e-07, 2.0862e-06, 8.7678e-05,
         7.3969e-05, 1.7881e-06, 2.9206e-06, 7.5102e-06, 2.4438e-06, 2.9802e-06,
         1.1861e-05, 3.2187e-06, 5.3406e-05, 7.1526e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[7.1704e-05, 5.3704e-05, 2.1040e-05, 6.3181e-06, 3.3259e-05, 4.2987e-04,
         6.3019e-03, 1.3947e-05, 4.4882e-05, 1.0222e-04, 7.1049e-05, 2.8729e-04,
         1.2565e-04, 4.0174e-05, 8.5497e-04, 1.6117e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.196028
summ of probs approach
id: [4874] -> tensor([[8.3447e-07, 1.6987e-05, 4.9889e-05, 6.9737e-06, 8.8215e-06, 8.9407e-07,
         9.9540e-06, 1.1325e-06, 2.4438e-06, 9.2983e-06, 8.3447e-07, 2.8610e-06,
         2.3246e-06, 6.5565e-07, 7.0989e-05, 3.5763e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[6.9737e-06, 3.9101e-04, 9.9659e-05, 7.0906e-04, 1.7262e-04, 1.9491e-05,
         6.2227e-04, 3.8505e-05, 2.2233e-05, 1.9372e-05, 3.5584e-05, 8.0168e-05,
         4.6849e-05, 8.7023e-06, 1.1396e-03, 3.8266e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.250550
summ of probs approach
id: [4874] -> tensor([[2.6226e-06, 1.6093e-06, 4.7088e-06, 2.9802e-07, 2.1458e-06, 9.5367e-07,
         7.5698e-06, 1.1277e-04, 4.7684e-07, 2.8372e-05, 7.1526e-07, 2.3377e-04,
         6.8545e-06, 1.1623e-05, 1.1504e-05, 5.9605e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[9.4175e-06, 1.2457e-05, 4.1008e-05, 3.7551e-06, 9.2030e-05, 4.8876e-06,
         1.9407e-04, 3.8681e-03, 4.0531e-06, 1.8001e-04, 1.9920e-04, 1.0719e-03,
         7.3254e-05, 4.4644e-05, 1.4544e-04, 3.5167e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.295055
summ of probs approach
id: [4874] -> tensor([[1.1921e-06, 1.8549e-04, 4.3511e-06, 3.2783e-06, 2.1935e-05, 8.9407e-07,
         1.9073e-06, 4.2915e-06]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
summ of probs approach
id: [694] -> tensor([[4.1127e-06, 1.0424e-03, 1.8847e-04, 2.7061e-05, 6.4492e-05, 3.8128e-03,
         2.5988e-05, 2.0659e-04]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.128531
acc:  0.51
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:03.763587
path ['42', 'en', 'llama', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [36339, 1], 'attention_mask': [1, 1]}
id:[36339, 1]
answer  {'input_ids': [375, 1], 'attention_mask': [1, 1]}
id:[375, 1]
load model Duration: 0:00:06.739770
prompt_type null has 1 prompts in it
----------- 42 en bigscience/mt0-small SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([1.5301e-03, 1.0833e-03, 1.2127e-03, 1.1716e-03, 2.5685e-03, 7.4013e-04,
        6.4597e-04, 4.2057e-03, 8.7222e-01, 7.7034e-04, 2.4104e-02, 8.4311e-04,
        1.1919e-03, 5.0021e-04, 1.0513e-03, 8.7882e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0667e-02, 1.0105e-03, 1.2034e-03, 1.1698e-03, 2.6384e-03, 1.0274e-03,
        2.3682e-03, 2.2794e-02, 8.7277e-01, 7.3856e-04, 2.5431e-02, 8.5364e-04,
        1.1789e-03, 7.5868e-04, 9.9068e-04, 8.8870e-04], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.123236
summ of probs approach
probs_ shape tensor([8.4016e-04, 1.9667e-04, 1.4165e-03, 8.6114e-01, 2.4373e-04, 1.2127e-03,
        9.3559e-04, 1.7591e-03, 2.3255e-04, 9.9379e-04, 3.4063e-04, 5.4918e-04,
        5.5185e-04, 1.3040e-03, 8.0963e-04, 8.7819e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.7261e-03, 3.7939e-04, 1.3826e-03, 8.6115e-01, 4.3313e-04, 1.2047e-03,
        1.1579e-03, 2.9849e-03, 6.6551e-04, 7.5799e-04, 3.2642e-04, 1.6159e-03,
        9.0490e-04, 1.5298e-03, 9.3869e-04, 8.3634e-04], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.076188
summ of probs approach
probs_ shape tensor([2.5249e-03, 1.0027e-03, 1.2045e-04, 2.2398e-04, 1.6505e-03, 5.7174e-04,
        4.4714e-04, 3.0743e-03, 6.7257e-04, 6.8890e-04, 9.4561e-01, 1.2829e-03,
        1.4758e-03, 4.9197e-04, 3.3460e-04, 7.2380e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.5211e-03, 9.5296e-04, 9.0698e-04, 3.1728e-04, 9.3560e-03, 5.7077e-04,
        4.7622e-04, 1.7600e-02, 8.3887e-04, 6.7811e-04, 9.4561e-01, 1.3597e-03,
        1.5594e-03, 4.9439e-04, 7.2888e-04, 5.9041e-03], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.098197
summ of probs approach
probs_ shape tensor([2.3953e-04, 5.6707e-04, 1.8779e-03, 5.5115e-04, 7.2577e-04, 2.0128e-03,
        5.9487e-04, 1.7400e-04, 2.2777e-04, 9.2925e-04, 9.6836e-01, 5.9525e-04,
        4.9331e-04, 6.3731e-04, 3.5451e-04, 1.5275e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.4493e-04, 9.7170e-04, 1.0967e-02, 5.3237e-04, 1.1547e-03, 2.6046e-03,
        5.9509e-04, 1.8429e-04, 3.6336e-04, 1.4805e-03, 9.6836e-01, 1.8855e-03,
        7.9647e-04, 9.1013e-04, 3.7509e-04, 1.4399e-03], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.088309
summ of probs approach
probs_ shape tensor([7.7180e-04, 2.5555e-03, 3.3528e-04, 3.2603e-04, 8.8555e-01, 1.2567e-03,
        7.0712e-04, 9.8750e-04, 5.2538e-04, 2.5284e-03, 7.7692e-04, 9.3549e-04,
        1.4614e-03, 4.0755e-04, 2.5800e-04, 6.3252e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.1521e-03, 3.0641e-03, 3.3888e-04, 3.2258e-04, 8.8559e-01, 1.2675e-03,
        1.5128e-03, 1.0738e-03, 5.2166e-04, 5.4380e-03, 1.1732e-03, 9.0246e-04,
        1.4883e-03, 3.8299e-04, 1.3122e-03, 1.4760e-03], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.059866
summ of probs approach
probs_ shape tensor([6.9209e-05, 3.5360e-04, 1.0364e-03, 1.0091e-03, 2.6441e-04, 4.1277e-04,
        9.4236e-05, 3.0354e-04, 8.1306e-04, 5.2264e-04, 1.6800e-04, 6.8925e-04,
        2.9962e-03, 9.8230e-01, 1.8462e-04, 4.0671e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.0559e-05, 6.0905e-04, 1.0469e-03, 9.4067e-04, 2.6236e-04, 4.9244e-04,
        2.5767e-04, 2.8641e-04, 1.2079e-03, 3.1759e-03, 2.7394e-04, 2.7487e-03,
        3.4327e-03, 9.8230e-01, 3.3437e-04, 2.3013e-03], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.063887
summ of probs approach
probs_ shape tensor([5.9445e-04, 3.4445e-04, 5.2465e-04, 1.0321e-03, 2.0357e-03, 9.9022e-04,
        7.9569e-04, 3.7174e-04, 6.8333e-04, 3.2321e-03, 5.9329e-04, 9.0270e-01,
        4.7462e-04, 1.3917e-03, 1.5249e-03, 7.6632e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.0961e-04, 7.0834e-04, 2.7493e-03, 9.6592e-03, 2.0234e-03, 9.8722e-04,
        2.6157e-03, 3.4871e-04, 1.0219e-03, 3.1785e-03, 5.5394e-04, 9.0270e-01,
        2.7102e-03, 2.4866e-03, 1.4193e-03, 7.4604e-04], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.094203
summ of probs approach
probs_ shape tensor([0.0042, 0.0006, 0.0033, 0.0046, 0.0011, 0.0010, 0.0008, 0.0008, 0.0008,
        0.0061, 0.0004, 0.0002, 0.0006, 0.0012, 0.0012, 0.0013],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0053, 0.0006, 0.0033, 0.0047, 0.0010, 0.0023, 0.0030, 0.0009, 0.0019,
        0.0540, 0.0004, 0.0002, 0.0011, 0.0016, 0.0012, 0.0017],
       device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.073741
summ of probs approach
probs_ shape tensor([4.0652e-04, 3.0016e-04, 7.4044e-04, 6.7356e-04, 7.5736e-04, 1.3575e-04,
        1.0200e-03, 3.2032e-04, 5.6260e-04, 5.0151e-04, 8.0571e-04, 1.0127e-03,
        9.5557e-01, 1.0715e-03, 7.9648e-04, 1.5255e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.8565e-04, 4.1009e-04, 7.3483e-04, 7.2408e-04, 1.8503e-03, 2.3647e-04,
        6.9469e-03, 5.7382e-04, 5.5141e-04, 5.8101e-04, 4.0505e-03, 1.0043e-03,
        9.5557e-01, 2.4862e-03, 3.7364e-03, 3.3578e-03], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.082254
summ of probs approach
probs_ shape tensor([5.8706e-04, 6.7587e-04, 1.8037e-03, 1.0428e-03, 1.8989e-03, 2.5653e-04,
        8.1470e-04, 6.2312e-04, 9.7585e-04, 8.9084e-01, 7.4426e-04, 6.5293e-04,
        5.4587e-04, 6.0213e-04, 8.9774e-04, 5.5049e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.6348e-03, 7.1754e-04, 1.7051e-03, 2.9297e-03, 2.2090e-03, 3.4103e-04,
        2.7285e-03, 7.0702e-04, 9.7648e-04, 8.9085e-01, 9.6151e-04, 6.4813e-04,
        2.0232e-03, 5.3286e-04, 8.1193e-04, 7.4500e-04], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.058972
summ of probs approach
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
probs_ shape tensor([4.0739e-04, 8.9457e-04, 1.7646e-02, 1.2404e-03, 2.0694e-04, 2.5561e-04,
        9.5085e-01, 1.9888e-03, 6.9803e-04, 8.0611e-04, 1.1192e-03, 7.5233e-04,
        1.1789e-03, 1.7943e-03, 1.3060e-03, 8.4245e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.6376e-04, 9.8996e-04, 7.3557e-02, 3.0328e-03, 1.2505e-03, 1.6154e-04,
        9.5087e-01, 2.1679e-03, 6.3343e-04, 1.1874e-03, 1.7352e-03, 1.3083e-03,
        1.1620e-03, 2.5707e-03, 1.2279e-03, 8.2085e-04], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.065733
summ of probs approach
probs_ shape tensor([5.1689e-04, 1.2486e-03, 1.2599e-03, 4.8251e-04, 5.2161e-04, 5.4295e-04,
        4.3470e-04, 1.8536e-03, 2.9163e-04, 8.1316e-04, 8.9489e-04, 8.5729e-04,
        1.0565e-03, 7.7863e-04, 6.3207e-01, 1.2239e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.2130e-04, 1.2070e-03, 1.2703e-03, 5.6999e-04, 5.1546e-04, 6.0339e-04,
        4.5378e-04, 1.8108e-03, 4.7672e-04, 8.1246e-04, 1.6004e-03, 8.6661e-04,
        2.5070e-03, 1.0460e-03, 6.3208e-01, 1.1232e-02], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.083462
summ of probs approach
probs_ shape tensor([9.6084e-04, 8.8048e-01, 1.6449e-03, 9.2277e-04, 3.2019e-03, 6.7970e-04,
        2.8590e-04, 1.0922e-03], device='cuda:0') torch.Size([8])
summ of probs approach
probs_ shape tensor([2.5435e-03, 8.8050e-01, 3.4989e-03, 9.2826e-04, 3.2040e-03, 6.5266e-04,
        5.4138e-04, 3.4219e-03], device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.045262
acc:  0.765
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.030429
path ['42', 'en', 't0', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Using NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  3.07it/s]100%|██████████| 3/3 [00:00<00:00,  7.65it/s]
loading model Duration: 0:00:02.068062
filter data Duraction: 0:00:00.000003
use_neutral is  True
len of entail_examples , neutral_examples, contra_examples:  66 66 66
len dataset  198
random sample Duraction: 0:03:06.121683
create dataloader Duration: 0:03:08.318454
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
answer  {'input_ids': [137111], 'attention_mask': [1]}
id:[137111]
load model Duration: 0:00:10.211548
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloom-560m NLI null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[2.4253e-06, 6.0094e-06, 2.6838e-07, 4.1084e-06, 1.6800e-08, 1.9820e-07,
         4.6258e-06, 2.1909e-06, 4.1626e-06, 3.3024e-08, 2.7241e-07, 6.0088e-05,
         5.2455e-08, 1.9110e-05, 4.6504e-08, 1.1991e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.9138e-04, 1.9448e-04, 5.6099e-06, 9.9171e-05, 5.0017e-07, 3.1826e-06,
         2.5753e-05, 3.8085e-05, 1.7496e-05, 2.6744e-06, 8.9749e-06, 3.0859e-04,
         1.6448e-06, 5.3896e-05, 3.6027e-07, 1.6820e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[4.6163e-06, 4.0259e-06, 7.2311e-08, 4.3418e-05, 3.0050e-09, 3.1410e-07,
         6.0159e-06, 1.8266e-05, 1.7857e-06, 9.3463e-08, 2.8249e-07, 2.0075e-04,
         1.2496e-07, 7.9669e-06, 1.7042e-08, 6.0703e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.200395
summ of probs approach
id: [18260] -> tensor([[1.2286e-05, 2.3072e-07, 1.3357e-06, 5.7832e-08, 1.1598e-05, 7.1576e-07,
         6.9387e-05, 4.6487e-07, 6.1590e-07, 1.6161e-06, 1.3529e-06, 3.1005e-08,
         8.6702e-07, 1.1803e-06, 3.3831e-07, 2.4605e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[7.7119e-05, 1.0886e-04, 2.2938e-06, 3.7560e-06, 9.2764e-05, 3.4865e-06,
         1.7555e-03, 2.1516e-06, 2.1959e-06, 1.8465e-06, 2.9831e-05, 7.6898e-07,
         1.3725e-05, 4.3340e-06, 1.0104e-05, 6.9901e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.3283e-04, 1.9152e-07, 2.0530e-07, 9.7736e-09, 2.6176e-05, 7.2440e-06,
         8.9218e-05, 3.1022e-07, 7.2407e-08, 1.2326e-06, 8.4747e-06, 1.4653e-08,
         1.2098e-06, 3.4182e-07, 7.7541e-07, 1.4862e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.152436
summ of probs approach
id: [18260] -> tensor([[3.4987e-08, 2.4431e-07, 3.8538e-07, 1.2878e-07, 1.8553e-07, 4.7658e-08,
         3.1793e-07, 6.4962e-07, 7.5820e-06, 5.5389e-06, 9.5310e-09, 3.3581e-07,
         3.1143e-06, 1.6026e-06, 7.0627e-06, 5.4251e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.1116e-06, 1.5179e-05, 7.6490e-06, 1.4732e-05, 1.0295e-06, 9.0048e-07,
         1.2575e-05, 2.6423e-05, 1.1152e-04, 6.2485e-05, 3.6853e-08, 6.1130e-06,
         2.4754e-05, 5.7969e-06, 4.7039e-05, 1.4290e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[9.0394e-08, 9.3689e-07, 1.8333e-07, 3.5965e-07, 3.4951e-08, 1.2079e-08,
         1.1963e-06, 4.7619e-07, 1.5197e-05, 1.0458e-04, 2.8274e-09, 2.8211e-07,
         3.7092e-07, 6.2411e-07, 1.9241e-05, 2.5520e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.251741
summ of probs approach
id: [18260] -> tensor([[2.6572e-06, 1.0100e-06, 2.9169e-05, 5.0219e-07, 8.3602e-08, 5.2342e-07,
         4.0818e-07, 7.0292e-07, 2.4041e-07, 4.7159e-07, 9.8956e-06, 8.7214e-05,
         1.9077e-05, 1.9102e-07, 8.0632e-08, 4.7707e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.5587e-06, 5.8138e-05, 3.3632e-04, 5.0746e-05, 5.0653e-06, 6.4836e-05,
         5.9966e-06, 1.0504e-05, 2.9807e-06, 4.3739e-06, 6.9160e-05, 8.2699e-05,
         1.9225e-04, 3.6778e-06, 8.7929e-06, 1.1076e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[7.1830e-06, 3.6361e-07, 5.0499e-05, 2.6994e-07, 7.2604e-08, 3.5156e-07,
         1.8156e-07, 2.8536e-08, 5.2754e-07, 9.8022e-07, 1.4272e-05, 1.6498e-04,
         5.0445e-05, 4.4192e-07, 7.4481e-08, 4.9235e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.133758
summ of probs approach
id: [18260] -> tensor([[6.7503e-06, 1.2448e-05, 6.3328e-08, 1.4464e-06, 1.5911e-07, 2.0528e-07,
         1.5099e-05, 3.2029e-06, 2.1746e-06, 3.5395e-07, 4.6228e-07, 6.5697e-08,
         1.1922e-05, 7.3021e-08, 3.9890e-06, 1.1336e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.7318e-06, 1.8537e-04, 5.3663e-06, 1.4146e-05, 1.2621e-05, 7.3792e-06,
         6.0690e-05, 1.7789e-06, 2.8123e-06, 9.9865e-07, 5.9242e-06, 1.3612e-06,
         1.1523e-04, 2.0047e-06, 7.1691e-05, 2.1650e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[8.6541e-07, 4.4282e-05, 2.2276e-08, 3.1677e-06, 4.4752e-07, 3.3718e-07,
         2.4398e-05, 2.8266e-07, 2.5485e-06, 4.6700e-08, 1.4088e-06, 1.4451e-07,
         5.6413e-06, 3.6017e-08, 2.4597e-05, 1.0880e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.117219
summ of probs approach
id: [18260] -> tensor([[1.3562e-07, 5.6827e-08, 1.0928e-07, 2.8814e-07, 4.2025e-05, 3.8459e-05,
         7.4203e-06, 7.8564e-06, 4.6973e-06, 2.0585e-08, 4.3561e-06, 1.3416e-06,
         4.8293e-07, 2.5534e-06, 1.9360e-07, 5.2071e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[7.6993e-07, 2.2158e-06, 6.7087e-07, 2.8866e-06, 2.5423e-05, 1.4611e-04,
         5.5734e-06, 1.3787e-05, 1.5254e-05, 3.9198e-06, 5.3260e-05, 6.1383e-06,
         6.7673e-06, 3.5674e-05, 2.8637e-06, 4.4696e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.1708e-07, 4.2216e-08, 1.0485e-06, 7.3933e-07, 4.7807e-05, 4.9160e-05,
         3.7230e-07, 3.8953e-06, 2.7019e-06, 7.5818e-08, 2.3214e-06, 1.1464e-06,
         5.1732e-07, 1.2900e-05, 1.3781e-07, 6.8450e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.127595
summ of probs approach
id: [18260] -> tensor([[1.0081e-07, 2.5699e-07, 1.2037e-06, 7.2257e-07, 4.2201e-07, 1.4337e-05,
         6.0663e-06, 9.6256e-09, 2.0965e-05, 1.2746e-07, 9.6127e-07, 1.2387e-07,
         2.0486e-05, 2.3320e-07, 2.2410e-05, 2.4038e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.6399e-07, 3.8518e-05, 3.5917e-06, 7.1913e-06, 2.7281e-06, 9.0388e-05,
         4.4466e-05, 6.9614e-06, 7.9497e-05, 2.6217e-06, 9.6527e-06, 2.8273e-05,
         8.1000e-05, 4.7732e-06, 5.5774e-05, 2.7392e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[8.3200e-08, 2.7712e-07, 3.3890e-07, 1.8625e-07, 1.2157e-07, 3.0341e-06,
         1.0483e-05, 6.1886e-08, 9.0390e-05, 1.7176e-08, 3.3269e-06, 9.2680e-08,
         1.4538e-05, 2.6246e-07, 3.4601e-04, 7.9796e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.204356
summ of probs approach
id: [18260] -> tensor([[8.7026e-05, 1.4012e-06, 3.6743e-08, 2.1928e-07, 1.1037e-07, 3.6064e-05,
         4.9415e-07, 1.2543e-06, 2.4109e-05, 2.7718e-05, 4.7468e-06, 3.3186e-05,
         4.6963e-07, 4.5531e-07, 4.5142e-07, 1.3593e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.0947e-04, 4.5077e-06, 1.2961e-06, 3.5870e-06, 2.6239e-05, 1.0649e-04,
         1.4331e-06, 1.8189e-06, 1.0316e-04, 8.3674e-05, 1.0694e-04, 5.5316e-04,
         1.0589e-05, 2.9634e-06, 1.9486e-06, 6.3749e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[5.4783e-06, 9.1286e-06, 1.4742e-07, 4.5955e-07, 1.3161e-07, 2.8939e-05,
         5.7529e-07, 1.6080e-06, 3.4117e-05, 1.9570e-05, 7.0530e-06, 1.2196e-04,
         3.2158e-07, 6.1118e-08, 1.6189e-07, 3.6741e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.131808
summ of probs approach
id: [18260] -> tensor([[2.6417e-07, 3.2524e-07, 2.2224e-06, 9.8126e-06, 4.6847e-08, 1.2222e-07,
         1.1953e-07, 9.5754e-06, 7.2546e-08, 3.5947e-06, 1.3675e-07, 1.3299e-07,
         3.7525e-07, 1.8147e-06, 1.2788e-07, 2.7301e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.9955e-05, 1.0918e-05, 5.4805e-06, 5.1073e-05, 4.1599e-06, 1.7121e-06,
         6.7536e-07, 6.3541e-05, 5.6590e-06, 2.4990e-04, 9.4361e-07, 5.4393e-06,
         3.2468e-06, 2.4569e-05, 3.1033e-06, 1.4504e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[2.5717e-08, 6.7255e-07, 1.6806e-06, 2.4858e-05, 1.2026e-07, 2.9526e-08,
         2.6643e-07, 1.2264e-05, 1.3498e-07, 1.1223e-06, 3.7859e-08, 3.4659e-08,
         2.6894e-07, 4.2161e-06, 5.9702e-08, 6.9911e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.116235
summ of probs approach
id: [18260] -> tensor([[8.4903e-08, 1.6321e-05, 3.0651e-06, 5.1732e-07, 2.2144e-07, 9.2354e-08,
         8.3478e-08, 6.2599e-06, 1.3055e-05, 5.9406e-07, 3.2696e-06, 6.3018e-07,
         8.7527e-07, 5.6785e-08, 4.9290e-07, 1.0285e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[6.5664e-07, 5.0006e-05, 3.5848e-05, 1.3875e-06, 3.7155e-06, 4.2751e-06,
         1.7415e-06, 4.2270e-05, 3.6600e-04, 2.6439e-06, 3.1082e-05, 8.3684e-06,
         5.0926e-05, 1.1182e-06, 7.4115e-06, 1.5912e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.8458e-07, 8.8260e-06, 9.1482e-06, 6.9122e-07, 1.0066e-08, 1.6347e-08,
         5.4016e-08, 1.4197e-05, 1.0425e-04, 6.0024e-07, 2.2662e-06, 4.0200e-07,
         1.4680e-06, 3.2294e-08, 8.1295e-06, 7.9650e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.147011
summ of probs approach
id: [18260] -> tensor([[1.6754e-05, 2.0718e-07, 3.8168e-05, 4.6860e-07, 7.2416e-07, 4.5739e-07,
         1.7590e-07, 7.4583e-05, 1.1053e-05, 4.3987e-07, 4.8677e-07, 1.0221e-05,
         2.0920e-08, 2.3293e-07, 3.9371e-07, 2.2903e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.9920e-05, 1.3709e-06, 1.9364e-04, 1.2865e-05, 9.9402e-07, 2.9812e-05,
         9.1106e-07, 8.2795e-05, 5.9035e-05, 3.9938e-06, 1.4335e-05, 6.1049e-06,
         3.9157e-07, 1.7013e-06, 2.8610e-05, 9.9372e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[7.6527e-05, 1.2323e-07, 5.4623e-05, 9.4378e-07, 2.9428e-07, 3.7436e-07,
         3.5030e-08, 3.6266e-04, 9.3178e-05, 3.8106e-07, 2.4848e-06, 9.5727e-06,
         1.3007e-08, 4.5967e-07, 5.7297e-07, 1.1807e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.148679
summ of probs approach
id: [18260] -> tensor([[5.1967e-08, 1.0887e-05, 9.8479e-07, 3.5939e-07, 1.1292e-06, 1.8563e-07,
         3.7069e-05, 7.3292e-09, 3.4500e-08, 5.2610e-07, 3.1562e-07, 6.0942e-07,
         2.7009e-07, 4.8550e-06, 5.4949e-07, 9.2011e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.1582e-06, 1.8718e-04, 9.4894e-06, 4.4256e-06, 1.3145e-05, 3.8537e-06,
         5.0364e-04, 1.7105e-07, 3.8485e-06, 4.7653e-06, 2.2062e-06, 7.4290e-06,
         9.5172e-06, 3.5291e-05, 4.8650e-06, 1.0818e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[2.2043e-08, 1.1503e-05, 1.0727e-06, 2.4377e-07, 1.0631e-06, 2.0643e-07,
         1.8327e-04, 1.9645e-09, 1.2734e-08, 4.2482e-07, 6.0051e-07, 9.5767e-07,
         4.4680e-07, 1.7363e-05, 5.8570e-07, 7.1621e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.162156
summ of probs approach
id: [18260] -> tensor([[1.4539e-08, 6.2746e-06, 6.2189e-06, 4.5543e-06, 2.7230e-07, 5.8270e-08]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [1936] -> tensor([[2.8422e-06, 1.1050e-04, 1.0902e-04, 2.8444e-05, 4.3747e-05, 1.7037e-06]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [137111] -> tensor([[1.0834e-07, 6.2205e-05, 3.0338e-05, 3.2269e-05, 5.8936e-07, 2.2651e-07]],
       device='cuda:0'), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.052900
acc:  0.37373737373737376
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.990679
path ['42', 'en', 'bloom', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
answer  {'input_ids': [137111], 'attention_mask': [1]}
id:[137111]
load model Duration: 0:00:09.635337
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloomz-560m NLI null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[1.0275e-07, 6.4816e-09, 1.6495e-08, 1.9724e-08, 2.8037e-09, 2.2312e-09,
         7.3909e-08, 1.3383e-09, 5.6294e-09, 1.9662e-10, 2.6619e-09, 2.3916e-07,
         2.2154e-07, 8.8081e-11, 4.3040e-08, 9.3906e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.1081e-07, 6.1703e-08, 1.4755e-07, 4.7527e-07, 2.9482e-08, 2.5171e-08,
         4.5185e-07, 2.0972e-07, 3.4212e-09, 5.6325e-09, 2.1071e-08, 2.9286e-06,
         4.8367e-07, 1.7330e-09, 1.9979e-07, 2.3043e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[3.6994e-07, 2.0338e-09, 6.6708e-09, 1.4304e-08, 2.2968e-10, 2.1698e-10,
         1.1247e-08, 3.9647e-11, 5.0147e-10, 7.6828e-11, 2.7507e-10, 8.4242e-08,
         7.2194e-08, 2.4250e-11, 1.7906e-08, 1.0575e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.190886
summ of probs approach
id: [18260] -> tensor([[2.1169e-10, 6.1186e-08, 5.4962e-07, 9.9001e-09, 1.4316e-08, 2.4502e-08,
         1.6594e-09, 2.1727e-07, 3.3223e-07, 5.7461e-08, 7.6748e-06, 2.0393e-07,
         1.1371e-08, 1.7321e-08, 4.9093e-08, 6.6035e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.8022e-08, 2.5870e-06, 3.7214e-07, 1.2585e-07, 6.6557e-08, 1.2463e-08,
         2.3017e-08, 1.0224e-06, 6.2981e-06, 2.2872e-07, 4.0616e-05, 9.1082e-07,
         1.0733e-06, 5.3051e-07, 7.5100e-08, 1.3839e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[2.6089e-11, 7.6615e-08, 2.2478e-08, 1.0213e-09, 2.3749e-09, 1.8996e-09,
         1.4704e-11, 1.0479e-07, 1.3146e-07, 7.3902e-09, 3.9366e-07, 4.2252e-08,
         3.9544e-09, 2.7341e-09, 1.3070e-08, 6.4802e-11]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.141479
summ of probs approach
id: [18260] -> tensor([[1.0098e-08, 2.9949e-10, 1.1361e-08, 1.6265e-09, 5.6323e-09, 7.4502e-10,
         6.7956e-09, 9.5376e-09, 9.2994e-08, 5.1942e-09, 4.6773e-08, 3.1888e-09,
         3.1047e-10, 2.3444e-09, 9.2780e-11, 2.6332e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.1116e-08, 4.4056e-09, 2.8916e-07, 1.3072e-07, 1.9377e-08, 3.5466e-09,
         1.3052e-07, 3.9128e-07, 1.6665e-06, 5.6135e-08, 1.5711e-06, 8.5699e-09,
         1.0587e-08, 1.3948e-08, 1.5341e-07, 1.1921e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.4399e-09, 1.6262e-11, 2.9813e-09, 3.7809e-10, 1.4678e-10, 4.9267e-10,
         7.5810e-10, 2.3819e-09, 1.7460e-08, 1.0322e-09, 6.2821e-09, 3.3470e-10,
         7.0305e-12, 9.9924e-09, 4.6435e-11, 3.9179e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.110624
summ of probs approach
id: [18260] -> tensor([[5.8634e-08, 1.1330e-09, 3.5265e-11, 1.6358e-09, 1.1396e-09, 1.1949e-08,
         9.3518e-10, 3.3482e-08, 1.6011e-08, 9.6788e-09, 2.0908e-09, 5.6068e-08,
         4.3765e-08, 6.3037e-09, 8.9807e-09, 9.9690e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.4477e-07, 1.2050e-08, 9.6951e-10, 3.0377e-08, 1.2036e-08, 1.3023e-08,
         3.7738e-09, 7.5822e-08, 2.1261e-08, 6.3541e-08, 2.4773e-07, 3.9619e-08,
         1.0597e-07, 2.3621e-09, 9.1146e-09, 1.8558e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.4466e-08, 1.2604e-10, 7.0756e-12, 3.1480e-10, 1.9782e-09, 1.0892e-10,
         1.1274e-11, 5.1830e-10, 5.3092e-09, 4.0277e-10, 3.9774e-09, 1.2216e-09,
         6.2990e-09, 6.9472e-10, 6.2598e-11, 8.3564e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.123273
summ of probs approach
id: [18260] -> tensor([[1.2286e-07, 1.4744e-07, 1.0121e-10, 1.4194e-08, 1.9762e-09, 5.9183e-10,
         2.6045e-09, 2.7481e-08, 1.0785e-10, 1.8662e-07, 4.1800e-08, 1.0205e-09,
         1.3154e-09, 1.9355e-07, 4.2465e-07, 6.7998e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[7.8597e-07, 1.1328e-06, 1.4764e-09, 1.0114e-07, 1.1692e-08, 6.2243e-08,
         1.1205e-08, 1.3749e-07, 7.9096e-09, 5.4521e-08, 4.4548e-07, 1.6254e-07,
         7.6318e-08, 2.2622e-06, 3.5600e-07, 4.7277e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[4.5476e-09, 6.3856e-08, 2.8499e-11, 2.8994e-09, 3.1114e-11, 3.4409e-11,
         6.1026e-10, 1.2092e-08, 3.0505e-12, 1.0805e-09, 2.6022e-08, 1.5271e-10,
         2.7738e-10, 3.5254e-08, 3.4254e-08, 1.4922e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.163733
summ of probs approach
id: [18260] -> tensor([[1.0846e-10, 1.5349e-09, 1.3631e-10, 2.5824e-08, 4.1845e-10, 3.3833e-10,
         8.0748e-08, 4.8090e-11, 1.1437e-08, 4.8196e-11, 3.6034e-09, 7.5642e-10,
         7.4716e-09, 2.1894e-09, 8.3986e-10, 2.5328e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.2964e-09, 2.6381e-08, 6.1681e-09, 1.3876e-06, 5.4008e-08, 3.2858e-09,
         6.2424e-07, 7.0145e-08, 1.8367e-07, 1.9419e-08, 4.6936e-07, 1.5408e-07,
         3.5192e-09, 1.3492e-07, 2.4530e-07, 4.6192e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.7272e-10, 3.0227e-10, 3.2205e-10, 2.8138e-08, 5.0332e-11, 3.1483e-11,
         1.3069e-08, 1.2077e-11, 7.4622e-09, 8.1817e-12, 2.5549e-10, 1.3661e-10,
         1.3039e-09, 4.2922e-10, 1.0550e-10, 3.7450e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.253188
summ of probs approach
id: [18260] -> tensor([[4.4343e-08, 6.6501e-07, 3.6254e-09, 1.3822e-09, 9.6740e-09, 1.2588e-07,
         1.5858e-07, 7.1327e-09, 4.8617e-10, 2.8468e-08, 5.7779e-10, 1.9763e-07,
         5.4746e-11, 1.5299e-09, 2.9472e-10, 3.5213e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[8.9416e-08, 7.6390e-06, 6.6251e-09, 6.7884e-09, 9.3338e-09, 7.2925e-07,
         6.6734e-07, 2.1984e-08, 4.0665e-09, 6.1215e-07, 3.2818e-08, 6.7993e-06,
         1.5372e-09, 3.2878e-08, 1.1767e-07, 8.3108e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.1202e-09, 1.3167e-07, 1.8780e-10, 9.6702e-12, 3.1988e-09, 3.2613e-08,
         8.5738e-08, 7.6827e-10, 1.1103e-11, 6.6360e-09, 7.8164e-11, 1.0741e-07,
         2.6680e-12, 1.5464e-10, 2.2344e-11, 2.2915e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.165622
summ of probs approach
id: [18260] -> tensor([[9.4238e-09, 7.8501e-09, 1.2254e-10, 1.0172e-07, 4.5492e-09, 2.1785e-10,
         1.0007e-09, 4.3264e-08, 9.5614e-10, 9.3421e-08, 2.0359e-10, 8.5768e-09,
         8.8451e-11, 5.8608e-09, 2.2272e-09, 2.3646e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.4656e-08, 3.8387e-07, 3.8151e-09, 1.4965e-06, 8.2049e-08, 4.7473e-09,
         2.0219e-09, 3.0414e-06, 5.6838e-09, 8.0423e-07, 1.9141e-08, 1.3988e-07,
         3.0735e-09, 1.9824e-08, 1.6676e-09, 1.2012e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[2.0192e-08, 1.8996e-09, 1.3215e-10, 3.0571e-07, 3.2642e-10, 2.7701e-11,
         6.4943e-11, 1.0057e-08, 1.0200e-11, 2.2084e-08, 1.7085e-11, 1.6408e-09,
         3.5376e-11, 1.5659e-10, 3.8769e-11, 1.2518e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.133271
summ of probs approach
id: [18260] -> tensor([[1.5912e-07, 1.0157e-09, 9.4988e-10, 4.0987e-08, 7.2385e-07, 1.3533e-10,
         2.9632e-10, 3.8087e-11, 1.8281e-09, 1.4492e-09, 1.7243e-08, 4.1374e-10,
         2.6785e-08, 7.9577e-11, 3.7146e-10, 6.9709e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.6532e-08, 2.6119e-08, 1.5835e-07, 3.4355e-07, 2.8663e-06, 6.9124e-10,
         1.4915e-07, 1.8884e-09, 2.0379e-08, 1.3353e-07, 6.2417e-08, 3.8224e-08,
         1.1826e-07, 1.1573e-09, 1.9758e-08, 2.3161e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.2020e-08, 6.4874e-10, 6.2838e-12, 1.3719e-10, 5.3682e-07, 8.2270e-12,
         3.7950e-11, 6.4521e-12, 4.7655e-11, 2.1230e-10, 1.6977e-09, 6.9403e-11,
         1.5647e-09, 9.2961e-12, 3.2731e-11, 1.7789e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.205464
summ of probs approach
id: [18260] -> tensor([[7.6959e-10, 5.6756e-10, 4.3956e-07, 2.6478e-08, 3.0105e-10, 1.1103e-07,
         2.7534e-10, 1.7478e-07, 4.8950e-09, 5.3734e-10, 4.7370e-10, 2.1627e-09,
         4.4298e-09, 4.1827e-09, 2.2789e-08, 4.8525e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.3746e-09, 4.3433e-08, 3.3004e-06, 5.3474e-08, 3.7159e-09, 2.1074e-07,
         6.7487e-09, 6.7984e-07, 7.5889e-09, 5.0809e-07, 2.9199e-08, 2.1678e-09,
         3.9769e-08, 1.4538e-07, 2.4781e-08, 1.3908e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[6.3316e-11, 3.2507e-10, 7.8202e-08, 3.5744e-09, 4.4386e-11, 3.6356e-08,
         1.7182e-11, 3.5581e-08, 1.9390e-10, 1.6754e-11, 2.6572e-10, 5.0068e-10,
         3.2279e-09, 4.9806e-09, 2.5335e-10, 2.4170e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.133210
summ of probs approach
id: [18260] -> tensor([[3.0690e-09, 8.2589e-09, 8.9029e-08, 1.0887e-08, 1.4783e-11, 2.2136e-09,
         7.9446e-09, 2.2896e-09, 7.2445e-10, 1.7611e-09, 3.8410e-09, 3.1194e-07,
         4.0454e-08, 6.9840e-10, 5.8095e-10, 1.1403e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.0821e-08, 7.4579e-09, 1.2835e-06, 3.8112e-07, 3.9730e-10, 2.3732e-09,
         6.9918e-09, 3.0386e-08, 9.6806e-08, 5.5110e-08, 4.9135e-08, 4.2415e-06,
         1.7903e-06, 4.0353e-09, 8.6111e-09, 6.3506e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[5.1770e-10, 5.4652e-10, 2.2271e-07, 4.4344e-10, 8.4382e-14, 1.6778e-10,
         3.4667e-09, 7.0832e-10, 1.4666e-10, 1.7860e-10, 1.1870e-09, 2.1423e-07,
         1.9087e-07, 6.4355e-11, 4.8862e-11, 1.9293e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.103779
summ of probs approach
id: [18260] -> tensor([[2.0565e-09, 2.8766e-09, 1.4507e-09, 3.3570e-09, 5.8040e-08, 2.7203e-09,
         8.7148e-10, 2.5875e-09, 5.0063e-09, 1.1305e-08, 6.8574e-09, 3.4048e-06,
         1.9681e-07, 9.3485e-08, 7.7261e-07, 5.3460e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.0627e-08, 6.3045e-08, 4.7539e-07, 3.5913e-08, 2.5543e-07, 1.9323e-08,
         1.5335e-08, 4.5229e-09, 4.0326e-07, 3.7808e-08, 3.3637e-07, 7.2850e-07,
         1.9608e-06, 2.2035e-07, 3.4062e-06, 1.9420e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.4452e-10, 7.4313e-10, 2.8752e-10, 7.3746e-09, 1.0763e-08, 3.0995e-11,
         6.3999e-11, 2.4748e-11, 7.4702e-09, 3.6576e-09, 9.2114e-10, 2.8905e-08,
         1.2245e-08, 2.1364e-08, 3.4484e-07, 2.5856e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.147098
summ of probs approach
id: [18260] -> tensor([[6.2584e-09, 9.0753e-07, 2.6197e-08, 2.9724e-09, 1.6991e-06, 1.0071e-08]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [1936] -> tensor([[7.5436e-08, 2.9626e-06, 8.3094e-09, 5.3918e-09, 6.4926e-06, 8.1608e-08]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [137111] -> tensor([[1.1690e-10, 1.6299e-07, 6.8738e-10, 9.6596e-10, 1.5863e-07, 7.9337e-10]],
       device='cuda:0'), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.050585
acc:  0.3686868686868687
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.961841
path ['42', 'en', 'bloomz', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [4273, 1], 'attention_mask': [1, 1]}
id: [4273, 1] -> [4273]
answer  {'input_ids': [150, 1], 'attention_mask': [1, 1]}
id: [150, 1] -> [150]
answer  {'input_ids': [2087, 1], 'attention_mask': [1, 1]}
id: [2087, 1] -> [2087]
load model Duration: 0:00:02.990944
prompt_type null has 1 prompts in it
----------- 42 en google/flan-t5-base NLI null 0 200 16 --------------
summ of probs approach
id: [4273] -> tensor([[1.8477e-03, 3.5806e-04, 2.7912e-03, 7.1534e-04, 5.3365e-04, 2.2054e-04,
         4.1686e-03, 1.1806e-02, 2.8578e-04, 2.2915e-03, 8.8458e-04, 1.6641e-04,
         5.5353e-06, 1.7370e-02, 8.5136e-05, 1.2868e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.5442e-02, 6.6411e-02, 1.6180e-02, 1.5589e-03, 8.6122e-04, 1.2507e-01,
         7.7127e-03, 8.8602e-03, 1.5984e-03, 4.2245e-03, 1.3458e-01, 6.5658e-04,
         6.5515e-05, 3.3758e-03, 3.3621e-04, 1.4524e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.7717e-04, 1.4430e-04, 3.8382e-05, 2.3140e-04, 1.7965e-05, 3.9172e-06,
         9.5719e-04, 5.9142e-04, 1.7818e-06, 1.4945e-05, 3.6872e-05, 2.7839e-05,
         2.4528e-06, 2.1288e-04, 3.8593e-06, 8.4412e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.099767
summ of probs approach
id: [4273] -> tensor([[1.7848e-03, 1.9535e-06, 2.2542e-05, 1.6287e-04, 1.2528e-03, 2.5999e-03,
         4.0626e-05, 2.2555e-04, 2.2754e-05, 1.6166e-03, 7.4186e-04, 2.2027e-04,
         8.4234e-05, 9.1297e-04, 7.6005e-04, 8.8695e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.0821e-02, 6.2726e-05, 5.3847e-04, 1.0399e-03, 6.1930e-03, 2.6831e-03,
         6.5637e-04, 1.3577e-03, 2.4644e-03, 1.0135e-02, 1.0631e-03, 1.7370e-03,
         1.3945e-04, 3.4900e-03, 2.5215e-03, 6.4349e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[6.7249e-05, 1.0741e-07, 4.1027e-06, 6.4564e-06, 2.2622e-05, 1.0859e-04,
         1.1881e-05, 8.6356e-06, 4.7704e-06, 1.9586e-04, 4.0374e-05, 2.8366e-04,
         8.4227e-06, 1.7310e-04, 6.4273e-04, 7.6102e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.108050
summ of probs approach
id: [4273] -> tensor([[1.2406e-07, 1.5396e-04, 7.8373e-05, 7.8674e-06, 7.3045e-05, 1.2899e-03,
         7.7672e-06, 2.0804e-05, 1.3844e-05, 1.4774e-04, 1.0503e-06, 1.1390e-05,
         2.1317e-03, 2.2844e-04, 9.3509e-03, 1.4450e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.6826e-06, 5.8994e-04, 7.8944e-04, 2.8426e-05, 1.9846e-03, 1.9937e-02,
         1.1378e-04, 3.0514e-03, 2.1139e-02, 4.6042e-03, 8.4324e-06, 5.7258e-04,
         5.0635e-03, 8.2410e-03, 2.3790e-02, 8.5174e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[4.1914e-08, 2.6917e-05, 9.0079e-06, 2.1584e-07, 3.8951e-05, 6.5832e-05,
         1.1949e-06, 3.3913e-07, 4.6765e-07, 5.7876e-05, 1.7140e-06, 2.9999e-06,
         1.0676e-04, 1.7973e-04, 2.6981e-04, 2.0772e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.064709
summ of probs approach
id: [4273] -> tensor([[1.6627e-03, 4.5135e-06, 1.8074e-02, 1.1215e-04, 2.3142e-02, 2.6160e-04,
         8.2539e-02, 4.0279e-05, 3.3912e-05, 1.6121e-05, 3.7421e-05, 1.6198e-02,
         9.3605e-04, 3.1138e-05, 1.2851e-04, 2.0416e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[9.9960e-03, 3.1588e-05, 3.6156e-03, 3.5476e-03, 1.8224e-02, 3.4631e-03,
         1.4671e-02, 9.5394e-05, 2.9980e-04, 7.7349e-05, 1.1873e-01, 2.0368e-02,
         2.1158e-03, 6.6884e-05, 1.9558e-03, 5.8569e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[4.2671e-05, 2.5626e-08, 4.9225e-04, 2.8414e-05, 2.3444e-03, 4.1702e-05,
         8.1407e-05, 1.4650e-06, 8.1075e-06, 2.3188e-05, 1.4547e-06, 4.4127e-03,
         6.1230e-04, 3.4101e-06, 1.4914e-05, 2.2107e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.080124
summ of probs approach
id: [4273] -> tensor([[6.2533e-03, 5.1019e-05, 4.8237e-04, 1.3637e-02, 5.6105e-03, 1.0095e-04,
         1.7511e-03, 6.8225e-04, 3.9724e-04, 6.5487e-05, 2.6458e-03, 1.7164e-04,
         4.0210e-03, 7.3150e-04, 3.0944e-04, 1.8142e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[4.3184e-02, 7.3588e-04, 2.7754e-03, 1.7950e-02, 3.0582e-02, 1.9261e-03,
         4.1926e-03, 3.1001e-03, 1.2384e-03, 2.8026e-05, 1.0630e-02, 3.9541e-03,
         6.4595e-03, 4.0468e-03, 2.7631e-03, 4.7691e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[3.8256e-04, 5.1176e-06, 2.5448e-04, 1.5251e-02, 2.5225e-03, 2.6291e-05,
         2.2817e-03, 2.6765e-05, 2.5593e-05, 1.1899e-05, 5.1571e-04, 4.7887e-05,
         2.5253e-05, 4.4912e-06, 1.9098e-05, 6.5587e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.079261
summ of probs approach
id: [4273] -> tensor([[1.5917e-04, 6.3807e-03, 6.4915e-04, 3.1351e-06, 2.4558e-07, 1.6932e-04,
         1.9066e-05, 1.7748e-04, 4.0331e-04, 2.0641e-03, 1.8700e-05, 1.6141e-06,
         5.9135e-05, 9.4102e-05, 4.5178e-05, 2.6153e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.1740e-03, 2.2423e-03, 1.7169e-03, 3.8525e-04, 1.4209e-06, 7.7737e-04,
         5.5025e-05, 3.7976e-03, 1.1229e-02, 1.1897e-02, 2.1451e-04, 3.6827e-05,
         3.4150e-04, 8.9835e-04, 1.4507e-03, 5.7937e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[6.9135e-06, 3.3575e-05, 2.5007e-05, 2.7500e-07, 1.9469e-07, 5.6821e-05,
         2.0478e-06, 9.2333e-06, 1.2121e-04, 3.4628e-04, 3.2909e-06, 5.7377e-07,
         6.7133e-06, 1.7739e-05, 1.5959e-05, 8.5395e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.085538
summ of probs approach
id: [4273] -> tensor([[2.2280e-03, 3.0896e-05, 9.1248e-05, 1.6703e-03, 1.1879e-05, 1.0405e-03,
         2.5640e-03, 4.2037e-04, 2.0195e-03, 6.8695e-06, 4.9000e-05, 7.0007e-04,
         2.5999e-04, 5.5374e-06, 4.0402e-04, 5.9636e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[7.4732e-03, 1.4046e-04, 4.3724e-04, 4.0861e-03, 2.8207e-04, 1.2151e-02,
         1.9512e-02, 1.1688e-01, 7.0957e-03, 2.4655e-05, 3.2779e-04, 7.2561e-03,
         3.2884e-04, 3.7578e-05, 3.0413e-03, 8.0112e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.9702e-03, 5.5070e-06, 2.9931e-06, 1.7763e-05, 1.0568e-04, 6.4703e-05,
         2.3416e-04, 7.5617e-05, 1.2078e-04, 2.4313e-06, 1.3464e-06, 1.5026e-05,
         3.9720e-04, 9.3310e-07, 3.2710e-06, 1.0209e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.084598
summ of probs approach
id: [4273] -> tensor([[4.6810e-04, 2.4115e-04, 2.7324e-03, 1.4489e-03, 9.4818e-04, 1.4738e-04,
         2.9506e-03, 2.3729e-05, 4.3907e-04, 1.0095e-04, 9.0991e-04, 4.0144e-05,
         1.6543e-02, 3.9537e-06, 6.1512e-05, 2.2144e-02]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[0.0001, 0.1058, 0.0046, 0.0004, 0.0010, 0.0069, 0.0120, 0.0007, 0.0032,
         0.0008, 0.0022, 0.0017, 0.0663, 0.0019, 0.0010, 0.0023]],
       device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[2.6072e-05, 3.2953e-06, 1.1622e-04, 7.4058e-05, 5.4323e-05, 3.6041e-06,
         2.0209e-05, 3.9774e-06, 2.8391e-05, 3.4781e-06, 1.7588e-05, 2.0209e-05,
         1.6584e-04, 2.1590e-06, 2.4624e-05, 1.5904e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.078685
summ of probs approach
id: [4273] -> tensor([[1.9318e-03, 1.0289e-07, 1.4872e-03, 7.8322e-05, 3.0787e-05, 7.5412e-04,
         3.9155e-02, 2.9473e-03, 1.4315e-04, 9.9676e-06, 5.1513e-04, 1.0887e-03,
         3.2270e-05, 3.2166e-05, 2.4349e-06, 4.2391e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.0052e-03, 6.3569e-07, 1.6895e-02, 1.1975e-04, 8.4053e-04, 5.8431e-04,
         1.3801e-02, 2.2679e-02, 8.1974e-03, 5.0204e-03, 1.1458e-03, 6.7972e-04,
         3.3635e-05, 1.4526e-04, 8.0779e-05, 2.7593e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[4.9170e-04, 2.4494e-08, 1.6999e-05, 9.5066e-07, 2.3060e-05, 2.8012e-04,
         2.5726e-03, 1.1642e-03, 4.9237e-07, 3.1459e-07, 2.7699e-06, 2.1749e-03,
         2.1209e-06, 2.0117e-06, 6.3704e-09, 1.2064e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.073769
summ of probs approach
id: [4273] -> tensor([[2.9409e-04, 2.8592e-04, 2.5506e-03, 7.3554e-05, 6.3276e-05, 3.0210e-04,
         3.8376e-05, 2.1846e-05, 3.8045e-03, 1.4252e-03, 4.7302e-04, 6.2765e-04,
         4.2727e-04, 6.3706e-04, 1.3878e-03, 8.8684e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.5235e-03, 3.3260e-03, 3.5590e-03, 4.5686e-01, 3.3221e-04, 2.6318e-03,
         3.7329e-04, 1.4097e-05, 6.2914e-03, 4.3680e-02, 1.3941e-03, 2.7510e-03,
         7.8862e-03, 2.3175e-03, 2.1786e-03, 1.6964e-01]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[2.1593e-04, 1.4230e-04, 1.8352e-04, 1.3208e-06, 8.2556e-06, 1.0790e-05,
         1.1478e-05, 2.5157e-06, 1.5543e-03, 1.5803e-05, 6.0894e-05, 3.8214e-04,
         9.3610e-05, 3.8131e-05, 2.8939e-05, 1.8290e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.097466
summ of probs approach
id: [4273] -> tensor([[5.3993e-04, 2.5079e-02, 5.8353e-03, 3.8164e-05, 3.3478e-04, 9.6472e-04,
         2.2471e-01, 2.7289e-04, 1.1494e-03, 3.5991e-04, 3.4632e-04, 1.8945e-04,
         1.6561e-04, 3.6469e-07, 6.5736e-05, 1.1478e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.6915e-03, 1.5229e-01, 9.4878e-02, 6.4183e-04, 1.1091e-03, 2.0454e-03,
         2.1470e-01, 7.4435e-04, 9.0258e-04, 3.4982e-04, 3.2374e-03, 2.3937e-03,
         1.1928e-03, 3.7575e-06, 4.8042e-04, 1.2479e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[7.8246e-04, 1.1390e-03, 5.3478e-04, 2.2708e-06, 5.3608e-05, 6.5163e-05,
         1.4074e-04, 8.0930e-06, 4.0781e-05, 2.9313e-04, 1.0280e-06, 4.4784e-06,
         1.2866e-05, 4.0750e-08, 1.5159e-06, 2.5438e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.115484
summ of probs approach
id: [4273] -> tensor([[5.4372e-04, 5.8965e-04, 1.1017e-03, 8.3397e-04, 1.7973e-04, 6.0490e-04,
         4.2918e-03, 7.6548e-03, 9.5346e-05, 3.9860e-04, 6.3199e-05, 1.6520e-04,
         2.1808e-03, 7.6854e-07, 5.5463e-03, 1.5006e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[4.3595e-03, 6.8221e-03, 1.0438e-02, 2.0780e-03, 1.4031e-03, 6.4746e-04,
         5.0304e-03, 5.2557e-02, 2.1944e-02, 4.9102e-03, 3.8285e-04, 1.4763e-03,
         1.9875e-02, 5.6660e-06, 6.6985e-03, 4.8765e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.5716e-03, 6.6247e-05, 7.5706e-04, 2.3411e-05, 3.1580e-06, 8.9934e-05,
         5.9701e-04, 7.3485e-05, 4.0043e-05, 9.6369e-05, 5.7415e-06, 1.5392e-05,
         6.0193e-06, 8.7679e-08, 4.1680e-04, 2.0495e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.148862
summ of probs approach
id: [4273] -> tensor([[3.1743e-04, 1.9651e-02, 2.6162e-05, 1.1397e-05, 6.1267e-04, 3.5467e-04]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [150] -> tensor([[0.0005, 0.0159, 0.0009, 0.0005, 0.0514, 0.0007]], device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [2087] -> tensor([[2.4376e-05, 4.1790e-04, 1.0157e-05, 1.9568e-06, 2.1770e-05, 3.2450e-06]],
       device='cuda:0'), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.041097
acc:  0.3838383838383838
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.192697
path ['42', 'en', 'flan', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:10<00:10, 10.23s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.25s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.84s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 4874], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 4874] -> [4874]
answer  {'input_ids': [1, 694], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 694] -> [694]
answer  {'input_ids': [1, 5505], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 5505] -> [5505]
load model Duration: 0:02:35.759091
prompt_type null has 1 prompts in it
----------- 42 en huggyllama/llama-7b NLI null 0 200 16 --------------
summ of probs approach
id: [4874] -> tensor([[7.7486e-07, 4.1723e-07, 1.0145e-04, 2.3842e-07, 4.7684e-07, 8.3447e-06,
         5.9605e-07, 5.2452e-04, 5.0366e-05, 4.5490e-04, 7.7486e-07, 1.7262e-04,
         3.1853e-04, 1.0669e-05, 1.5140e-05, 1.3375e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[2.3603e-05, 1.7285e-06, 8.6606e-05, 2.2054e-06, 2.9802e-06, 2.2650e-05,
         2.3544e-05, 8.7023e-04, 2.3007e-05, 1.8854e-03, 1.3113e-06, 2.1565e-04,
         1.9622e-04, 1.5140e-05, 1.0782e-04, 3.9077e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[1.6689e-06, 2.3842e-07, 6.8128e-05, 5.9605e-07, 7.1526e-07, 7.7486e-07,
         1.1921e-06, 1.5581e-04, 2.5511e-05, 6.0987e-04, 3.5763e-07, 4.8208e-04,
         3.7837e-04, 1.8537e-05, 1.9670e-04, 1.1024e-03]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.255578
summ of probs approach
id: [4874] -> tensor([[1.0133e-06, 2.6226e-06, 7.8082e-06, 3.7193e-05, 2.3246e-06, 1.1921e-07,
         4.1723e-07, 3.4571e-05, 7.1526e-07, 2.3067e-05, 7.7486e-07, 1.2994e-05,
         1.6689e-06, 1.6510e-05, 2.7597e-05, 6.9141e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.7047e-05, 1.1921e-06, 7.2658e-05, 5.8115e-05, 3.1590e-06, 1.6689e-06,
         1.9670e-05, 8.7798e-05, 9.2387e-06, 1.6546e-04, 4.3511e-06, 2.2352e-04,
         7.3314e-06, 3.2425e-05, 4.0352e-05, 1.1206e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[9.5367e-07, 7.7486e-07, 2.7835e-05, 1.1283e-04, 3.5763e-07, 1.1921e-07,
         1.7881e-07, 6.7830e-05, 2.9802e-07, 1.7619e-04, 3.5763e-07, 1.0788e-05,
         1.4305e-06, 4.8220e-05, 9.8944e-06, 8.9407e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.253410
summ of probs approach
id: [4874] -> tensor([[3.5763e-07, 2.9385e-05, 1.0729e-06, 6.5565e-07, 2.3842e-07, 3.5763e-07,
         1.6749e-05, 5.9319e-04, 1.1921e-06, 2.9802e-07, 6.5565e-07, 1.1921e-06,
         5.0068e-06, 2.2650e-06, 2.6226e-06, 7.1526e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[7.5698e-06, 3.8743e-05, 7.8678e-06, 1.6153e-05, 2.2650e-06, 1.1921e-06,
         1.5080e-05, 8.0442e-04, 1.7881e-06, 3.2187e-06, 1.9073e-06, 2.5630e-06,
         7.2122e-06, 1.9073e-05, 6.3956e-05, 5.4836e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[8.3447e-07, 3.3438e-05, 1.0371e-05, 1.5497e-06, 1.1921e-06, 1.7881e-07,
         1.4901e-06, 3.5076e-03, 1.7881e-06, 4.7684e-07, 4.7684e-07, 5.9605e-07,
         1.1444e-05, 2.6822e-06, 4.1127e-06, 5.1856e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.268973
summ of probs approach
id: [4874] -> tensor([[3.3975e-04, 1.4305e-06, 1.1921e-06, 1.7130e-04, 4.4107e-04, 1.0729e-06,
         9.7132e-04, 1.0127e-04, 3.8147e-06, 1.1033e-04, 2.3246e-06, 3.0160e-04,
         1.7881e-06, 4.5776e-05, 3.5167e-06, 1.8775e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.6630e-04, 1.7881e-06, 1.3113e-06, 3.7408e-04, 8.6308e-04, 1.8120e-04,
         1.4191e-03, 1.4532e-04, 5.1260e-06, 1.2505e-04, 1.0610e-05, 1.1224e-04,
         3.6359e-06, 3.5167e-06, 7.9274e-06, 1.5378e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[4.4584e-05, 2.9802e-07, 7.7486e-07, 1.5700e-04, 3.5787e-04, 4.7684e-07,
         5.7316e-04, 2.2292e-04, 7.3314e-06, 8.6069e-05, 6.5565e-07, 2.5392e-04,
         2.3842e-06, 2.0862e-06, 2.8610e-06, 3.6407e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.194248
summ of probs approach
id: [4874] -> tensor([[1.7881e-06, 3.1710e-04, 5.6624e-06, 2.1458e-06, 4.7684e-07, 5.3930e-04,
         1.5950e-04, 6.0976e-05, 2.7895e-05, 1.1659e-04, 1.3769e-05, 9.4771e-06,
         1.5914e-05, 2.2411e-05, 4.7684e-07, 3.1590e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[5.1260e-06, 2.3937e-04, 3.8743e-06, 3.4571e-06, 4.1723e-06, 1.6141e-04,
         1.0300e-04, 6.2406e-05, 8.2493e-05, 1.0514e-04, 1.5259e-05, 2.1100e-05,
         7.8022e-05, 4.3213e-05, 4.4703e-06, 1.9670e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[1.2875e-05, 8.8036e-05, 3.4571e-06, 7.1526e-06, 6.5565e-07, 1.4269e-04,
         9.1195e-06, 3.7551e-05, 3.0577e-05, 1.2684e-04, 9.9242e-05, 2.4617e-05,
         1.6904e-04, 2.6524e-05, 1.3113e-06, 1.7881e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.299612
summ of probs approach
id: [4874] -> tensor([[1.7881e-07, 1.7881e-07, 5.1856e-06, 4.2319e-06, 5.9605e-08, 5.5492e-05,
         9.5367e-07, 2.0671e-04, 2.1183e-04, 1.0133e-06, 1.0729e-06, 2.7657e-05,
         6.7353e-06, 4.0531e-06, 2.3842e-07, 1.2577e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[8.1062e-06, 2.6166e-05, 5.1856e-06, 7.6294e-06, 1.3709e-06, 2.5749e-04,
         4.7088e-06, 9.3997e-05, 7.8559e-05, 2.5332e-05, 1.4901e-06, 6.0797e-06,
         1.4186e-05, 1.0550e-05, 2.9802e-06, 1.6868e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[4.1723e-07, 0.0000e+00, 5.0664e-06, 3.9935e-06, 2.3842e-07, 1.1212e-04,
         1.2517e-06, 5.2691e-04, 3.1805e-04, 1.3113e-06, 4.1723e-07, 5.1856e-06,
         1.6630e-05, 2.7418e-06, 5.9605e-08, 1.5438e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.298455
summ of probs approach
id: [4874] -> tensor([[3.2187e-06, 7.7486e-06, 1.6689e-06, 9.5963e-06, 8.5235e-06, 6.1035e-04,
         2.5630e-06, 8.4043e-06, 4.7779e-04, 1.4305e-06, 2.8014e-06, 1.0815e-03,
         3.3116e-04, 2.5630e-06, 5.9605e-08, 5.6624e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.0967e-05, 4.4048e-05, 8.7023e-06, 3.4690e-05, 1.0550e-05, 7.0810e-04,
         2.1935e-05, 2.6643e-05, 1.5974e-04, 1.6689e-06, 3.8147e-06, 8.9169e-04,
         3.7456e-04, 5.0008e-05, 2.0266e-06, 4.7624e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[1.6689e-06, 9.5367e-06, 3.5763e-07, 5.1260e-06, 2.8014e-06, 4.5204e-04,
         2.0266e-06, 5.6446e-05, 8.3327e-05, 7.7486e-07, 1.8477e-06, 1.4889e-04,
         1.7083e-04, 1.1325e-06, 0.0000e+00, 1.1265e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.385967
summ of probs approach
id: [4874] -> tensor([[2.8014e-06, 4.8280e-06, 8.3447e-07, 1.2493e-04, 3.8862e-05, 7.1526e-07,
         4.4703e-06, 3.5763e-07, 1.4305e-06, 5.9605e-08, 1.9133e-05, 1.0133e-06,
         2.4557e-05, 1.5497e-06, 7.1526e-07, 5.1785e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.0669e-05, 1.0431e-05, 2.0266e-06, 7.3135e-05, 9.8526e-05, 5.6863e-05,
         4.0412e-05, 2.5034e-06, 3.8743e-06, 1.7881e-06, 1.9908e-05, 3.4750e-05,
         3.3557e-05, 1.3709e-06, 1.8477e-06, 3.8767e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[9.5367e-07, 1.9670e-06, 1.7881e-07, 9.7156e-05, 3.6359e-05, 5.7220e-06,
         3.9339e-06, 7.7486e-07, 4.7684e-07, 1.1921e-07, 2.8014e-06, 2.2411e-05,
         3.1590e-06, 1.7881e-07, 2.3842e-07, 2.8157e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.485918
summ of probs approach
id: [4874] -> tensor([[3.2187e-06, 7.1526e-07, 1.1086e-05, 5.3644e-07, 1.6308e-04, 2.3842e-06,
         3.1590e-05, 3.9983e-04, 9.3889e-04, 1.3709e-06, 6.4373e-06, 4.8339e-05,
         1.3709e-06, 1.4901e-06, 3.4571e-06, 5.9605e-08]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.0890e-04, 7.7486e-07, 1.1444e-05, 2.9206e-06, 1.5569e-04, 1.1683e-05,
         6.2704e-05, 1.9312e-04, 1.2150e-03, 3.2783e-06, 5.3108e-05, 1.4853e-04,
         7.0333e-06, 7.0930e-06, 3.5763e-06, 4.7684e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[1.4305e-06, 4.7684e-07, 2.6226e-06, 1.1921e-07, 1.3912e-04, 9.2387e-06,
         4.5240e-05, 1.1265e-05, 2.1958e-04, 2.3842e-07, 2.2292e-05, 8.7619e-05,
         2.8014e-06, 2.4438e-06, 6.0797e-06, 0.0000e+00]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.271423
summ of probs approach
id: [4874] -> tensor([[1.2517e-06, 4.2319e-06, 1.3888e-05, 3.1590e-06, 5.0068e-06, 1.1921e-07,
         1.7881e-07, 1.4961e-05, 6.5565e-07, 1.5497e-06, 5.7817e-06, 3.6526e-04,
         2.5630e-06, 1.6093e-06, 2.1100e-05, 3.9768e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[4.0531e-06, 6.3181e-06, 1.4186e-05, 5.5015e-05, 1.2398e-05, 8.3447e-07,
         8.3447e-07, 1.9193e-05, 3.5763e-06, 7.7486e-07, 2.5988e-05, 5.7030e-04,
         3.2783e-06, 7.1526e-06, 1.1486e-04, 1.2660e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[1.0729e-06, 6.5565e-07, 3.6955e-06, 6.0201e-06, 7.2718e-06, 5.9605e-08,
         2.9802e-07, 1.4007e-05, 3.5763e-07, 1.1921e-07, 2.7776e-05, 2.6631e-04,
         8.3447e-07, 7.0333e-06, 2.2531e-05, 7.3969e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.251862
summ of probs approach
id: [4874] -> tensor([[3.2783e-06, 8.1837e-05, 5.6028e-06, 5.9605e-08, 3.5763e-07, 1.7703e-05,
         9.5367e-07, 1.4007e-05, 1.2994e-04, 1.8477e-06, 2.6226e-06, 3.6955e-06,
         1.7881e-07, 5.3644e-07, 1.5497e-05, 5.2452e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[5.0247e-05, 1.8334e-04, 4.2319e-06, 1.2577e-05, 2.3842e-07, 9.7156e-06,
         3.6359e-06, 5.2929e-05, 1.1969e-04, 2.0862e-06, 7.6294e-06, 3.0398e-06,
         6.5565e-07, 1.6093e-06, 3.1471e-05, 1.9550e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[2.6226e-06, 7.5161e-05, 7.3910e-06, 5.9605e-08, 5.9605e-08, 1.8477e-06,
         2.3842e-07, 1.3053e-05, 1.7762e-04, 2.7418e-06, 7.4685e-05, 2.0266e-06,
         5.9605e-08, 1.1921e-07, 9.6560e-06, 1.0133e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.267621
summ of probs approach
id: [4874] -> tensor([[6.7353e-05, 5.1260e-06, 9.0599e-06, 2.4295e-04, 9.0599e-06, 6.6757e-06,
         6.9737e-06, 1.2505e-04, 2.5630e-06, 4.7684e-06, 2.9802e-07, 1.5461e-04,
         1.0073e-05, 2.4915e-04, 8.5449e-04, 1.3113e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[8.2552e-05, 1.2577e-05, 9.0599e-06, 1.2743e-04, 6.7949e-06, 1.1981e-05,
         2.0742e-05, 9.8705e-05, 4.4703e-06, 4.5300e-06, 8.9407e-07, 1.3781e-04,
         1.1146e-05, 1.9717e-04, 7.9918e-04, 2.8610e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[4.7207e-04, 2.5034e-06, 3.8147e-06, 2.6608e-04, 1.0729e-05, 8.5235e-06,
         6.7353e-06, 2.5105e-04, 9.5367e-07, 1.9073e-06, 2.9802e-07, 7.1049e-04,
         1.4186e-05, 1.2636e-04, 1.3971e-04, 4.7684e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.320391
summ of probs approach
id: [4874] -> tensor([[9.0599e-06, 1.1921e-07, 2.2411e-05, 2.5868e-05, 2.9266e-05, 1.3745e-04]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
summ of probs approach
id: [694] -> tensor([[8.7619e-06, 6.5565e-07, 1.1760e-04, 3.1352e-05, 2.4319e-05, 4.2856e-05]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
summ of probs approach
id: [5505] -> tensor([[3.7551e-06, 5.9605e-08, 3.6299e-05, 7.9393e-05, 4.6194e-05, 3.6836e-05]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.066930
acc:  0.3939393939393939
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:03.654460
path ['42', 'en', 'llama', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [36339, 1], 'attention_mask': [1, 1]}
id:[36339, 1]
answer  {'input_ids': [375, 1], 'attention_mask': [1, 1]}
id:[375, 1]
answer  {'input_ids': [259, 37627, 1], 'attention_mask': [1, 1, 1]}
id:[259, 37627, 1]
load model Duration: 0:00:06.239245
prompt_type null has 1 prompts in it
----------- 42 en bigscience/mt0-small NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([7.7838e-03, 2.2728e-03, 1.3114e-02, 1.1858e-03, 6.4281e-04, 9.2767e-04,
        1.0636e-03, 7.5192e-04, 1.0666e-03, 2.7467e-04, 9.6772e-01, 1.6023e-01,
        4.0779e-03, 1.4343e-03, 4.9622e-03, 6.8702e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.1360e-03, 9.0142e-03, 4.6308e-02, 1.1228e-03, 6.6615e-04, 8.4608e-04,
        2.8253e-03, 7.5129e-04, 8.3044e-04, 3.8873e-04, 9.6772e-01, 1.2808e-01,
        6.9274e-03, 2.0697e-03, 7.4601e-03, 1.1068e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.3156, 0.0233, 0.4904, 0.0507, 0.3409, 0.1874, 0.2531, 0.1794, 0.3189,
        0.1015, 0.9802, 0.0248, 0.4117, 0.2696, 0.0210, 0.1165],
       device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.125274
summ of probs approach
probs_ shape tensor([7.5258e-04, 1.0980e-03, 3.3830e-04, 1.4631e-03, 2.5629e-03, 5.1011e-04,
        2.5571e-03, 7.1064e-04, 8.8285e-01, 1.6391e-03, 1.0036e-03, 5.9937e-04,
        4.3533e-03, 4.5057e-04, 1.6148e-04, 1.0588e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.3105e-04, 1.0982e-03, 7.2224e-04, 1.4190e-03, 2.7841e-03, 9.0161e-04,
        3.8828e-03, 7.0131e-04, 8.8285e-01, 4.5184e-03, 1.0131e-03, 6.4319e-04,
        4.5416e-03, 5.9966e-04, 2.2733e-04, 1.0639e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.2527, 0.5026, 0.1626, 0.0483, 0.0501, 0.0626, 0.1123, 0.6344, 0.8874,
        0.1181, 0.6651, 0.1146, 0.0520, 0.0670, 0.0559, 0.1537],
       device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.088578
summ of probs approach
probs_ shape tensor([3.6532e-03, 6.9443e-04, 1.0441e-02, 2.6488e-03, 1.7021e-03, 4.3398e-03,
        8.6012e-01, 1.8005e-03, 3.8072e-03, 3.7648e-04, 9.0794e-04, 3.8613e-03,
        3.9577e-04, 8.6026e-04, 8.0177e-04, 8.3170e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.9823e-03, 1.1705e-03, 2.2946e-02, 3.2693e-03, 4.2243e-03, 5.5718e-03,
        8.6014e-01, 1.6993e-03, 5.5435e-03, 3.9614e-04, 1.4592e-03, 3.8580e-03,
        4.1790e-04, 1.1676e-03, 1.8035e-03, 6.5125e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.3669, 0.2403, 0.1780, 0.1693, 0.1122, 0.0502, 0.8734, 0.3468, 0.2382,
        0.1996, 0.1239, 0.3450, 0.6927, 0.0765, 0.1577, 0.3725],
       device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.129264
summ of probs approach
probs_ shape tensor([4.4409e-03, 1.9874e-03, 5.0135e-03, 4.0475e-03, 2.3013e-03, 9.9069e-05,
        6.9286e-04, 1.4679e-03, 9.7574e-04, 1.1241e-03, 1.2792e-04, 3.7178e-04,
        1.5990e-05, 1.3845e-04, 9.9846e-01, 1.9351e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.3126e-03, 1.7632e-03, 5.0153e-03, 4.3265e-03, 2.2533e-03, 1.4037e-04,
        5.8194e-04, 8.7948e-03, 9.4601e-04, 3.3754e-03, 1.1978e-04, 6.1402e-04,
        5.3333e-05, 1.5631e-04, 9.9846e-01, 4.0936e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.4624, 0.1830, 0.2158, 0.0297, 0.5198, 0.0454, 0.1407, 0.4601, 0.1575,
        0.2391, 0.0510, 0.1696, 0.0534, 0.1875, 0.9992, 0.1064],
       device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.076352
summ of probs approach
probs_ shape tensor([2.0034e-03, 4.4536e-04, 5.3962e-03, 4.3370e-03, 3.7486e-03, 8.1899e-04,
        1.7343e-03, 1.9613e-03, 3.7357e-03, 6.0594e-04, 9.9020e-01, 1.2760e-03,
        1.0176e-03, 2.1804e-03, 1.7619e-03, 2.3763e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.1833e-03, 1.0388e-03, 1.0231e-02, 3.8920e-03, 3.1585e-03, 7.2811e-04,
        1.7799e-03, 1.1101e-03, 4.2194e-03, 4.5007e-04, 9.9020e-01, 1.2946e-03,
        1.2135e-03, 2.2077e-03, 1.9716e-03, 2.1721e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1531, 0.0435, 0.3342, 0.1935, 0.2373, 0.1587, 0.2697, 0.5363, 0.1907,
        0.1728, 0.9959, 0.1458, 0.1035, 0.5226, 0.1348, 0.0117],
       device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.072851
summ of probs approach
probs_ shape tensor([2.2447e-03, 9.2198e-04, 1.7096e-03, 2.1526e-04, 9.9599e-01, 9.5322e-01,
        4.2537e-03, 1.0903e-03, 7.1575e-04, 1.2462e-02, 6.3659e-03, 1.8449e-03,
        1.7902e-03, 4.1819e-03, 2.3268e-04, 1.2215e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.2639e-03, 1.4853e-03, 2.3561e-03, 2.1440e-04, 9.9599e-01, 9.5322e-01,
        4.7325e-03, 1.1636e-03, 7.1062e-04, 2.5129e-02, 1.7004e-03, 2.0885e-03,
        1.7399e-03, 2.8164e-03, 2.3057e-04, 1.8827e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1734, 0.1580, 0.4221, 0.0643, 0.9979, 0.9620, 0.4883, 0.1540, 0.1075,
        0.2219, 0.5489, 0.3194, 0.2433, 0.0512, 0.0874, 0.2745],
       device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.073498
summ of probs approach
probs_ shape tensor([2.6884e-04, 1.9544e-03, 7.8652e-04, 1.5249e-03, 6.8422e-04, 3.5786e-03,
        2.2877e-03, 5.2936e-04, 1.8964e-02, 3.8152e-04, 4.1943e-04, 4.6767e-04,
        2.8557e-03, 9.1079e-04, 9.9131e-01, 7.6862e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.4669e-04, 2.0354e-03, 8.1897e-04, 1.4411e-03, 8.7290e-04, 4.7740e-03,
        4.2666e-03, 2.5154e-04, 1.0739e-02, 3.3663e-04, 4.8619e-04, 4.9310e-04,
        4.8104e-03, 1.1445e-03, 9.9131e-01, 6.6075e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0797, 0.3978, 0.2236, 0.2877, 0.3246, 0.1423, 0.4966, 0.0064, 0.2296,
        0.0242, 0.0713, 0.1718, 0.1820, 0.4732, 0.9938, 0.2604],
       device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.088547
summ of probs approach
probs_ shape tensor([1.0270e-03, 2.2275e-03, 6.7366e-01, 1.3936e-03, 5.8814e-03, 6.6260e-04,
        1.1311e-03, 2.3348e-03, 1.3342e-03, 3.7684e-03, 1.3686e-03, 7.8299e-04,
        9.6153e-01, 5.2246e-05, 7.3192e-03, 2.3334e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1187e-03, 3.0243e-03, 6.7366e-01, 1.3426e-03, 5.8786e-03, 1.8225e-03,
        1.2225e-03, 2.3195e-03, 1.9298e-03, 4.7543e-03, 1.2937e-03, 1.9491e-03,
        9.6153e-01, 1.1294e-04, 2.6752e-02, 2.4071e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0485, 0.2493, 0.6858, 0.3729, 0.4507, 0.1317, 0.1719, 0.6230, 0.2643,
        0.1754, 0.0863, 0.1267, 0.9632, 0.0125, 0.0251, 0.0237],
       device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.063697
summ of probs approach
probs_ shape tensor([5.4569e-03, 9.2583e-04, 3.2806e-03, 9.5085e-01, 6.7105e-04, 3.7275e-04,
        1.7085e-04, 1.8060e-04, 5.5871e-04, 4.3254e-02, 2.9262e-04, 7.4664e-04,
        1.2312e-03, 4.1786e-03, 1.8775e-03, 1.4804e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0674e-02, 1.0062e-03, 3.7604e-03, 9.5085e-01, 5.4677e-04, 4.6456e-04,
        1.7218e-04, 2.1611e-04, 2.1932e-03, 5.9498e-02, 3.7145e-04, 9.6796e-04,
        1.2443e-03, 1.0897e-02, 1.9614e-03, 1.4931e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1369, 0.0523, 0.2065, 0.9548, 0.1121, 0.1969, 0.0284, 0.0318, 0.1188,
        0.4013, 0.0958, 0.3481, 0.0959, 0.6729, 0.1569, 0.1727],
       device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.067490
summ of probs approach
probs_ shape tensor([5.9037e-04, 6.4563e-04, 4.2206e-03, 1.1238e-03, 8.2001e-04, 1.9104e-04,
        5.6767e-04, 6.0918e-04, 1.4596e-04, 3.6058e-04, 2.1589e-03, 4.5502e-04,
        9.7545e-01, 2.6644e-03, 3.5904e-03, 6.0708e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0379e-03, 6.2085e-04, 2.3980e-03, 1.0953e-03, 7.9995e-04, 2.1133e-04,
        6.6427e-04, 6.3182e-04, 2.9538e-04, 8.4304e-04, 2.4249e-03, 4.5496e-04,
        9.7547e-01, 5.2483e-03, 1.6974e-03, 7.6908e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.2122, 0.1227, 0.6405, 0.1958, 0.0617, 0.0673, 0.0880, 0.2165, 0.9182,
        0.0919, 0.4423, 0.1374, 0.9836, 0.3979, 0.1883, 0.3544],
       device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.093492
summ of probs approach
probs_ shape tensor([2.3859e-04, 9.6473e-01, 1.9145e-04, 1.0650e-03, 2.1134e-03, 1.2989e-04,
        4.8795e-04, 2.2070e-03, 1.9543e-03, 7.0258e-03, 6.6238e-03, 1.4415e-03,
        5.2529e-04, 1.8389e-04, 1.2010e-02, 1.7005e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.8885e-04, 9.6474e-01, 8.1097e-04, 1.1101e-03, 2.5757e-03, 1.1913e-04,
        6.4108e-04, 2.3345e-03, 2.8875e-03, 7.8675e-03, 3.1950e-02, 2.1179e-03,
        5.5601e-04, 1.9118e-04, 1.1212e-02, 1.5600e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0736, 0.9708, 0.0241, 0.0971, 0.1091, 0.0147, 0.1621, 0.6118, 0.0812,
        0.2569, 0.0994, 0.3713, 0.1747, 0.0289, 0.1426, 0.1245],
       device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.084507
summ of probs approach
probs_ shape tensor([3.7038e-04, 4.4388e-05, 5.8226e-04, 2.2268e-03, 5.2613e-04, 2.5047e-04,
        1.2309e-03, 1.9015e-03, 6.3142e-04, 1.6866e-03, 9.3784e-01, 3.4516e-03,
        4.3844e-04, 4.4372e-04, 8.6426e-04, 2.3958e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.9548e-04, 3.0506e-05, 5.1479e-04, 2.2414e-03, 6.1692e-04, 4.2284e-04,
        1.2522e-03, 1.8983e-03, 7.6785e-04, 1.7097e-03, 9.3784e-01, 3.4449e-03,
        4.7205e-04, 1.4611e-03, 8.3718e-04, 2.3961e-03], device='cuda:0') torch.Size([16])
summ of probs approach
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
probs_ shape tensor([0.1981, 0.0026, 0.4823, 0.2731, 0.0745, 0.0926, 0.1068, 0.1845, 0.3042,
        0.3348, 0.9414, 0.6318, 0.7515, 0.2664, 0.0230, 0.1313],
       device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.073725
summ of probs approach
probs_ shape tensor([9.0891e-01, 5.2352e-04, 4.1757e-04, 1.6246e-04, 1.6717e-03, 3.8972e-04],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([9.0891e-01, 5.2652e-04, 4.2179e-04, 1.6928e-04, 1.3466e-03, 3.8531e-04],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([0.9184, 0.8886, 0.8665, 0.2252, 0.0402, 0.7054], device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.038087
acc:  0.3434343434343434
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.115475
path ['42', 'en', 't0', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v56.pickle' as a pickle file.

Using MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  3.31it/s]100%|██████████| 3/3 [00:00<00:00,  8.57it/s]
loading model Duration: 0:00:01.555833
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  200
create dataloader Duration: 0:03:43.565277
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1650], 'attention_mask': [1]}
id:[1650]
answer  {'input_ids': [951, 265], 'attention_mask': [1, 1]}
id:[951, 265]
load model Duration: 0:00:09.505029
prompt_type null has 1 prompts in it
----------- 42 de bigscience/bloom-560m SA null 0 200 16 --------------
summ of probs approach
id: [1650] -> tensor([[3.1239e-05, 1.1122e-06, 3.3224e-06, 8.2650e-06, 1.4873e-06, 5.0486e-05,
         1.4911e-06, 5.1756e-06, 3.3841e-06, 7.2817e-06, 5.5944e-07, 2.4389e-06,
         3.4777e-07, 1.8450e-07, 3.1566e-06, 1.8622e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.8496e-04, 7.9099e-06, 4.2327e-05, 9.2020e-05, 6.6987e-06, 2.6474e-04,
        9.6781e-06, 1.1604e-05, 1.7647e-04, 1.4522e-04, 4.0841e-06, 1.3717e-05,
        3.2392e-05, 4.5605e-05, 2.2690e-05, 3.5503e-03], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.307469
summ of probs approach
id: [1650] -> tensor([[1.2267e-06, 5.4504e-06, 3.5038e-06, 8.4630e-06, 4.0829e-07, 4.2938e-07,
         4.9516e-06, 3.6501e-06, 2.0284e-06, 1.7717e-06, 1.2847e-06, 6.5367e-07,
         6.5754e-07, 4.6386e-06, 3.3537e-06, 7.6727e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1661e-05, 3.5654e-05, 1.2729e-05, 4.4650e-05, 6.0940e-05, 6.7129e-06,
        2.2936e-05, 3.3439e-05, 1.0954e-05, 1.1657e-05, 7.1734e-06, 1.3544e-05,
        8.3146e-06, 2.7510e-05, 1.5925e-05, 1.6798e-05], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.328278
summ of probs approach
id: [1650] -> tensor([[4.6172e-06, 1.5771e-06, 5.6817e-06, 1.0325e-05, 5.8244e-06, 2.1687e-06,
         4.8712e-07, 1.6392e-06, 1.3618e-06, 9.0407e-07, 3.0140e-06, 3.6247e-05,
         1.6609e-06, 1.9208e-06, 8.4398e-07, 1.0151e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.4578e-05, 1.8319e-05, 2.6863e-05, 7.6121e-04, 8.5087e-05, 1.0550e-05,
        1.5607e-05, 6.8389e-06, 6.4465e-06, 2.5164e-05, 2.4167e-05, 3.6716e-04,
        1.1416e-05, 5.7088e-05, 8.2253e-06, 4.6663e-04], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.215827
summ of probs approach
id: [1650] -> tensor([[1.5290e-06, 1.1877e-05, 7.6753e-07, 1.7864e-06, 3.8957e-05, 6.2118e-07,
         1.6402e-06, 2.1944e-07, 2.5318e-06, 2.1069e-06, 2.9321e-05, 3.7110e-06,
         1.7322e-06, 1.7260e-06, 1.6916e-05, 9.0911e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.3625e-05, 1.2186e-04, 3.6643e-05, 1.8825e-05, 2.3755e-04, 1.0149e-05,
        1.5641e-05, 2.8946e-05, 1.0687e-05, 4.9556e-05, 7.5564e-05, 3.6379e-05,
        2.8115e-05, 1.2515e-05, 7.6511e-05, 6.5404e-06], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.213013
summ of probs approach
id: [1650] -> tensor([[2.4654e-06, 1.3778e-05, 1.2167e-06, 8.1801e-07, 1.9373e-06, 1.5940e-06,
         6.7920e-06, 6.7712e-06, 1.1063e-06, 3.5268e-06, 7.0184e-07, 2.7696e-06,
         2.0094e-05, 9.0697e-07, 6.2007e-06, 3.0926e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.8593e-05, 4.8136e-04, 1.1596e-05, 7.7523e-06, 1.6356e-05, 3.8523e-05,
        2.0176e-03, 3.9677e-05, 8.0342e-05, 3.5542e-05, 1.3659e-05, 9.6212e-06,
        1.5779e-03, 9.2432e-06, 2.9903e-04, 6.9877e-05], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.261759
summ of probs approach
id: [1650] -> tensor([[7.1380e-06, 1.0597e-06, 1.3707e-04, 8.9254e-07, 9.3193e-07, 3.2604e-06,
         1.1318e-06, 5.5212e-06, 1.0360e-06, 1.8656e-05, 2.2147e-06, 1.4424e-06,
         1.4724e-06, 1.8727e-06, 2.7844e-06, 2.1632e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.6468e-05, 8.1789e-06, 1.1465e-03, 1.3391e-05, 1.0767e-05, 1.6186e-05,
        2.2681e-05, 1.4167e-05, 1.9803e-05, 1.1138e-04, 3.5950e-05, 1.8747e-05,
        8.2071e-06, 2.1472e-05, 2.7224e-03, 1.4831e-03], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.166572
summ of probs approach
id: [1650] -> tensor([[1.0944e-06, 5.8712e-06, 2.6434e-06, 2.7050e-06, 6.0775e-06, 2.2748e-06,
         8.5464e-06, 2.9802e-06, 2.5081e-06, 1.0074e-05, 2.2981e-06, 1.4622e-06,
         1.9361e-05, 1.4492e-05, 3.4675e-06, 4.3612e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.5673e-05, 6.0327e-05, 4.8666e-05, 7.0917e-05, 1.6608e-05, 4.5004e-05,
        2.7378e-05, 1.7675e-04, 3.8343e-05, 3.9262e-05, 1.4958e-05, 1.4970e-05,
        3.4144e-04, 1.7390e-04, 1.8390e-05, 5.0267e-05], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.304740
summ of probs approach
id: [1650] -> tensor([[4.3590e-06, 8.7449e-05, 5.0479e-06, 2.4340e-06, 8.4181e-07, 2.5069e-06,
         3.2248e-06, 6.2720e-07, 1.4533e-06, 5.1005e-06, 9.5811e-07, 1.1163e-06,
         3.2566e-07, 2.7499e-06, 3.6087e-06, 9.3018e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6353e-04, 7.2767e-04, 2.0036e-05, 6.6805e-06, 3.2934e-05, 4.2248e-04,
        1.7915e-05, 6.7713e-05, 6.7534e-06, 1.7938e-05, 1.3550e-05, 8.5358e-06,
        1.0152e-05, 1.6114e-04, 2.2075e-05, 7.1675e-05], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.241671
summ of probs approach
id: [1650] -> tensor([[1.3179e-06, 1.8636e-06, 1.6552e-06, 5.2755e-06, 1.1474e-05, 1.6275e-06,
         1.9226e-05, 1.1509e-06, 9.9328e-07, 1.9744e-06, 4.5936e-06, 8.3271e-06,
         1.2836e-06, 1.4922e-06, 2.4239e-06, 2.1447e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2329e-05, 1.4245e-05, 7.4001e-06, 1.7017e-04, 5.0252e-05, 1.3590e-05,
        1.5137e-03, 8.0875e-06, 1.0164e-05, 1.5758e-05, 4.8237e-05, 3.4770e-05,
        9.5589e-06, 1.9779e-05, 8.1897e-05, 1.5040e-05], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.214916
summ of probs approach
id: [1650] -> tensor([[1.8710e-06, 1.1236e-04, 2.0635e-06, 4.9785e-06, 2.8093e-06, 8.0102e-07,
         2.9124e-06, 8.5742e-06, 3.0616e-06, 1.9769e-06, 1.6557e-06, 1.7394e-06,
         9.3118e-07, 5.6019e-07, 1.4463e-06, 9.7004e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.7208e-05, 1.8070e-03, 2.5942e-05, 2.4571e-05, 3.9835e-06, 2.8035e-05,
        1.2293e-05, 5.9033e-04, 2.8968e-04, 1.0392e-05, 1.1976e-05, 7.6577e-06,
        6.5905e-06, 6.2574e-06, 1.7254e-05, 1.7181e-05], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.311776
summ of probs approach
id: [1650] -> tensor([[6.4915e-06, 2.4516e-06, 2.2177e-06, 4.5968e-06, 1.6833e-06, 3.3947e-06,
         1.7605e-06, 1.0052e-06, 9.5522e-05, 9.9614e-07, 1.6335e-06, 2.0769e-06,
         2.3296e-06, 2.0385e-06, 6.9061e-06, 4.7956e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.8449e-05, 1.4345e-05, 2.2857e-05, 1.3339e-05, 1.8874e-05, 3.6395e-05,
        4.2948e-06, 6.1961e-06, 6.7772e-04, 1.1164e-05, 1.4768e-05, 1.5528e-05,
        2.9007e-05, 9.9684e-06, 7.3970e-05, 9.3118e-05], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.264223
summ of probs approach
id: [1650] -> tensor([[8.0998e-07, 7.2000e-06, 5.8595e-06, 1.7347e-05, 1.4341e-06, 2.2738e-06,
         1.4926e-06, 7.6095e-06, 5.8674e-05, 3.9766e-06, 6.9973e-07, 5.0558e-05,
         1.4168e-06, 1.7207e-06, 1.3238e-06, 8.8175e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2603e-05, 3.6192e-05, 1.2201e-05, 2.1162e-04, 1.2175e-05, 5.3417e-05,
        8.5825e-06, 7.4039e-05, 3.0933e-03, 1.0544e-05, 4.8628e-06, 1.2712e-03,
        1.1978e-05, 1.1693e-04, 1.4322e-05, 1.6664e-05], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.296396
summ of probs approach
id: [1650] -> tensor([[1.5032e-05, 3.6054e-06, 2.7496e-06, 8.8951e-06, 1.0039e-06, 4.2919e-06,
         1.1553e-04, 6.5654e-07]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
probs_ shape tensor([1.3601e-03, 2.3994e-05, 1.1157e-05, 1.7248e-04, 9.0275e-06, 3.4156e-05,
        4.6594e-04, 3.6077e-05], device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.079768
acc:  0.5
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:03.229249
path ['42', 'de', 'bloom', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1650], 'attention_mask': [1]}
id:[1650]
answer  {'input_ids': [951, 265], 'attention_mask': [1, 1]}
id:[951, 265]
load model Duration: 0:00:09.259892
prompt_type null has 1 prompts in it
----------- 42 de bigscience/bloomz-560m SA null 0 200 16 --------------
summ of probs approach
id: [1650] -> tensor([[8.0428e-06, 9.5269e-08, 1.9916e-07, 1.0421e-06, 1.9233e-05, 1.3496e-06,
         4.9629e-07, 1.4214e-06, 2.6907e-07, 3.2581e-05, 8.6022e-07, 9.3530e-07,
         3.2242e-06, 9.8930e-07, 7.2869e-07, 7.8760e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.3448e-04, 6.2638e-06, 1.1165e-05, 2.7211e-05, 6.1904e-05, 3.2894e-04,
        2.9874e-05, 7.4415e-05, 7.7499e-06, 7.1009e-04, 1.5526e-05, 9.4491e-06,
        1.8197e-04, 2.0391e-05, 1.2644e-05, 2.3365e-05], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.371399
summ of probs approach
id: [1650] -> tensor([[4.5675e-06, 1.9046e-07, 8.0059e-07, 2.8714e-06, 8.3562e-07, 4.6011e-07,
         1.0940e-06, 8.5837e-07, 6.5048e-07, 1.4592e-06, 3.5171e-07, 3.5888e-07,
         1.2139e-05, 5.2697e-07, 2.5749e-06, 7.5819e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6746e-04, 7.4024e-06, 3.1809e-05, 1.3702e-04, 1.6768e-05, 1.5843e-05,
        7.8258e-06, 9.0669e-07, 4.5574e-06, 5.9841e-05, 3.7283e-05, 7.5176e-06,
        1.1650e-04, 2.4075e-05, 8.4702e-05, 1.8008e-05], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.255247
summ of probs approach
id: [1650] -> tensor([[4.3369e-07, 6.1771e-07, 2.8640e-07, 1.4194e-05, 1.3092e-05, 5.2071e-07,
         2.5709e-08, 1.3237e-07, 5.9709e-07, 4.0866e-07, 2.4239e-06, 3.3350e-05,
         6.1105e-07, 1.7773e-07, 3.7405e-06, 1.5589e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.1201e-05, 9.8795e-06, 1.0887e-05, 7.3115e-04, 8.8426e-04, 2.1189e-05,
        1.7399e-06, 3.4657e-06, 1.4646e-05, 8.6283e-06, 3.5829e-05, 4.6158e-04,
        3.1032e-05, 3.6198e-06, 7.7732e-05, 1.3296e-05], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.281856
summ of probs approach
id: [1650] -> tensor([[7.2038e-07, 1.6313e-06, 1.7500e-05, 7.8104e-06, 2.1477e-06, 1.1177e-06,
         6.5094e-06, 1.7955e-06, 2.2801e-07, 5.9521e-07, 6.8267e-07, 4.8618e-07,
         1.4987e-05, 5.1468e-07, 4.0683e-05, 2.2322e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.8550e-05, 1.4760e-05, 4.6325e-04, 6.3399e-04, 4.2358e-05, 1.0302e-05,
        1.4062e-05, 3.6492e-05, 1.2551e-05, 1.6705e-05, 2.5794e-05, 1.4345e-05,
        3.0666e-04, 1.4094e-05, 2.9552e-04, 4.9548e-05], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.261109
summ of probs approach
id: [1650] -> tensor([[3.4321e-07, 1.4969e-06, 7.6223e-07, 8.1347e-07, 1.6266e-06, 6.8829e-07,
         2.5591e-07, 2.4967e-07, 1.3831e-06, 2.1342e-06, 3.5517e-06, 1.5079e-06,
         5.8825e-06, 1.6789e-06, 3.3967e-06, 6.3403e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4744e-05, 1.9057e-05, 1.2061e-05, 1.6307e-05, 3.5041e-05, 9.1415e-06,
        3.2527e-06, 8.4529e-06, 1.4986e-05, 3.3980e-05, 1.3621e-05, 5.3623e-05,
        1.0089e-04, 4.1844e-05, 2.8163e-05, 2.1254e-05], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.295474
summ of probs approach
id: [1650] -> tensor([[1.1979e-05, 1.9529e-05, 7.4998e-06, 3.8330e-06, 1.5523e-06, 2.7918e-07,
         2.7980e-06, 3.9522e-07, 2.5258e-05, 1.8206e-06, 3.0629e-07, 1.0731e-06,
         2.0104e-05, 1.4508e-06, 3.1161e-06, 1.2579e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.1418e-04, 1.0549e-03, 2.8635e-04, 2.6790e-04, 1.1251e-04, 3.2742e-05,
        5.1198e-05, 7.4786e-05, 3.0733e-05, 2.8159e-05, 2.4191e-06, 1.1094e-04,
        6.2081e-04, 3.6535e-05, 1.0083e-04, 1.4563e-05], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.223166
summ of probs approach
id: [1650] -> tensor([[7.1634e-07, 3.1409e-07, 1.0340e-06, 4.9937e-07, 1.7651e-06, 7.0540e-05,
         1.5247e-06, 4.5985e-07, 1.0543e-06, 8.0668e-07, 8.1728e-07, 3.0575e-07,
         1.6199e-06, 7.3098e-07, 4.8133e-07, 2.1653e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.7002e-05, 1.1990e-05, 1.3918e-05, 1.9100e-05, 2.1159e-05, 5.1280e-04,
        2.5107e-05, 1.2178e-05, 1.7239e-05, 2.3535e-05, 1.6773e-05, 1.6080e-05,
        5.3643e-05, 1.4280e-05, 1.1504e-05, 1.3459e-05], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.241012
summ of probs approach
id: [1650] -> tensor([[1.6708e-05, 1.8905e-05, 1.8912e-06, 2.0214e-07, 1.2162e-06, 1.2553e-06,
         6.6639e-07, 5.8384e-07, 1.1454e-06, 6.7530e-08, 1.0192e-06, 7.7789e-07,
         1.0550e-06, 6.7804e-07, 2.5281e-06, 5.0496e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.8905e-05, 3.0430e-04, 1.7182e-05, 9.1634e-06, 9.7817e-05, 1.9976e-05,
        2.1074e-05, 1.5096e-05, 1.8982e-05, 3.9578e-06, 2.9363e-06, 1.1465e-05,
        1.5395e-05, 1.8698e-05, 5.0868e-05, 4.6654e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.307561
summ of probs approach
id: [1650] -> tensor([[7.7669e-07, 6.8632e-06, 5.8128e-07, 6.2780e-07, 6.8250e-07, 1.0485e-06,
         1.5389e-06, 1.7620e-05, 1.5248e-06, 1.0752e-06, 2.7304e-07, 7.7260e-05,
         1.1371e-06, 5.2213e-07, 9.7309e-07, 1.6198e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1736e-05, 2.5610e-04, 1.5562e-05, 7.2885e-06, 2.8277e-05, 8.5706e-06,
        2.2175e-05, 8.5145e-05, 3.1523e-05, 2.4025e-05, 7.0809e-06, 8.4495e-04,
        2.3644e-05, 1.6297e-05, 1.6865e-05, 9.5089e-05], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.311352
summ of probs approach
id: [1650] -> tensor([[2.3549e-06, 6.0007e-06, 5.2002e-05, 1.8305e-06, 1.5667e-04, 3.5412e-07,
         4.8599e-07, 1.5503e-06, 4.9293e-07, 3.8903e-06, 6.7861e-06, 2.7022e-06,
         1.9442e-06, 2.2771e-06, 3.9322e-06, 4.8017e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.1280e-05, 3.1381e-05, 6.0581e-04, 1.9910e-05, 1.2817e-03, 8.7447e-06,
        2.1725e-05, 2.9788e-05, 7.3941e-06, 9.4286e-06, 2.0717e-04, 3.3563e-05,
        1.0251e-03, 1.5061e-04, 5.0067e-05, 8.7185e-06], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.297006
summ of probs approach
id: [1650] -> tensor([[1.4273e-06, 1.0845e-06, 3.2157e-07, 3.4480e-06, 3.0140e-06, 1.0369e-06,
         4.2199e-05, 1.7833e-05, 1.0624e-06, 5.9745e-07, 1.5742e-05, 4.6219e-06,
         7.8478e-07, 2.4707e-07, 3.8864e-06, 1.5336e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.9251e-05, 3.2107e-05, 2.7648e-06, 1.2689e-04, 1.1482e-05, 6.2003e-05,
        8.5425e-05, 9.5889e-05, 2.7324e-05, 7.2113e-06, 1.5966e-05, 2.1612e-05,
        4.7164e-05, 8.4658e-06, 3.2740e-05, 3.2962e-04], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.309094
summ of probs approach
id: [1650] -> tensor([[1.6818e-05, 6.3891e-07, 1.7139e-07, 1.4776e-06, 1.0725e-05, 3.4418e-06,
         3.6273e-06, 3.0230e-06, 6.6236e-07, 1.0184e-06, 1.3438e-06, 4.3854e-07,
         5.5869e-07, 1.2041e-05, 1.0287e-06, 2.6664e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.4040e-04, 8.1587e-06, 6.4916e-06, 5.4333e-05, 1.4167e-04, 3.0039e-04,
        5.6015e-05, 1.4635e-04, 6.0364e-05, 1.2141e-05, 8.2374e-05, 9.3795e-06,
        1.8825e-05, 9.4465e-04, 2.2681e-05, 4.9271e-05], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.264034
summ of probs approach
id: [1650] -> tensor([[2.7904e-07, 7.5760e-07, 3.1219e-05, 6.2937e-07, 8.2087e-07, 7.9753e-06,
         4.1346e-05, 1.7114e-05]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
probs_ shape tensor([9.3925e-06, 6.5443e-06, 3.4001e-04, 1.1177e-05, 1.8923e-05, 2.6906e-04,
        3.3975e-03, 2.0414e-04], device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.076414
acc:  0.5
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:03.521261
path ['42', 'de', 'bloomz', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
load model Duration: 0:00:02.896127
prompt_type null has 1 prompts in it
----------- 42 de google/flan-t5-base SA null 0 200 16 --------------
summ of probs approach
id: [2662] -> tensor([[5.9773e-05, 7.0118e-05, 7.3667e-05, 1.6864e-05, 3.5960e-05, 6.6999e-04,
         1.8149e-04, 1.4791e-04, 1.0542e-05, 2.9838e-04, 1.6414e-04, 3.6598e-05,
         2.7618e-04, 1.9418e-05, 2.4016e-05, 2.1426e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.8170e-07, 1.7815e-05, 1.8331e-05, 2.0957e-05, 5.1355e-08, 7.8234e-05,
         2.1377e-07, 8.1117e-07, 5.6665e-08, 5.3934e-05, 2.8290e-06, 6.5376e-08,
         9.2282e-06, 4.2561e-06, 2.2803e-06, 1.6462e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.126961
summ of probs approach
id: [2662] -> tensor([[4.5980e-05, 7.0081e-06, 4.7322e-05, 1.3321e-04, 5.5322e-05, 4.5913e-05,
         7.3284e-05, 2.5752e-04, 1.2543e-03, 1.8426e-04, 1.8815e-04, 1.0003e-04,
         1.5416e-03, 6.9963e-05, 7.8105e-04, 1.5968e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[7.0361e-08, 2.1434e-08, 5.8710e-09, 1.6401e-06, 4.9425e-09, 2.9811e-07,
         2.5147e-07, 6.0041e-05, 8.8925e-05, 1.1906e-06, 2.9751e-05, 9.3019e-06,
         3.7226e-05, 3.5939e-07, 5.4737e-07, 7.7206e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.112421
summ of probs approach
id: [2662] -> tensor([[2.6269e-05, 1.0647e-03, 7.1075e-05, 9.5915e-05, 6.1829e-05, 1.2388e-04,
         5.0584e-05, 1.1704e-04, 4.0479e-07, 1.6852e-04, 1.6109e-04, 4.8320e-04,
         3.8142e-04, 4.1273e-05, 2.5375e-04, 4.3286e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.4842e-07, 2.1189e-05, 1.3384e-05, 1.3676e-05, 2.5707e-06, 3.4292e-07,
         5.4071e-05, 6.0429e-06, 1.4704e-08, 1.9214e-06, 3.7613e-06, 4.2339e-06,
         1.9385e-06, 4.3028e-06, 2.1901e-06, 4.3801e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.123020
summ of probs approach
id: [2662] -> tensor([[1.5314e-04, 1.2839e-04, 1.2271e-04, 1.9129e-04, 3.8009e-05, 1.3680e-04,
         2.7003e-04, 7.5234e-07, 2.2194e-05, 2.1762e-04, 1.1256e-04, 1.4243e-04,
         4.7175e-05, 2.6651e-04, 4.0261e-05, 9.6538e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.3526e-05, 5.1020e-07, 8.2727e-07, 1.2019e-05, 5.7574e-07, 1.1661e-06,
         6.5853e-04, 3.6324e-06, 4.6377e-08, 4.9776e-05, 8.2248e-07, 5.9540e-07,
         1.5246e-07, 9.4579e-05, 5.4743e-07, 4.2049e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.123642
summ of probs approach
id: [2662] -> tensor([[3.5822e-05, 1.2873e-04, 5.0194e-05, 3.9499e-07, 3.2174e-04, 1.0247e-03,
         2.1555e-04, 9.9893e-05, 3.4496e-04, 2.3248e-05, 5.6191e-05, 4.0454e-05,
         2.2904e-04, 1.2318e-04, 5.9790e-04, 1.3736e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[5.1299e-05, 2.8724e-07, 8.1693e-08, 2.0438e-08, 2.3662e-06, 3.0391e-04,
         8.1125e-07, 2.8082e-05, 1.1887e-05, 1.2538e-06, 7.2225e-07, 1.1508e-06,
         3.3607e-06, 1.0931e-06, 9.6107e-05, 2.5444e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.112360
summ of probs approach
id: [2662] -> tensor([[1.9406e-04, 4.5967e-04, 2.3623e-05, 2.9670e-04, 5.7320e-06, 1.4632e-05,
         6.4995e-04, 3.9095e-07, 1.1263e-03, 2.9216e-06, 8.3702e-06, 8.4224e-05,
         3.8537e-05, 2.4108e-05, 4.1757e-05, 2.8696e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.2272e-06, 2.1076e-04, 9.8079e-07, 2.8343e-06, 2.2207e-06, 3.3108e-06,
         5.6445e-05, 1.1114e-07, 1.0205e-05, 6.9804e-08, 9.1142e-09, 2.7401e-05,
         1.3046e-07, 5.3170e-07, 2.0331e-06, 3.6375e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.122670
summ of probs approach
id: [2662] -> tensor([[4.4564e-05, 4.6081e-05, 1.7055e-04, 2.4792e-05, 9.7053e-05, 4.4424e-05,
         6.2294e-04, 1.6784e-07, 2.3902e-06, 7.8202e-06, 2.8205e-06, 2.0050e-04,
         1.5225e-05, 3.5818e-04, 1.0556e-04, 2.5142e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[8.0637e-07, 2.4159e-05, 8.6413e-06, 3.0968e-06, 4.1965e-07, 4.4173e-06,
         8.9406e-07, 2.4831e-08, 2.5178e-08, 8.8064e-08, 4.1725e-09, 9.1307e-06,
         6.8200e-07, 1.4456e-05, 3.6773e-06, 6.0825e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.085120
summ of probs approach
id: [2662] -> tensor([[8.3865e-05, 1.6901e-07, 3.8220e-05, 2.8822e-05, 3.6293e-04, 1.3698e-05,
         3.7629e-04, 1.5057e-05, 4.4072e-06, 1.0178e-04, 2.6284e-05, 2.1192e-04,
         7.4244e-05, 4.5528e-05, 3.2642e-04, 7.9438e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.2012e-07, 1.6390e-08, 9.6406e-06, 7.4827e-07, 3.2132e-05, 1.4118e-07,
         2.3551e-06, 4.9503e-07, 6.6497e-09, 8.8244e-06, 2.3422e-06, 1.4486e-05,
         2.6645e-07, 4.1575e-06, 1.3905e-05, 1.5766e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.095813
summ of probs approach
id: [2662] -> tensor([[1.8025e-04, 1.9041e-05, 2.9943e-04, 1.8014e-05, 2.3030e-07, 3.7462e-04,
         8.5437e-05, 4.6316e-04, 1.2623e-04, 1.1331e-04, 4.9133e-04, 2.3968e-05,
         8.8707e-05, 1.5532e-03, 7.1070e-05, 7.7031e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[5.4539e-06, 5.3041e-05, 1.3655e-06, 9.3519e-06, 9.1191e-08, 4.0822e-06,
         1.0097e-04, 1.9520e-08, 8.3144e-06, 6.4715e-06, 1.5831e-05, 6.3249e-06,
         3.3896e-06, 1.3082e-04, 1.9422e-05, 1.4569e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.142188
summ of probs approach
id: [2662] -> tensor([[9.2959e-04, 1.3123e-05, 1.0845e-05, 2.4026e-04, 5.0893e-05, 1.1468e-04,
         2.4050e-04, 3.8643e-05, 6.5543e-05, 3.9088e-06, 7.7122e-06, 1.0545e-04,
         1.8123e-05, 7.8407e-05, 1.0662e-04, 3.5741e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[4.1260e-05, 3.1030e-08, 1.1563e-07, 4.5098e-05, 7.3085e-06, 4.2546e-07,
         1.1176e-05, 1.4697e-07, 5.4752e-06, 5.0470e-07, 3.7028e-06, 6.2247e-07,
         1.8009e-07, 7.0254e-05, 4.0118e-06, 1.3447e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.122260
summ of probs approach
id: [2662] -> tensor([[1.7809e-05, 6.4727e-05, 3.0046e-07, 1.2553e-04, 4.3011e-06, 2.9530e-05,
         1.7049e-04, 1.0123e-05, 3.1453e-04, 2.6385e-04, 1.6845e-04, 1.6558e-05,
         3.5518e-05, 1.7132e-04, 3.0401e-04, 1.1491e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[3.1937e-08, 9.8123e-06, 2.7165e-07, 4.7683e-06, 2.6599e-07, 2.1859e-05,
         1.3481e-06, 5.7580e-07, 1.3613e-06, 3.3924e-05, 4.9899e-06, 9.8810e-06,
         1.0493e-05, 2.1868e-05, 5.0416e-05, 2.0105e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.108273
summ of probs approach
id: [2662] -> tensor([[2.7622e-04, 2.7389e-05, 1.6118e-04, 5.7424e-05, 2.1759e-05, 3.6370e-05,
         5.2803e-05, 2.4100e-04, 2.5334e-05, 2.6352e-05, 5.3698e-05, 1.3963e-04,
         5.1809e-06, 9.6542e-06, 1.2233e-04, 1.9833e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[5.9176e-07, 5.9214e-08, 1.1316e-06, 2.1829e-06, 5.0822e-07, 9.1127e-06,
         7.3282e-06, 4.8544e-06, 1.3378e-07, 6.8853e-06, 9.3952e-07, 8.8217e-05,
         2.4876e-09, 4.0565e-07, 7.0065e-07, 2.8382e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.086031
summ of probs approach
id: [2662] -> tensor([[4.2487e-05, 5.0635e-05, 5.4880e-05, 9.6962e-08, 3.1030e-05, 2.2272e-05,
         9.5290e-06, 2.3262e-04]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [23607] -> tensor([[1.4154e-07, 9.9200e-08, 1.7132e-05, 1.8673e-08, 1.5402e-06, 2.2115e-07,
         4.5437e-06, 1.4830e-05]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.064247
acc:  0.54
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.447127
path ['42', 'de', 'flan', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.61s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.40s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id:[1, 452, 262]
load model Duration: 0:02:34.563124
prompt_type null has 1 prompts in it
----------- 42 de huggyllama/llama-7b SA null 0 200 16 --------------
summ of probs approach
id: [12337] -> tensor([[8.6427e-06, 2.4557e-05, 6.3181e-06, 4.5896e-06, 6.3777e-06, 5.2452e-06,
         5.0163e-04, 1.3232e-05, 1.5497e-05, 4.1723e-07, 2.0862e-06, 6.5625e-05,
         5.5432e-06, 3.0994e-06, 7.2718e-05, 1.6272e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1623e-05, 2.1040e-05, 4.8876e-06, 3.2187e-06, 1.0073e-05, 2.5153e-05,
        2.1398e-05, 4.9412e-05, 1.1802e-05, 1.3113e-06, 5.3048e-06, 1.7023e-04,
        6.9737e-06, 3.6657e-05, 6.3658e-05, 2.0146e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.510662
summ of probs approach
id: [12337] -> tensor([[2.2054e-06, 2.9624e-05, 5.9605e-07, 3.4213e-04, 1.7285e-06, 4.1723e-07,
         2.3842e-06, 3.1590e-06, 1.8477e-06, 2.5630e-06, 8.1062e-06, 1.0896e-04,
         3.4571e-06, 3.1590e-06, 3.2783e-06, 1.7285e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6226e-06, 3.9816e-05, 2.1458e-06, 4.7159e-04, 5.8413e-06, 1.5497e-06,
        4.5300e-06, 1.7285e-06, 5.7936e-05, 4.5300e-06, 1.4901e-05, 4.2582e-04,
        1.1504e-05, 3.3975e-06, 9.5367e-07, 5.3048e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.301076
summ of probs approach
id: [12337] -> tensor([[1.5140e-05, 1.6093e-06, 1.2517e-06, 5.0664e-06, 2.0087e-05, 2.2054e-06,
         1.3709e-06, 4.7684e-07, 2.9206e-06, 1.8477e-06, 2.1791e-04, 1.2517e-06,
         2.2650e-06, 2.6405e-05, 4.9162e-04, 2.2709e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.5630e-05, 1.2696e-05, 8.4639e-06, 4.7088e-06, 6.6698e-05, 4.8876e-06,
        7.7486e-07, 5.3644e-07, 2.5630e-06, 5.1379e-05, 4.2105e-04, 4.7684e-06,
        3.5167e-06, 5.7459e-05, 6.1572e-05, 3.0577e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.474752
summ of probs approach
id: [12337] -> tensor([[2.3246e-06, 1.0133e-06, 4.2915e-06, 4.7684e-07, 1.8477e-06, 1.3232e-05,
         8.3447e-07, 1.1325e-06, 5.9605e-07, 1.8656e-05, 1.2815e-04, 3.9935e-06,
         5.8770e-05, 1.2279e-05, 2.8753e-04, 1.9670e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.0930e-06, 5.5432e-06, 3.2902e-05, 1.1498e-04, 6.2585e-06, 1.9789e-04,
        1.7285e-06, 1.7285e-06, 2.4438e-06, 8.5831e-06, 1.1320e-03, 1.1861e-05,
        6.2406e-05, 1.6093e-05, 4.0603e-04, 2.6226e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.428247
summ of probs approach
id: [12337] -> tensor([[6.2585e-06, 4.4405e-05, 3.6359e-06, 8.7452e-04, 9.1195e-06, 1.5497e-06,
         5.9605e-07, 6.3419e-05, 1.5616e-05, 6.5565e-07, 1.3113e-06, 2.5034e-06,
         1.6093e-06, 2.9802e-06, 1.0133e-06, 7.1585e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.6161e-06, 3.8385e-05, 1.0967e-05, 8.9836e-04, 1.1504e-05, 2.2054e-06,
        1.9073e-06, 1.0830e-04, 1.4007e-05, 1.2517e-06, 4.1127e-06, 3.1590e-06,
        1.3709e-06, 7.9274e-06, 1.6689e-06, 1.2779e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.389257
summ of probs approach
id: [12337] -> tensor([[5.7817e-06, 6.4373e-06, 4.7386e-05, 8.3447e-07, 1.3113e-06, 4.4107e-06,
         4.8876e-06, 2.3842e-06, 3.0398e-06, 7.7486e-07, 2.2054e-06, 7.3910e-06,
         3.9220e-05, 1.1921e-06, 2.4438e-06, 2.3246e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2696e-05, 2.2650e-06, 4.1962e-05, 2.2054e-06, 2.2054e-06, 4.1723e-06,
        4.2915e-06, 2.4319e-05, 8.8811e-06, 1.9073e-06, 3.0398e-06, 6.4969e-06,
        2.1827e-04, 3.8147e-06, 7.5698e-06, 2.1696e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.510687
summ of probs approach
id: [12337] -> tensor([[9.2387e-06, 1.0133e-06, 2.2173e-05, 4.8876e-05, 1.9431e-05, 1.1855e-04,
         1.7881e-06, 1.6689e-06, 1.8215e-04, 4.6492e-06, 8.2850e-06, 1.1325e-06,
         2.9206e-06, 5.3644e-07, 3.5620e-04, 2.8014e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.0068e-06, 9.5367e-07, 5.6076e-04, 6.7651e-05, 3.1888e-05, 2.7180e-04,
        2.6822e-06, 8.4043e-06, 7.3528e-04, 9.4175e-06, 4.6372e-05, 2.1458e-06,
        1.0395e-04, 1.1921e-06, 1.0157e-03, 4.4703e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.422509
summ of probs approach
id: [12337] -> tensor([[5.3644e-06, 9.3889e-04, 2.3842e-07, 1.3709e-05, 3.5763e-07, 2.9516e-04,
         1.4305e-06, 1.3709e-06, 1.3912e-04, 1.2004e-04, 1.0401e-04, 1.7047e-05,
         1.6689e-06, 1.2910e-04, 1.0026e-04, 3.9558e-03]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.3379e-06, 4.7755e-04, 7.7486e-07, 1.5855e-04, 4.4703e-06, 1.6999e-04,
        1.1444e-05, 1.0729e-06, 3.3245e-03, 1.8272e-03, 1.0252e-04, 2.9743e-05,
        6.7353e-06, 8.9705e-05, 6.7770e-05, 2.1667e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.389661
summ of probs approach
id: [12337] -> tensor([[2.7001e-05, 1.4877e-04, 3.7551e-06, 1.7881e-07, 4.7636e-04, 4.6325e-04,
         1.1921e-06, 5.0664e-06, 1.3471e-05, 8.3447e-07, 3.1734e-04, 2.3842e-06,
         4.6492e-05, 2.0862e-06, 1.3113e-06, 1.5223e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.6809e-05, 1.8144e-04, 5.7220e-06, 1.1921e-06, 2.8074e-05, 6.5613e-04,
        1.8477e-06, 7.1526e-06, 2.3043e-04, 1.7285e-06, 1.0943e-04, 2.6822e-06,
        7.9870e-06, 2.9206e-06, 2.5630e-06, 1.2755e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.493759
summ of probs approach
id: [12337] -> tensor([[5.6744e-05, 9.8050e-05, 1.4007e-05, 3.9339e-06, 6.0201e-06, 1.6093e-06,
         6.8545e-06, 6.9022e-05, 3.8743e-06, 1.6689e-05, 1.4901e-06, 6.5565e-07,
         1.1623e-05, 1.0133e-06, 5.5373e-05, 1.6868e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.6785e-04, 4.0174e-05, 9.8133e-04, 3.2783e-06, 2.3556e-04, 3.2187e-06,
        7.1526e-06, 7.7546e-05, 5.0664e-06, 2.9802e-04, 1.9073e-06, 2.3842e-06,
        3.5048e-05, 4.4107e-06, 1.9968e-04, 2.5153e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.376704
summ of probs approach
id: [12337] -> tensor([[3.0398e-06, 1.7285e-06, 2.0862e-06, 4.1485e-05, 5.7817e-06, 1.5008e-04,
         2.2650e-06, 1.2898e-04, 1.2922e-03, 6.8128e-05, 3.3379e-06, 3.9935e-06,
         4.0531e-06, 9.0122e-05, 4.2319e-06, 1.1802e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.4703e-06, 1.5497e-06, 3.2187e-06, 6.4909e-05, 1.1027e-05, 1.6308e-04,
        5.6624e-06, 9.8896e-04, 2.0945e-04, 3.5286e-05, 2.9802e-06, 1.1146e-05,
        7.3910e-06, 8.2636e-04, 1.2338e-05, 2.3186e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.347084
summ of probs approach
id: [12337] -> tensor([[1.0729e-06, 7.1883e-05, 7.5102e-06, 4.4107e-06, 1.3947e-05, 6.5994e-04,
         1.5078e-03, 4.4703e-06, 2.8896e-04, 1.8477e-06, 2.9206e-06, 1.5497e-06,
         7.1526e-06, 1.4007e-05, 7.9274e-06, 1.3709e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.2650e-06, 2.7919e-04, 1.8418e-05, 1.1146e-05, 1.4246e-05, 2.4452e-03,
        1.5330e-04, 1.9789e-05, 1.1575e-04, 7.6890e-06, 2.3842e-06, 4.6492e-06,
        2.0385e-05, 2.3305e-05, 3.2842e-05, 1.9670e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.483325
summ of probs approach
id: [12337] -> tensor([[5.7817e-06, 1.7881e-07, 3.9935e-06, 1.0729e-06, 8.7202e-05, 4.5896e-06,
         2.2817e-04, 3.2663e-04]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
summ of probs approach
probs_ shape tensor([1.2279e-05, 3.8147e-06, 1.1861e-05, 1.8477e-06, 6.1154e-05, 6.6757e-06,
        9.1171e-04, 1.3638e-03], device='cuda:0', dtype=torch.float16) torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.109479
acc:  0.55
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:05.260943
path ['42', 'de', 'llama', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [432, 1], 'attention_mask': [1, 1]}
id:[432, 1]
answer  {'input_ids': [448, 348, 1], 'attention_mask': [1, 1, 1]}
id:[448, 348, 1]
load model Duration: 0:00:06.222183
prompt_type null has 1 prompts in it
----------- 42 de bigscience/mt0-small SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([0.0004, 0.0014, 0.0022, 0.0008, 0.0007, 0.0065, 0.0014, 0.0007, 0.0008,
        0.0016, 0.0008, 0.0059, 0.0019, 0.0031, 0.0006, 0.0008],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0005, 0.0016, 0.0029, 0.0009, 0.0036, 0.0070, 0.0024, 0.0010, 0.0010,
        0.0020, 0.0008, 0.0035, 0.0022, 0.0031, 0.0011, 0.0009],
       device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.112324
summ of probs approach
probs_ shape tensor([5.5452e-04, 1.6012e-03, 1.6201e-03, 9.7898e-01, 5.4140e-03, 1.3487e-03,
        5.8408e-04, 6.9148e-04, 1.6389e-03, 1.0750e-03, 6.6307e-04, 2.3486e-03,
        8.3482e-04, 8.6586e-04, 4.6952e-04, 2.3117e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0469e-03, 1.6214e-03, 1.6267e-03, 9.7899e-01, 5.4399e-03, 1.4056e-03,
        1.0364e-03, 8.4601e-04, 1.5368e-03, 1.4004e-03, 1.5227e-03, 2.5106e-03,
        8.3916e-04, 9.1407e-04, 7.8864e-04, 2.3336e-03], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.103446
summ of probs approach
probs_ shape tensor([1.7646e-03, 5.4817e-04, 1.1401e-03, 1.0219e-03, 3.8991e-04, 1.4977e-03,
        8.5444e-04, 3.1087e-03, 1.2205e-03, 8.9769e-04, 1.0699e-03, 1.2564e-03,
        1.8056e-03, 9.4975e-01, 7.9393e-04, 1.3734e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.7411e-03, 5.5623e-04, 1.3376e-03, 2.5353e-03, 6.3539e-04, 3.2781e-03,
        2.1262e-03, 3.1381e-03, 1.3652e-03, 8.2525e-04, 1.5399e-03, 1.6584e-03,
        1.8632e-03, 9.4976e-01, 1.0149e-03, 5.8547e-03], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.081097
summ of probs approach
probs_ shape tensor([1.2867e-03, 1.9394e-03, 1.0037e-03, 1.2363e-03, 7.5010e-04, 4.7574e-04,
        1.4306e-03, 1.5771e-03, 1.2142e-03, 2.4522e-03, 4.2746e-04, 9.4916e-01,
        4.7181e-04, 1.2379e-03, 1.1632e-03, 1.8453e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4700e-03, 1.9837e-03, 1.0362e-03, 1.3008e-03, 1.6265e-03, 4.9575e-04,
        1.4279e-03, 3.1722e-03, 9.7659e-04, 6.6603e-03, 7.6360e-04, 9.4916e-01,
        5.0323e-04, 1.2416e-03, 1.1687e-03, 1.7429e-03], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.089631
summ of probs approach
probs_ shape tensor([1.8018e-03, 1.8641e-03, 8.4037e-03, 8.7397e-04, 1.1552e-03, 9.6501e-04,
        5.8158e-04, 6.4631e-04, 1.0865e-03, 1.8202e-03, 9.3587e-01, 3.8769e-04,
        6.1895e-04, 1.2250e-03, 1.4364e-03, 1.5136e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.8255e-03, 3.3294e-03, 4.4692e-03, 1.1412e-03, 1.2247e-03, 1.1614e-03,
        8.1775e-04, 3.7849e-04, 1.1107e-03, 3.8126e-03, 9.3587e-01, 6.7223e-03,
        7.2836e-04, 1.3732e-03, 2.8738e-03, 1.8211e-03], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.067421
summ of probs approach
probs_ shape tensor([5.5630e-04, 2.6940e-03, 5.2701e-04, 1.0983e-03, 6.2015e-03, 7.0491e-04,
        1.2623e-03, 1.0836e-03, 9.0707e-04, 1.6481e-03, 3.9986e-04, 1.3676e-03,
        9.7547e-04, 9.8146e-01, 9.2782e-04, 2.6576e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.6098e-04, 2.7019e-03, 5.1992e-04, 1.1034e-03, 6.2394e-03, 7.3068e-04,
        1.3647e-03, 2.3015e-03, 9.9077e-04, 1.3596e-03, 5.2030e-04, 1.2793e-03,
        2.7546e-03, 9.8147e-01, 8.6741e-04, 2.7233e-03], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.079540
summ of probs approach
probs_ shape tensor([1.4436e-03, 1.3855e-03, 1.0210e-03, 9.5942e-01, 1.1857e-03, 4.8530e-04,
        1.0108e-03, 4.8784e-04, 1.5403e-03, 7.3796e-04, 2.2039e-03, 1.1955e-03,
        1.2755e-03, 2.4437e-04, 6.3246e-04, 8.2774e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4748e-03, 3.2497e-03, 1.3564e-03, 9.5943e-01, 1.3280e-03, 2.1268e-03,
        1.9246e-03, 9.0333e-04, 2.3306e-03, 1.5397e-03, 2.2389e-03, 2.0300e-03,
        1.5065e-03, 2.4517e-04, 8.1473e-04, 8.3761e-04], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.109106
summ of probs approach
probs_ shape tensor([5.1769e-03, 2.4716e-04, 6.1634e-04, 3.7028e-03, 2.0191e-03, 8.5557e-04,
        7.3974e-04, 2.4700e-03, 1.0411e-03, 7.2671e-04, 8.1036e-04, 3.8677e-03,
        1.5376e-03, 9.4782e-01, 9.5317e-04, 2.3956e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.6024e-03, 3.6517e-04, 1.9216e-03, 3.7263e-03, 2.8223e-03, 1.0462e-03,
        1.0456e-03, 2.4927e-03, 1.2942e-03, 7.2685e-04, 8.2047e-04, 3.9448e-03,
        1.5179e-03, 9.4784e-01, 2.6927e-03, 3.2608e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.091776
summ of probs approach
probs_ shape tensor([3.2077e-03, 4.4255e-04, 3.8385e-04, 1.6681e-03, 9.5007e-01, 6.6727e-04,
        9.8669e-04, 1.8642e-03, 2.1044e-03, 2.5064e-03, 8.2354e-04, 1.4825e-03,
        6.0513e-04, 2.6203e-03, 2.0756e-03, 2.8726e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.0612e-03, 4.4352e-04, 4.5850e-04, 1.8689e-03, 9.5007e-01, 9.4378e-04,
        1.4722e-03, 1.9611e-03, 2.8816e-03, 2.8683e-03, 1.3054e-03, 1.6322e-03,
        9.0287e-04, 3.8463e-03, 2.0806e-03, 2.9275e-03], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.067083
summ of probs approach
probs_ shape tensor([9.5116e-04, 1.1886e-03, 2.5748e-03, 7.1701e-04, 6.8431e-04, 8.2353e-04,
        5.6454e-04, 9.6969e-01, 1.6095e-03, 1.3452e-03, 8.3054e-05, 1.5197e-03,
        9.0368e-04, 2.8626e-03, 2.6163e-03, 1.0994e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.6373e-03, 2.6634e-03, 2.1682e-03, 7.0825e-04, 6.4193e-04, 1.1855e-03,
        1.2488e-03, 9.6969e-01, 1.6529e-03, 1.7648e-03, 8.3038e-05, 1.5215e-03,
        8.5862e-04, 3.1361e-03, 2.6493e-03, 1.2391e-03], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.093428
summ of probs approach
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
probs_ shape tensor([1.2053e-03, 5.2218e-03, 9.7268e-01, 4.2089e-04, 7.0610e-04, 5.1104e-03,
        5.9559e-04, 8.5798e-04, 4.3123e-04, 3.6475e-03, 1.8137e-03, 1.2200e-03,
        8.0011e-04, 2.7699e-03, 8.3835e-03, 3.1783e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.3001e-03, 5.3428e-03, 9.7268e-01, 4.2970e-04, 1.2628e-03, 5.1216e-03,
        7.2539e-04, 7.2110e-04, 5.7257e-04, 3.6555e-03, 1.4606e-03, 1.2983e-03,
        8.0252e-04, 2.8297e-03, 8.4075e-03, 3.1790e-04], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.080182
summ of probs approach
probs_ shape tensor([6.8443e-04, 1.8504e-03, 1.1256e-03, 5.7552e-04, 1.3313e-03, 1.0507e-03,
        1.0388e-03, 3.4451e-04, 8.9103e-01, 9.6596e-04, 3.5073e-03, 1.0817e-03,
        1.0336e-03, 9.1195e-04, 2.6020e-03, 1.2757e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.4206e-04, 2.6609e-03, 1.1410e-03, 5.8040e-04, 1.3402e-03, 1.1218e-03,
        9.8494e-04, 3.5954e-04, 8.9103e-01, 1.0864e-03, 5.0258e-03, 1.6725e-03,
        7.0837e-04, 1.9993e-03, 2.6148e-03, 1.4338e-03], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.105224
summ of probs approach
probs_ shape tensor([1.1135e-03, 9.6086e-01, 6.6931e-04, 9.9776e-04, 2.0785e-03, 1.4184e-03,
        1.9677e-03, 2.2416e-03], device='cuda:0') torch.Size([8])
summ of probs approach
probs_ shape tensor([0.0013, 0.9609, 0.0018, 0.0010, 0.0021, 0.0016, 0.0021, 0.0023],
       device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.062833
acc:  0.47
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.166055
path ['42', 'de', 't0', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Using NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  3.39it/s]100%|██████████| 3/3 [00:00<00:00,  8.24it/s]
loading model Duration: 0:00:01.393026
filter data Duraction: 0:00:00.000003
use_neutral is  True
len of entail_examples , neutral_examples, contra_examples:  66 66 66
len dataset  198
random sample Duraction: 0:02:49.072623
create dataloader Duration: 0:02:50.578364
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1650], 'attention_mask': [1]}
id:[1650]
answer  {'input_ids': [951, 265], 'attention_mask': [1, 1]}
id:[951, 265]
answer  {'input_ids': [89, 25898, 18508], 'attention_mask': [1, 1, 1]}
id:[89, 25898, 18508]
load model Duration: 0:00:09.999377
prompt_type null has 1 prompts in it
----------- 42 de bigscience/bloom-560m NLI null 0 200 16 --------------
summ of probs approach
id: [1650] -> tensor([[1.9268e-06, 1.1709e-06, 2.8550e-06, 1.0340e-06, 8.7463e-06, 1.9458e-06,
         1.8364e-06, 3.4765e-05, 1.1968e-06, 3.4503e-06, 3.0712e-06, 6.7643e-06,
         6.7321e-06, 1.3314e-07, 1.4634e-06, 3.9142e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.8161e-06, 2.8866e-06, 1.0800e-05, 8.1706e-06, 2.4731e-05, 6.0587e-06,
        1.1532e-05, 5.2843e-05, 1.9457e-05, 9.0617e-06, 2.5958e-06, 4.0781e-05,
        8.0499e-06, 9.7267e-07, 4.1090e-06, 2.2108e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.3493e-06, 4.0527e-06, 6.6875e-06, 2.0190e-05, 2.8496e-05, 6.7844e-06,
        4.0265e-05, 3.9763e-05, 2.1781e-05, 1.1221e-05, 3.9284e-06, 4.0049e-05,
        1.1082e-05, 2.3464e-06, 6.5883e-06, 4.4528e-06], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.229250
summ of probs approach
id: [1650] -> tensor([[5.1242e-07, 7.7680e-06, 8.8349e-07, 1.5826e-06, 1.1034e-06, 2.8421e-06,
         9.8918e-07, 6.0723e-07, 1.4182e-06, 7.5962e-07, 2.0860e-06, 1.1589e-06,
         4.9398e-07, 1.5401e-05, 6.0847e-07, 7.4757e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.1370e-06, 3.4363e-05, 4.1339e-06, 5.2558e-06, 5.7436e-06, 1.6148e-05,
        3.2745e-06, 2.4643e-06, 7.0852e-06, 3.1717e-06, 3.6163e-06, 3.6635e-06,
        4.7834e-06, 1.6931e-04, 3.2522e-06, 8.0925e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.7078e-06, 6.2006e-05, 4.5697e-06, 4.7286e-06, 2.9175e-06, 2.7688e-05,
        5.7195e-06, 5.5587e-06, 9.6018e-06, 6.6389e-06, 5.9819e-06, 1.9030e-06,
        6.2857e-06, 2.3683e-04, 7.3007e-06, 4.6941e-06], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.232312
summ of probs approach
id: [1650] -> tensor([[2.2504e-05, 4.4115e-06, 1.8819e-05, 3.4260e-07, 8.9034e-06, 7.5620e-07,
         8.2167e-07, 2.9213e-07, 2.6695e-06, 1.6551e-06, 1.4112e-06, 1.2652e-06,
         4.6099e-07, 8.0485e-07, 7.5751e-07, 7.1441e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.4418e-05, 1.7629e-05, 1.0903e-04, 1.9637e-06, 8.0083e-06, 2.5089e-06,
        1.0447e-05, 4.5758e-06, 3.5907e-05, 4.2376e-06, 3.2834e-06, 1.4387e-05,
        1.0386e-06, 2.9809e-06, 5.5654e-06, 4.8630e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.6685e-04, 1.3143e-05, 8.8124e-05, 3.5116e-06, 1.3488e-05, 5.4533e-06,
        1.3258e-05, 2.1536e-06, 9.5176e-06, 4.7239e-06, 1.8601e-06, 3.8187e-06,
        1.6222e-06, 4.1495e-06, 3.6555e-06, 1.0244e-05], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.221148
summ of probs approach
id: [1650] -> tensor([[3.8575e-06, 3.4291e-07, 2.7994e-06, 4.1431e-07, 8.1832e-07, 1.9450e-06,
         4.9656e-06, 9.2526e-08, 1.1457e-06, 1.5779e-06, 2.9265e-06, 2.6766e-07,
         6.9861e-06, 1.6347e-06, 7.4366e-07, 1.8598e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.4107e-05, 2.9905e-06, 2.5610e-05, 1.2185e-06, 1.4619e-06, 5.6593e-06,
        3.3246e-06, 6.9766e-07, 4.2044e-06, 2.9484e-06, 8.9105e-06, 2.0301e-06,
        2.6957e-05, 3.3703e-06, 2.2047e-06, 6.4711e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1563e-05, 4.5450e-06, 3.9221e-05, 4.1203e-06, 2.4578e-06, 1.1825e-05,
        9.4229e-06, 1.5012e-06, 5.0810e-06, 4.8474e-06, 1.0286e-05, 4.6193e-06,
        3.8062e-05, 9.4018e-06, 1.4539e-06, 1.2730e-05], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.212894
summ of probs approach
id: [1650] -> tensor([[4.7351e-06, 4.6597e-07, 3.5281e-07, 1.1761e-06, 2.3302e-06, 6.7708e-06,
         2.7740e-06, 5.0654e-07, 7.5047e-07, 3.0830e-07, 4.1889e-07, 5.3762e-07,
         1.1288e-06, 1.8690e-05, 1.6485e-06, 8.0437e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.6577e-06, 5.7543e-06, 2.4312e-06, 6.5599e-06, 2.7796e-05, 1.5991e-05,
        1.0115e-05, 3.5591e-06, 1.7727e-06, 2.0630e-06, 3.5764e-06, 2.7487e-06,
        3.5686e-06, 3.7877e-05, 8.2203e-06, 1.1758e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.0288e-06, 4.7605e-06, 3.6820e-06, 7.0009e-06, 8.5453e-05, 2.9040e-05,
        1.3188e-05, 5.6568e-06, 4.0574e-06, 3.2124e-06, 4.2277e-06, 6.3209e-06,
        5.7020e-06, 4.2805e-05, 1.0911e-05, 1.1528e-05], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.225148
summ of probs approach
id: [1650] -> tensor([[5.3937e-07, 2.1247e-06, 8.9814e-06, 4.0141e-07, 1.5841e-07, 4.1612e-06,
         1.8026e-06, 1.6185e-06, 2.9918e-07, 2.6129e-07, 3.5900e-06, 2.1751e-06,
         3.7516e-06, 9.9750e-06, 1.2850e-06, 1.4423e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.3244e-06, 5.0368e-06, 1.8012e-05, 2.8688e-06, 1.2847e-06, 4.5751e-05,
        7.5832e-06, 1.7435e-05, 2.7236e-06, 9.3016e-07, 8.1354e-06, 4.2625e-06,
        2.5694e-05, 4.9409e-05, 4.8282e-06, 5.8215e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1805e-05, 7.0578e-06, 6.6129e-05, 6.1319e-06, 3.0808e-06, 8.4092e-05,
        5.2067e-06, 2.0500e-05, 5.4081e-06, 2.6292e-06, 2.0040e-05, 1.0319e-05,
        3.6240e-05, 4.4755e-05, 2.0956e-05, 5.6058e-06], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.151009
summ of probs approach
id: [1650] -> tensor([[4.1183e-07, 2.2688e-07, 2.4557e-07, 9.1264e-07, 3.0728e-07, 2.6228e-07,
         6.0407e-07, 4.3010e-07, 1.1345e-06, 2.3335e-05, 2.6156e-06, 2.2803e-06,
         8.3400e-07, 1.7151e-06, 1.9253e-07, 1.7836e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.3629e-06, 2.3643e-06, 1.1036e-06, 8.2527e-06, 1.3743e-06, 1.0701e-06,
        1.0062e-05, 3.2587e-06, 3.6527e-06, 1.7693e-04, 5.3690e-06, 2.5468e-05,
        1.6539e-06, 6.2629e-06, 1.7384e-06, 1.3978e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.5424e-06, 3.7698e-06, 3.0176e-06, 5.8627e-06, 3.7343e-06, 1.4738e-06,
        6.0371e-06, 2.5931e-06, 5.7166e-06, 1.9862e-04, 5.5156e-06, 1.0527e-05,
        2.3160e-06, 9.8622e-06, 3.3233e-06, 2.8005e-06], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.248708
summ of probs approach
id: [1650] -> tensor([[2.0783e-07, 1.1352e-06, 4.8396e-07, 1.4874e-06, 1.0949e-06, 8.6341e-07,
         5.3432e-07, 7.5007e-07, 3.9707e-07, 1.1446e-07, 6.6268e-07, 5.0517e-07,
         1.0363e-05, 5.2879e-07, 2.7183e-06, 8.7672e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.0573e-06, 5.0019e-06, 6.4520e-05, 1.5573e-06, 3.8843e-06, 6.4489e-06,
        3.1801e-06, 7.0029e-06, 1.4847e-06, 1.1824e-06, 4.1624e-06, 2.8662e-06,
        8.0521e-05, 2.7958e-06, 1.2911e-05, 3.9280e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.4278e-06, 1.0222e-05, 3.2990e-05, 1.9765e-06, 5.2298e-06, 6.8316e-06,
        4.1246e-06, 1.0788e-05, 2.7666e-06, 6.3877e-06, 7.8650e-06, 2.9628e-06,
        1.1913e-04, 6.5539e-07, 1.6434e-05, 9.2176e-06], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.183519
summ of probs approach
id: [1650] -> tensor([[3.4655e-06, 3.0860e-05, 5.4828e-06, 2.3000e-06, 1.4644e-06, 2.5091e-06,
         3.0669e-06, 3.1381e-07, 1.9681e-06, 1.3469e-04, 3.6811e-07, 1.8828e-07,
         7.6948e-06, 5.6975e-07, 1.4384e-06, 7.3528e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.4175e-06, 3.9234e-04, 1.0030e-04, 6.1166e-06, 2.6666e-05, 1.8209e-05,
        1.0266e-05, 9.1705e-06, 9.3248e-06, 1.9665e-03, 4.6336e-06, 1.6738e-06,
        4.4779e-06, 4.6815e-06, 8.8715e-06, 5.5882e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.7768e-06, 1.2392e-04, 1.2087e-04, 1.2962e-05, 9.3389e-06, 4.6569e-05,
        1.4805e-05, 2.5979e-06, 7.5650e-06, 3.0945e-03, 5.6039e-06, 5.1855e-06,
        1.1691e-05, 3.2241e-06, 1.2952e-05, 5.5478e-06], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.293769
summ of probs approach
id: [1650] -> tensor([[2.5968e-06, 3.5859e-07, 6.6614e-07, 1.3776e-06, 4.5257e-07, 3.7553e-06,
         3.3711e-07, 4.0351e-07, 3.0337e-07, 5.4325e-07, 8.8703e-06, 1.1637e-06,
         9.4084e-08, 4.0712e-07, 9.6793e-07, 1.1575e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.3095e-06, 2.6580e-06, 1.9202e-06, 3.4742e-06, 2.2790e-06, 1.9927e-05,
        1.1366e-06, 2.3633e-06, 1.7811e-06, 1.4000e-06, 3.5333e-05, 2.3024e-05,
        1.0053e-06, 1.7495e-06, 4.0341e-06, 1.6733e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0441e-05, 2.9621e-05, 2.4443e-06, 6.7143e-06, 3.3012e-06, 3.2373e-05,
        2.3989e-06, 2.3152e-06, 3.2050e-06, 2.2313e-06, 5.7373e-05, 2.1781e-04,
        1.4382e-06, 2.7183e-06, 4.3947e-06, 2.2199e-06], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.244657
summ of probs approach
id: [1650] -> tensor([[3.0714e-07, 9.8261e-07, 2.6168e-06, 1.1602e-06, 1.4835e-06, 1.2538e-05,
         4.5203e-07, 3.8387e-06, 5.8038e-06, 6.6275e-07, 5.7764e-07, 5.2376e-06,
         1.0829e-06, 1.3854e-06, 2.5754e-07, 5.7902e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.5807e-06, 5.7043e-06, 1.1101e-06, 1.0505e-05, 2.1085e-05, 5.7275e-05,
        2.9330e-06, 1.2502e-05, 2.9736e-05, 3.2281e-06, 2.6228e-06, 9.2008e-06,
        7.3617e-06, 3.0099e-06, 3.1230e-05, 2.4155e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.5573e-06, 1.0282e-05, 1.7548e-06, 1.4000e-05, 6.2484e-06, 7.2117e-05,
        3.8524e-06, 6.2174e-06, 5.2875e-05, 4.8600e-06, 2.9477e-06, 5.8008e-06,
        2.9059e-06, 4.8747e-06, 3.4075e-06, 2.3168e-05], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.195472
summ of probs approach
id: [1650] -> tensor([[3.6370e-06, 1.3456e-06, 1.4553e-06, 1.3296e-06, 2.7739e-06, 4.6168e-06,
         1.7634e-06, 4.4921e-07, 2.3367e-07, 2.0963e-07, 2.4689e-04, 4.5464e-06,
         4.7820e-06, 2.6592e-07, 1.8329e-06, 2.1489e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.8159e-05, 3.9290e-06, 6.9200e-06, 2.4091e-06, 1.5966e-05, 3.7325e-06,
        1.1029e-05, 4.6335e-06, 3.3160e-06, 2.0077e-06, 2.1799e-04, 1.7517e-05,
        6.3866e-06, 4.9649e-07, 1.2997e-05, 1.1077e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.6902e-05, 6.9517e-06, 1.2218e-05, 3.6794e-06, 2.4428e-05, 5.7578e-06,
        1.1091e-05, 9.9500e-06, 3.6505e-06, 1.5524e-06, 5.3714e-05, 4.4389e-05,
        5.1145e-06, 8.1164e-07, 7.0623e-06, 2.1745e-06], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.395325
summ of probs approach
id: [1650] -> tensor([[1.1698e-06, 3.4694e-07, 1.4706e-07, 1.4401e-05, 2.9933e-06, 3.8460e-06]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([4.9306e-06, 4.5269e-06, 5.0525e-06, 4.0989e-05, 1.3756e-05, 1.9719e-05],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([9.1683e-06, 4.3377e-06, 7.8629e-06, 3.6171e-05, 2.4118e-05, 2.1918e-05],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.087312
acc:  0.3181818181818182
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.949419
path ['42', 'de', 'bloom', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1650], 'attention_mask': [1]}
id:[1650]
answer  {'input_ids': [951, 265], 'attention_mask': [1, 1]}
id:[951, 265]
answer  {'input_ids': [89, 25898, 18508], 'attention_mask': [1, 1, 1]}
id:[89, 25898, 18508]
load model Duration: 0:00:09.463873
prompt_type null has 1 prompts in it
----------- 42 de bigscience/bloomz-560m NLI null 0 200 16 --------------
summ of probs approach
id: [1650] -> tensor([[5.1102e-08, 8.4322e-08, 2.4544e-08, 2.6721e-08, 6.8333e-08, 4.3989e-08,
         3.3617e-08, 1.3059e-07, 2.8699e-08, 1.5904e-05, 7.1584e-08, 4.5306e-08,
         2.9213e-08, 7.2539e-09, 1.0929e-07, 9.7470e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.1010e-06, 1.2458e-06, 7.2558e-07, 1.2621e-06, 1.6190e-06, 2.0654e-07,
        1.2007e-06, 1.3737e-06, 6.8044e-07, 8.6884e-05, 1.2415e-06, 1.0861e-06,
        1.2113e-07, 4.8010e-08, 4.1051e-07, 2.5225e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.6955e-07, 4.5635e-07, 4.3308e-07, 1.8191e-07, 2.1122e-06, 4.5247e-08,
        9.0064e-07, 2.7765e-07, 1.7192e-07, 1.1243e-04, 4.4762e-07, 2.1637e-07,
        1.9981e-08, 1.3667e-08, 9.6524e-08, 8.1736e-08], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.253046
summ of probs approach
id: [1650] -> tensor([[3.7015e-08, 7.2160e-08, 6.3416e-07, 2.9190e-08, 1.8795e-08, 3.5940e-08,
         1.4780e-07, 5.5503e-08, 1.9880e-08, 2.7643e-07, 1.8706e-08, 2.8483e-08,
         5.7983e-08, 1.7473e-08, 6.0878e-08, 7.8980e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6841e-07, 5.9018e-07, 1.7754e-05, 4.9936e-07, 4.3589e-07, 2.4121e-07,
        1.0848e-06, 1.3371e-06, 1.0963e-06, 9.0973e-07, 5.3895e-07, 2.5974e-07,
        6.1261e-07, 4.5726e-07, 1.1617e-06, 7.2979e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.2569e-08, 1.7679e-07, 2.5630e-06, 7.9313e-08, 4.6817e-08, 1.1328e-07,
        6.3164e-07, 5.2496e-07, 3.1152e-07, 2.9168e-07, 1.1599e-07, 1.4552e-07,
        3.5915e-07, 7.7945e-08, 2.4188e-06, 8.2016e-08], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.194918
summ of probs approach
id: [1650] -> tensor([[1.0989e-07, 4.0125e-09, 9.2103e-09, 2.1946e-08, 1.0675e-07, 7.5465e-09,
         1.6117e-07, 3.4947e-08, 1.7721e-07, 5.2549e-08, 6.3032e-07, 4.2912e-08,
         1.9364e-08, 9.8434e-07, 3.8017e-08, 4.7071e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.4533e-06, 1.0868e-07, 3.6551e-07, 2.6709e-07, 2.3778e-07, 3.7181e-08,
        2.0439e-07, 2.2318e-06, 6.8985e-07, 1.0096e-06, 5.7227e-06, 4.7311e-07,
        5.4470e-07, 1.5636e-07, 1.3606e-06, 5.3308e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.5059e-06, 2.6095e-07, 4.0910e-07, 7.0114e-08, 6.7902e-08, 1.1711e-08,
        1.7950e-08, 1.7851e-07, 4.9352e-08, 9.5524e-07, 2.5937e-06, 8.8605e-08,
        1.8263e-07, 9.6028e-08, 3.4455e-07, 9.8400e-08], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.181319
summ of probs approach
id: [1650] -> tensor([[1.1339e-07, 1.7548e-06, 5.4991e-08, 2.6375e-08, 3.0822e-07, 6.1209e-08,
         4.6136e-08, 3.5325e-08, 3.8482e-08, 8.8940e-07, 2.3113e-09, 1.0654e-07,
         3.5615e-08, 2.2250e-08, 2.4757e-08, 1.4370e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.9189e-07, 3.2391e-07, 1.3664e-06, 4.4064e-07, 1.9602e-06, 2.9801e-07,
        3.1269e-07, 3.9030e-07, 2.2423e-07, 3.3256e-06, 2.8453e-08, 5.2608e-07,
        5.4178e-07, 2.4256e-07, 7.5935e-07, 4.9269e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.1280e-07, 8.5428e-08, 2.8306e-07, 2.4810e-07, 5.0005e-07, 7.6294e-08,
        3.6539e-08, 1.9752e-07, 9.5222e-08, 3.0523e-07, 2.2480e-09, 6.2138e-07,
        1.0257e-07, 1.9124e-07, 3.9392e-07, 2.5942e-07], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.197158
summ of probs approach
id: [1650] -> tensor([[7.5172e-07, 3.2625e-08, 4.8812e-08, 1.9245e-08, 2.4732e-08, 1.3565e-08,
         1.4739e-07, 7.9544e-08, 2.0755e-08, 4.4393e-07, 2.1089e-07, 5.7892e-09,
         6.3895e-08, 4.3855e-08, 3.5199e-07, 2.1861e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.4255e-07, 9.7350e-08, 4.2710e-07, 6.6136e-07, 1.0053e-06, 3.1529e-07,
        1.8082e-06, 3.2785e-07, 7.0763e-07, 3.5751e-07, 1.2387e-06, 5.3496e-07,
        6.8276e-07, 3.5815e-07, 5.2352e-07, 8.5982e-08], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0696e-07, 3.6103e-08, 1.4811e-07, 3.1810e-07, 3.0373e-07, 1.4288e-07,
        1.8668e-07, 6.0990e-08, 8.9598e-08, 5.1892e-08, 3.4335e-07, 4.5017e-08,
        3.6335e-07, 4.5815e-07, 3.0133e-07, 1.9741e-08], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.295540
summ of probs approach
id: [1650] -> tensor([[1.4952e-07, 8.0362e-09, 8.5702e-08, 1.8229e-06, 4.1163e-08, 4.1137e-08,
         1.7158e-08, 5.9629e-08, 3.5276e-08, 1.9227e-07, 1.4206e-07, 2.0074e-07,
         6.7281e-07, 1.3535e-07, 6.9933e-09, 7.5290e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.7753e-06, 2.1029e-07, 2.3112e-07, 2.6330e-06, 7.8439e-07, 1.7322e-06,
        6.2898e-07, 1.1068e-06, 2.4711e-07, 3.8615e-07, 1.1633e-06, 2.3484e-06,
        3.1874e-06, 1.0586e-07, 2.0892e-07, 6.4676e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.3235e-06, 9.2731e-08, 2.2049e-07, 4.6320e-07, 3.9389e-07, 8.1496e-08,
        2.6988e-07, 8.1718e-07, 2.3510e-08, 2.6444e-07, 3.3885e-07, 9.7276e-07,
        1.2568e-06, 2.7973e-08, 5.6653e-08, 6.5338e-07], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.215954
summ of probs approach
id: [1650] -> tensor([[2.3871e-08, 3.8798e-09, 1.9398e-07, 1.9258e-08, 1.8044e-07, 5.0850e-08,
         7.9385e-08, 7.8303e-09, 2.4791e-08, 4.2848e-08, 1.1167e-07, 2.6820e-09,
         2.3503e-08, 8.8336e-08, 1.0807e-08, 4.3737e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.2120e-07, 1.9089e-07, 5.6301e-07, 1.0395e-06, 5.4074e-07, 8.3525e-07,
        4.8941e-07, 5.0394e-07, 3.3616e-07, 1.2772e-06, 3.3451e-07, 1.1452e-07,
        1.0259e-06, 2.1696e-06, 7.9992e-07, 2.0206e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.0514e-08, 1.3950e-07, 4.0811e-07, 3.2018e-07, 3.9139e-07, 1.6027e-07,
        2.0890e-07, 8.5149e-08, 8.9798e-07, 5.2712e-07, 8.6879e-08, 8.5229e-08,
        3.9306e-07, 6.6149e-07, 2.0956e-07, 3.0053e-08], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.209060
summ of probs approach
id: [1650] -> tensor([[5.0170e-08, 3.3336e-08, 4.3082e-08, 2.8869e-08, 3.1922e-07, 5.5695e-08,
         2.4598e-08, 1.0363e-07, 8.2074e-09, 3.0808e-08, 3.3107e-08, 5.1183e-08,
         9.6487e-08, 7.3543e-08, 1.7530e-08, 4.5701e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.9852e-06, 6.2188e-07, 1.4460e-06, 1.8319e-07, 6.3942e-07, 2.6616e-06,
        6.5238e-07, 1.0195e-06, 3.9980e-07, 3.8925e-07, 5.9207e-07, 5.2095e-08,
        1.8991e-07, 6.3926e-07, 5.5745e-08, 1.3669e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.4463e-07, 3.6313e-07, 7.2448e-07, 9.2640e-08, 5.1103e-08, 4.6418e-07,
        2.9989e-07, 4.2083e-07, 5.6887e-07, 1.5550e-07, 1.6003e-07, 6.2336e-08,
        5.6737e-08, 2.5662e-07, 5.3311e-09, 9.1476e-08], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.181690
summ of probs approach
id: [1650] -> tensor([[2.1147e-07, 9.1664e-09, 4.5270e-08, 5.3545e-08, 8.4781e-08, 3.5396e-07,
         1.0995e-08, 8.1641e-09, 4.7999e-08, 2.6007e-07, 3.9938e-07, 1.0781e-06,
         5.0028e-08, 1.3240e-08, 5.1597e-08, 1.9590e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.0190e-07, 5.4713e-07, 1.4840e-06, 4.9685e-07, 7.2458e-07, 4.5621e-06,
        1.3994e-07, 1.4507e-07, 1.4118e-06, 1.3115e-06, 3.8039e-06, 1.3936e-05,
        9.2450e-07, 7.3082e-08, 1.7242e-06, 1.2368e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.9183e-08, 9.3592e-08, 2.8948e-06, 3.0073e-07, 1.8997e-07, 7.6437e-07,
        4.1313e-08, 7.8830e-08, 6.1848e-08, 1.7660e-07, 2.5607e-06, 6.4053e-07,
        1.8629e-07, 2.1902e-08, 1.4561e-07, 4.0378e-08], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.391625
summ of probs approach
id: [1650] -> tensor([[6.3184e-09, 6.5539e-08, 1.3966e-08, 2.2518e-06, 5.6065e-07, 1.0904e-08,
         3.1428e-05, 2.1517e-08, 3.4608e-08, 1.0152e-07, 7.6153e-08, 1.9755e-08,
         1.0785e-07, 8.6382e-08, 3.4660e-08, 3.0074e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.2422e-07, 8.3353e-07, 1.3817e-07, 4.0034e-06, 3.7662e-06, 1.1795e-06,
        8.6165e-05, 3.7421e-07, 3.0534e-07, 7.4081e-07, 9.2040e-07, 6.1077e-07,
        1.4822e-07, 8.6862e-07, 1.3730e-06, 3.3179e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.8094e-07, 3.4443e-07, 5.1269e-08, 8.8191e-07, 1.1293e-06, 9.7934e-08,
        2.2291e-05, 1.4870e-07, 8.2554e-08, 4.4244e-07, 6.0447e-07, 3.4110e-07,
        6.8618e-08, 2.9152e-07, 4.1432e-07, 8.2923e-08], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.248522
summ of probs approach
id: [1650] -> tensor([[2.9116e-09, 2.0906e-08, 3.9741e-07, 5.7854e-08, 5.0884e-08, 2.2899e-08,
         1.0210e-08, 7.9692e-09, 1.9142e-08, 4.2678e-08, 2.3126e-08, 5.1819e-07,
         2.5354e-08, 3.1735e-08, 1.2190e-07, 1.7146e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.5410e-08, 4.8742e-07, 1.4390e-06, 1.2945e-06, 1.0676e-07, 8.4921e-08,
        4.1316e-07, 9.3392e-07, 2.2636e-07, 8.4978e-06, 6.4551e-07, 1.2841e-06,
        1.7861e-07, 4.5601e-07, 1.3644e-06, 4.2075e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.9435e-08, 4.9964e-07, 2.9957e-07, 3.3355e-07, 5.1665e-08, 6.7418e-08,
        4.4992e-08, 2.2788e-07, 1.4328e-07, 7.3944e-07, 2.6257e-07, 6.2070e-07,
        3.2661e-08, 2.1387e-07, 3.9567e-07, 7.0976e-07], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.224063
summ of probs approach
id: [1650] -> tensor([[1.6442e-08, 9.1669e-08, 5.6118e-09, 4.7193e-08, 6.9351e-08, 4.9142e-08,
         4.1818e-07, 1.5806e-07, 1.2015e-08, 6.5364e-08, 3.7115e-09, 2.5318e-08,
         5.2255e-09, 1.0886e-07, 5.8129e-08, 2.3317e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.2314e-07, 3.4448e-07, 3.7212e-08, 8.4317e-07, 3.4262e-07, 1.2619e-06,
        3.1500e-06, 9.2067e-07, 6.4172e-08, 2.9790e-08, 4.1749e-07, 8.1493e-08,
        3.2934e-07, 2.2093e-06, 9.8546e-07, 1.1167e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.1764e-07, 2.7686e-07, 7.6007e-09, 3.8970e-07, 1.7129e-07, 5.6638e-07,
        1.0631e-06, 7.8773e-07, 1.7794e-08, 2.1096e-08, 3.3964e-08, 1.0861e-07,
        3.8695e-08, 1.2166e-07, 4.8957e-07, 2.6183e-07], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.252933
summ of probs approach
id: [1650] -> tensor([[5.8248e-08, 6.4522e-08, 1.9997e-08, 1.4382e-07, 2.3741e-08, 7.5618e-09]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([2.5980e-06, 6.5868e-07, 4.7838e-07, 3.0677e-06, 6.6336e-08, 8.6939e-07],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([7.9618e-07, 3.5099e-07, 2.3939e-07, 1.1611e-06, 1.9467e-07, 1.1851e-07],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.075642
acc:  0.3282828282828283
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.959443
path ['42', 'de', 'bloomz', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
load model Duration: 0:00:02.912932
prompt_type null has 1 prompts in it
----------- 42 de google/flan-t5-base NLI null 0 200 16 --------------
summ of probs approach
id: [2662] -> tensor([[5.4515e-05, 9.5963e-05, 3.1666e-05, 6.6162e-05, 3.4467e-04, 2.6674e-05,
         1.6037e-07, 1.5778e-05, 3.4983e-06, 1.3685e-08, 2.0393e-05, 5.9243e-04,
         4.6229e-06, 1.8275e-04, 5.2041e-06, 1.3646e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.3274e-06, 4.2733e-06, 7.9496e-07, 3.3078e-07, 6.5715e-06, 4.5731e-07,
         2.7008e-08, 1.2436e-06, 1.7623e-09, 2.2155e-11, 1.0548e-05, 3.3665e-06,
         5.6375e-07, 3.5797e-06, 1.2720e-04, 1.1728e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[2.9134e-05, 1.5720e-06, 5.1571e-07, 7.8927e-07, 5.5979e-06, 8.4414e-08,
         6.7509e-08, 6.9825e-07, 6.7412e-09, 2.9732e-10, 3.9119e-06, 4.4827e-08,
         9.2844e-08, 7.2590e-07, 4.3413e-06, 2.9347e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.148295
summ of probs approach
id: [2662] -> tensor([[1.3637e-05, 2.4731e-06, 5.0829e-06, 5.9630e-07, 4.4874e-05, 1.0176e-07,
         5.9021e-06, 3.2789e-05, 4.1290e-05, 1.3233e-05, 1.2625e-04, 5.0708e-06,
         3.2293e-05, 1.7751e-04, 7.3258e-07, 1.1085e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.4583e-06, 2.1670e-08, 1.0742e-07, 4.5560e-10, 2.2690e-06, 3.8828e-08,
         8.3787e-08, 7.2866e-05, 1.1305e-07, 1.2821e-07, 2.3948e-06, 7.2720e-06,
         1.3336e-05, 1.1177e-06, 1.9117e-09, 2.3213e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[4.1848e-07, 2.5811e-08, 1.2742e-07, 1.4774e-08, 5.8811e-07, 1.3888e-09,
         1.8318e-06, 6.0210e-07, 3.3944e-07, 2.2336e-08, 6.0215e-07, 1.4779e-07,
         9.4859e-06, 4.5442e-07, 5.2213e-10, 2.6946e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.110612
summ of probs approach
id: [2662] -> tensor([[1.0349e-04, 1.7703e-04, 4.8656e-04, 5.1057e-04, 2.5680e-05, 8.6703e-06,
         1.1913e-06, 2.9223e-05, 1.2339e-08, 4.3630e-05, 2.1319e-04, 4.3801e-06,
         8.5217e-04, 1.7136e-05, 9.2369e-06, 9.4711e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.4627e-08, 2.1344e-05, 5.4806e-06, 1.8935e-04, 5.0619e-06, 5.0118e-08,
         3.6614e-09, 2.0642e-06, 1.1881e-08, 8.6131e-07, 1.0227e-04, 3.3854e-09,
         1.9592e-04, 3.1867e-06, 6.8189e-08, 5.5624e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[7.2570e-09, 5.0023e-06, 1.5333e-07, 3.2716e-06, 5.0402e-07, 7.4501e-08,
         8.7277e-09, 2.5740e-07, 2.3861e-10, 1.9517e-07, 9.3059e-08, 3.1665e-08,
         8.0540e-06, 2.6644e-06, 1.4493e-06, 2.8817e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.077013
summ of probs approach
id: [2662] -> tensor([[3.6014e-05, 1.3904e-04, 9.7876e-05, 1.8656e-04, 4.5500e-05, 8.0486e-05,
         3.8385e-05, 4.3215e-07, 2.4109e-04, 3.0469e-06, 9.2274e-05, 6.9896e-05,
         5.5098e-06, 1.4323e-04, 7.0918e-06, 1.5987e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[4.4271e-07, 5.4071e-06, 9.5051e-07, 1.2503e-05, 1.8740e-05, 2.2410e-07,
         1.5199e-07, 4.1472e-07, 1.2517e-05, 1.2074e-06, 8.4199e-07, 2.8039e-06,
         7.7813e-08, 1.7214e-06, 4.3152e-06, 1.0693e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[1.0864e-06, 1.6809e-06, 5.7549e-06, 1.0354e-05, 1.2870e-05, 3.5289e-08,
         1.5620e-06, 5.0720e-08, 1.0220e-04, 5.7592e-06, 4.3456e-07, 1.5493e-06,
         1.8532e-07, 5.4537e-07, 2.3919e-06, 9.6565e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.142236
summ of probs approach
id: [2662] -> tensor([[1.4065e-04, 1.7599e-05, 3.7927e-05, 2.0261e-04, 2.3431e-08, 2.6770e-05,
         5.6760e-06, 1.0216e-04, 1.7551e-05, 6.7651e-05, 1.2415e-03, 1.9060e-05,
         5.0446e-05, 9.3760e-06, 1.2953e-04, 2.6244e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[7.5188e-06, 3.6569e-05, 1.2052e-05, 5.8625e-07, 3.6163e-08, 5.9052e-07,
         1.0149e-06, 4.3088e-07, 5.3938e-06, 4.4628e-06, 6.5589e-05, 3.8384e-05,
         1.2202e-06, 1.0281e-06, 1.9231e-06, 1.0285e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[5.1459e-08, 1.8944e-06, 3.2754e-06, 4.0940e-07, 2.0294e-10, 5.3033e-07,
         7.7766e-07, 8.4118e-07, 6.2324e-06, 7.3044e-06, 2.4842e-05, 4.1154e-06,
         2.7139e-07, 2.4624e-06, 4.1807e-06, 1.0531e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.200353
summ of probs approach
id: [2662] -> tensor([[4.2486e-04, 1.0716e-04, 1.0526e-04, 3.5590e-06, 9.1039e-05, 1.2121e-04,
         7.4924e-05, 5.2127e-05, 1.4241e-03, 3.5703e-04, 1.1288e-04, 5.5733e-07,
         7.7438e-06, 9.7423e-07, 1.7172e-05, 2.0985e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.5806e-07, 5.0170e-06, 4.8962e-06, 1.1348e-07, 1.3751e-07, 5.2976e-07,
         2.1125e-07, 4.1867e-07, 7.1243e-05, 1.8905e-06, 2.1596e-07, 3.4621e-08,
         6.7104e-06, 2.4797e-09, 1.1155e-08, 4.8677e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[4.2495e-08, 1.8025e-06, 1.8446e-07, 6.4987e-07, 2.5281e-07, 4.4049e-06,
         5.9436e-10, 6.4990e-06, 3.7997e-06, 1.5291e-07, 8.4112e-08, 3.4671e-09,
         9.5315e-08, 1.7349e-09, 1.1551e-08, 1.6961e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.108885
summ of probs approach
id: [2662] -> tensor([[1.1078e-04, 1.0188e-04, 9.5820e-07, 6.1374e-05, 6.2540e-08, 2.3291e-06,
         1.2651e-05, 1.6498e-04, 1.6269e-07, 7.3268e-05, 1.5001e-05, 1.8246e-06,
         3.0832e-06, 1.4499e-05, 1.2671e-04, 9.1221e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[5.1905e-06, 1.7302e-06, 4.0634e-09, 3.4497e-07, 8.3313e-08, 1.0594e-07,
         1.1139e-07, 3.2479e-06, 1.4030e-08, 1.7529e-06, 7.3607e-07, 5.8378e-08,
         3.3499e-08, 2.7530e-07, 1.4538e-05, 4.3740e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[2.5582e-06, 5.1018e-06, 1.2413e-09, 1.0290e-06, 4.2841e-09, 4.6303e-08,
         8.1356e-08, 1.7693e-06, 2.9192e-09, 2.6937e-07, 3.2783e-09, 3.6072e-09,
         2.8356e-08, 4.2692e-07, 6.0275e-07, 4.9033e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.078245
summ of probs approach
id: [2662] -> tensor([[1.0367e-04, 4.2956e-05, 1.4767e-05, 4.2918e-06, 8.4679e-05, 5.0153e-05,
         2.6600e-05, 8.6375e-05, 1.5202e-05, 9.2715e-07, 2.2881e-06, 1.4334e-05,
         3.8541e-05, 2.3882e-04, 7.0788e-06, 2.7805e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[6.3052e-07, 1.1386e-06, 2.0179e-06, 8.4046e-08, 4.2269e-06, 3.7571e-07,
         1.1777e-05, 1.2530e-05, 5.6587e-08, 3.2851e-08, 4.8921e-06, 6.6440e-09,
         2.3989e-05, 4.8870e-06, 6.4746e-07, 2.4586e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[1.6079e-07, 1.4468e-06, 4.3631e-06, 1.5314e-07, 5.1305e-06, 9.9497e-07,
         2.1034e-05, 4.9898e-05, 2.1714e-07, 5.9882e-08, 8.0907e-08, 4.7405e-08,
         3.6327e-07, 1.4828e-05, 4.1963e-07, 4.6448e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.105169
summ of probs approach
id: [2662] -> tensor([[2.0720e-04, 2.3672e-04, 1.7628e-05, 2.3878e-05, 6.0625e-05, 1.3501e-04,
         6.9909e-05, 8.9424e-05, 1.4797e-05, 2.5685e-08, 1.0356e-06, 4.9607e-05,
         5.0099e-05, 2.7679e-06, 1.5316e-04, 4.9801e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.7667e-06, 1.0136e-06, 2.6164e-07, 1.8785e-06, 1.6575e-07, 2.1160e-05,
         6.0942e-07, 9.2049e-07, 1.3340e-06, 1.2724e-08, 2.1819e-08, 7.4470e-07,
         2.0606e-05, 1.4355e-07, 1.0116e-06, 2.2236e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[2.2170e-06, 5.6411e-07, 3.0957e-07, 2.4355e-07, 2.4250e-07, 1.8056e-06,
         6.3416e-06, 9.7957e-07, 3.2549e-07, 1.3386e-09, 2.0093e-09, 1.8960e-07,
         1.8951e-06, 7.3590e-07, 2.8875e-08, 1.2566e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.086192
summ of probs approach
id: [2662] -> tensor([[5.4385e-05, 1.7078e-04, 1.0317e-05, 1.8662e-05, 8.2422e-08, 1.2895e-04,
         1.7420e-05, 1.7962e-05, 1.9104e-05, 3.2512e-05, 2.8500e-05, 1.7739e-05,
         2.0432e-06, 2.4186e-05, 1.7730e-06, 1.8023e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.0739e-06, 2.3691e-06, 7.8242e-08, 3.1708e-07, 1.6775e-08, 1.0954e-05,
         3.3741e-07, 3.3801e-06, 2.3552e-07, 1.1807e-07, 1.7795e-06, 9.2636e-07,
         1.8057e-08, 1.0671e-07, 2.7823e-08, 1.4299e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[7.3721e-08, 2.6081e-07, 6.8114e-07, 7.5324e-08, 1.4561e-08, 6.5320e-06,
         1.0281e-07, 4.4149e-06, 9.7029e-07, 6.3990e-07, 2.8332e-06, 8.5878e-06,
         3.8222e-07, 1.0646e-07, 1.5231e-07, 6.6773e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.077692
summ of probs approach
id: [2662] -> tensor([[1.7750e-04, 8.9101e-05, 9.8080e-05, 3.9542e-05, 2.6647e-05, 5.7723e-08,
         1.1404e-05, 4.2300e-06, 2.2443e-04, 3.2512e-05, 1.7168e-04, 1.2528e-05,
         1.1124e-05, 1.5560e-04, 8.7904e-07, 1.0609e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.1436e-06, 2.9022e-07, 2.2428e-07, 5.2287e-07, 7.6676e-06, 8.6739e-08,
         6.9998e-07, 6.2065e-09, 3.3919e-06, 5.9217e-06, 2.7978e-07, 1.0239e-07,
         5.4462e-08, 2.9490e-04, 5.6786e-09, 6.6756e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[1.0713e-06, 8.5156e-07, 7.4068e-08, 7.2177e-06, 5.4072e-05, 3.4432e-10,
         4.3192e-07, 2.3794e-07, 1.2756e-06, 4.3446e-06, 3.6039e-09, 1.1373e-08,
         1.5803e-08, 4.2757e-06, 2.5020e-09, 1.3160e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.064827
summ of probs approach
id: [2662] -> tensor([[1.1191e-07, 1.4942e-05, 1.3531e-04, 4.4435e-05, 2.8059e-06, 7.6883e-05,
         1.6077e-04, 2.3118e-05, 5.4195e-05, 3.0916e-04, 7.3491e-07, 2.4775e-04,
         3.6935e-05, 5.5253e-05, 2.0433e-05, 2.6895e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.3101e-08, 1.1374e-06, 2.1952e-06, 8.9025e-08, 3.8026e-08, 2.5250e-06,
         7.1953e-06, 1.6602e-06, 4.8472e-06, 7.7530e-05, 2.6097e-08, 4.0121e-07,
         6.8598e-07, 7.8562e-05, 1.1204e-05, 3.1728e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[1.0717e-07, 5.2931e-07, 1.5707e-06, 9.0203e-08, 2.0201e-07, 6.1925e-06,
         6.7148e-06, 4.7465e-07, 6.3905e-06, 4.5181e-08, 3.7840e-08, 1.7863e-07,
         1.1096e-06, 8.8053e-06, 1.4827e-05, 1.9594e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.121124
summ of probs approach
id: [2662] -> tensor([[1.1774e-05, 1.2635e-04, 1.2762e-07, 7.4926e-05, 1.3197e-04, 1.2422e-05]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [23607] -> tensor([[3.0471e-07, 1.6978e-06, 2.3436e-08, 2.9764e-05, 2.0338e-06, 3.2136e-07]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [10330] -> tensor([[2.7946e-06, 6.9208e-06, 8.6469e-09, 1.3805e-07, 3.4620e-07, 2.2756e-07]],
       device='cuda:0'), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.035957
acc:  0.3484848484848485
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.389289
path ['42', 'de', 'flan', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.63s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id:[1, 452, 262]
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id:[1, 325, 11381, 1428]
load model Duration: 0:02:36.273344
prompt_type null has 1 prompts in it
----------- 42 de huggyllama/llama-7b NLI null 0 200 16 --------------
summ of probs approach
id: [12337] -> tensor([[7.0930e-06, 3.2663e-05, 4.2915e-06, 4.2319e-06, 4.0531e-06, 1.3709e-06,
         1.9598e-04, 1.4603e-05, 4.7088e-06, 1.4842e-05, 1.7464e-05, 8.3447e-07,
         3.0994e-06, 2.9802e-07, 4.6730e-05, 1.2696e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.3379e-06, 2.0087e-05, 5.1260e-06, 1.7524e-05, 2.2054e-06, 1.9908e-05,
        9.8526e-05, 7.7486e-06, 1.1146e-05, 3.6657e-05, 1.6391e-05, 3.0398e-06,
        6.7949e-06, 2.9206e-06, 4.4644e-05, 7.8678e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1623e-05, 2.2888e-05, 7.2718e-06, 2.2292e-05, 1.4305e-05, 5.9009e-06,
        9.5248e-05, 2.9445e-05, 3.8266e-05, 2.1553e-04, 3.6097e-04, 2.7657e-05,
        8.3447e-06, 3.8743e-06, 7.5459e-05, 1.6642e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.300933
summ of probs approach
id: [12337] -> tensor([[1.2875e-05, 7.0930e-06, 1.3113e-06, 2.4021e-05, 2.4438e-06, 2.6393e-04,
         9.0599e-06, 8.7619e-06, 4.1723e-06, 4.2915e-06, 6.3181e-06, 2.6822e-06,
         6.9141e-06, 2.6941e-05, 2.2650e-05, 1.2040e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.5153e-05, 7.7486e-06, 3.8922e-05, 3.6180e-05, 2.5034e-06, 2.0444e-04,
        3.6776e-05, 6.0201e-06, 7.0930e-06, 9.4175e-06, 1.7107e-05, 1.4305e-06,
        1.4007e-05, 3.7611e-05, 1.0288e-04, 7.4506e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([8.4996e-05, 3.6657e-05, 9.5189e-05, 6.4313e-05, 6.6161e-06, 2.6751e-04,
        5.3227e-05, 7.8082e-06, 1.1206e-05, 2.6822e-05, 3.9518e-05, 5.4836e-06,
        4.9651e-05, 4.0126e-04, 8.4579e-05, 4.5002e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.373755
summ of probs approach
id: [12337] -> tensor([[3.2604e-05, 6.6757e-06, 8.8930e-05, 4.4107e-06, 2.2054e-06, 2.9802e-07,
         6.4850e-05, 4.1723e-07, 1.3351e-05, 3.3081e-05, 6.4969e-06, 1.0073e-05,
         5.3346e-05, 4.2200e-05, 5.4836e-06, 1.0192e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.0220e-05, 5.2452e-06, 6.2943e-05, 1.9014e-05, 1.1086e-05, 9.3579e-06,
        5.6744e-05, 8.8811e-06, 1.7762e-05, 2.5332e-05, 1.2040e-05, 1.2815e-05,
        8.9943e-05, 3.2949e-04, 7.6294e-06, 1.4722e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([5.3704e-05, 1.6153e-05, 9.7871e-05, 7.5698e-06, 2.0623e-05, 5.1260e-06,
        9.7632e-05, 1.8597e-05, 4.1127e-05, 1.8668e-04, 2.2531e-05, 1.7524e-05,
        3.2961e-05, 3.8576e-04, 4.0531e-06, 4.0412e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.305581
summ of probs approach
id: [12337] -> tensor([[6.4373e-06, 4.9472e-06, 6.9857e-05, 8.2254e-06, 4.1127e-06, 5.0664e-06,
         4.9472e-06, 2.0266e-06, 3.9339e-06, 1.1325e-06, 6.9737e-06, 2.9802e-06,
         5.6267e-05, 8.7023e-06, 4.7684e-07, 1.6451e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2934e-05, 5.2512e-05, 3.2306e-05, 1.4722e-05, 1.2636e-05, 9.7752e-06,
        1.9431e-05, 1.0908e-05, 9.1195e-06, 5.4836e-06, 3.8147e-06, 1.6272e-05,
        8.2314e-05, 7.5817e-05, 1.0133e-05, 3.1173e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([2.1696e-05, 2.5392e-05, 1.3027e-03, 1.1265e-05, 6.0201e-06, 1.5914e-05,
        1.2338e-05, 3.0279e-05, 1.5378e-05, 1.3292e-05, 5.1498e-05, 6.9737e-06,
        1.7905e-04, 1.0657e-04, 3.8087e-05, 8.3089e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.371412
summ of probs approach
id: [12337] -> tensor([[7.9274e-06, 5.0068e-06, 2.0802e-05, 1.2577e-05, 1.5676e-05, 1.4305e-06,
         5.4240e-06, 9.4771e-06, 1.1325e-05, 4.4405e-05, 2.2531e-05, 1.1158e-04,
         1.7405e-05, 4.1723e-07, 3.8564e-05, 1.4901e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.9141e-06, 3.3379e-06, 4.3392e-05, 6.4969e-06, 5.9307e-05, 1.1623e-05,
        1.6093e-05, 2.0206e-05, 1.4424e-05, 3.7313e-05, 1.6153e-04, 1.4055e-04,
        1.1802e-05, 8.3447e-06, 4.5300e-05, 1.1683e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([1.8418e-05, 1.2875e-05, 1.5569e-04, 9.4175e-06, 9.3365e-04, 7.7486e-06,
        1.2279e-05, 3.7551e-05, 1.2159e-05, 2.1458e-05, 1.2839e-04, 1.7762e-04,
        2.5272e-05, 4.9472e-06, 6.9857e-05, 1.1623e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.300992
summ of probs approach
id: [12337] -> tensor([[1.4305e-06, 3.9339e-05, 5.0783e-05, 8.9407e-07, 1.5497e-06, 2.1458e-06,
         1.4949e-04, 6.7353e-06, 7.1526e-07, 7.8142e-05, 4.6551e-05, 1.2815e-05,
         1.3113e-06, 5.3167e-05, 1.7166e-04, 1.1092e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.8895e-05, 4.3511e-05, 2.7001e-05, 3.6359e-06, 9.2387e-06, 2.1398e-05,
        4.4107e-05, 1.1384e-05, 4.6492e-06, 9.1255e-05, 3.7074e-05, 4.7147e-05,
        2.7597e-05, 1.3161e-04, 1.5187e-04, 5.4836e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([3.1352e-05, 4.5717e-05, 2.5809e-05, 8.8811e-06, 1.2696e-05, 4.1366e-05,
        6.4552e-05, 3.0398e-05, 2.6822e-06, 2.1720e-04, 5.8234e-05, 2.0099e-04,
        1.1444e-05, 1.0824e-04, 1.5211e-04, 1.6403e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.476333
summ of probs approach
id: [12337] -> tensor([[5.3644e-05, 1.1921e-06, 3.7789e-05, 1.0610e-05, 7.4506e-06, 8.9407e-07,
         3.0398e-05, 1.8716e-05, 4.1723e-07, 1.0133e-05, 1.4067e-05, 1.3113e-06,
         4.8280e-06, 1.2994e-05, 1.0312e-05, 1.4901e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.4928e-05, 4.5896e-06, 4.5002e-05, 1.0133e-05, 2.5630e-06, 2.7418e-06,
        1.3471e-05, 7.1108e-05, 5.2452e-06, 6.3777e-06, 3.4571e-06, 2.9802e-06,
        3.0756e-05, 2.5868e-05, 3.2187e-06, 4.5896e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([1.2088e-04, 1.5736e-05, 2.0814e-04, 1.2279e-04, 9.1195e-06, 1.2815e-05,
        3.6657e-05, 2.6202e-04, 6.0201e-06, 2.4974e-05, 2.6524e-05, 3.6955e-06,
        9.0003e-06, 1.2141e-04, 1.4186e-05, 5.2452e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.351765
summ of probs approach
id: [12337] -> tensor([[1.0729e-06, 1.2040e-05, 5.3048e-06, 1.3769e-05, 3.1710e-05, 5.4240e-06,
         4.4703e-06, 3.1114e-05, 1.1444e-05, 2.6822e-06, 8.7023e-06, 3.5763e-07,
         1.9193e-05, 2.2829e-05, 1.4663e-05, 1.9789e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.8678e-06, 6.2585e-06, 4.4107e-06, 9.7752e-06, 5.0068e-05, 6.0797e-06,
        2.1458e-06, 1.7762e-05, 3.7849e-05, 2.8610e-05, 5.4836e-06, 3.9935e-06,
        1.9133e-05, 2.8849e-05, 5.8413e-06, 1.0371e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([2.5630e-06, 2.3901e-05, 1.7285e-05, 9.6202e-05, 1.4734e-04, 4.8697e-05,
        2.1160e-05, 6.3658e-05, 2.2769e-05, 1.5497e-05, 1.7285e-05, 1.1325e-05,
        1.0937e-04, 5.9605e-05, 8.8573e-05, 3.2783e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.299940
summ of probs approach
id: [12337] -> tensor([[9.1195e-06, 6.1393e-06, 2.3782e-05, 3.0637e-05, 3.9935e-06, 1.3709e-05,
         1.0729e-06, 3.2246e-05, 1.4079e-04, 3.0994e-06, 1.8477e-06, 2.3842e-07,
         4.5300e-05, 3.5763e-07, 8.7619e-06, 3.2783e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.2254e-06, 3.6955e-06, 5.0604e-05, 5.7817e-06, 7.2718e-06, 5.9605e-06,
        1.9312e-05, 1.4925e-04, 1.0163e-04, 2.0266e-06, 2.2113e-05, 7.7486e-07,
        3.0816e-05, 9.3579e-06, 4.4584e-05, 5.1856e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([1.6534e-04, 4.1723e-06, 2.5511e-05, 2.7478e-05, 9.4771e-06, 9.2983e-06,
        4.7326e-05, 3.3069e-04, 4.6492e-05, 1.8120e-05, 1.1146e-05, 4.8876e-06,
        7.5579e-05, 1.3828e-05, 1.8299e-04, 1.2994e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.320471
summ of probs approach
id: [12337] -> tensor([[4.5300e-06, 1.0073e-05, 1.2338e-05, 2.9564e-04, 2.9206e-06, 4.8876e-06,
         5.3883e-05, 6.6757e-06, 1.0252e-05, 2.3246e-06, 6.7353e-06, 1.9670e-06,
         1.1623e-05, 1.6689e-06, 1.0729e-06, 2.2221e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.8610e-05, 2.1696e-05, 1.0192e-05, 1.7881e-04, 1.1688e-04, 3.7193e-05,
        6.9141e-06, 2.6226e-06, 1.1754e-04, 1.3292e-05, 5.9009e-06, 3.5763e-06,
        1.5140e-05, 4.8280e-06, 9.7156e-06, 6.3539e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([1.6928e-04, 1.0967e-05, 8.7619e-06, 8.5771e-05, 2.9135e-04, 4.2498e-05,
        4.6015e-05, 3.3200e-05, 1.7190e-04, 2.9027e-05, 3.2783e-05, 7.9274e-06,
        1.1665e-04, 2.1458e-06, 8.4043e-06, 1.7166e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.389722
summ of probs approach
id: [12337] -> tensor([[9.6142e-05, 4.4048e-05, 1.6093e-06, 1.2517e-06, 2.5630e-06, 2.5034e-06,
         1.7226e-05, 3.9279e-05, 1.6093e-06, 2.3842e-07, 1.5497e-06, 2.9802e-07,
         1.5283e-04, 7.3314e-06, 3.7432e-05, 8.9407e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.5075e-05, 2.6047e-05, 1.5497e-06, 6.7949e-06, 5.7220e-06, 1.1683e-05,
        1.2398e-05, 3.1471e-05, 4.0531e-06, 4.7684e-06, 5.6028e-06, 3.2187e-06,
        3.6895e-05, 2.8014e-05, 2.3425e-05, 2.0921e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([3.6597e-05, 5.2631e-05, 8.2254e-06, 3.0994e-06, 5.4836e-06, 2.5332e-05,
        4.1008e-05, 1.7357e-04, 4.8280e-06, 1.1325e-06, 5.7220e-06, 1.9670e-06,
        7.1108e-05, 2.3484e-05, 2.9683e-04, 2.5570e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.415856
summ of probs approach
id: [12337] -> tensor([[1.0729e-06, 1.0848e-05, 4.7684e-07, 1.6510e-05, 8.9407e-07, 3.4571e-06,
         5.5432e-06, 1.7285e-06, 2.8014e-06, 7.2718e-06, 4.1723e-06, 1.7583e-05,
         2.8014e-06, 6.5565e-07, 9.5367e-06, 9.0599e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.7817e-06, 7.5698e-06, 4.0531e-06, 3.5763e-05, 8.8215e-06, 2.6226e-06,
        2.9206e-06, 1.2219e-05, 2.3842e-06, 2.5928e-05, 6.3717e-05, 4.6015e-05,
        2.5630e-06, 5.5432e-06, 2.9266e-05, 4.7445e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([8.1062e-06, 1.4603e-05, 2.8610e-06, 4.1187e-05, 1.3590e-05, 1.6451e-05,
        2.0266e-06, 3.0518e-05, 6.3181e-06, 4.3988e-05, 6.3956e-05, 3.8266e-05,
        4.6670e-05, 1.9670e-06, 8.0884e-05, 1.0413e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.699330
summ of probs approach
id: [12337] -> tensor([[2.3842e-06, 8.3447e-07, 2.3842e-07, 7.7486e-07, 1.9729e-05, 2.9802e-06]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([3.5167e-05, 4.7088e-06, 1.4901e-06, 4.8280e-06, 3.9041e-05, 4.1127e-06],
       device='cuda:0', dtype=torch.float16) torch.Size([6])
summ of probs approach
probs_ shape tensor([2.2709e-05, 1.3113e-06, 4.2319e-06, 1.1146e-05, 2.7657e-03, 5.3644e-06],
       device='cuda:0', dtype=torch.float16) torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.109680
acc:  0.37373737373737376
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:04.748961
path ['42', 'de', 'llama', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [432, 1], 'attention_mask': [1, 1]}
id:[432, 1]
answer  {'input_ids': [448, 348, 1], 'attention_mask': [1, 1, 1]}
id:[448, 348, 1]
answer  {'input_ids': [3393, 13584, 1], 'attention_mask': [1, 1, 1]}
id:[3393, 13584, 1]
load model Duration: 0:00:06.208938
prompt_type null has 1 prompts in it
----------- 42 de bigscience/mt0-small NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([5.3155e-03, 1.5566e-03, 4.1898e-03, 5.5307e-03, 1.8606e-05, 7.4133e-05,
        3.3942e-03, 1.7871e-03, 9.3968e-01, 1.5870e-03, 6.6330e-04, 1.5679e-03,
        3.5289e-03, 1.6306e-03, 9.8261e-04, 9.8492e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.3134e-03, 1.7880e-03, 4.2080e-03, 5.5232e-03, 1.8848e-05, 7.7663e-05,
        3.3634e-03, 5.7204e-03, 9.3968e-01, 1.6670e-03, 6.6524e-04, 1.6465e-03,
        3.6807e-03, 2.9435e-03, 9.8276e-04, 4.5480e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.3106e-03, 1.5390e-03, 4.1788e-03, 5.2648e-03, 1.8580e-05, 7.4071e-05,
        3.3486e-03, 1.1282e-03, 9.3968e-01, 1.4429e-03, 6.6257e-04, 1.5494e-03,
        3.1482e-03, 1.4119e-03, 9.8202e-04, 3.0487e-03], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.104063
summ of probs approach
probs_ shape tensor([1.5795e-03, 7.5116e-04, 4.6728e-04, 1.1913e-03, 4.7431e-03, 2.3888e-03,
        1.0780e-03, 1.8327e-03, 2.1031e-03, 1.7822e-03, 8.6692e-03, 6.9857e-04,
        8.9426e-01, 7.2883e-04, 2.8747e-03, 1.2116e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.8128e-03, 1.1341e-03, 4.7101e-04, 1.1893e-03, 5.5880e-03, 2.5450e-03,
        9.9747e-04, 2.6186e-03, 1.7507e-03, 4.4593e-03, 8.6857e-03, 7.0028e-04,
        8.9426e-01, 7.3883e-04, 2.9041e-03, 1.2130e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4916e-03, 6.9420e-04, 4.6651e-04, 1.1856e-03, 4.7086e-03, 2.3168e-03,
        8.0765e-04, 1.7296e-03, 1.6465e-03, 1.5367e-03, 8.6570e-03, 6.9507e-04,
        8.9426e-01, 5.2018e-04, 2.8631e-03, 1.1312e-04], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.080365
summ of probs approach
probs_ shape tensor([9.7119e-01, 2.6901e-04, 1.8746e-03, 1.1343e-03, 1.1684e-03, 1.6374e-03,
        1.1872e-03, 2.4553e-04, 1.1178e-03, 2.7149e-04, 9.9211e-04, 4.2786e-03,
        5.4845e-04, 1.2616e-03, 1.2591e-03, 7.9525e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.7119e-01, 5.0938e-05, 2.3333e-03, 1.2963e-03, 5.0207e-03, 4.0624e-03,
        1.9996e-03, 3.3313e-04, 1.6366e-03, 6.1764e-04, 1.0476e-03, 2.2026e-03,
        6.5914e-04, 1.9044e-03, 1.2575e-03, 7.2140e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.7118e-01, 4.4979e-05, 1.6526e-03, 9.2873e-04, 1.1059e-03, 6.6733e-04,
        9.3744e-04, 2.3617e-04, 9.1082e-04, 2.6969e-04, 9.6213e-04, 6.8259e-04,
        4.2772e-04, 1.0385e-03, 1.2537e-03, 5.1599e-04], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.121579
summ of probs approach
probs_ shape tensor([2.2645e-03, 1.3856e-03, 3.6434e-03, 1.3106e-03, 8.0065e-04, 1.1042e-03,
        2.2068e-03, 1.6693e-03, 7.7103e-04, 3.1711e-03, 2.1944e-03, 8.7333e-03,
        1.6494e-04, 1.2312e-03, 5.7707e-04, 9.3877e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.2011e-03, 1.1050e-03, 1.4672e-03, 1.2242e-03, 8.2879e-04, 1.0059e-03,
        2.7714e-03, 1.8766e-03, 7.5471e-04, 3.3169e-03, 2.4147e-03, 8.9459e-03,
        2.0735e-04, 1.5531e-03, 1.2633e-03, 9.3877e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.1096e-03, 9.0333e-04, 1.2578e-03, 1.1822e-03, 7.9321e-04, 7.4180e-04,
        2.1937e-03, 1.4589e-03, 6.5553e-04, 3.1446e-03, 2.1317e-03, 8.6242e-03,
        1.3822e-04, 1.0300e-03, 5.3008e-04, 9.3877e-01], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.075574
summ of probs approach
probs_ shape tensor([6.0681e-04, 2.1660e-04, 1.4629e-03, 7.5507e-04, 5.5009e-03, 9.9135e-01,
        1.0600e-03, 6.7909e-03, 7.8859e-04, 9.3076e-01, 4.3760e-04, 1.0661e-03,
        2.0736e-03, 1.4893e-03, 1.1256e-03, 2.7559e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.0883e-04, 2.2824e-04, 1.4988e-03, 8.9527e-04, 9.9039e-03, 9.9135e-01,
        1.0048e-03, 1.0557e-03, 7.1620e-04, 9.3077e-01, 3.1489e-04, 2.1268e-03,
        2.1887e-03, 5.4553e-03, 1.3479e-03, 3.3082e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.0169e-04, 2.1643e-04, 1.4478e-03, 5.6067e-04, 4.9817e-03, 9.9135e-01,
        9.8683e-04, 2.6119e-04, 6.9193e-04, 9.3076e-01, 2.9164e-04, 6.1925e-04,
        1.7191e-03, 8.1932e-04, 1.0080e-03, 2.5819e-03], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.066144
summ of probs approach
probs_ shape tensor([9.8414e-01, 2.5520e-04, 1.0077e-03, 1.1867e-03, 2.2272e-03, 3.1286e-03,
        2.6133e-04, 3.0262e-04, 1.0434e-03, 1.4762e-04, 1.2792e-03, 4.9518e-03,
        1.7851e-03, 9.7851e-03, 8.5904e-04, 7.0963e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.8414e-01, 2.8311e-04, 1.0104e-03, 1.2548e-03, 2.2265e-03, 3.4243e-03,
        3.4987e-04, 3.4699e-04, 1.1432e-03, 1.6366e-04, 2.0350e-03, 4.9501e-03,
        1.8088e-03, 9.7982e-03, 3.6250e-03, 7.8923e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.8414e-01, 2.3765e-04, 9.8851e-04, 1.1538e-03, 2.2142e-03, 2.9083e-03,
        2.4903e-04, 2.8654e-04, 9.5280e-04, 1.4274e-04, 7.9827e-04, 4.9429e-03,
        1.7377e-03, 9.7832e-03, 7.1191e-04, 7.0063e-03], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.082572
summ of probs approach
probs_ shape tensor([2.9874e-03, 9.7324e-01, 7.2866e-05, 2.4060e-02, 8.7101e-04, 1.0014e-03,
        1.1806e-03, 4.1734e-03, 2.8345e-03, 2.8470e-03, 1.2052e-03, 3.6830e-03,
        1.9283e-03, 7.5203e-04, 3.3079e-04, 9.8975e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.8891e-03, 9.7324e-01, 7.2083e-05, 2.4641e-02, 1.6514e-02, 1.5335e-03,
        1.1592e-03, 4.4105e-03, 4.2412e-03, 2.8524e-03, 2.5511e-03, 3.6931e-03,
        3.2435e-03, 1.0972e-03, 3.3258e-04, 9.9562e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.7255e-03, 9.7324e-01, 6.9877e-05, 2.3960e-02, 7.8342e-04, 8.9323e-04,
        1.1452e-03, 4.0961e-03, 2.7289e-03, 2.8431e-03, 1.1329e-03, 3.6792e-03,
        1.2849e-03, 7.2630e-04, 3.2198e-04, 7.9521e-05], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.074326
summ of probs approach
probs_ shape tensor([6.6222e-04, 2.3794e-03, 1.3926e-03, 1.9180e-03, 9.7050e-01, 1.2082e-03,
        2.8331e-03, 7.4656e-04, 6.4176e-03, 1.0705e-03, 6.9876e-04, 2.4639e-03,
        1.1279e-03, 6.3513e-04, 3.1073e-04, 2.1358e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.7563e-04, 2.6282e-03, 1.6243e-03, 1.9796e-03, 9.7050e-01, 1.5284e-03,
        4.2812e-03, 1.7777e-03, 6.4995e-03, 1.0778e-03, 2.8654e-04, 5.3660e-03,
        1.3178e-03, 6.0944e-04, 3.8806e-04, 2.3217e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.6101e-04, 1.7193e-03, 1.2858e-03, 1.8908e-03, 9.7050e-01, 1.1731e-03,
        2.1602e-03, 5.8091e-04, 6.3797e-03, 1.0612e-03, 1.4814e-04, 2.4336e-03,
        1.1261e-03, 5.7842e-04, 3.4634e-04, 1.8953e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.078859
summ of probs approach
probs_ shape tensor([1.1037e-03, 1.8090e-03, 3.5315e-04, 2.6385e-03, 1.1088e-03, 1.2289e-03,
        2.1679e-03, 2.5528e-03, 1.2577e-03, 5.8115e-04, 9.8159e-01, 5.1303e-04,
        1.0976e-03, 1.6695e-03, 7.3900e-04, 1.6717e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.3079e-03, 8.8590e-04, 3.5842e-04, 2.8477e-03, 4.9275e-03, 3.3553e-03,
        8.0510e-03, 2.0944e-03, 1.5053e-03, 5.8291e-04, 9.8159e-01, 1.1914e-03,
        6.4246e-03, 2.4308e-03, 7.6047e-04, 1.6736e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0548e-03, 5.9769e-04, 1.3934e-04, 2.6296e-03, 1.0099e-03, 9.8189e-04,
        5.9264e-04, 1.2242e-03, 1.1918e-03, 5.7780e-04, 9.8159e-01, 4.8522e-04,
        7.0130e-04, 6.8591e-04, 7.1302e-04, 1.6492e-03], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.143553
summ of probs approach
probs_ shape tensor([8.5016e-04, 1.9333e-03, 9.8264e-01, 2.6612e-04, 5.2940e-04, 1.3846e-03,
        9.9286e-05, 2.7613e-03, 1.9513e-03, 4.7692e-03, 6.9492e-03, 2.7099e-03,
        9.5302e-04, 2.4402e-04, 2.3003e-03, 2.1939e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.8086e-03, 1.6019e-03, 9.8264e-01, 3.3609e-04, 9.1630e-04, 1.3137e-03,
        1.0142e-04, 2.9077e-03, 7.0218e-03, 4.8393e-03, 7.0743e-03, 4.6005e-03,
        8.9722e-04, 2.5166e-04, 3.3390e-03, 2.0766e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.9390e-04, 7.5580e-04, 9.8264e-01, 1.6964e-04, 4.8857e-04, 1.1590e-03,
        9.9048e-05, 2.6331e-03, 3.8223e-04, 4.7498e-03, 6.8769e-03, 2.2705e-03,
        8.4167e-04, 2.4325e-04, 1.0958e-03, 1.9689e-05], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.078550
summ of probs approach
probs_ shape tensor([1.4951e-03, 7.0284e-04, 6.7698e-04, 1.1910e-03, 9.8717e-04, 1.2983e-03,
        2.2291e-03, 1.6584e-05, 1.3425e-03, 2.1656e-03, 9.1185e-03, 2.2877e-03,
        9.0216e-01, 1.2195e-03, 1.3556e-03, 6.5467e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4265e-03, 8.1587e-04, 2.6909e-02, 5.6168e-03, 1.7356e-03, 1.2695e-03,
        2.0614e-03, 1.5840e-05, 2.1609e-03, 4.0785e-03, 9.1414e-03, 5.5539e-03,
        9.0216e-01, 1.6508e-03, 1.4163e-03, 1.1076e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.2973e-03, 3.8351e-04, 3.4096e-04, 7.9640e-04, 9.4586e-04, 1.2593e-03,
        1.5921e-03, 1.2771e-05, 1.0353e-03, 2.1464e-03, 9.1075e-03, 2.2508e-03,
        9.0216e-01, 1.2014e-03, 1.3100e-03, 6.3816e-04], device='cuda:0') torch.Size([16])
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/fr/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
 Batch: 10 of null classification Duration: 0:00:00.090936
summ of probs approach
probs_ shape tensor([2.9573e-03, 4.4886e-03, 2.2944e-03, 2.3372e-03, 9.8939e-01, 5.4364e-04,
        7.5151e-04, 5.7129e-04, 9.3644e-01, 7.7102e-04, 6.0236e-04, 3.2942e-03,
        2.0912e-03, 1.5688e-03, 3.3377e-04, 1.2127e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.9574e-03, 4.5057e-03, 2.2888e-03, 2.4088e-03, 9.8939e-01, 6.0249e-04,
        1.0112e-03, 6.3876e-04, 9.3644e-01, 7.0008e-04, 7.0049e-04, 3.4474e-03,
        3.7218e-03, 3.2157e-03, 3.7546e-04, 4.7437e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.5389e-03, 4.4765e-03, 2.0687e-03, 2.2781e-03, 9.8939e-01, 5.0638e-04,
        6.0258e-04, 4.8293e-04, 9.3644e-01, 6.5623e-04, 3.8073e-04, 3.2624e-03,
        1.8049e-03, 4.8557e-04, 3.1460e-04, 7.5708e-04], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.091541
summ of probs approach
probs_ shape tensor([1.2961e-03, 3.8333e-03, 9.3230e-01, 1.8434e-03, 6.2185e-04, 1.1634e-03],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([1.5328e-03, 3.8675e-03, 9.3230e-01, 1.7237e-03, 7.0338e-04, 1.8897e-03],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([1.2614e-03, 3.8066e-03, 9.3230e-01, 1.6298e-03, 6.1214e-04, 1.1024e-03],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.053210
acc:  0.3686868686868687
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.184022
path ['42', 'de', 't0', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v56.pickle' as a pickle file.

Using MARC dataset for fr
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  3.35it/s]100%|██████████| 3/3 [00:00<00:00,  8.77it/s]
loading model Duration: 0:00:01.450382
Average length of review_body for rows with 1 star: 155.920675
Average length of review_body for rows with 5 star: 144.119575
len of lowest cat:  39333
len of pos_reviews, neg_reviews:  39333 39333
len dataset  78666
len dataset  200
create dataloader Duration: 0:03:11.885806
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [92000], 'attention_mask': [1]}
id:[92000]
answer  {'input_ids': [25490], 'attention_mask': [1]}
id:[25490]
load model Duration: 0:00:09.573155
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/bloom-560m SA null 0 200 16 --------------
summ of probs approach
id: [92000] -> tensor([[5.7798e-08, 7.1495e-07, 3.6241e-04, 1.3140e-07, 7.6294e-06, 5.8517e-06,
         3.9550e-07, 3.1229e-06, 2.0764e-06, 2.2419e-07, 2.6583e-09, 1.1903e-07,
         1.5432e-09, 1.4216e-05, 2.8356e-09, 2.3955e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.0049e-06, 6.5581e-07, 1.7760e-03, 1.0448e-07, 1.5190e-05, 9.7104e-05,
         7.5025e-07, 5.0714e-06, 3.9831e-06, 6.7401e-07, 8.0442e-08, 3.2321e-06,
         2.0378e-08, 1.3040e-05, 3.1307e-08, 1.7522e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.184476
summ of probs approach
id: [92000] -> tensor([[2.4804e-07, 9.5006e-08, 2.0981e-07, 3.4036e-07, 1.4871e-07, 2.3945e-07,
         1.3505e-06, 5.5585e-06, 1.6178e-07, 1.7538e-08, 2.5834e-06, 2.4616e-07,
         6.1134e-07, 3.5477e-07, 3.6431e-09, 1.5214e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.7337e-07, 1.5268e-06, 4.8822e-07, 1.4665e-06, 8.3482e-07, 1.3681e-06,
         6.6681e-06, 7.3109e-05, 6.6024e-07, 7.7904e-08, 4.0821e-06, 4.2059e-07,
         8.8096e-07, 1.4872e-07, 4.1377e-09, 7.1798e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.129626
summ of probs approach
id: [92000] -> tensor([[2.2347e-07, 1.0380e-07, 2.1214e-06, 1.4941e-06, 1.9918e-08, 8.6178e-09,
         1.3254e-09, 7.0208e-08, 2.6187e-06, 7.0490e-07, 3.2406e-07, 1.7855e-06,
         5.0946e-08, 4.1342e-07, 1.5905e-06, 1.8016e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[6.0057e-07, 2.3143e-07, 4.7482e-06, 4.3859e-07, 1.0308e-06, 1.2760e-08,
         5.9149e-08, 1.6422e-07, 7.4316e-07, 5.8146e-07, 9.7002e-07, 3.2529e-06,
         1.3505e-07, 4.3645e-06, 6.9227e-06, 5.5636e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.156708
summ of probs approach
id: [92000] -> tensor([[6.0982e-08, 2.4262e-07, 3.0267e-07, 8.2755e-06, 3.5486e-07, 1.9750e-09,
         7.0592e-05, 2.3212e-08, 8.1826e-08, 2.6033e-06, 1.5269e-06, 2.9825e-10,
         1.0953e-06, 5.7815e-08, 4.2328e-09, 1.5667e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[9.1038e-07, 1.2720e-06, 3.5995e-07, 1.1651e-05, 2.9792e-07, 9.5412e-08,
         1.5432e-04, 9.2789e-09, 1.9935e-06, 2.1495e-05, 2.5430e-06, 4.2092e-08,
         2.3888e-06, 4.0781e-07, 9.2692e-09, 3.7722e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.132546
summ of probs approach
id: [92000] -> tensor([[1.7894e-08, 6.9051e-08, 8.2206e-12, 9.6322e-07, 4.5618e-06, 1.1070e-04,
         4.4334e-05, 1.8606e-07, 1.0542e-06, 1.5204e-07, 9.6324e-07, 1.2737e-06,
         5.8775e-05, 4.3782e-08, 6.8764e-09, 9.6442e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.5353e-07, 2.0528e-07, 8.2863e-12, 2.6562e-06, 8.1279e-06, 6.9116e-05,
         3.8146e-05, 9.1187e-07, 5.9001e-07, 8.7751e-07, 1.8354e-06, 4.2863e-06,
         1.5511e-04, 3.1855e-07, 7.3171e-08, 1.5245e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.091150
summ of probs approach
id: [92000] -> tensor([[1.4548e-04, 4.7933e-07, 3.2829e-06, 9.2379e-07, 8.5857e-07, 4.9406e-06,
         3.9642e-07, 8.7283e-06, 3.0898e-08, 1.2779e-07, 6.3716e-07, 8.4450e-05,
         1.1082e-05, 5.3175e-07, 2.5732e-08, 4.3879e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.0754e-04, 3.3469e-06, 2.7061e-05, 3.3986e-06, 1.3055e-06, 1.1058e-05,
         5.2899e-06, 6.1241e-06, 6.0570e-08, 9.7962e-07, 1.5579e-06, 1.7572e-04,
         2.0228e-04, 4.7962e-07, 1.8961e-07, 2.1053e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.130266
summ of probs approach
id: [92000] -> tensor([[2.7450e-09, 1.1737e-06, 4.7944e-06, 1.1114e-06, 4.6497e-07, 1.8512e-06,
         4.4373e-09, 5.3215e-07, 6.4652e-07, 9.9451e-07, 1.4729e-07, 1.5087e-06,
         2.2747e-07, 3.5081e-07, 2.3493e-07, 1.3926e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.0857e-07, 1.1018e-06, 8.1767e-06, 2.2755e-06, 4.6227e-07, 5.7492e-06,
         1.6396e-07, 2.4271e-06, 4.1526e-06, 1.0144e-05, 2.9390e-07, 1.8457e-06,
         3.0345e-06, 4.6543e-06, 5.4832e-06, 4.7737e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.150601
summ of probs approach
id: [92000] -> tensor([[5.3166e-06, 3.3550e-09, 2.8998e-08, 7.7161e-10, 1.0474e-08, 6.3940e-09,
         3.6926e-07, 3.8022e-08, 1.4887e-05, 8.9106e-09, 3.5960e-07, 4.2976e-06,
         5.4377e-08, 1.7336e-08, 1.9052e-08, 1.0950e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.3523e-06, 4.5925e-08, 9.5050e-08, 4.0942e-08, 4.5571e-07, 4.4957e-08,
         2.0153e-06, 1.6702e-06, 8.7921e-06, 9.6830e-08, 4.5415e-07, 7.2452e-06,
         3.9687e-07, 1.0733e-07, 3.8410e-07, 4.9906e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.101168
summ of probs approach
id: [92000] -> tensor([[4.1220e-09, 1.3561e-07, 6.8394e-10, 3.0358e-08, 1.4102e-06, 2.0081e-07,
         1.8575e-06, 5.3045e-07, 3.2570e-07, 8.8430e-09, 3.0623e-08, 1.7008e-07,
         9.0053e-07, 4.6131e-07, 1.1068e-08, 4.7332e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.2942e-07, 6.6269e-07, 4.7804e-08, 3.1181e-08, 3.0148e-06, 4.5064e-07,
         1.2038e-06, 1.5993e-06, 1.1288e-06, 1.9319e-08, 1.6671e-07, 2.9426e-07,
         2.1887e-06, 8.4606e-07, 1.6816e-08, 1.5553e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.217276
summ of probs approach
id: [92000] -> tensor([[2.3226e-05, 1.3022e-08, 3.5853e-09, 9.9040e-10, 6.6088e-07, 1.9752e-09,
         6.7626e-07, 1.0203e-07, 1.7103e-07, 1.4687e-05, 9.0741e-09, 3.0215e-08,
         1.9851e-07, 1.5706e-08, 4.3685e-06, 1.8218e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[7.5267e-05, 5.5976e-08, 5.0484e-08, 4.3997e-08, 1.9982e-06, 1.0558e-07,
         1.5675e-06, 3.6570e-07, 8.9568e-07, 1.7202e-04, 2.1388e-08, 3.6422e-08,
         5.7677e-06, 7.0457e-08, 3.3199e-06, 2.2670e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.193835
summ of probs approach
id: [92000] -> tensor([[1.0410e-08, 4.3374e-07, 2.0626e-07, 1.9524e-08, 1.1879e-06, 1.6886e-09,
         8.0718e-09, 2.5141e-06, 1.3490e-08, 3.7007e-07, 3.2648e-08, 7.0876e-07,
         2.9075e-07, 5.7026e-07, 3.8066e-07, 1.3518e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.9607e-08, 2.1206e-06, 2.0216e-07, 2.0706e-07, 1.1794e-06, 5.6053e-08,
         2.6127e-08, 1.1869e-05, 2.7156e-07, 2.1448e-06, 4.2040e-07, 5.8511e-06,
         5.3816e-07, 2.4470e-06, 1.3920e-06, 4.4805e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.161248
summ of probs approach
id: [92000] -> tensor([[8.3151e-06, 1.0551e-08, 6.1026e-05, 5.9257e-09, 6.6279e-08, 4.4320e-06,
         6.5217e-06, 1.5817e-06, 1.8623e-08, 2.8209e-08, 2.9397e-07, 3.0435e-07,
         1.3579e-08, 3.6970e-08, 1.9144e-07, 4.7866e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.5088e-06, 8.3303e-08, 3.1890e-04, 1.2897e-08, 1.1254e-07, 3.1713e-05,
         4.9430e-06, 2.4102e-06, 1.3402e-08, 6.6960e-08, 3.0271e-06, 2.9737e-06,
         1.0708e-07, 3.6060e-07, 2.1967e-07, 6.2319e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.131052
summ of probs approach
id: [92000] -> tensor([[2.0573e-07, 1.6201e-07, 1.3327e-05, 2.6648e-08, 5.3353e-07, 6.3635e-07,
         3.2367e-09, 1.2015e-06]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [25490] -> tensor([[5.1788e-07, 1.3627e-06, 6.5670e-07, 4.0411e-08, 1.0907e-06, 2.2297e-06,
         2.3167e-09, 8.5333e-07]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.091872
acc:  0.54
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.893220
path ['42', 'fr', 'bloom', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [92000], 'attention_mask': [1]}
id:[92000]
answer  {'input_ids': [25490], 'attention_mask': [1]}
id:[25490]
load model Duration: 0:00:09.367619
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/bloomz-560m SA null 0 200 16 --------------
summ of probs approach
id: [92000] -> tensor([[1.1728e-10, 1.3560e-09, 9.4531e-09, 1.8143e-06, 7.6154e-07, 5.6922e-07,
         1.7728e-06, 5.1206e-09, 8.0666e-07, 1.2133e-09, 2.6978e-08, 5.1449e-09,
         9.2750e-08, 3.0300e-06, 1.9250e-07, 2.0558e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.3536e-09, 3.7032e-08, 5.0182e-08, 3.3957e-06, 4.2666e-07, 5.8519e-07,
         2.6664e-06, 1.3253e-08, 1.6920e-06, 1.6107e-07, 3.2446e-08, 2.6121e-08,
         6.0247e-08, 5.6987e-07, 9.4137e-07, 2.6815e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.198080
summ of probs approach
id: [92000] -> tensor([[8.6611e-08, 3.4924e-07, 3.8014e-06, 6.3114e-08, 3.0217e-09, 6.0226e-09,
         2.8965e-09, 8.5435e-09, 6.1334e-09, 7.7367e-09, 1.7729e-08, 5.8578e-06,
         2.2622e-08, 8.1570e-08, 3.7184e-08, 1.3733e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.2199e-07, 8.0776e-07, 4.9428e-06, 3.7443e-07, 3.0801e-09, 3.2232e-08,
         5.9969e-09, 9.7731e-08, 1.2191e-08, 1.1993e-06, 2.2551e-07, 5.1161e-06,
         7.5171e-08, 2.3490e-07, 3.1888e-07, 3.4592e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.105656
summ of probs approach
id: [92000] -> tensor([[3.7209e-07, 1.3389e-09, 2.4896e-08, 1.2705e-07, 2.6381e-07, 9.5761e-09,
         1.3663e-06, 9.8864e-08, 6.2311e-08, 3.4946e-10, 2.9681e-08, 5.2082e-09,
         2.5296e-07, 1.3302e-06, 2.6549e-07, 1.1443e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.4186e-07, 1.1296e-07, 1.4807e-08, 3.1887e-07, 6.7930e-08, 2.4135e-08,
         1.6624e-05, 1.3172e-08, 6.6408e-07, 3.1147e-08, 4.3284e-08, 2.0584e-08,
         2.1431e-06, 2.7209e-05, 2.3000e-07, 4.3780e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.215821
summ of probs approach
id: [92000] -> tensor([[1.8536e-11, 1.9199e-08, 8.2858e-09, 4.3794e-07, 1.8913e-07, 1.1741e-08,
         1.4240e-06, 1.7848e-08, 3.7433e-08, 7.0784e-09, 1.4834e-06, 3.9009e-07,
         2.5929e-07, 3.5347e-08, 7.3731e-06, 1.2629e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.3479e-08, 1.3960e-07, 2.5139e-08, 6.2050e-07, 6.9862e-07, 4.8913e-07,
         2.0489e-06, 1.8276e-09, 1.2287e-07, 6.6110e-08, 7.5151e-06, 3.9523e-06,
         1.4788e-07, 3.8732e-08, 5.7067e-07, 9.5320e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.154713
summ of probs approach
id: [92000] -> tensor([[2.2542e-10, 3.1100e-08, 3.2170e-08, 7.3456e-10, 4.2269e-08, 3.3158e-09,
         1.1544e-08, 1.6554e-06, 3.5581e-06, 1.0829e-07, 6.6472e-11, 1.3380e-06,
         6.6653e-06, 3.9576e-06, 2.0615e-07, 5.9011e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[6.1115e-09, 4.6010e-08, 1.0923e-07, 1.3937e-07, 6.8992e-08, 4.5861e-10,
         6.6895e-07, 3.3722e-06, 2.1165e-06, 6.6400e-07, 5.4046e-08, 1.4938e-06,
         4.3585e-06, 1.0405e-05, 2.2337e-07, 3.5788e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.191199
summ of probs approach
id: [92000] -> tensor([[4.3913e-05, 5.3294e-08, 1.0111e-06, 1.9210e-10, 6.4588e-11, 1.5280e-09,
         8.8087e-08, 1.9327e-06, 2.0479e-07, 2.2668e-07, 4.0468e-08, 2.4212e-09,
         2.2262e-08, 2.5786e-08, 3.4160e-07, 1.2144e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.9002e-05, 6.3838e-08, 1.3838e-06, 4.4233e-08, 2.5853e-11, 2.1446e-07,
         4.0341e-07, 1.0499e-06, 7.8051e-06, 1.1990e-07, 1.3205e-08, 4.2819e-09,
         8.1652e-08, 1.2336e-06, 1.3787e-06, 1.3734e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.150986
summ of probs approach
id: [92000] -> tensor([[1.5271e-09, 2.9593e-08, 1.2608e-05, 2.1166e-08, 2.8184e-07, 9.7248e-09,
         8.5009e-08, 1.9759e-10, 1.5962e-08, 8.4662e-07, 4.4068e-08, 4.7289e-06,
         2.5676e-08, 1.1053e-07, 1.6814e-06, 2.8488e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.5815e-07, 3.1856e-09, 3.8070e-07, 6.7586e-08, 4.5518e-07, 3.5363e-07,
         8.8768e-07, 5.0815e-08, 3.5667e-08, 1.4965e-05, 2.8583e-07, 5.4140e-07,
         3.5845e-07, 8.8840e-07, 3.9081e-06, 9.8410e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.191746
summ of probs approach
id: [92000] -> tensor([[1.5407e-08, 2.5259e-09, 3.5498e-09, 9.5349e-08, 8.1094e-07, 2.5865e-05,
         2.3865e-08, 6.9687e-09, 7.6783e-07, 6.9135e-07, 9.3301e-07, 8.0055e-11,
         6.0672e-07, 1.9404e-07, 8.5715e-08, 4.8964e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.9936e-08, 2.3485e-08, 7.2209e-10, 3.5553e-07, 1.1491e-06, 5.7422e-05,
         8.7843e-08, 1.4293e-08, 1.0247e-06, 1.8210e-06, 4.5440e-07, 5.0984e-08,
         4.2743e-06, 6.8267e-07, 1.3027e-07, 1.0597e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.153687
summ of probs approach
id: [92000] -> tensor([[4.3491e-07, 5.1487e-05, 1.7168e-07, 1.2011e-08, 5.1100e-08, 7.4705e-08,
         7.1166e-11, 2.4333e-06, 1.2720e-07, 2.7561e-09, 3.0041e-05, 6.6447e-05,
         1.0114e-08, 2.4810e-08, 3.8793e-08, 2.2104e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.5267e-07, 1.0349e-04, 2.0817e-06, 1.1446e-07, 4.7936e-07, 5.5506e-07,
         2.3980e-09, 1.2320e-06, 1.7863e-07, 2.2839e-09, 1.5469e-05, 3.5603e-04,
         7.6365e-08, 1.2639e-08, 2.3521e-08, 8.3497e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.134267
summ of probs approach
id: [92000] -> tensor([[3.9868e-07, 5.6165e-06, 2.9310e-07, 3.5064e-07, 9.7275e-09, 5.7533e-08,
         1.2935e-08, 1.4058e-08, 8.5332e-06, 1.1054e-06, 1.5310e-08, 3.3816e-10,
         5.0895e-07, 1.0871e-08, 6.5445e-09, 6.9766e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.4194e-07, 1.2310e-06, 9.0321e-06, 1.7086e-05, 4.1238e-07, 3.6879e-07,
         3.2834e-08, 2.3854e-08, 1.5552e-05, 3.6432e-06, 2.8089e-08, 8.3477e-09,
         1.2621e-06, 5.1516e-08, 2.0800e-08, 1.1438e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.130695
summ of probs approach
id: [92000] -> tensor([[4.5199e-08, 4.0833e-07, 1.9780e-06, 5.6908e-08, 7.0464e-09, 2.8721e-06,
         4.7897e-07, 4.2759e-08, 2.2325e-07, 3.7640e-07, 2.9249e-08, 1.2156e-07,
         1.6404e-07, 2.2311e-06, 6.3972e-08, 3.3106e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.4299e-07, 7.0194e-08, 1.6676e-06, 1.9595e-06, 5.1391e-08, 5.2691e-07,
         1.0771e-06, 1.3437e-06, 1.6207e-06, 4.3911e-07, 4.6552e-07, 1.1556e-07,
         4.3990e-07, 6.2429e-06, 1.7671e-06, 2.8504e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.165540
summ of probs approach
id: [92000] -> tensor([[1.7456e-05, 3.4242e-09, 3.1143e-07, 8.3518e-10, 2.8878e-09, 8.5026e-06,
         8.6799e-07, 6.3582e-07, 1.4573e-08, 2.0277e-08, 4.4167e-08, 3.6986e-08,
         3.4566e-07, 4.5317e-07, 7.3024e-05, 5.2190e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[6.5926e-06, 1.7405e-08, 3.0070e-07, 2.5862e-09, 5.5127e-08, 6.7674e-05,
         1.5481e-06, 3.7227e-06, 1.3862e-06, 6.4317e-08, 1.1604e-07, 5.3661e-08,
         4.3056e-07, 4.2373e-07, 2.1285e-04, 3.7615e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.109979
summ of probs approach
id: [92000] -> tensor([[1.4673e-08, 1.7498e-08, 4.6451e-07, 4.4961e-07, 4.0969e-07, 2.6468e-05,
         1.7073e-07, 4.7896e-07]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [25490] -> tensor([[1.9158e-06, 4.3089e-07, 7.0198e-08, 2.8430e-07, 3.5439e-06, 1.1301e-04,
         7.1309e-08, 1.0508e-05]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.074431
acc:  0.625
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:02.001442
path ['42', 'fr', 'bloomz', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [407, 23, 1], 'attention_mask': [1, 1, 1]}
id:[407, 23, 1]
answer  {'input_ids': [529, 1], 'attention_mask': [1, 1]}
id: [529, 1] -> [529]
load model Duration: 0:00:02.819612
prompt_type null has 1 prompts in it
----------- 42 fr google/flan-t5-base SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([2.9388e-03, 8.8033e-04, 2.0425e-03, 4.2958e-03, 2.2507e-03, 4.5347e-04,
        1.3906e-03, 9.8102e-01, 1.8126e-03, 2.2192e-03, 1.5090e-03, 5.3450e-04,
        1.6422e-03, 3.1680e-03, 2.4335e-03, 1.3617e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.0766e-03, 1.9755e-03, 5.6876e-04, 2.2692e-04, 4.9453e-03, 2.1246e-05,
         2.4505e-04, 9.8968e-07, 3.1493e-04, 1.5699e-04, 4.4481e-05, 2.2127e-04,
         2.0203e-05, 7.8544e-04, 6.8380e-04, 6.9200e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.167451
summ of probs approach
probs_ shape tensor([9.8244e-01, 3.9277e-03, 1.8757e-03, 2.5873e-03, 8.0476e-03, 3.3297e-03,
        1.5881e-03, 1.0650e-03, 1.9625e-03, 1.6765e-03, 7.6267e-04, 1.5804e-03,
        6.1295e-04, 1.7330e-03, 1.6038e-03, 1.6634e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.3673e-06, 8.0893e-04, 3.1618e-05, 1.3656e-06, 1.2588e-03, 1.2473e-03,
         2.4967e-05, 4.3826e-05, 6.3320e-06, 6.8823e-05, 1.8455e-05, 1.4993e-05,
         7.3080e-05, 1.4390e-03, 3.8059e-05, 4.1627e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.122448
summ of probs approach
probs_ shape tensor([2.1629e-03, 8.5064e-04, 1.8223e-03, 5.8478e-04, 1.2809e-03, 2.6208e-03,
        9.8696e-01, 5.9548e-04, 5.1988e-04, 1.8519e-03, 3.8267e-04, 8.9244e-04,
        1.9660e-03, 5.8170e-04, 1.4901e-03, 2.0037e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[2.4451e-05, 6.5630e-05, 8.2607e-05, 5.1835e-05, 1.4790e-04, 4.0396e-04,
         5.5997e-07, 8.5081e-06, 1.7033e-05, 1.8288e-05, 2.8456e-05, 3.3380e-04,
         6.2714e-04, 6.5594e-05, 1.9077e-05, 2.5982e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.143031
summ of probs approach
probs_ shape tensor([3.0401e-03, 8.4721e-03, 1.8743e-03, 3.5630e-03, 1.3582e-03, 1.2595e-03,
        8.8888e-04, 1.6527e-03, 2.5856e-03, 1.0182e-03, 6.1249e-03, 1.1701e-03,
        1.3219e-03, 1.2312e-03, 4.2332e-03, 9.1792e-01], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[5.4678e-05, 5.0184e-05, 5.2345e-05, 4.8078e-05, 5.3624e-06, 1.4111e-03,
         7.0063e-06, 7.3712e-06, 3.6509e-04, 8.4668e-05, 6.9566e-05, 1.2263e-04,
         3.7698e-06, 5.3049e-04, 6.5311e-05, 8.3162e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.104312
summ of probs approach
probs_ shape tensor([5.2506e-04, 3.5610e-03, 6.4897e-04, 2.0706e-04, 1.2703e-03, 1.6925e-03,
        1.8785e-03, 5.1047e-03, 2.3648e-03, 6.8709e-04, 2.3375e-03, 9.8354e-01,
        1.8680e-03, 8.3691e-04, 5.1332e-03, 4.4431e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.0909e-06, 1.2476e-04, 4.6017e-05, 2.5413e-05, 6.1243e-05, 1.3232e-03,
         2.7872e-04, 2.9992e-05, 3.9172e-04, 2.9093e-05, 1.2381e-03, 2.4136e-06,
         3.6854e-05, 8.9064e-06, 5.4376e-04, 2.3980e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.148547
summ of probs approach
probs_ shape tensor([0.0012, 0.0015, 0.0015, 0.0013, 0.0027, 0.0032, 0.0014, 0.0013, 0.0021,
        0.0011, 0.0020, 0.0012, 0.0011, 0.0021, 0.0019, 0.9951],
       device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.0778e-04, 1.5940e-06, 3.1706e-05, 8.4575e-05, 1.0382e-04, 7.8076e-04,
         1.3488e-05, 1.7212e-05, 5.9446e-04, 6.8504e-05, 4.8008e-05, 7.3846e-05,
         7.4490e-05, 3.2117e-05, 3.3314e-04, 5.7796e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.098863
summ of probs approach
probs_ shape tensor([2.9174e-03, 1.6011e-03, 7.0253e-04, 3.7408e-04, 1.2184e-03, 5.3011e-03,
        9.0422e-04, 1.4553e-03, 5.4361e-03, 8.8346e-04, 9.2920e-04, 2.4996e-03,
        8.2092e-04, 1.4081e-03, 5.7338e-01, 1.7415e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[6.1638e-05, 1.9708e-05, 7.0251e-04, 1.6672e-05, 5.1977e-05, 2.2507e-05,
         1.9807e-05, 4.6984e-05, 4.0358e-04, 2.0034e-05, 6.3117e-04, 2.4234e-05,
         2.1055e-03, 4.6857e-04, 2.4928e-05, 1.5116e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.105898
summ of probs approach
probs_ shape tensor([9.0208e-04, 4.0278e-03, 9.0868e-04, 5.6961e-03, 4.1661e-03, 1.7334e-03,
        8.7597e-01, 1.1250e-03, 1.3681e-03, 7.4222e-04, 7.4536e-03, 1.0960e-03,
        1.2160e-02, 7.6865e-04, 1.1527e-03, 1.7990e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[4.5324e-04, 1.7073e-05, 2.2344e-04, 4.8772e-04, 8.2636e-05, 1.8083e-04,
         1.5506e-06, 5.5935e-05, 3.5389e-05, 1.1179e-03, 2.2978e-04, 1.6452e-04,
         4.5946e-05, 3.1524e-05, 6.3714e-05, 1.8390e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.111871
summ of probs approach
probs_ shape tensor([3.3375e-04, 1.0125e-03, 9.5583e-04, 8.2791e-04, 1.8254e-03, 5.1031e-04,
        5.7867e-03, 2.9151e-03, 1.3409e-03, 2.4169e-03, 8.1938e-04, 1.2374e-03,
        6.5350e-04, 2.8465e-03, 9.8658e-01, 8.0328e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[2.3791e-05, 1.5374e-04, 1.2477e-05, 2.1181e-05, 6.3288e-05, 3.0811e-04,
         9.3044e-05, 2.9394e-03, 6.7641e-05, 3.1790e-06, 5.1456e-03, 4.5392e-08,
         2.7741e-05, 6.9555e-04, 2.1698e-06, 1.0418e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.085345
summ of probs approach
probs_ shape tensor([0.0057, 0.0073, 0.0007, 0.0033, 0.0061, 0.0013, 0.0556, 0.0005, 0.0045,
        0.0119, 0.0024, 0.0014, 0.0049, 0.0016, 0.0035, 0.0005],
       device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.9909e-05, 6.6395e-04, 2.9839e-05, 1.2784e-04, 9.9170e-04, 1.2162e-05,
         1.6814e-05, 1.6368e-05, 1.3399e-04, 3.1450e-05, 5.7889e-03, 3.5479e-04,
         4.9072e-06, 7.7493e-05, 1.3175e-04, 8.0942e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.092420
summ of probs approach
probs_ shape tensor([3.2134e-03, 1.6582e-03, 1.8189e-03, 1.0576e-03, 1.1223e-03, 9.8591e-01,
        8.9702e-04, 3.8176e-03, 2.2187e-03, 6.6788e-04, 1.4604e-03, 3.8141e-03,
        2.4210e-04, 2.1870e-03, 2.7412e-03, 2.1456e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.2907e-06, 1.6517e-04, 3.4697e-05, 4.3716e-05, 2.3810e-05, 9.0581e-07,
         3.4397e-05, 1.5456e-04, 1.5484e-04, 3.0301e-06, 1.8960e-04, 2.1675e-05,
         1.4601e-06, 6.5773e-05, 3.2634e-05, 1.3438e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.084693
summ of probs approach
probs_ shape tensor([4.2076e-03, 4.3742e-04, 8.0350e-04, 1.5203e-02, 9.9036e-01, 1.0528e-03,
        3.4729e-03, 1.3003e-03, 1.2575e-03, 3.8255e-03, 2.2604e-03, 1.8625e-03,
        9.2857e-04, 1.0659e-03, 2.5144e-03, 6.2093e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.6489e-05, 9.4154e-05, 8.8861e-06, 1.8802e-04, 2.3991e-05, 1.8321e-05,
         1.2228e-04, 5.0473e-06, 3.6813e-05, 2.0768e-05, 1.4313e-04, 8.5487e-06,
         3.4327e-05, 3.9973e-06, 2.3934e-05, 1.9221e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.064060
summ of probs approach
probs_ shape tensor([0.0013, 0.0024, 0.0012, 0.0016, 0.0100, 0.0029, 0.5894, 0.0040],
       device='cuda:0') torch.Size([8])
summ of probs approach
id: [529] -> tensor([[1.8122e-05, 2.6669e-06, 6.4155e-06, 5.5708e-04, 6.6731e-05, 1.3357e-04,
         1.6042e-06, 1.0459e-03]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.042558
acc:  0.525
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.390497
path ['42', 'fr', 'flan', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.39s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 2123, 29875], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id:[1, 2123, 29875]
answer  {'input_ids': [1, 1661], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 1661] -> [1661]
load model Duration: 0:02:34.544925
prompt_type null has 1 prompts in it
----------- 42 fr huggyllama/llama-7b SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([4.0829e-05, 5.5408e-04, 6.4011e-03, 3.0479e-03, 7.0906e-04, 4.5478e-05,
        4.5109e-04, 1.9264e-04, 1.0830e-04, 2.9981e-05, 7.2813e-04, 3.6025e-04,
        1.1740e-03, 1.4019e-03, 1.9798e-03, 7.0572e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[7.8082e-06, 4.7612e-04, 4.6515e-04, 4.8280e-04, 1.0395e-04, 9.5367e-06,
         1.3626e-04, 4.1723e-05, 1.0073e-05, 4.7684e-06, 1.2946e-04, 2.5058e-04,
         4.5776e-05, 9.0456e-04, 2.9683e-04, 7.4506e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.273649
summ of probs approach
probs_ shape tensor([6.7711e-03, 6.3539e-05, 1.1444e-05, 1.1024e-03, 2.0447e-03, 4.6945e-04,
        5.8651e-04, 5.8222e-04, 3.9279e-05, 4.9744e-03, 1.1024e-02, 1.5831e-04,
        1.2946e-04, 6.8069e-05, 2.6188e-03, 4.4823e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.0611e-04, 2.1875e-05, 4.5896e-06, 9.5749e-04, 6.0081e-04, 4.5896e-06,
         4.4823e-05, 8.0490e-04, 3.5763e-06, 2.9969e-04, 1.2197e-03, 2.8610e-05,
         1.4639e-04, 2.3007e-05, 3.7074e-05, 8.0490e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.316623
summ of probs approach
probs_ shape tensor([4.2498e-05, 2.8110e-04, 1.2755e-05, 5.1558e-05, 5.4419e-05, 1.1563e-04,
        1.3304e-03, 1.4067e-03, 3.8862e-04, 9.0241e-05, 3.7503e-04, 1.1002e-02,
        9.0714e-03, 1.4925e-04, 1.7929e-02, 1.2283e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[9.3043e-05, 3.5763e-04, 1.6868e-05, 6.8545e-05, 6.5565e-06, 1.9193e-05,
         6.2943e-04, 5.3227e-05, 1.5461e-04, 4.1842e-05, 4.2319e-05, 6.9809e-04,
         1.1530e-03, 2.0540e-04, 1.9193e-04, 3.1161e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.299575
summ of probs approach
probs_ shape tensor([3.5572e-04, 1.6565e-03, 1.1349e-03, 1.0842e-04, 7.4768e-03, 2.1243e-04,
        3.3569e-03, 6.5982e-05, 1.0643e-03, 4.2496e-03, 5.1928e-04, 2.5024e-03,
        2.5392e-05, 2.3580e-04, 1.1331e-04, 5.6152e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.3077e-04, 1.3018e-04, 3.3736e-05, 3.3975e-06, 6.6948e-04, 1.0252e-05,
         2.5964e-04, 2.0814e-04, 2.5213e-05, 5.0240e-03, 6.3717e-05, 4.7207e-04,
         7.5102e-06, 1.2863e-04, 2.0385e-05, 2.3689e-03]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.259441
summ of probs approach
probs_ shape tensor([5.7077e-04, 8.9951e-03, 5.3406e-04, 5.7793e-04, 8.8692e-05, 2.8789e-05,
        3.4094e-04, 4.0412e-05, 3.6764e-04, 2.1801e-03, 1.3375e-04, 3.1471e-05,
        4.9248e-03, 4.2839e-03, 2.4438e-05, 6.2704e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.2709e-04, 1.2503e-03, 2.9504e-05, 3.6776e-05, 1.0788e-05, 9.9540e-06,
         1.6403e-03, 1.2612e-04, 5.1856e-05, 1.5192e-03, 1.2195e-04, 1.2040e-05,
         7.3612e-05, 3.0541e-04, 1.1325e-05, 1.0127e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.362974
summ of probs approach
probs_ shape tensor([4.7722e-03, 4.0436e-04, 3.8177e-02, 7.9727e-04, 6.1095e-05, 4.3154e-05,
        4.9949e-05, 1.1462e-04, 7.0810e-05, 1.6153e-05, 2.7823e-04, 2.0564e-05,
        1.1528e-04, 4.4918e-04, 5.8365e-04, 9.9468e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.1053e-03, 7.5459e-05, 3.5381e-04, 2.1577e-04, 2.2531e-05, 2.7537e-05,
         6.0201e-06, 3.8505e-05, 2.2769e-05, 1.5199e-05, 6.1512e-04, 1.9491e-05,
         2.5153e-05, 1.2910e-04, 1.1617e-04, 1.3375e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.474316
summ of probs approach
probs_ shape tensor([5.9545e-05, 1.3304e-04, 2.8849e-05, 2.3270e-04, 1.6189e-04, 9.3043e-05,
        3.9637e-05, 6.0940e-04, 2.3961e-05, 2.1994e-05, 3.3975e-05, 4.0070e-02,
        1.7805e-03, 3.4285e-04, 9.4700e-04, 2.7790e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[6.6638e-05, 1.9372e-05, 5.8413e-06, 2.2364e-04, 1.8477e-05, 4.4584e-05,
         5.4240e-06, 1.0228e-04, 8.4043e-06, 1.0371e-05, 1.1683e-05, 1.6155e-03,
         8.7202e-05, 1.3411e-04, 6.9201e-05, 3.8528e-03]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.508335
summ of probs approach
probs_ shape tensor([1.8013e-04, 4.7112e-04, 2.9449e-02, 1.0090e-03, 7.5519e-05, 1.0857e-02,
        6.7294e-05, 1.2245e-03, 1.2054e-03, 7.2670e-04, 1.9836e-02, 7.6771e-05,
        2.4557e-05, 1.4893e-02, 2.4128e-03, 5.5075e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[4.4286e-05, 1.7917e-04, 3.9339e-05, 4.3702e-04, 2.4199e-05, 4.4703e-05,
         1.8954e-05, 7.3004e-04, 1.3933e-03, 2.0432e-04, 2.0142e-03, 3.8445e-05,
         1.6093e-05, 8.9788e-04, 4.8661e-04, 5.9605e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.351664
summ of probs approach
probs_ shape tensor([3.4218e-03, 2.0332e-03, 1.4567e-04, 3.2425e-05, 1.0118e-03, 6.3241e-05,
        5.3673e-03, 1.0576e-03, 1.2255e-04, 5.0902e-05, 1.9610e-05, 5.0354e-04,
        9.1136e-05, 2.0373e-04, 1.3542e-03, 2.0332e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[5.6839e-04, 9.2220e-04, 1.4639e-04, 9.4175e-06, 5.7602e-04, 2.6107e-05,
         1.0681e-04, 1.4067e-04, 5.4240e-06, 1.1742e-05, 5.7817e-06, 2.8181e-04,
         3.6836e-05, 2.2650e-04, 1.9419e-04, 5.8770e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.299883
summ of probs approach
probs_ shape tensor([3.2723e-05, 2.2352e-05, 2.3150e-04, 1.2648e-04, 3.1490e-03, 5.9068e-05,
        7.4267e-05, 3.3302e-03, 3.9673e-03, 3.1948e-04, 8.9836e-04, 1.0319e-03,
        1.0691e-03, 3.7098e-03, 5.2750e-05, 3.5584e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.6987e-05, 6.1393e-06, 3.1769e-05, 4.0472e-05, 2.5201e-04, 1.6510e-05,
         2.0802e-05, 7.3814e-04, 3.7134e-05, 2.4080e-05, 7.6485e-04, 3.7253e-05,
         1.0891e-03, 4.4274e-04, 1.3649e-05, 2.9802e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.321738
summ of probs approach
probs_ shape tensor([3.6755e-03, 1.6928e-05, 3.7432e-05, 6.5386e-05, 6.5029e-05, 2.5868e-05,
        4.4048e-05, 7.5042e-05, 8.9645e-04, 3.4785e-04, 5.3453e-04, 1.2770e-03,
        7.6950e-05, 2.8801e-03, 7.7868e-04, 7.3314e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.5177e-04, 2.6226e-06, 3.9935e-06, 4.7624e-05, 9.7156e-06, 2.1219e-05,
         3.6836e-05, 1.0431e-05, 1.6136e-03, 8.4043e-05, 3.7742e-04, 1.0931e-04,
         6.7890e-05, 8.2672e-05, 9.1612e-05, 1.9193e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.384654
summ of probs approach
probs_ shape tensor([2.3365e-03, 2.4078e-02, 4.8904e-03, 9.6941e-04, 1.3602e-04, 1.2951e-03,
        6.8009e-05, 3.3557e-05, 9.9106e-03, 1.2674e-03, 1.1611e-04, 4.8459e-05,
        5.4264e-04, 1.6510e-02, 4.6635e-04, 1.2436e-02], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.2717e-03, 2.3384e-03, 2.6989e-04, 7.2062e-05, 7.7665e-05, 1.3285e-03,
         1.4722e-05, 9.5367e-07, 2.3508e-04, 8.6498e-04, 2.0683e-05, 5.0068e-06,
         3.8624e-05, 2.8372e-04, 9.0599e-05, 2.9397e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.344640
summ of probs approach
probs_ shape tensor([3.2401e-04, 8.1587e-04, 1.0854e-04, 3.0756e-05, 6.2227e-04, 9.2506e-05,
        5.9307e-05, 1.7252e-03], device='cuda:0', dtype=torch.float16) torch.Size([8])
summ of probs approach
id: [1661] -> tensor([[2.1422e-04, 5.9986e-04, 1.1736e-04, 1.0252e-05, 2.0385e-04, 1.9193e-05,
         3.9577e-05, 1.0324e-04]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.159940
acc:  0.585
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:04.377274
path ['42', 'fr', 'llama', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1032, 266, 1], 'attention_mask': [1, 1, 1]}
id:[1032, 266, 1]
answer  {'input_ids': [935, 1], 'attention_mask': [1, 1]}
id:[935, 1]
load model Duration: 0:00:06.178932
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/mt0-small SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([0.0011, 0.0007, 0.0003, 0.0003, 0.0011, 0.0009, 0.0011, 0.0001, 0.0010,
        0.0004, 0.0559, 0.0002, 0.0007, 0.0004, 0.0008, 0.0005],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0011, 0.0006, 0.0002, 0.0003, 0.0010, 0.0009, 0.0010, 0.0001, 0.0013,
        0.0003, 0.0179, 0.0002, 0.0007, 0.0003, 0.0008, 0.0004],
       device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.117858
summ of probs approach
probs_ shape tensor([0.0008, 0.0012, 0.0003, 0.0005, 0.0012, 0.0016, 0.0008, 0.0016, 0.0008,
        0.0007, 0.0004, 0.0013, 0.0007, 0.0009, 0.0006, 0.0023],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0005, 0.0015, 0.0003, 0.0006, 0.0018, 0.0086, 0.0008, 0.0041, 0.0007,
        0.0007, 0.0003, 0.0013, 0.0065, 0.0006, 0.0007, 0.0018],
       device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.071989
summ of probs approach
probs_ shape tensor([5.4913e-04, 3.9399e-04, 9.8690e-04, 4.3891e-04, 5.9616e-04, 5.2659e-04,
        1.3171e-03, 7.2361e-04, 5.0117e-04, 9.5877e-01, 3.0170e-04, 2.7154e-04,
        5.1640e-04, 6.6116e-04, 2.4492e-04, 1.0107e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.8698e-04, 2.8666e-04, 9.4680e-04, 5.0292e-04, 3.8299e-04, 5.1350e-04,
        9.8675e-04, 2.3445e-03, 4.8901e-04, 9.5876e-01, 2.8947e-04, 3.9604e-04,
        4.7517e-04, 4.9926e-04, 1.9522e-04, 9.5922e-05], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.100374
summ of probs approach
probs_ shape tensor([4.5267e-04, 6.1722e-04, 5.7917e-04, 9.5220e-01, 3.1954e-03, 6.8026e-04,
        1.5529e-03, 4.2424e-04, 5.4191e-04, 1.2836e-03, 1.0952e-03, 6.5773e-04,
        5.8680e-04, 1.0197e-03, 6.4659e-04, 6.9255e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.3583e-04, 5.9861e-04, 5.6513e-04, 9.5220e-01, 6.2701e-03, 6.3476e-04,
        3.5902e-03, 2.9121e-04, 4.3272e-04, 1.0386e-03, 1.0887e-03, 6.3269e-04,
        8.8157e-04, 7.5076e-04, 6.7993e-04, 5.7593e-04], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.069432
summ of probs approach
probs_ shape tensor([5.5182e-04, 4.4046e-04, 1.0571e-03, 8.7643e-04, 7.0695e-04, 1.2311e-03,
        3.7591e-04, 3.7089e-04, 4.6625e-04, 9.0387e-04, 8.1665e-04, 5.0971e-04,
        4.0574e-04, 3.5778e-04, 7.5145e-04, 6.5611e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.1031e-04, 3.6284e-04, 6.9589e-03, 2.0199e-03, 5.9704e-04, 1.9079e-03,
        3.6886e-04, 3.2318e-04, 4.3384e-04, 2.2616e-03, 9.9991e-04, 4.5904e-04,
        4.4814e-04, 1.4022e-03, 6.7559e-04, 6.5610e-01], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.127869
summ of probs approach
probs_ shape tensor([3.0337e-04, 9.7530e-04, 5.2969e-04, 9.3186e-04, 6.1297e-04, 9.9154e-01,
        9.6448e-05, 7.9615e-04, 3.1913e-04, 1.2281e-04, 1.0948e-03, 3.4884e-04,
        6.3604e-04, 9.6092e-04, 4.4179e-03, 2.5393e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0518e-03, 8.0548e-04, 3.9681e-04, 5.2844e-04, 1.0418e-03, 9.9153e-01,
        8.3343e-05, 5.9696e-04, 2.6786e-04, 4.0855e-04, 1.1360e-03, 2.8734e-04,
        7.1149e-04, 9.1638e-04, 3.7334e-03, 2.5228e-03], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.062564
summ of probs approach
probs_ shape tensor([3.2229e-04, 7.1269e-04, 8.5321e-04, 7.2751e-04, 3.2763e-04, 1.0769e-03,
        6.5729e-04, 7.2218e-04, 5.3795e-04, 6.5594e-02, 8.2879e-04, 2.7525e-04,
        6.1495e-04, 9.6638e-04, 2.2381e-05, 1.8485e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.9929e-04, 7.1890e-04, 9.1942e-04, 5.2724e-02, 5.2647e-04, 8.4064e-04,
        6.3548e-04, 1.3556e-03, 5.2036e-04, 5.1078e-02, 6.1992e-04, 2.4491e-04,
        1.1546e-03, 9.2630e-04, 1.5631e-05, 1.9040e-03], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.051006
summ of probs approach
probs_ shape tensor([0.0003, 0.0008, 0.0003, 0.0002, 0.0012, 0.0009, 0.0002, 0.0018, 0.0136,
        0.0008, 0.0004, 0.0008, 0.0010, 0.0004, 0.0003, 0.0010],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0002, 0.0006, 0.0003, 0.0002, 0.0009, 0.0008, 0.0004, 0.0017, 0.0078,
        0.0009, 0.0003, 0.0007, 0.0007, 0.0004, 0.0002, 0.0009],
       device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.064896
summ of probs approach
probs_ shape tensor([0.0024, 0.0006, 0.0002, 0.0004, 0.0013, 0.0018, 0.0003, 0.0008, 0.0013,
        0.0021, 0.0002, 0.0386, 0.0003, 0.0001, 0.0010, 0.0004],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0020, 0.0004, 0.0002, 0.0004, 0.0009, 0.0015, 0.0003, 0.0009, 0.0021,
        0.0020, 0.0002, 0.0348, 0.0003, 0.0001, 0.0011, 0.0005],
       device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.079321
summ of probs approach
probs_ shape tensor([0.0004, 0.0006, 0.0012, 0.0004, 0.0018, 0.0004, 0.1891, 0.0002, 0.0007,
        0.0008, 0.0007, 0.0008, 0.0027, 0.0036, 0.0012, 0.0006],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.3842e-04, 5.0497e-04, 3.8173e-03, 3.4067e-04, 4.4742e-03, 3.3182e-04,
        1.8908e-01, 1.8868e-04, 1.3267e-03, 1.1742e-03, 1.6675e-03, 7.4207e-04,
        3.6709e-03, 5.4780e-03, 7.8008e-03, 5.0075e-04], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.099262
summ of probs approach
probs_ shape tensor([1.0879e-03, 3.9848e-04, 5.3893e-04, 5.2782e-04, 4.9745e-04, 7.1273e-04,
        6.3966e-05, 4.7561e-04, 4.9766e-04, 6.1205e-04, 8.9848e-01, 4.7553e-04,
        3.5828e-04, 8.8646e-04, 7.2536e-04, 2.4647e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0743e-03, 4.7085e-04, 7.8354e-04, 4.2729e-04, 3.2300e-04, 6.6392e-04,
        8.0481e-05, 5.6689e-04, 4.8523e-04, 1.1416e-03, 8.9847e-01, 4.3701e-04,
        3.2921e-04, 8.3569e-04, 6.6977e-04, 1.8303e-02], device='cuda:0') torch.Size([16])
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/fr/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
 Batch: 10 of null classification Duration: 0:00:00.116794
summ of probs approach
probs_ shape tensor([9.0212e-04, 6.1408e-04, 6.9225e-04, 7.0755e-04, 3.2488e-04, 7.2109e-04,
        2.8999e-02, 4.1601e-04, 2.5610e-04, 1.0391e-04, 4.0955e-04, 2.0441e-04,
        3.2944e-04, 5.0897e-04, 6.2515e-04, 7.3040e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.0906e-04, 5.6431e-04, 6.5402e-04, 7.6959e-04, 3.0555e-04, 1.6054e-03,
        1.7575e-03, 3.5763e-04, 2.1781e-04, 1.2162e-04, 2.8301e-04, 2.8890e-04,
        3.0756e-04, 5.0390e-04, 1.6453e-03, 7.3040e-01], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.082434
summ of probs approach
probs_ shape tensor([0.0026, 0.0016, 0.0008, 0.0007, 0.0008, 0.0011, 0.0014, 0.0046],
       device='cuda:0') torch.Size([8])
summ of probs approach
probs_ shape tensor([0.0024, 0.0011, 0.0008, 0.0007, 0.0009, 0.0010, 0.0013, 0.0041],
       device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.053362
acc:  0.7
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.114159
path ['42', 'fr', 't0', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Using NLI dataset for fr
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  2.41it/s]100%|██████████| 3/3 [00:00<00:00,  6.42it/s]
loading model Duration: 0:00:01.582684
filter data Duraction: 0:00:00.000003
use_neutral is  True
len of entail_examples , neutral_examples, contra_examples:  66 66 66
len dataset  198
random sample Duraction: 0:02:49.657347
create dataloader Duration: 0:02:51.369233
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [92000], 'attention_mask': [1]}
id:[92000]
answer  {'input_ids': [25490], 'attention_mask': [1]}
id:[25490]
answer  {'input_ids': [1090, 69696], 'attention_mask': [1, 1]}
id:[1090, 69696]
load model Duration: 0:00:09.950487
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/bloom-560m NLI null 0 200 16 --------------
summ of probs approach
id: [92000] -> tensor([[2.5989e-07, 1.6028e-07, 9.3029e-07, 2.2989e-07, 1.2158e-08, 2.0068e-08,
         9.1064e-07, 1.3855e-08, 1.4968e-08, 9.3542e-07, 1.4043e-06, 1.6738e-07,
         6.1427e-07, 2.1683e-06, 2.1992e-06, 1.9732e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.3589e-06, 7.5259e-07, 4.0863e-06, 5.0316e-06, 2.5309e-07, 2.0928e-07,
         5.7454e-07, 2.1642e-07, 1.5552e-07, 3.0138e-06, 3.0339e-06, 2.1289e-06,
         4.9422e-06, 2.8343e-06, 3.4516e-06, 8.5495e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.7610e-05, 4.3524e-06, 3.3368e-06, 2.3526e-05, 3.3431e-06, 8.3869e-07,
        1.5870e-06, 4.0593e-07, 1.6551e-06, 1.4906e-05, 2.1802e-06, 9.1425e-06,
        6.8935e-06, 4.4549e-06, 4.6969e-06, 8.2720e-06], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.182294
summ of probs approach
id: [92000] -> tensor([[5.3659e-08, 2.4635e-07, 5.9040e-08, 1.0607e-06, 1.4482e-08, 7.3250e-07,
         1.8694e-06, 1.6985e-07, 3.6334e-09, 2.5402e-08, 5.4654e-08, 4.1398e-07,
         7.9081e-07, 1.6325e-07, 7.5307e-06, 9.1847e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.0696e-07, 1.6621e-06, 2.0914e-06, 8.1375e-06, 1.6484e-07, 8.4084e-07,
         2.5504e-06, 3.2774e-07, 1.5763e-07, 9.1461e-08, 3.4642e-07, 1.4657e-05,
         3.8721e-06, 5.4701e-08, 1.3789e-06, 6.2388e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.0104e-07, 3.6512e-05, 4.7109e-06, 1.8445e-05, 5.5763e-07, 4.5554e-06,
        1.9861e-05, 1.3379e-06, 1.3792e-06, 4.3043e-06, 2.9245e-08, 3.0749e-05,
        9.8822e-07, 9.6820e-07, 1.6857e-06, 1.7030e-06], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.144936
summ of probs approach
id: [92000] -> tensor([[3.7497e-06, 1.6558e-09, 1.4481e-07, 7.7101e-06, 1.1962e-07, 3.9743e-08,
         1.6437e-08, 2.4092e-07, 1.8056e-08, 2.9675e-09, 1.7419e-08, 4.2032e-08,
         7.9342e-09, 3.2463e-07, 1.9376e-07, 2.0771e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.2542e-06, 3.2857e-08, 3.4591e-07, 1.1827e-05, 6.4900e-07, 4.7502e-07,
         5.5937e-07, 1.6287e-06, 4.6449e-07, 2.1185e-08, 2.1251e-07, 7.2576e-07,
         2.9693e-07, 3.2644e-07, 3.9878e-07, 3.3508e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.7265e-05, 6.4338e-07, 9.0074e-07, 1.0009e-05, 2.5396e-06, 5.6474e-06,
        2.7211e-06, 4.9790e-06, 1.8478e-07, 2.2069e-07, 3.6246e-06, 1.7884e-06,
        7.2174e-07, 3.5101e-06, 5.3109e-06, 8.3895e-07], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.164378
summ of probs approach
id: [92000] -> tensor([[6.5184e-07, 5.5094e-07, 2.4569e-06, 9.9064e-07, 1.2174e-07, 4.4741e-08,
         1.6054e-07, 8.2794e-09, 1.4375e-07, 6.6790e-08, 5.3513e-08, 2.9044e-07,
         1.1737e-08, 3.0095e-08, 1.9127e-07, 7.3061e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.7838e-06, 4.7049e-06, 1.2862e-05, 7.2058e-07, 4.4770e-07, 2.1853e-07,
         6.6997e-07, 2.6171e-07, 3.5155e-07, 4.2071e-07, 8.3772e-07, 7.0705e-07,
         5.8824e-08, 5.9115e-08, 7.7809e-07, 7.0744e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.5229e-06, 9.5367e-06, 5.0427e-05, 3.1130e-06, 1.2571e-06, 2.4399e-06,
        1.0822e-05, 1.6588e-06, 2.1277e-06, 1.8527e-06, 1.2100e-06, 9.2931e-07,
        9.7740e-07, 7.9966e-06, 2.6476e-06, 5.9397e-07], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.339637
summ of probs approach
id: [92000] -> tensor([[8.6321e-08, 4.7295e-07, 7.2650e-07, 1.0133e-06, 5.4770e-11, 3.1287e-05,
         1.9616e-06, 5.1189e-06, 2.6763e-06, 2.2451e-07, 2.0629e-07, 8.5335e-07,
         4.2316e-09, 4.9061e-09, 2.2166e-05, 2.2242e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[6.3996e-07, 5.8376e-07, 6.6304e-07, 1.2447e-06, 8.4062e-11, 6.0422e-06,
         5.2913e-06, 3.3583e-06, 3.9929e-06, 9.6811e-07, 5.1568e-07, 1.0991e-06,
         1.3051e-07, 1.2585e-07, 4.2794e-05, 1.7960e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.3146e-06, 1.4987e-06, 1.3514e-06, 1.0178e-05, 2.9616e-10, 5.7116e-06,
        5.8527e-06, 1.5979e-05, 4.1685e-06, 3.1604e-06, 2.1593e-06, 8.3028e-06,
        1.4513e-06, 2.4708e-06, 7.1817e-05, 5.7706e-06], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.194544
summ of probs approach
id: [92000] -> tensor([[2.7904e-05, 1.5407e-06, 1.0660e-06, 2.0199e-08, 1.0044e-07, 8.8812e-06,
         3.5159e-09, 1.9436e-08, 7.6416e-08, 5.1416e-07, 1.8439e-07, 3.9981e-07,
         6.3102e-08, 3.0411e-08, 1.8135e-07, 2.8230e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.3894e-05, 1.6123e-06, 8.5679e-07, 7.3755e-08, 6.0224e-07, 5.3207e-06,
         7.7010e-08, 1.3413e-07, 1.6931e-07, 4.5529e-06, 1.9297e-07, 2.3925e-06,
         6.8720e-07, 2.4043e-07, 8.1109e-07, 5.5313e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.1758e-05, 5.1083e-06, 2.4362e-06, 6.1492e-07, 6.2179e-06, 4.6355e-06,
        1.8478e-06, 1.2311e-06, 3.3443e-06, 9.1639e-06, 3.4288e-06, 1.0142e-06,
        1.0442e-06, 2.1388e-06, 2.7839e-06, 9.5319e-07], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.131302
summ of probs approach
id: [92000] -> tensor([[3.4470e-09, 2.2560e-05, 4.5578e-07, 4.0813e-08, 1.8664e-06, 5.8609e-07,
         1.4575e-07, 4.9782e-06, 2.2623e-07, 1.4329e-07, 1.7849e-07, 7.9095e-07,
         1.2515e-07, 1.3688e-08, 5.9847e-06, 1.6419e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[6.9120e-08, 4.5518e-05, 4.7591e-07, 3.3356e-08, 2.9114e-06, 1.6690e-06,
         1.0331e-06, 1.2994e-05, 6.7553e-07, 9.5404e-07, 1.2896e-06, 6.5901e-07,
         8.7587e-08, 2.1484e-07, 2.6370e-06, 1.0235e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.0942e-06, 1.1968e-05, 9.4376e-07, 7.8539e-08, 1.3634e-05, 1.4951e-05,
        1.3410e-06, 2.8450e-05, 1.4715e-06, 2.7143e-05, 4.1340e-06, 1.7432e-06,
        1.8899e-06, 8.0416e-07, 8.1833e-06, 2.4350e-05], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.145470
summ of probs approach
id: [92000] -> tensor([[8.3435e-08, 4.5625e-08, 8.1749e-07, 3.8941e-08, 1.7192e-06, 4.6868e-09,
         2.3876e-07, 1.5242e-08, 4.6642e-07, 1.0010e-06, 6.4726e-06, 5.6617e-07,
         3.7161e-08, 2.0599e-06, 2.9736e-09, 4.0992e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.2618e-07, 1.3700e-07, 3.2445e-06, 2.0509e-07, 4.8280e-06, 3.2289e-07,
         7.7986e-07, 1.4703e-07, 1.0090e-06, 2.6256e-06, 1.6086e-05, 1.1386e-06,
         1.1045e-06, 2.3490e-06, 7.5760e-08, 5.0433e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.0615e-07, 1.2963e-06, 1.4874e-06, 2.4725e-06, 3.5492e-05, 1.6067e-06,
        7.7282e-06, 4.1748e-07, 2.4204e-06, 4.9033e-06, 1.2426e-05, 2.9574e-06,
        2.4716e-06, 6.2836e-06, 1.8894e-07, 8.6544e-07], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.175309
summ of probs approach
id: [92000] -> tensor([[1.3718e-05, 2.1983e-08, 1.5642e-07, 8.8642e-08, 2.0938e-05, 4.2942e-07,
         1.4363e-05, 4.0233e-06, 1.9641e-05, 4.8225e-09, 2.8439e-07, 3.6043e-08,
         1.0640e-07, 1.8290e-08, 9.4082e-07, 5.8037e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.8920e-05, 2.3760e-07, 8.2450e-07, 5.0665e-07, 1.8517e-05, 2.4467e-06,
         2.4652e-05, 1.5203e-05, 4.5132e-05, 1.0920e-07, 2.4704e-06, 1.3597e-07,
         1.1837e-06, 1.3966e-07, 5.1113e-07, 5.2394e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2763e-05, 1.1937e-06, 7.1929e-06, 5.1079e-06, 1.0797e-04, 9.7669e-06,
        3.5350e-05, 6.1748e-05, 6.7983e-05, 6.0691e-07, 3.3461e-05, 4.1147e-06,
        1.6197e-06, 1.3681e-06, 1.6451e-06, 1.0544e-05], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.161518
summ of probs approach
id: [92000] -> tensor([[4.2704e-08, 2.0072e-08, 1.8487e-05, 2.6871e-09, 3.0248e-05, 4.4125e-08,
         5.7875e-09, 1.7186e-05, 5.2770e-07, 1.4749e-05, 5.2005e-07, 6.1392e-08,
         1.4942e-08, 8.8070e-06, 4.3805e-07, 5.7241e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.3431e-07, 4.6147e-07, 5.7632e-05, 1.0449e-07, 2.2659e-05, 6.7855e-07,
         1.7672e-07, 2.7408e-05, 6.1521e-07, 1.2620e-05, 1.9062e-06, 3.7460e-07,
         1.3276e-07, 1.3235e-05, 8.7968e-07, 3.7334e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.6979e-06, 2.0839e-06, 8.1403e-05, 1.7323e-06, 4.0470e-05, 3.3762e-06,
        5.5452e-07, 5.5606e-05, 4.6971e-06, 1.2369e-04, 3.8550e-06, 1.6124e-06,
        1.0656e-06, 1.6217e-05, 1.5532e-05, 2.2099e-06], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.161329
summ of probs approach
id: [92000] -> tensor([[3.3908e-06, 7.7315e-07, 6.1706e-08, 2.6623e-07, 5.8328e-06, 9.6587e-09,
         8.2074e-08, 8.6478e-09, 5.0251e-06, 5.0498e-07, 9.3591e-08, 2.6882e-07,
         3.5116e-07, 2.0927e-05, 1.0575e-06, 1.2888e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.0954e-06, 3.5418e-07, 1.2902e-07, 3.1584e-07, 8.5734e-06, 3.7916e-07,
         3.2162e-07, 1.2350e-07, 5.1592e-06, 7.9907e-07, 5.3169e-07, 1.4220e-06,
         7.1889e-07, 4.0787e-05, 2.6277e-06, 2.2419e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.6380e-06, 2.2608e-06, 2.9122e-06, 2.7273e-06, 3.7529e-06, 2.5687e-06,
        8.8953e-06, 1.3726e-07, 7.6708e-07, 4.5398e-07, 1.8063e-06, 1.5338e-06,
        5.6550e-06, 4.4775e-05, 2.4338e-06, 9.5166e-06], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.149656
summ of probs approach
id: [92000] -> tensor([[1.4416e-06, 2.0743e-08, 4.5690e-06, 1.1028e-07, 3.2219e-05, 8.2037e-09,
         9.0805e-07, 4.4844e-06, 3.0422e-08, 3.7105e-06, 2.2936e-07, 7.9611e-08,
         2.0755e-07, 3.7999e-09, 2.1407e-05, 2.2797e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[8.6403e-06, 4.8730e-08, 7.2597e-06, 1.7511e-06, 6.2383e-05, 7.5537e-07,
         2.4806e-06, 3.1268e-06, 1.0900e-07, 4.6667e-06, 9.2958e-07, 6.6381e-07,
         3.8205e-07, 4.0667e-07, 2.7152e-05, 1.1059e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.5929e-05, 6.4666e-07, 3.9620e-05, 2.2922e-06, 3.0796e-05, 2.1720e-06,
        3.6852e-06, 2.0398e-05, 1.1965e-06, 1.2855e-05, 2.7336e-06, 3.7172e-06,
        3.0245e-06, 1.8773e-06, 6.0346e-05, 3.2253e-06], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.173089
summ of probs approach
id: [92000] -> tensor([[1.7633e-07, 4.8717e-09, 1.6117e-07, 9.3703e-08, 5.1600e-09, 1.3899e-09]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [25490] -> tensor([[1.0411e-06, 1.4348e-07, 7.8003e-07, 2.9624e-07, 3.6795e-08, 6.1375e-08]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([3.7379e-06, 9.3799e-07, 3.0429e-06, 3.9691e-06, 1.0277e-06, 3.1394e-07],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.051913
acc:  0.30808080808080807
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.204924
path ['42', 'fr', 'bloom', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [92000], 'attention_mask': [1]}
id:[92000]
answer  {'input_ids': [25490], 'attention_mask': [1]}
id:[25490]
answer  {'input_ids': [1090, 69696], 'attention_mask': [1, 1]}
id:[1090, 69696]
load model Duration: 0:00:09.481339
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/bloomz-560m NLI null 0 200 16 --------------
summ of probs approach
id: [92000] -> tensor([[1.3058e-09, 2.4755e-10, 1.2138e-10, 3.0570e-08, 8.9217e-10, 5.7889e-11,
         5.2136e-10, 5.5590e-08, 5.4638e-11, 5.2058e-09, 5.0877e-10, 2.6200e-08,
         3.9808e-08, 2.6499e-10, 9.8703e-08, 2.2358e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.2374e-09, 2.9068e-09, 1.1747e-09, 2.8768e-08, 1.0890e-08, 1.3968e-09,
         6.2692e-09, 1.0509e-07, 5.7042e-10, 4.8369e-08, 7.5057e-10, 1.1891e-08,
         2.5815e-09, 3.8151e-10, 3.5094e-07, 2.1504e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6361e-08, 1.8069e-08, 1.7473e-08, 2.5645e-07, 2.5737e-07, 1.7720e-08,
        9.4334e-08, 8.0922e-07, 4.2902e-09, 1.9207e-07, 9.4404e-09, 9.4503e-08,
        3.0504e-09, 3.1824e-08, 2.5816e-06, 2.3847e-08], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.148177
summ of probs approach
id: [92000] -> tensor([[8.3183e-09, 1.2173e-11, 3.1500e-09, 6.9054e-08, 8.0961e-07, 4.8205e-06,
         1.2351e-10, 5.8588e-08, 3.3442e-09, 7.1027e-10, 9.8464e-10, 2.2858e-12,
         1.6163e-10, 2.3283e-10, 9.6175e-09, 9.1786e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.6261e-08, 1.6049e-09, 3.0445e-09, 3.7290e-08, 1.9846e-06, 7.4980e-06,
         1.7613e-08, 6.1034e-08, 2.3656e-08, 1.2263e-09, 3.2886e-09, 2.5417e-12,
         1.9446e-09, 3.9967e-10, 2.6082e-09, 4.5445e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.9615e-08, 3.1559e-09, 1.7861e-08, 1.4824e-08, 2.7331e-06, 7.5782e-06,
        4.1532e-08, 1.6235e-08, 1.5232e-07, 4.1601e-08, 4.0045e-08, 6.5089e-11,
        4.4138e-08, 3.5942e-09, 2.0294e-07, 2.4115e-08], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.191550
summ of probs approach
id: [92000] -> tensor([[1.0035e-08, 3.1373e-10, 6.4891e-09, 5.2678e-11, 1.3784e-11, 2.0492e-09,
         6.1481e-08, 2.4150e-10, 4.7119e-11, 1.1927e-09, 9.6799e-08, 9.6705e-07,
         4.9191e-10, 3.8240e-09, 9.0450e-11, 2.7895e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.3645e-09, 9.0933e-09, 1.1117e-08, 8.2405e-10, 2.7789e-10, 1.9613e-09,
         7.5066e-08, 1.0019e-09, 2.6494e-10, 3.9184e-09, 3.0801e-08, 5.6533e-07,
         5.4863e-09, 7.4662e-09, 4.9567e-10, 9.6922e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.7873e-09, 1.4117e-07, 4.3938e-08, 5.0739e-09, 3.1781e-09, 2.9924e-08,
        1.4670e-07, 7.4541e-08, 1.8716e-09, 1.5921e-08, 1.7221e-07, 4.9509e-06,
        3.6692e-08, 8.1977e-09, 9.7898e-09, 1.5881e-08], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.163134
summ of probs approach
id: [92000] -> tensor([[5.7358e-09, 9.9461e-10, 3.6336e-08, 7.5174e-10, 4.2390e-09, 5.1055e-10,
         2.7222e-07, 1.0948e-09, 7.8711e-08, 1.8772e-10, 2.4543e-08, 2.2971e-09,
         4.5090e-10, 1.7695e-10, 3.6033e-09, 9.0500e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.7222e-09, 1.1276e-09, 3.8195e-08, 3.1622e-09, 4.8683e-09, 4.5872e-10,
         4.4823e-07, 5.8373e-09, 2.5094e-07, 2.0836e-09, 1.9687e-07, 4.2779e-09,
         2.3775e-08, 3.6241e-10, 1.2858e-09, 2.6917e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.8850e-09, 7.0350e-08, 6.0191e-07, 6.2060e-08, 7.1750e-08, 2.4025e-09,
        4.1003e-06, 1.8903e-07, 1.5054e-06, 1.8183e-08, 6.7888e-07, 1.4726e-07,
        5.6333e-07, 4.0437e-08, 1.5676e-08, 8.8235e-08], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.163135
summ of probs approach
id: [92000] -> tensor([[1.8751e-10, 2.2845e-10, 1.1658e-09, 3.9367e-07, 1.1767e-09, 2.2430e-08,
         2.6120e-10, 1.3463e-09, 7.5224e-09, 3.3357e-08, 3.6330e-09, 6.4297e-10,
         2.8831e-10, 8.9227e-12, 1.3248e-11, 2.6141e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[8.7700e-10, 1.1791e-09, 3.9581e-09, 5.1969e-08, 4.4506e-08, 1.1292e-07,
         8.6375e-10, 1.0788e-08, 1.2766e-08, 1.8791e-08, 2.2792e-08, 2.1655e-08,
         4.6724e-09, 1.8965e-10, 2.9137e-10, 1.4357e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.7637e-09, 4.7879e-09, 1.6965e-08, 3.7597e-08, 4.8405e-07, 9.9777e-08,
        3.6979e-08, 1.0918e-08, 5.9729e-08, 2.6720e-07, 4.6106e-08, 1.6818e-08,
        1.6563e-08, 3.1915e-09, 2.4501e-08, 2.2378e-07], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.131978
summ of probs approach
id: [92000] -> tensor([[5.5667e-09, 2.8963e-06, 6.7366e-10, 1.0537e-09, 8.6437e-08, 5.6105e-08,
         2.1827e-10, 1.5878e-09, 7.5305e-12, 4.3460e-10, 5.3292e-08, 1.5482e-09,
         6.3011e-08, 5.6781e-07, 8.3214e-09, 1.5362e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.3632e-08, 4.3667e-07, 1.0056e-09, 7.4429e-09, 4.2261e-08, 8.1354e-07,
         2.1714e-09, 5.3500e-08, 8.4147e-10, 3.3442e-09, 4.0834e-08, 1.4729e-09,
         1.6319e-08, 4.5964e-07, 2.6902e-08, 1.7001e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.7261e-07, 3.0345e-07, 1.1623e-08, 2.9944e-08, 1.7196e-07, 3.9621e-06,
        1.0449e-07, 4.8080e-07, 3.3025e-09, 2.8068e-08, 2.5968e-08, 2.5371e-08,
        5.1764e-08, 1.6344e-05, 1.3271e-07, 8.3377e-08], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.337101
summ of probs approach
id: [92000] -> tensor([[3.7581e-10, 1.3451e-07, 2.7278e-08, 4.9265e-08, 3.5923e-11, 1.6844e-09,
         1.7994e-08, 5.4320e-07, 4.4671e-10, 1.6098e-10, 7.5273e-09, 2.1780e-09,
         6.7382e-08, 2.3182e-09, 3.0562e-09, 1.6241e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.7748e-09, 1.0221e-06, 3.9164e-08, 1.2203e-08, 2.7995e-10, 6.9636e-09,
         1.7206e-08, 6.0477e-07, 1.7421e-09, 3.8787e-10, 2.8392e-08, 2.3034e-09,
         4.8309e-09, 4.9201e-09, 2.9793e-10, 1.6642e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.2708e-08, 1.9007e-06, 3.9211e-07, 3.1851e-08, 9.7821e-09, 3.7013e-07,
        3.7900e-07, 2.7664e-07, 4.0924e-08, 1.7002e-08, 2.4929e-07, 9.1332e-09,
        4.5990e-09, 7.2213e-08, 4.7099e-08, 2.8805e-07], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.135289
summ of probs approach
id: [92000] -> tensor([[1.1186e-08, 2.2616e-09, 9.3604e-11, 5.0272e-09, 1.5602e-08, 1.1063e-08,
         2.6136e-09, 2.8590e-10, 7.0333e-09, 6.2122e-11, 2.9336e-10, 3.5644e-09,
         1.2309e-09, 7.0098e-08, 5.5353e-09, 8.9705e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.5358e-08, 9.0656e-10, 1.0112e-10, 5.1129e-09, 7.4410e-09, 6.2415e-08,
         2.8369e-09, 5.6221e-10, 8.0234e-09, 4.6745e-10, 5.6721e-10, 1.3462e-09,
         1.9652e-09, 8.0091e-09, 6.9666e-09, 9.2330e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.1784e-08, 8.7879e-09, 8.6209e-10, 9.5527e-08, 5.6275e-08, 1.5610e-07,
        8.0390e-08, 7.6322e-09, 2.2011e-08, 5.3267e-09, 7.7592e-10, 2.0494e-08,
        2.0891e-07, 6.1263e-08, 7.7146e-08, 7.2739e-07], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.177721
summ of probs approach
id: [92000] -> tensor([[7.7461e-09, 5.4868e-09, 1.3693e-10, 2.6723e-09, 9.1700e-09, 3.9244e-09,
         2.6348e-08, 5.5358e-09, 3.0255e-09, 2.7142e-08, 2.8830e-09, 1.9879e-10,
         1.8374e-09, 1.2846e-08, 1.2571e-09, 5.2294e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.8869e-09, 8.6933e-10, 3.5221e-08, 2.2186e-09, 1.1642e-09, 3.7634e-09,
         5.5597e-08, 4.9712e-08, 1.9224e-09, 9.8502e-08, 1.1883e-09, 1.8820e-09,
         1.4794e-09, 7.0442e-08, 2.0385e-09, 2.6351e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.2820e-09, 1.2328e-08, 3.1382e-08, 4.3312e-08, 6.2474e-09, 1.3242e-07,
        4.6461e-07, 1.1702e-07, 1.1034e-07, 1.8995e-07, 9.5594e-09, 3.1369e-09,
        5.4591e-08, 1.2372e-06, 6.2055e-08, 8.1108e-09], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.151959
summ of probs approach
id: [92000] -> tensor([[2.1517e-08, 6.3660e-09, 1.9134e-12, 9.5977e-08, 1.9514e-09, 1.0358e-09,
         4.2079e-09, 3.4664e-10, 2.9212e-08, 4.1764e-08, 1.0056e-09, 2.6545e-07,
         2.8165e-08, 3.1574e-10, 1.0919e-09, 1.4500e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.1476e-08, 1.4124e-08, 4.0996e-11, 4.3643e-08, 4.8212e-09, 8.1028e-09,
         5.0910e-08, 1.2580e-08, 1.0722e-08, 5.3935e-08, 2.5033e-09, 1.8417e-07,
         5.1309e-08, 8.2759e-09, 2.1494e-08, 3.5665e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.7585e-07, 8.6835e-08, 8.7661e-10, 1.7448e-07, 6.5357e-08, 5.1327e-08,
        6.6862e-08, 2.1352e-08, 3.3960e-07, 2.1965e-07, 1.5831e-08, 3.6015e-07,
        5.5232e-07, 2.3206e-08, 6.6725e-08, 2.1042e-07], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.135484
summ of probs approach
id: [92000] -> tensor([[7.1413e-10, 3.0714e-09, 1.0655e-07, 3.0446e-09, 1.4280e-09, 8.5080e-09,
         3.4050e-11, 6.1917e-09, 8.0177e-09, 1.7310e-10, 1.7243e-08, 4.1543e-08,
         1.1146e-11, 4.2475e-09, 4.1102e-10, 3.1043e-11]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[8.8848e-10, 4.8411e-09, 1.7254e-07, 1.0740e-08, 1.5620e-08, 3.2084e-09,
         8.7169e-10, 1.4262e-09, 4.4545e-09, 6.3089e-10, 5.7150e-08, 1.0756e-08,
         1.9412e-10, 4.1682e-09, 4.9389e-10, 2.4649e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.7939e-08, 7.0937e-08, 8.4976e-07, 6.7289e-08, 4.4823e-08, 2.5828e-08,
        3.2825e-08, 1.2938e-08, 1.2213e-08, 3.3872e-08, 9.5598e-08, 2.8535e-08,
        1.0315e-09, 5.9183e-08, 3.2506e-09, 4.1987e-08], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.206259
summ of probs approach
id: [92000] -> tensor([[2.7298e-08, 2.9418e-10, 3.5918e-08, 3.5492e-07, 1.3633e-08, 5.9020e-09,
         4.9365e-10, 2.0694e-09, 1.8890e-08, 1.1250e-08, 1.8033e-08, 1.4336e-11,
         1.7634e-09, 5.1708e-10, 4.2751e-09, 5.7994e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.8879e-08, 2.1261e-09, 1.3895e-08, 4.4731e-08, 1.2171e-08, 1.3462e-09,
         1.9854e-09, 1.7469e-09, 3.9852e-08, 2.1003e-08, 1.5058e-08, 1.1499e-09,
         1.7718e-08, 4.6068e-09, 8.3384e-10, 5.3254e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.0265e-07, 2.8111e-08, 1.3370e-07, 1.6087e-07, 5.7348e-08, 1.4718e-08,
        1.7429e-08, 6.7564e-08, 6.2197e-07, 1.4362e-07, 1.8406e-07, 5.4829e-09,
        5.4787e-08, 1.6098e-08, 9.4938e-10, 2.6171e-08], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.135066
summ of probs approach
id: [92000] -> tensor([[1.1801e-09, 1.5754e-10, 1.7314e-09, 2.0815e-08, 2.0756e-09, 2.3412e-09]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [25490] -> tensor([[4.5996e-09, 1.2685e-09, 1.1788e-08, 5.0192e-08, 3.1522e-10, 8.4964e-10]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([7.1923e-08, 2.8933e-08, 2.9128e-07, 4.5513e-09, 1.8542e-09, 1.0649e-08],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.080124
acc:  0.36363636363636365
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.192555
path ['42', 'fr', 'bloomz', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [407, 23, 1], 'attention_mask': [1, 1, 1]}
id:[407, 23, 1]
answer  {'input_ids': [529, 1], 'attention_mask': [1, 1]}
id: [529, 1] -> [529]
answer  {'input_ids': [1351, 18, 2680, 1], 'attention_mask': [1, 1, 1, 1]}
id:[1351, 18, 2680, 1]
load model Duration: 0:00:03.024554
prompt_type null has 1 prompts in it
----------- 42 fr google/flan-t5-base NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([2.6610e-03, 1.0322e-03, 3.2039e-03, 2.6659e-03, 1.4178e-03, 2.4120e-03,
        3.4484e-03, 1.4347e-02, 1.3574e-03, 3.7675e-03, 4.9936e-03, 1.8535e-04,
        3.9752e-03, 7.7218e-04, 2.7273e-02, 9.9592e-01], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[6.5817e-05, 6.4787e-06, 9.4213e-06, 9.8454e-04, 1.7183e-04, 3.3924e-05,
         1.4074e-04, 3.1962e-04, 1.0074e-05, 4.1733e-05, 1.9095e-05, 3.8607e-06,
         3.7669e-04, 2.2170e-05, 1.8677e-04, 5.9156e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.5141e-03, 1.0300e-03, 3.1939e-03, 2.0923e-03, 1.2964e-03, 2.1318e-03,
        2.4806e-03, 1.0987e-02, 1.2398e-03, 3.5768e-03, 4.3513e-03, 6.4118e-05,
        1.7162e-04, 7.2944e-04, 2.7262e-02, 9.9592e-01], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.168198
summ of probs approach
probs_ shape tensor([6.8093e-04, 9.8941e-01, 9.3189e-04, 3.0397e-03, 7.6392e-04, 9.6128e-04,
        6.4688e-03, 2.6211e-03, 3.2088e-03, 7.4965e-04, 7.2198e-05, 1.8011e-03,
        6.2059e-05, 2.1673e-03, 2.0956e-03, 7.0324e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.8335e-05, 2.7662e-07, 8.7306e-05, 9.6966e-05, 2.9161e-04, 6.9719e-05,
         1.0053e-04, 7.3788e-04, 2.5170e-04, 2.3685e-05, 6.9914e-06, 8.7313e-06,
         3.9593e-06, 6.3319e-05, 2.8390e-05, 3.2270e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.4550e-04, 9.8944e-01, 5.3445e-04, 2.6632e-03, 4.5382e-04, 3.6020e-04,
        1.3050e-03, 2.5834e-03, 1.8324e-03, 5.4039e-04, 7.1377e-05, 2.2198e-04,
        6.2564e-05, 1.4418e-03, 2.0435e-03, 5.8161e-03], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.133513
summ of probs approach
probs_ shape tensor([2.7825e-04, 7.3614e-04, 5.2808e-04, 9.2905e-04, 1.5324e-03, 1.2719e-03,
        6.9123e-03, 5.9519e-04, 3.6075e-03, 2.6360e-03, 9.9788e-01, 2.9678e-04,
        3.0696e-03, 2.0529e-03, 4.8931e-04, 6.0768e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[8.6214e-06, 2.3829e-06, 2.3132e-04, 1.5740e-04, 3.2604e-05, 3.7938e-05,
         5.7520e-05, 2.0792e-06, 4.7518e-04, 2.6133e-06, 4.9006e-07, 1.4524e-05,
         4.9777e-04, 1.4886e-04, 3.2711e-06, 4.4041e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6661e-04, 7.1903e-04, 1.8440e-04, 9.1953e-04, 6.2439e-04, 5.5991e-04,
        5.1384e-03, 5.7162e-04, 3.5254e-03, 2.5081e-03, 9.9788e-01, 1.5116e-04,
        1.6295e-03, 1.9281e-03, 4.8327e-04, 5.7058e-03], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.112592
summ of probs approach
probs_ shape tensor([2.6745e-03, 1.2722e-03, 9.6676e-03, 6.3936e-03, 1.0158e-03, 8.6222e-04,
        2.7345e-03, 4.6005e-03, 3.7237e-03, 9.7695e-01, 1.1232e-03, 7.8059e-04,
        1.1976e-03, 3.1415e-03, 9.3669e-04, 3.8473e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[4.3334e-06, 8.8642e-04, 2.5048e-04, 5.2040e-05, 2.0641e-06, 8.5275e-05,
         2.3302e-04, 1.5288e-03, 2.9803e-05, 1.2642e-07, 6.5465e-05, 3.1020e-06,
         8.3547e-06, 8.0615e-04, 1.1541e-05, 1.1268e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6497e-03, 1.2162e-03, 3.1121e-03, 1.9858e-04, 1.0144e-03, 8.8655e-04,
        2.4215e-03, 1.0704e-03, 3.2331e-03, 9.7698e-01, 5.6588e-04, 7.2571e-04,
        1.1837e-03, 2.7941e-03, 8.7806e-04, 3.5275e-04], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.138562
summ of probs approach
probs_ shape tensor([2.2057e-03, 9.9455e-01, 9.1507e-04, 3.1141e-03, 3.8686e-03, 2.1228e-03,
        4.0267e-03, 2.3327e-03, 1.9329e-03, 3.3181e-03, 2.1501e-03, 4.2641e-03,
        7.0646e-03, 5.3167e-03, 4.0722e-03, 2.0019e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[6.4927e-04, 2.6683e-07, 2.6656e-05, 2.5693e-05, 4.3484e-06, 2.3452e-05,
         2.5620e-04, 1.5326e-05, 2.3113e-05, 1.8431e-05, 8.8572e-06, 8.2532e-06,
         5.3656e-04, 9.0726e-06, 2.9990e-05, 1.8377e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.9640e-03, 9.9455e-01, 3.6182e-04, 2.7772e-03, 3.7434e-03, 1.2771e-03,
        3.9773e-03, 2.2389e-03, 1.3199e-03, 3.3030e-03, 2.0769e-03, 4.2515e-03,
        6.1134e-03, 4.6450e-03, 4.0545e-03, 8.8052e-04], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.123922
summ of probs approach
probs_ shape tensor([3.5407e-03, 6.7890e-04, 3.0050e-04, 3.6932e-04, 9.9316e-01, 3.0074e-03,
        2.8175e-03, 1.6415e-03, 2.2752e-03, 1.2956e-03, 1.4978e-03, 2.5222e-03,
        2.1224e-03, 1.2535e-03, 5.8530e-03, 3.7613e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.3585e-04, 4.0040e-05, 1.1665e-06, 5.2157e-04, 6.8462e-07, 2.9690e-05,
         6.1521e-05, 4.1988e-06, 4.0130e-05, 6.5714e-04, 6.8209e-07, 2.9485e-05,
         5.5633e-06, 4.4766e-05, 4.6118e-06, 2.0289e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.4644e-03, 5.4200e-04, 8.0395e-05, 2.0791e-04, 9.9316e-01, 2.8912e-03,
        3.0448e-04, 4.7277e-04, 1.8097e-04, 1.3551e-03, 3.8858e-04, 2.4523e-03,
        2.1139e-03, 1.2068e-03, 5.8631e-03, 2.7170e-04], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.116363
summ of probs approach
probs_ shape tensor([5.1731e-03, 4.5231e-03, 1.3514e-03, 2.1481e-03, 1.5002e-02, 1.1632e-03,
        9.7122e-04, 1.4167e-02, 1.4999e-03, 5.3614e-03, 1.8633e-03, 2.4207e-03,
        9.9877e-01, 8.4328e-03, 1.7628e-03, 8.3374e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.4042e-05, 1.5079e-04, 2.3257e-05, 5.5075e-05, 1.4499e-03, 1.5144e-04,
         5.6940e-05, 9.5313e-05, 4.8416e-06, 1.1762e-04, 9.9855e-05, 1.2228e-04,
         2.9707e-07, 7.7523e-04, 4.4760e-05, 7.5741e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.1433e-04, 4.2072e-03, 1.1072e-03, 2.0331e-03, 1.2698e-02, 7.1188e-04,
        7.1515e-04, 9.0537e-03, 1.4439e-03, 5.2003e-03, 1.4763e-03, 2.0761e-03,
        9.9876e-01, 5.5991e-03, 1.1867e-03, 7.6438e-04], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.111229
summ of probs approach
probs_ shape tensor([8.1162e-03, 7.2276e-04, 1.9237e-03, 5.0190e-04, 9.9468e-01, 3.5800e-04,
        3.1138e-03, 2.9383e-03, 4.3033e-03, 2.8675e-03, 1.2740e-02, 9.3045e-03,
        1.6213e-02, 1.1748e-02, 2.4499e-04, 7.8488e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.0101e-05, 1.5210e-05, 5.1468e-06, 1.1763e-05, 2.1570e-06, 9.5281e-06,
         1.3197e-04, 1.0388e-04, 2.1309e-05, 1.2167e-04, 1.9012e-05, 1.8657e-06,
         6.7071e-05, 8.6798e-05, 7.7852e-06, 1.5579e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.0595e-03, 7.1615e-04, 1.9163e-03, 4.4756e-04, 9.9467e-01, 1.5454e-04,
        3.1628e-03, 2.8752e-03, 4.2676e-03, 1.0190e-03, 1.2732e-02, 9.3045e-03,
        1.6351e-02, 1.1741e-02, 2.4238e-04, 7.6663e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.109558
summ of probs approach
probs_ shape tensor([1.5165e-03, 6.2807e-04, 3.2292e-03, 7.2237e-04, 2.1129e-02, 4.9861e-04,
        9.9867e-01, 9.4295e-03, 9.3542e-03, 6.2260e-03, 2.2771e-03, 2.0969e-03,
        5.9235e-03, 9.8320e-03, 3.3573e-03, 6.7797e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[6.0217e-05, 3.3916e-04, 3.2555e-03, 1.5510e-05, 1.3047e-03, 1.5770e-05,
         9.8017e-07, 9.8400e-05, 5.9974e-05, 3.1006e-03, 2.1323e-05, 2.8055e-04,
         7.0377e-05, 7.4764e-07, 5.2943e-05, 4.7833e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.9550e-04, 4.4946e-04, 1.7772e-03, 4.9032e-04, 1.7941e-02, 4.8899e-04,
        9.9866e-01, 9.3798e-03, 9.2172e-03, 5.4729e-03, 2.1040e-03, 6.6341e-04,
        5.7659e-03, 9.8323e-03, 3.3294e-03, 5.6061e-03], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.080175
summ of probs approach
probs_ shape tensor([1.3168e-03, 1.4994e-02, 4.5281e-03, 1.1104e-03, 1.5523e-03, 1.1944e-02,
        5.8337e-03, 2.9391e-03, 1.2560e-03, 1.2404e-03, 9.1516e-05, 9.9617e-01,
        1.1019e-03, 1.0718e-02, 1.9783e-03, 2.7171e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.6641e-05, 1.5117e-05, 8.6532e-04, 1.1493e-05, 4.1127e-06, 6.2879e-05,
         5.4456e-04, 8.1061e-05, 4.9438e-06, 6.5628e-06, 3.1939e-06, 2.2814e-06,
         1.6924e-04, 3.0378e-04, 2.5417e-04, 4.6715e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1731e-03, 1.4853e-02, 4.6139e-03, 9.0888e-04, 1.1907e-03, 5.2688e-03,
        2.7573e-03, 2.6169e-04, 1.1719e-03, 1.0125e-03, 8.3336e-05, 9.9615e-01,
        8.3545e-04, 2.6044e-03, 1.8841e-03, 1.4945e-03], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.114820
summ of probs approach
probs_ shape tensor([3.2106e-04, 7.7716e-04, 3.6422e-03, 3.0022e-03, 4.3741e-03, 6.6514e-03,
        3.2021e-03, 1.3219e-03, 9.9535e-01, 2.2342e-03, 1.2811e-03, 5.7953e-02,
        8.6483e-03, 1.4246e-03, 2.7841e-03, 1.7348e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[4.7473e-06, 6.7604e-06, 7.8642e-06, 3.1554e-05, 5.6135e-04, 2.8533e-05,
         1.8024e-05, 2.5251e-04, 4.6959e-06, 7.9477e-05, 3.3862e-05, 4.0435e-04,
         8.9906e-05, 1.3833e-04, 3.7212e-05, 5.7278e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.2282e-04, 4.2779e-04, 3.4524e-03, 2.5453e-03, 4.2056e-03, 6.6382e-03,
        2.9019e-03, 3.2650e-04, 9.9535e-01, 2.1453e-03, 1.1483e-03, 5.7962e-02,
        8.5337e-03, 8.7192e-04, 2.7021e-03, 7.8375e-04], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.240210
summ of probs approach
probs_ shape tensor([8.6895e-04, 3.6894e-03, 2.9643e-03, 1.6789e-03, 1.5603e-03, 8.0805e-03,
        3.8740e-03, 5.3371e-03, 8.3837e-03, 1.5200e-03, 2.2382e-03, 9.9261e-01,
        1.6412e-02, 1.2330e-03, 1.0893e-02, 8.1934e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.9433e-04, 2.0686e-06, 7.1031e-06, 4.7324e-06, 1.6228e-04, 2.7057e-06,
         7.6164e-06, 2.5509e-05, 1.4832e-05, 2.4286e-04, 1.7291e-03, 1.9824e-07,
         1.4629e-05, 5.3484e-05, 7.6108e-05, 4.8643e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.5056e-04, 3.7161e-03, 7.6631e-04, 1.6722e-03, 9.4729e-04, 4.2176e-03,
        2.6504e-04, 1.5380e-03, 8.3334e-03, 5.2226e-04, 1.7482e-03, 9.9261e-01,
        1.5623e-02, 6.0762e-04, 2.8335e-03, 7.8094e-03], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.120842
summ of probs approach
probs_ shape tensor([9.9502e-01, 8.3631e-03, 7.1506e-04, 1.7719e-01, 4.8689e-03, 1.4238e-02],
       device='cuda:0') torch.Size([6])
summ of probs approach
id: [529] -> tensor([[1.1353e-06, 2.8312e-05, 9.7050e-05, 3.2091e-05, 9.0557e-06, 2.1219e-04]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([9.9503e-01, 8.2873e-03, 4.1731e-04, 1.7724e-01, 3.9787e-03, 5.9843e-03],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.043664
acc:  0.3333333333333333
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.658640
path ['42', 'fr', 'flan', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  5.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.56s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 2123, 29875], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id:[1, 2123, 29875]
answer  {'input_ids': [1, 1661], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 1661] -> [1661]
answer  {'input_ids': [1, 8164, 29899, 5474], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id:[1, 8164, 29899, 5474]
load model Duration: 0:02:35.308517
prompt_type null has 1 prompts in it
----------- 42 fr huggyllama/llama-7b NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([1.6093e-04, 2.6882e-05, 1.1241e-04, 7.7248e-04, 7.8380e-05, 2.8968e-05,
        1.2159e-05, 5.0604e-05, 2.9802e-05, 8.2397e-04, 7.2122e-06, 2.9922e-05,
        3.3879e-04, 1.2064e-03, 1.0043e-04, 5.7817e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.2948e-05, 3.3379e-06, 8.5831e-06, 6.5207e-05, 6.0201e-06, 5.3644e-07,
         9.5367e-07, 3.5763e-07, 3.4571e-06, 7.0870e-05, 1.9670e-06, 5.1260e-06,
         3.2246e-05, 7.2718e-05, 3.1710e-05, 1.6093e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.9945e-04, 6.8843e-05, 1.0765e-04, 7.9489e-04, 5.4741e-04, 2.9635e-04,
        3.8266e-05, 5.1677e-05, 4.6849e-05, 1.0481e-03, 1.0252e-05, 1.9050e-04,
        4.1723e-04, 2.1038e-03, 1.1075e-04, 2.2829e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.414170
summ of probs approach
probs_ shape tensor([1.3697e-04, 4.3094e-05, 2.9922e-05, 2.4629e-04, 6.8307e-05, 3.4189e-04,
        6.9380e-05, 1.0389e-04, 9.3699e-05, 2.2411e-05, 1.0192e-05, 1.2398e-04,
        8.0490e-04, 1.4734e-04, 2.4071e-03, 8.5878e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.0669e-05, 1.2338e-05, 6.5565e-07, 9.6977e-05, 8.2850e-06, 4.2975e-05,
         1.3828e-05, 7.0333e-06, 9.8944e-06, 1.0133e-06, 7.2718e-06, 5.7220e-05,
         3.5882e-05, 4.0352e-05, 4.8018e-04, 1.1927e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.7268e-04, 4.3035e-05, 8.5652e-05, 2.7704e-04, 4.3154e-05, 6.1131e-04,
        1.3864e-04, 1.5974e-04, 1.2803e-04, 8.5533e-05, 5.4717e-05, 5.9223e-04,
        1.6632e-03, 1.3423e-04, 1.2255e-03, 3.4666e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.354384
summ of probs approach
probs_ shape tensor([1.3590e-04, 2.6643e-05, 5.8949e-05, 4.6134e-05, 6.4075e-05, 5.2094e-05,
        3.5191e-04, 7.1526e-06, 5.0259e-04, 6.3241e-05, 3.2485e-05, 1.0133e-04,
        2.4736e-05, 7.8738e-05, 1.0645e-04, 1.4842e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.5140e-05, 3.5763e-07, 1.6451e-05, 9.3579e-06, 3.6359e-06, 2.7418e-06,
         6.4075e-05, 1.1325e-06, 2.7061e-05, 4.4107e-06, 3.0935e-05, 8.9407e-07,
         2.2054e-06, 4.5896e-06, 1.1921e-06, 1.7881e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.7251e-04, 1.5593e-04, 1.6928e-04, 1.1331e-04, 9.7454e-05, 8.5831e-06,
        2.1756e-04, 7.8380e-05, 1.6146e-03, 7.1406e-05, 1.8084e-04, 1.2565e-04,
        1.3065e-04, 1.3638e-04, 1.2660e-04, 1.8001e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.328020
summ of probs approach
probs_ shape tensor([2.5940e-04, 1.4591e-03, 1.9193e-05, 1.9932e-04, 1.4186e-05, 2.9862e-05,
        1.1671e-04, 5.9843e-04, 3.7670e-05, 8.2314e-05, 2.3627e-04, 1.6034e-05,
        1.1677e-04, 2.3782e-05, 1.2970e-02, 3.0041e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[7.6890e-06, 4.9067e-04, 1.6093e-06, 3.9101e-05, 5.9605e-07, 3.2187e-06,
         8.2254e-06, 4.7684e-05, 2.1458e-06, 1.3173e-05, 1.5259e-05, 4.1723e-07,
         4.2915e-06, 1.0133e-06, 1.9312e-05, 9.4771e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2898e-04, 1.1795e-02, 3.0577e-05, 1.6117e-04, 4.1842e-05, 2.9504e-05,
        1.8620e-04, 9.3985e-04, 2.2829e-05, 1.6272e-04, 3.6240e-04, 8.0049e-05,
        1.9360e-04, 5.9426e-05, 2.8900e-02, 8.1956e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.356197
summ of probs approach
probs_ shape tensor([5.1260e-05, 6.8128e-05, 1.1927e-04, 2.8968e-05, 1.7977e-04, 1.1796e-04,
        1.3804e-04, 9.9242e-05, 8.2254e-06, 5.9128e-05, 2.1100e-05, 2.4819e-04,
        8.3208e-05, 3.0935e-05, 4.0865e-04, 4.8399e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.9206e-06, 4.3511e-06, 5.5432e-06, 1.1325e-06, 2.0564e-05, 4.0770e-05,
         1.8358e-05, 1.2159e-05, 2.3842e-07, 1.9073e-06, 5.3644e-07, 4.0293e-05,
         8.5831e-06, 1.9670e-06, 5.3763e-05, 1.0610e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.3419e-05, 1.8001e-05, 2.6798e-04, 1.4758e-04, 8.2874e-04, 1.7107e-04,
        9.0837e-05, 4.6539e-04, 1.4961e-05, 1.3065e-04, 4.5180e-05, 9.9564e-04,
        1.1253e-03, 9.9242e-05, 1.6451e-04, 1.7035e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.349170
summ of probs approach
probs_ shape tensor([2.3782e-05, 2.1505e-04, 9.1195e-06, 8.1956e-05, 4.3273e-05, 2.9087e-05,
        5.1379e-05, 9.2387e-05, 9.7275e-05, 1.3769e-04, 2.2049e-03, 8.0919e-04,
        2.1935e-05, 9.0003e-06, 4.9055e-05, 2.0051e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.2650e-06, 4.8935e-05, 3.5763e-07, 2.3484e-05, 4.0710e-05, 3.7551e-06,
         1.5497e-06, 2.7657e-05, 8.4043e-06, 3.0100e-05, 6.9141e-05, 1.8895e-05,
         3.5167e-06, 1.6093e-06, 1.2279e-05, 5.4240e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2875e-05, 6.4373e-04, 3.8266e-04, 9.8526e-05, 1.3590e-04, 5.7518e-05,
        3.1257e-04, 3.1018e-04, 1.1802e-04, 2.2745e-04, 7.4348e-03, 1.8144e-04,
        5.3406e-05, 1.0312e-05, 1.1075e-04, 3.2723e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.326438
summ of probs approach
probs_ shape tensor([1.0049e-04, 1.4722e-05, 3.0637e-04, 4.2617e-05, 3.1292e-05, 2.0385e-04,
        1.1683e-04, 2.3186e-05, 3.6895e-05, 1.7762e-04, 1.7762e-05, 5.7578e-05,
        3.3259e-05, 4.4107e-05, 9.1672e-05, 9.9003e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.6212e-05, 1.5497e-06, 3.8624e-05, 4.2319e-06, 2.9802e-07, 4.4882e-05,
         8.2254e-06, 1.0729e-06, 1.0669e-05, 7.5042e-05, 1.8477e-06, 8.7619e-06,
         3.6359e-06, 1.4305e-06, 1.2100e-05, 6.0797e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.2697e-04, 4.3392e-05, 6.0701e-04, 4.4107e-05, 1.2636e-05, 1.6737e-04,
        4.4465e-04, 3.6299e-05, 5.7650e-04, 1.4353e-04, 2.6286e-05, 1.1700e-04,
        2.3663e-05, 1.5426e-04, 6.1369e-04, 2.0003e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.432398
summ of probs approach
probs_ shape tensor([3.1114e-04, 8.1599e-05, 1.0157e-04, 1.7083e-04, 4.7827e-04, 1.3590e-05,
        4.3333e-05, 2.5451e-05, 4.8995e-05, 4.1068e-05, 6.7353e-05, 1.2279e-05,
        2.3663e-05, 7.0810e-05, 1.9431e-05, 2.9325e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.6034e-05, 2.6226e-06, 7.9274e-06, 7.5102e-06, 3.7551e-06, 5.3644e-07,
         7.0930e-06, 5.3644e-07, 6.7353e-06, 5.6028e-06, 1.4722e-05, 3.0994e-06,
         1.7285e-06, 6.1393e-06, 3.6359e-06, 5.9605e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.7445e-04, 1.5140e-04, 3.0231e-04, 3.0303e-04, 3.7432e-05, 1.4174e-04,
        9.7811e-05, 3.4809e-05, 1.3626e-04, 8.8036e-05, 1.4603e-04, 1.6177e-04,
        7.0572e-05, 1.0290e-03, 3.8326e-05, 2.9743e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.423231
summ of probs approach
probs_ shape tensor([1.7929e-04, 6.6221e-05, 1.5259e-05, 4.0984e-04, 1.5438e-05, 1.1086e-05,
        4.1842e-05, 1.3351e-04, 2.8968e-05, 5.0426e-05, 5.1975e-05, 3.4332e-05,
        2.3508e-04, 9.3818e-05, 7.0870e-05, 6.3360e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[3.6299e-05, 6.0797e-06, 2.0862e-06, 6.0201e-05, 2.2054e-06, 8.3447e-07,
         3.9935e-06, 2.1279e-05, 8.1658e-06, 2.5630e-06, 5.9605e-07, 4.5896e-06,
         2.0504e-05, 1.4305e-06, 8.4043e-06, 1.7285e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.8685e-04, 1.5664e-04, 2.6703e-05, 2.5463e-04, 5.2214e-05, 6.7353e-06,
        1.1384e-04, 8.4341e-05, 6.1035e-05, 2.8074e-05, 4.1485e-05, 5.2571e-05,
        6.7568e-04, 5.8830e-05, 1.0514e-04, 8.3745e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.351691
summ of probs approach
probs_ shape tensor([7.1585e-05, 3.2711e-03, 4.7743e-05, 2.1279e-05, 5.0497e-04, 3.2783e-05,
        4.3094e-05, 4.1485e-05, 1.6141e-04, 6.3419e-04, 1.6689e-04, 2.5332e-05,
        2.5749e-05, 5.6744e-05, 5.8532e-05, 5.0116e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[5.3644e-07, 3.3438e-05, 1.0729e-06, 3.6359e-06, 3.9458e-05, 2.3246e-06,
         1.4901e-06, 7.1526e-07, 1.9670e-06, 1.0663e-04, 1.4007e-05, 2.3246e-06,
         5.9605e-07, 4.0531e-06, 1.1504e-05, 2.4140e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.4056e-05, 4.9686e-04, 5.9068e-05, 5.8889e-05, 1.2722e-03, 2.9945e-04,
        3.8803e-05, 1.5056e-04, 1.7357e-04, 1.0443e-03, 1.0717e-04, 2.7478e-05,
        2.3365e-05, 7.9632e-05, 1.7297e-04, 9.3746e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.721150
summ of probs approach
probs_ shape tensor([1.0312e-05, 2.5630e-05, 4.4763e-05, 3.5763e-05, 1.2034e-04, 4.6611e-05,
        6.5565e-05, 2.7239e-05, 3.0518e-05, 3.7050e-04, 3.8862e-05, 3.9577e-05,
        1.8430e-04, 1.3125e-04, 3.9399e-05, 7.5245e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[6.5565e-07, 3.8147e-06, 2.3842e-06, 4.7088e-06, 3.6359e-06, 2.5630e-06,
         4.8280e-06, 1.7822e-05, 8.3447e-07, 1.6510e-05, 6.0201e-06, 6.2585e-06,
         2.3007e-05, 1.2815e-05, 6.7949e-06, 9.0063e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.5552e-05, 1.8883e-04, 7.7069e-05, 3.8683e-05, 1.6904e-04, 4.0054e-05,
        3.1590e-05, 5.5969e-05, 3.7253e-05, 1.0711e-04, 6.8069e-05, 4.2200e-05,
        3.4094e-04, 1.9860e-04, 7.9989e-05, 7.9441e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.361821
summ of probs approach
probs_ shape tensor([3.7849e-05, 2.9445e-05, 7.0989e-05, 2.2531e-05, 6.5267e-05, 1.7405e-04,
        2.8491e-04, 6.0022e-05, 4.0889e-05, 2.3663e-05, 1.1092e-04, 8.8394e-05,
        7.5150e-04, 1.0490e-05, 1.2636e-05, 6.1095e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.3709e-06, 2.0266e-06, 1.1325e-05, 3.6955e-06, 5.7817e-06, 4.6313e-05,
         2.4796e-05, 1.2338e-05, 6.7949e-06, 5.9605e-07, 4.5896e-06, 2.0742e-05,
         1.6093e-06, 1.0133e-06, 4.1723e-07, 6.1393e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.3268e-05, 5.6839e-04, 1.6332e-04, 6.5148e-05, 1.0216e-04, 1.3471e-04,
        6.7282e-04, 5.9068e-05, 7.6950e-05, 2.2411e-05, 1.5545e-03, 2.1160e-04,
        1.0645e-04, 2.8753e-04, 5.5373e-05, 1.8430e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.417573
summ of probs approach
probs_ shape tensor([1.4534e-03, 6.5386e-05, 9.8407e-05, 4.2737e-05, 8.6010e-05, 5.1928e-04],
       device='cuda:0', dtype=torch.float16) torch.Size([6])
summ of probs approach
id: [1661] -> tensor([[1.0806e-04, 6.4969e-06, 3.4392e-05, 1.1921e-06, 9.1195e-06, 3.6001e-05]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([0.0010, 0.0002, 0.0002, 0.0015, 0.0002, 0.0008], device='cuda:0',
       dtype=torch.float16) torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.127885
acc:  0.3383838383838384
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:05.003461
path ['42', 'fr', 'llama', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1032, 266, 1], 'attention_mask': [1, 1, 1]}
id:[1032, 266, 1]
answer  {'input_ids': [935, 1], 'attention_mask': [1, 1]}
id:[935, 1]
answer  {'input_ids': [259, 5926, 264, 3381, 1], 'attention_mask': [1, 1, 1, 1, 1]}
id:[259, 5926, 264, 3381, 1]
load model Duration: 0:00:06.221584
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/mt0-small NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([2.0708e-04, 6.6944e-04, 2.3274e-03, 1.3520e-03, 1.2650e-04, 3.8868e-04,
        5.5181e-04, 1.5624e-04, 7.4163e-04, 2.2937e-03, 9.4939e-04, 9.2628e-01,
        3.4612e-03, 1.3798e-04, 4.3644e-04, 2.4437e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4800e-04, 5.2085e-04, 2.2715e-03, 1.0059e-03, 1.0949e-04, 5.7588e-04,
        4.3797e-04, 1.0809e-04, 7.3593e-04, 2.0329e-03, 9.7587e-04, 9.2628e-01,
        3.8684e-03, 1.3528e-04, 4.6088e-04, 5.0494e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0624, 0.0761, 0.1556, 0.1193, 0.0313, 0.0412, 0.1409, 0.0205, 0.1584,
        0.2906, 0.2442, 0.9868, 0.1769, 0.0419, 0.1177, 0.2021],
       device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.142794
summ of probs approach
probs_ shape tensor([1.0565e-04, 1.3545e-03, 8.8694e-05, 1.7517e-04, 4.7568e-04, 5.4170e-04,
        1.6824e-04, 2.3044e-05, 3.9642e-04, 5.3943e-04, 8.2442e-04, 3.0098e-04,
        8.7887e-01, 1.6191e-03, 6.6378e-04, 7.4085e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.4714e-05, 1.1741e-03, 9.3166e-05, 1.1495e-04, 4.4046e-04, 5.2329e-04,
        2.0337e-04, 2.2226e-05, 8.3582e-04, 4.1523e-04, 1.1627e-03, 2.4714e-04,
        8.7886e-01, 1.4730e-03, 1.0155e-03, 6.8514e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0469, 0.4496, 0.0207, 0.8248, 0.0398, 0.5190, 0.0590, 0.0029, 0.0562,
        0.2002, 0.1716, 0.0800, 0.9080, 0.2092, 0.1448, 0.1560],
       device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.104874
summ of probs approach
probs_ shape tensor([7.3248e-01, 7.7535e-04, 1.5223e-04, 2.7131e-04, 1.2660e-04, 1.9353e-03,
        1.1059e-03, 1.5172e-03, 1.2219e-03, 1.9112e-04, 5.0731e-04, 3.1309e-04,
        4.5891e-04, 2.4025e-03, 3.1095e-04, 2.2861e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.3245e-01, 7.4814e-04, 2.3335e-04, 1.8697e-04, 1.1833e-04, 1.5873e-03,
        1.7248e-03, 1.4465e-03, 1.7759e-03, 1.7913e-04, 5.4017e-04, 3.9151e-04,
        3.0876e-04, 3.3850e-03, 2.7909e-04, 3.0119e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.7625, 0.3691, 0.0900, 0.0668, 0.0171, 0.4069, 0.1561, 0.1656, 0.1842,
        0.0448, 0.3028, 0.1063, 0.3025, 0.1091, 0.3282, 0.2035],
       device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.106221
summ of probs approach
probs_ shape tensor([6.7430e-04, 1.8165e-04, 3.9819e-04, 1.7857e-03, 6.9444e-03, 6.1317e-04,
        1.3850e-03, 2.7025e-05, 1.7812e-03, 9.6979e-01, 2.7121e-03, 6.2202e-04,
        2.6926e-04, 1.3091e-03, 2.5159e-04, 2.8117e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.1619e-04, 1.5619e-04, 3.3130e-04, 9.2235e-04, 6.9460e-03, 6.1613e-04,
        2.3535e-03, 1.8860e-05, 5.7584e-03, 9.6980e-01, 2.4562e-03, 7.2016e-04,
        2.7012e-04, 1.3097e-03, 2.4913e-04, 4.4803e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.2243, 0.0715, 0.2277, 0.2252, 0.4398, 0.1320, 0.1783, 0.0068, 0.1650,
        0.9748, 0.1194, 0.0910, 0.0022, 0.0879, 0.1969, 0.0510],
       device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.076605
summ of probs approach
probs_ shape tensor([3.3901e-03, 5.7509e-04, 1.0454e-03, 9.1344e-05, 3.1639e-04, 1.4764e-03,
        7.7543e-04, 1.1609e-03, 5.7934e-04, 6.1181e-04, 4.4404e-04, 9.2240e-04,
        1.6334e-03, 9.8899e-01, 1.8068e-03, 1.7122e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.3357e-03, 1.1670e-03, 1.0232e-03, 8.5267e-05, 2.8813e-04, 2.2642e-03,
        7.3975e-04, 5.2354e-04, 4.5795e-04, 5.9240e-04, 4.0546e-04, 8.3739e-04,
        2.8244e-03, 9.8899e-01, 1.4939e-03, 1.7001e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.5868, 0.2495, 0.0562, 0.0525, 0.1258, 0.0665, 0.3488, 0.2555, 0.2208,
        0.0272, 0.2956, 0.3063, 0.1001, 0.9959, 0.2728, 0.2323],
       device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.079324
summ of probs approach
probs_ shape tensor([6.8518e-04, 3.0993e-04, 4.4596e-04, 2.1686e-04, 5.2026e-04, 7.4987e-04,
        1.1187e-03, 1.4335e-04, 2.1894e-04, 9.7500e-01, 3.7375e-03, 2.5876e-03,
        1.2941e-04, 9.0104e-04, 7.4221e-04, 2.6395e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4336e-03, 3.6655e-04, 4.3052e-04, 2.4872e-04, 4.8399e-04, 6.2460e-04,
        1.2373e-03, 1.7168e-04, 2.1281e-04, 9.7500e-01, 1.6953e-02, 2.2757e-03,
        1.7545e-04, 1.9049e-03, 5.5978e-04, 2.0034e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1324, 0.1038, 0.1033, 0.0087, 0.0719, 0.1549, 0.1040, 0.1334, 0.3778,
        0.9809, 0.1851, 0.2913, 0.0660, 0.1904, 0.1185, 0.1498],
       device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.084400
summ of probs approach
probs_ shape tensor([1.7436e-03, 2.7289e-03, 1.3019e-03, 6.0052e-04, 4.5679e-04, 4.2827e-04,
        3.6118e-04, 4.8848e-05, 9.5715e-01, 2.8079e-04, 2.3325e-04, 1.0147e-03,
        9.8278e-04, 4.8040e-04, 6.4969e-03, 5.3831e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.8514e-03, 2.5307e-03, 1.5993e-03, 7.5394e-04, 8.4766e-04, 4.0108e-04,
        1.9014e-04, 7.3302e-05, 9.5714e-01, 3.0519e-04, 2.1598e-04, 1.1547e-03,
        9.1682e-04, 4.1455e-04, 4.5859e-03, 9.7866e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.2869, 0.1713, 0.1232, 0.0936, 0.1058, 0.1698, 0.0907, 0.0589, 0.9691,
        0.0599, 0.0720, 0.1949, 0.0841, 0.1408, 0.1058, 0.2126],
       device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.089675
summ of probs approach
probs_ shape tensor([0.0007, 0.0006, 0.0009, 0.0022, 0.0008, 0.0004, 0.0018, 0.0014, 0.0011,
        0.0026, 0.0005, 0.0001, 0.0002, 0.0018, 0.0026, 0.0015],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0005, 0.0006, 0.0004, 0.0015, 0.0005, 0.0006, 0.0017, 0.0013, 0.0011,
        0.0024, 0.0005, 0.0004, 0.0002, 0.0019, 0.0025, 0.0014],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1003, 0.0839, 0.1027, 0.9072, 0.1087, 0.0652, 0.2158, 0.1352, 0.1912,
        0.2701, 0.0558, 0.0316, 0.0543, 0.3763, 0.1294, 0.1503],
       device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.074482
summ of probs approach
probs_ shape tensor([3.0518e-04, 9.5651e-04, 1.7201e-04, 9.9502e-04, 5.5670e-04, 1.5527e-03,
        2.8444e-04, 8.8628e-04, 6.6207e-04, 1.1670e-03, 4.2562e-04, 4.0572e-03,
        9.8922e-01, 1.0424e-03, 8.4827e-04, 9.6548e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.4944e-04, 9.1602e-04, 1.6853e-04, 8.0158e-04, 5.8694e-04, 2.5459e-03,
        2.9780e-04, 1.4694e-03, 6.9913e-04, 2.4480e-03, 5.4372e-04, 4.0626e-03,
        9.8920e-01, 1.2239e-03, 4.8579e-04, 6.5241e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1470, 0.3036, 0.0842, 0.1518, 0.1231, 0.4932, 0.2192, 0.3701, 0.1086,
        0.4170, 0.0668, 0.2005, 0.9964, 0.0425, 0.4782, 0.2696],
       device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.088708
summ of probs approach
probs_ shape tensor([5.0791e-04, 4.1419e-04, 2.3043e-04, 6.7384e-04, 1.0829e-03, 6.6698e-04,
        1.0989e-03, 3.6083e-04, 6.9182e-04, 9.5450e-01, 9.6902e-04, 1.7223e-04,
        8.1566e-04, 4.3516e-04, 1.9749e-03, 4.2437e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.1744e-04, 2.5766e-03, 3.3874e-04, 4.7674e-04, 1.0440e-03, 9.8455e-04,
        1.3902e-03, 7.7367e-04, 6.7110e-04, 9.5450e-01, 1.0132e-03, 1.7519e-04,
        6.1737e-04, 5.3810e-04, 1.7673e-03, 3.0350e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0320, 0.0527, 0.0517, 0.2134, 0.2903, 0.0507, 0.2940, 0.1088, 0.0463,
        0.9701, 0.0567, 0.0816, 0.3010, 0.0469, 0.1522, 0.1436],
       device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.078692
summ of probs approach
probs_ shape tensor([8.1006e-04, 2.2622e-05, 2.5930e-03, 8.6054e-04, 5.2446e-04, 2.1273e-04,
        5.7197e-04, 1.3298e-04, 1.3036e-03, 2.8694e-04, 3.0262e-04, 3.2380e-04,
        3.7337e-04, 9.4813e-03, 4.7131e-04, 9.2034e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.9628e-04, 2.0494e-05, 2.6816e-03, 4.2048e-04, 1.2210e-03, 1.6412e-04,
        5.8341e-04, 1.0278e-04, 1.2332e-03, 5.8184e-04, 3.7191e-04, 1.7676e-03,
        2.8762e-04, 1.5256e-03, 6.0757e-04, 9.2033e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1183, 0.0067, 0.1675, 0.0905, 0.0223, 0.0596, 0.0799, 0.0219, 0.1516,
        0.0610, 0.0376, 0.1034, 0.0938, 0.1878, 0.0643, 0.9363],
       device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.114699
summ of probs approach
probs_ shape tensor([1.3866e-03, 1.5688e-03, 7.0871e-04, 6.6287e-04, 2.8100e-04, 3.5816e-03,
        7.4208e-04, 1.7460e-05, 9.3100e-04, 2.5114e-03, 3.6583e-04, 1.0587e-03,
        2.3110e-03, 2.1910e-04, 6.6169e-01, 9.0092e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4426e-03, 2.5091e-03, 7.3050e-04, 7.0153e-04, 2.5702e-04, 2.7104e-03,
        5.4289e-04, 1.5819e-05, 9.3650e-04, 4.5083e-03, 1.5746e-04, 9.1048e-04,
        3.4340e-03, 2.2666e-04, 6.6166e-01, 8.7714e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1352, 0.2842, 0.2165, 0.2017, 0.0557, 0.2135, 0.0854, 0.0142, 0.0705,
        0.1266, 0.1372, 0.3048, 0.3903, 0.1166, 0.7480, 0.1599],
       device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.224148
summ of probs approach
probs_ shape tensor([6.5731e-04, 6.6422e-04, 2.4801e-04, 8.3425e-01, 9.8295e-04, 1.1046e-03],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([6.7511e-04, 5.1900e-04, 2.6316e-04, 8.3425e-01, 6.0129e-04, 1.0208e-03],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([0.0953, 0.2226, 0.0763, 0.8917, 0.1458, 0.0764], device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.055653
acc:  0.3333333333333333
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.354997
path ['42', 'fr', 't0', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v56.pickle' as a pickle file.

****End Time: 2023-05-27 13:47:34.720586 Duration: 0:38:54.183205
