Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
----------- 42 en bigscience/bloom-560m SA active 0 10 2 --------------
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 332.98it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
{'review_body': 'Great movie ! Loved it !', 'stars': tensor(5)}
16446
19304
16446
16446
len dataset  32892
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 0
sample_id 1
Batch: 1 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 2 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 3 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 4 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
acc:  0.7
Time taken to execute the en SA task with prompt type active, variation 0 and batchsize 2: 0:03:16.131475
----------- 42 en bigscience/bloom-560m SA active 1 10 2 --------------
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 411.17it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
{'review_body': 'Great movie ! Loved it !', 'stars': tensor(5)}
16446
19304
16446
16446
len dataset  32892
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 0
sample_id 1
Batch: 1 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 2 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 3 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 4 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
acc:  0.6
Time taken to execute the en SA task with prompt type active, variation 1 and batchsize 2: 0:03:15.745580
----------- 42 en bigscience/bloom-560m SA passive 0 10 2 --------------
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 399.62it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
{'review_body': 'Great movie ! Loved it !', 'stars': tensor(5)}
16446
19304
16446
16446
len dataset  32892
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 0
sample_id 1
Batch: 1 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 2 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 3 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 4 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
acc:  0.6
Time taken to execute the en SA task with prompt type passive, variation 0 and batchsize 2: 0:03:14.733484
----------- 42 en bigscience/bloom-560m SA passive 1 10 2 --------------
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 363.89it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
MARC dataset loaded
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
{'review_body': 'Great movie ! Loved it !', 'stars': tensor(5)}
16446
19304
16446
16446
len dataset  32892
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 0
sample_id 1
Batch: 1 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 2 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 3 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
Batch: 4 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
sample_id 1
sample_id 1
acc:  0.7
Time taken to execute the en SA task with prompt type passive, variation 1 and batchsize 2: 0:03:14.423482
----------- 42 en bigscience/bloom-560m NLI active 0 10 2 --------------
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 185.06it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 1 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 2 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 3 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 4 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
acc:  0.4
Time taken to execute the en NLI task with prompt type active, variation 0 and batchsize 2: 0:00:01.218375
----------- 42 en bigscience/bloom-560m NLI active 1 10 2 --------------
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 453.86it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 1 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 2 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 3 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 4 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
acc:  0.3
Time taken to execute the en NLI task with prompt type active, variation 1 and batchsize 2: 0:00:01.466022
----------- 42 en bigscience/bloom-560m NLI passive 0 10 2 --------------
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 453.18it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 1 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 2 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 3 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 4 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
acc:  0.4
Time taken to execute the en NLI task with prompt type passive, variation 0 and batchsize 2: 0:00:01.161859
----------- 42 en bigscience/bloom-560m NLI passive 1 10 2 --------------
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 365.43it/s]
NLI dataset loaded
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 1 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 2 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 3 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
Batch: 4 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
acc:  0.4
Time taken to execute the en NLI task with prompt type passive, variation 1 and batchsize 2: 0:00:01.190812
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict.pickle' as a pickle file.
Traceback (most recent call last):
  File "/home/lcur1101/ATCS_group3/src/main.py", line 191, in <module>
    get_acc_plot()
  File "/home/lcur1101/ATCS_group3/src/visualize.py", line 112, in get_acc_plot
    batch = data['42']['en']['bloom']['SA']['active']['prompt_id_1']
KeyError: 'bloom'
srun: error: r33n6: task 0: Exited with exit code 1
