Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
model device: cuda:0
Model embedding layer vocab size: 250880
Tokenizer vocab size: 250680
----------- 42 en bigscience/bloom-560m SA active 0 10 2 --------------
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 293.07it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
{'review_body': 'Great movie ! Loved it !', 'stars': tensor(5)}
16446
19304
16446
16446
len dataset  32892
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
acc:  0.6
Time taken to execute the en SA task with prompt type active, variation 0 and batchsize 2: 0:03:14.897797
----------- 42 en bigscience/bloom-560m SA active 1 10 2 --------------
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 365.85it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
{'review_body': 'Great movie ! Loved it !', 'stars': tensor(5)}
16446
19304
16446
16446
len dataset  32892
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
acc:  0.6
Time taken to execute the en SA task with prompt type active, variation 1 and batchsize 2: 0:03:12.684994
----------- 42 en bigscience/bloom-560m SA passive 0 10 2 --------------
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 397.18it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
MARC dataset loaded
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
{'review_body': 'Great movie ! Loved it !', 'stars': tensor(5)}
16446
19304
16446
16446
len dataset  32892
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
acc:  0.6
Time taken to execute the en SA task with prompt type passive, variation 0 and batchsize 2: 0:03:12.454719
----------- 42 en bigscience/bloom-560m SA passive 1 10 2 --------------
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 375.80it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
MARC dataset loaded
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
{'review_body': 'Great movie ! Loved it !', 'stars': tensor(5)}
16446
19304
16446
16446
len dataset  32892
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
acc:  0.6
Time taken to execute the en SA task with prompt type passive, variation 1 and batchsize 2: 0:03:13.226928
----------- 42 en bigscience/bloom-560m NLI active 0 10 2 --------------
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:01,  1.80it/s]100%|██████████| 3/3 [00:00<00:00,  4.65it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
acc:  0.0
Time taken to execute the en NLI task with prompt type active, variation 0 and batchsize 2: 0:00:01.980388
----------- 42 en bigscience/bloom-560m NLI active 1 10 2 --------------
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 328.68it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
acc:  0.0
Time taken to execute the en NLI task with prompt type active, variation 1 and batchsize 2: 0:00:01.177627
----------- 42 en bigscience/bloom-560m NLI passive 0 10 2 --------------
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 449.66it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
NLI dataset loaded
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
acc:  0.0
Time taken to execute the en NLI task with prompt type passive, variation 0 and batchsize 2: 0:00:01.114522
----------- 42 en bigscience/bloom-560m NLI passive 1 10 2 --------------
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 462.98it/s]
NLI dataset loaded
len dataset  10
Batch: 0 , batch size: 2, sample_size: 10
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
acc:  0.0
Time taken to execute the en NLI task with prompt type passive, variation 1 and batchsize 2: 0:00:01.241563
Dictionary saved to 'saved_outputs/logits_dict.pickle' as a pickle file.
