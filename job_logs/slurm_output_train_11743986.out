/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:561: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
task  SA
self.device  cuda
/home/lcur1101/ATCS_group3/marc_data/dataset_fr_train.json
sentence len :  20 Je ne peux donner au
Time taken to execute pipeline function: 0:00:00.000032
Time taken to execute prompt gen: 0:00:00.000046
Time taken to execute mapping: 0:00:00.000191
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2133 MiB |   2133 MiB |   2133 MiB |      0 B   |
|       from large pool |   2132 MiB |   2132 MiB |   2132 MiB |      0 B   |
|       from small pool |      1 MiB |      1 MiB |      1 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |   2133 MiB |   2133 MiB |   2133 MiB |      0 B   |
|       from large pool |   2132 MiB |   2132 MiB |   2132 MiB |      0 B   |
|       from small pool |      1 MiB |      1 MiB |      1 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |   2133 MiB |   2133 MiB |   2133 MiB |      0 B   |
|       from large pool |   2132 MiB |   2132 MiB |   2132 MiB |      0 B   |
|       from small pool |      1 MiB |      1 MiB |      1 MiB |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2134 MiB |   2134 MiB |   2134 MiB |      0 B   |
|       from large pool |   2132 MiB |   2132 MiB |   2132 MiB |      0 B   |
|       from small pool |      2 MiB |      2 MiB |      2 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    775 KiB |  18404 KiB | 395260 KiB | 394485 KiB |
|       from large pool |      0 KiB |  16384 KiB | 393216 KiB | 393216 KiB |
|       from small pool |    775 KiB |   2044 KiB |   2044 KiB |   1269 KiB |
|---------------------------------------------------------------------------|
| Allocations           |     295    |     295    |     295    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |     198    |     198    |     198    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     295    |     295    |     295    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |     198    |     198    |     198    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      74    |      74    |       0    |
|       from large pool |      73    |      73    |      73    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |       2    |      25    |      24    |
|       from large pool |       0    |       1    |      24    |      24    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'negative', 'negative', 'positive', 'positive', 'negative', 'negative', 'positive']
Time taken to execute classification (32): 0:00:00.773117
pred_answer  ['positive', 'negative', 'negative', 'positive', 'positive', 'negative', 'negative', 'positive']
mapped_labels  ['positive', 'positive', 'negative', 'negative', 'positive', 'positive', 'positive', 'positive']
Batch acc:  0.5

sentence len :  20 Ce ne sont pas de vr
Time taken to execute pipeline function: 0:00:00.000016
Time taken to execute prompt gen: 0:00:00.000023
Time taken to execute mapping: 0:00:00.000077
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4346 MiB |   5962 MiB |   6923 MiB |   2577 MiB |
|       from large pool |   4344 MiB |   5960 MiB |   6826 MiB |   2481 MiB |
|       from small pool |      1 MiB |      2 MiB |     97 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   4346 MiB |   5962 MiB |   6923 MiB |   2577 MiB |
|       from large pool |   4344 MiB |   5960 MiB |   6826 MiB |   2481 MiB |
|       from small pool |      1 MiB |      2 MiB |     97 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4337 MiB |   5952 MiB |   6912 MiB |   2575 MiB |
|       from large pool |   4335 MiB |   5951 MiB |   6814 MiB |   2479 MiB |
|       from small pool |      1 MiB |      2 MiB |     97 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5474 MiB |   6012 MiB |   6012 MiB | 550912 KiB |
|       from large pool |   5472 MiB |   6008 MiB |   6008 MiB | 548864 KiB |
|       from small pool |      2 MiB |      4 MiB |      4 MiB |   2048 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  48977 KiB |  71736 KiB |   2743 MiB |   2695 MiB |
|       from large pool |  48497 KiB |  71281 KiB |   2645 MiB |   2597 MiB |
|       from small pool |    479 KiB |   2044 KiB |     98 MiB |     97 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     812    |     818    |    1122    |     310    |
|       from large pool |     509    |     512    |     704    |     195    |
|       from small pool |     303    |     307    |     418    |     115    |
|---------------------------------------------------------------------------|
| Active allocs         |     812    |     818    |    1122    |     310    |
|       from large pool |     509    |     512    |     704    |     195    |
|       from small pool |     303    |     307    |     418    |     115    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     189    |     191    |     191    |       2    |
|       from large pool |     188    |     189    |     189    |       1    |
|       from small pool |       1    |       2    |       2    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |      27    |     392    |     367    |
|       from large pool |      21    |      24    |     285    |     264    |
|       from small pool |       4    |       5    |     107    |     103    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['negative', 'negative', 'negative', 'positive', 'positive', 'positive', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.081116
pred_answer  ['negative', 'negative', 'negative', 'positive', 'positive', 'positive', 'positive', 'positive']
mapped_labels  ['positive', 'negative', 'positive', 'negative', 'negative', 'negative', 'positive', 'negative']
Batch acc:  0.25

sentence len :  20 j'ai deux chiens mal
Time taken to execute pipeline function: 0:00:00.000010
Time taken to execute prompt gen: 0:00:00.000017
Time taken to execute mapping: 0:00:00.000179
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   6553 MiB |   8169 MiB |  11707 MiB |   5154 MiB |
|       from large pool |   6551 MiB |   8167 MiB |  11513 MiB |   4962 MiB |
|       from small pool |      1 MiB |      2 MiB |    193 MiB |    192 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   6553 MiB |   8169 MiB |  11707 MiB |   5154 MiB |
|       from large pool |   6551 MiB |   8167 MiB |  11513 MiB |   4962 MiB |
|       from small pool |      1 MiB |      2 MiB |    193 MiB |    192 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   6533 MiB |   8148 MiB |  11683 MiB |   5150 MiB |
|       from large pool |   6531 MiB |   8147 MiB |  11489 MiB |   4958 MiB |
|       from small pool |      1 MiB |      2 MiB |    193 MiB |    192 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7694 MiB |   8232 MiB |   8770 MiB |   1076 MiB |
|       from large pool |   7692 MiB |   8228 MiB |   8764 MiB |   1072 MiB |
|       from small pool |      2 MiB |      4 MiB |      6 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  62348 KiB | 589036 KiB |   5472 MiB |   5411 MiB |
|       from large pool |  62164 KiB | 588696 KiB |   5278 MiB |   5217 MiB |
|       from small pool |    184 KiB |   2044 KiB |    194 MiB |    193 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1328    |    1334    |    1948    |     620    |
|       from large pool |     920    |     923    |    1310    |     390    |
|       from small pool |     408    |     412    |     638    |     230    |
|---------------------------------------------------------------------------|
| Active allocs         |    1328    |    1334    |    1948    |     620    |
|       from large pool |     920    |     923    |    1310    |     390    |
|       from small pool |     408    |     412    |     638    |     230    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     248    |     250    |     252    |       4    |
|       from large pool |     247    |     248    |     249    |       2    |
|       from small pool |       1    |       2    |       3    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |      38    |     714    |     677    |
|       from large pool |      32    |      35    |     499    |     467    |
|       from small pool |       5    |       6    |     215    |     210    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['negative', 'negative', 'positive', 'negative', 'positive', 'positive', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.074429
pred_answer  ['negative', 'negative', 'positive', 'negative', 'positive', 'positive', 'positive', 'positive']
mapped_labels  ['positive', 'negative', 'positive', 'positive', 'positive', 'positive', 'positive', 'positive']
Batch acc:  0.75

sentence len :  20 protéger un portable
Time taken to execute pipeline function: 0:00:00.000010
Time taken to execute prompt gen: 0:00:00.000016
Time taken to execute mapping: 0:00:00.000072
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8759 MiB |  10375 MiB |  16490 MiB |   7731 MiB |
|       from large pool |   8757 MiB |  10373 MiB |  16200 MiB |   7443 MiB |
|       from small pool |      2 MiB |      3 MiB |    290 MiB |    288 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8759 MiB |  10375 MiB |  16490 MiB |   7731 MiB |
|       from large pool |   8757 MiB |  10373 MiB |  16200 MiB |   7443 MiB |
|       from small pool |      2 MiB |      3 MiB |    290 MiB |    288 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8729 MiB |  10344 MiB |  16454 MiB |   7725 MiB |
|       from large pool |   8727 MiB |  10342 MiB |  16164 MiB |   7437 MiB |
|       from small pool |      2 MiB |      3 MiB |    290 MiB |    288 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9916 MiB |  10452 MiB |  11528 MiB |   1612 MiB |
|       from large pool |   9912 MiB |  10448 MiB |  11520 MiB |   1608 MiB |
|       from small pool |      4 MiB |      4 MiB |      8 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  78200 KiB | 620831 KiB |   8203 MiB |   8127 MiB |
|       from large pool |  76263 KiB | 620787 KiB |   7911 MiB |   7837 MiB |
|       from small pool |   1936 KiB |   2049 KiB |    292 MiB |    290 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1844    |    1850    |    2774    |     930    |
|       from large pool |    1331    |    1334    |    1916    |     585    |
|       from small pool |     513    |     517    |     858    |     345    |
|---------------------------------------------------------------------------|
| Active allocs         |    1844    |    1850    |    2774    |     930    |
|       from large pool |    1331    |    1334    |    1916    |     585    |
|       from small pool |     513    |     517    |     858    |     345    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     308    |     309    |     313    |       5    |
|       from large pool |     306    |     307    |     309    |       3    |
|       from small pool |       2    |       2    |       4    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |      50    |     981    |     934    |
|       from large pool |      41    |      44    |     715    |     674    |
|       from small pool |       6    |       7    |     266    |     260    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'negative', 'negative', 'negative', 'negative', 'positive', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.072960
pred_answer  ['positive', 'negative', 'negative', 'negative', 'negative', 'positive', 'positive', 'positive']
mapped_labels  ['positive', 'negative', 'negative', 'positive', 'negative', 'positive', 'negative', 'positive']
Batch acc:  0.75

sentence len :  20 Certainement un bon 
Time taken to execute pipeline function: 0:00:00.000012
Time taken to execute prompt gen: 0:00:00.000018
Time taken to execute mapping: 0:00:00.000090
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  10966 MiB |  12582 MiB |  21274 MiB |  10308 MiB |
|       from large pool |  10964 MiB |  12580 MiB |  20888 MiB |   9923 MiB |
|       from small pool |      2 MiB |      3 MiB |    386 MiB |    384 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  10966 MiB |  12582 MiB |  21274 MiB |  10308 MiB |
|       from large pool |  10964 MiB |  12580 MiB |  20888 MiB |   9923 MiB |
|       from small pool |      2 MiB |      3 MiB |    386 MiB |    384 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  10925 MiB |  12540 MiB |  21226 MiB |  10300 MiB |
|       from large pool |  10923 MiB |  12538 MiB |  20839 MiB |   9916 MiB |
|       from small pool |      2 MiB |      3 MiB |    386 MiB |    384 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  12156 MiB |  12692 MiB |  14304 MiB |   2148 MiB |
|       from large pool |  12152 MiB |  12688 MiB |  14296 MiB |   2144 MiB |
|       from small pool |      4 MiB |      4 MiB |      8 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 112051 KiB | 636467 KiB |  10944 MiB |  10834 MiB |
|       from large pool | 110410 KiB | 634670 KiB |  10556 MiB |  10448 MiB |
|       from small pool |   1641 KiB |   2049 KiB |    388 MiB |    386 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    2360    |    2366    |    3600    |    1240    |
|       from large pool |    1742    |    1745    |    2522    |     780    |
|       from small pool |     618    |     622    |    1078    |     460    |
|---------------------------------------------------------------------------|
| Active allocs         |    2360    |    2366    |    3600    |    1240    |
|       from large pool |    1742    |    1745    |    2522    |     780    |
|       from small pool |     618    |     622    |    1078    |     460    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     369    |     374    |       6    |
|       from large pool |     366    |     367    |     370    |       4    |
|       from small pool |       2    |       2    |       4    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      59    |      61    |    1206    |    1147    |
|       from large pool |      53    |      55    |     926    |     873    |
|       from small pool |       6    |       7    |     280    |     274    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['negative', 'positive', 'positive', 'positive', 'positive', 'positive', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.079737
pred_answer  ['negative', 'positive', 'positive', 'positive', 'positive', 'positive', 'positive', 'positive']
mapped_labels  ['negative', 'positive', 'negative', 'positive', 'positive', 'positive', 'positive', 'positive']
Batch acc:  0.875

sentence len :  20 Petit chronomètre qu
Time taken to execute pipeline function: 0:00:00.000012
Time taken to execute prompt gen: 0:00:00.000017
Time taken to execute mapping: 0:00:00.000051
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  13207 MiB |  14847 MiB |  26129 MiB |  12922 MiB |
|       from large pool |  13204 MiB |  14844 MiB |  25646 MiB |  12441 MiB |
|       from small pool |      2 MiB |      3 MiB |    483 MiB |    480 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  13207 MiB |  14847 MiB |  26129 MiB |  12922 MiB |
|       from large pool |  13204 MiB |  14844 MiB |  25646 MiB |  12441 MiB |
|       from small pool |      2 MiB |      3 MiB |    483 MiB |    480 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  13153 MiB |  14791 MiB |  26065 MiB |  12912 MiB |
|       from large pool |  13150 MiB |  14788 MiB |  25582 MiB |  12432 MiB |
|       from small pool |      2 MiB |      3 MiB |    482 MiB |    480 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14512 MiB |  15056 MiB |  17204 MiB |   2692 MiB |
|       from large pool |  14508 MiB |  15052 MiB |  17196 MiB |   2688 MiB |
|       from small pool |      4 MiB |      4 MiB |      8 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 213881 KiB | 662676 KiB |  13766 MiB |  13557 MiB |
|       from large pool | 212537 KiB | 661177 KiB |  13281 MiB |  13074 MiB |
|       from small pool |   1344 KiB |   2049 KiB |    484 MiB |    483 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    2876    |    2882    |    4426    |    1550    |
|       from large pool |    2153    |    2156    |    3128    |     975    |
|       from small pool |     723    |     727    |    1298    |     575    |
|---------------------------------------------------------------------------|
| Active allocs         |    2876    |    2882    |    4426    |    1550    |
|       from large pool |    2153    |    2156    |    3128    |     975    |
|       from small pool |     723    |     727    |    1298    |     575    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     433    |     434    |     440    |       7    |
|       from large pool |     431    |     432    |     436    |       5    |
|       from small pool |       2    |       2    |       4    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     121    |     124    |    1436    |    1315    |
|       from large pool |     116    |     118    |    1144    |    1028    |
|       from small pool |       5    |       7    |     292    |     287    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'negative', 'positive', 'positive', 'positive', 'positive', 'positive', 'negative']
Time taken to execute classification (32): 0:00:00.074569
pred_answer  ['positive', 'negative', 'positive', 'positive', 'positive', 'positive', 'positive', 'negative']
mapped_labels  ['positive', 'negative', 'positive', 'positive', 'negative', 'positive', 'positive', 'negative']
Batch acc:  0.875

sentence len :  20 Problème robot ne fo
Time taken to execute pipeline function: 0:00:00.000010
Time taken to execute prompt gen: 0:00:00.000017
Time taken to execute mapping: 0:00:00.000050
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  15392 MiB |  16984 MiB |  30856 MiB |  15464 MiB |
|       from large pool |  15389 MiB |  16981 MiB |  30277 MiB |  14888 MiB |
|       from small pool |      2 MiB |      3 MiB |    579 MiB |    576 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  15392 MiB |  16984 MiB |  30856 MiB |  15464 MiB |
|       from large pool |  15389 MiB |  16981 MiB |  30277 MiB |  14888 MiB |
|       from small pool |      2 MiB |      3 MiB |    579 MiB |    576 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  15317 MiB |  16909 MiB |  30768 MiB |  15451 MiB |
|       from large pool |  15314 MiB |  16907 MiB |  30189 MiB |  14874 MiB |
|       from small pool |      2 MiB |      3 MiB |    579 MiB |    576 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16698 MiB |  17230 MiB |  19922 MiB |   3224 MiB |
|       from large pool |  16694 MiB |  17224 MiB |  19912 MiB |   3218 MiB |
|       from small pool |      4 MiB |      6 MiB |     10 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 245539 KiB | 779215 KiB |  16488 MiB |  16248 MiB |
|       from large pool | 244489 KiB | 778009 KiB |  15907 MiB |  15669 MiB |
|       from small pool |   1050 KiB |   2050 KiB |    580 MiB |    579 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    3392    |    3398    |    5252    |    1860    |
|       from large pool |    2564    |    2567    |    3734    |    1170    |
|       from small pool |     828    |     832    |    1518    |     690    |
|---------------------------------------------------------------------------|
| Active allocs         |    3392    |    3398    |    5252    |    1860    |
|       from large pool |    2564    |    2567    |    3734    |    1170    |
|       from small pool |     828    |     832    |    1518    |     690    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     491    |     493    |     500    |       9    |
|       from large pool |     489    |     490    |     495    |       6    |
|       from small pool |       2    |       3    |       5    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     133    |     136    |    1673    |    1540    |
|       from large pool |     128    |     131    |    1367    |    1239    |
|       from small pool |       5    |       7    |     306    |     301    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['negative', 'positive', 'positive', 'positive', 'positive', 'positive', 'negative', 'negative']
Time taken to execute classification (32): 0:00:00.075068
pred_answer  ['negative', 'positive', 'positive', 'positive', 'positive', 'positive', 'negative', 'negative']
mapped_labels  ['negative', 'negative', 'positive', 'positive', 'negative', 'positive', 'negative', 'negative']
Batch acc:  0.75

sentence len :  20 Très beau rideau ave
Time taken to execute pipeline function: 0:00:00.000011
Time taken to execute prompt gen: 0:00:00.000018
Time taken to execute mapping: 0:00:00.000056
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17579 MiB |  19171 MiB |  35587 MiB |  18008 MiB |
|       from large pool |  17575 MiB |  19168 MiB |  34911 MiB |  17335 MiB |
|       from small pool |      3 MiB |      4 MiB |    675 MiB |    672 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  17579 MiB |  19171 MiB |  35587 MiB |  18008 MiB |
|       from large pool |  17575 MiB |  19168 MiB |  34911 MiB |  17335 MiB |
|       from small pool |      3 MiB |      4 MiB |    675 MiB |    672 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  17481 MiB |  19074 MiB |  35471 MiB |  17989 MiB |
|       from large pool |  17478 MiB |  19071 MiB |  34795 MiB |  17317 MiB |
|       from small pool |      3 MiB |      4 MiB |    675 MiB |    672 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18904 MiB |  19436 MiB |  22660 MiB |   3756 MiB |
|       from large pool |  18900 MiB |  19430 MiB |  22648 MiB |   3748 MiB |
|       from small pool |      4 MiB |      6 MiB |     12 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 265194 KiB | 779274 KiB |  19190 MiB |  18931 MiB |
|       from large pool | 264439 KiB | 778363 KiB |  18513 MiB |  18255 MiB |
|       from small pool |    755 KiB |   2050 KiB |    676 MiB |    675 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    3908    |    3914    |    6078    |    2170    |
|       from large pool |    2975    |    2978    |    4340    |    1365    |
|       from small pool |     933    |     937    |    1738    |     805    |
|---------------------------------------------------------------------------|
| Active allocs         |    3908    |    3914    |    6078    |    2170    |
|       from large pool |    2975    |    2978    |    4340    |    1365    |
|       from small pool |     933    |     937    |    1738    |     805    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     550    |     552    |     561    |      11    |
|       from large pool |     548    |     549    |     555    |       7    |
|       from small pool |       2    |       3    |       6    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     139    |     142    |    1999    |    1860    |
|       from large pool |     134    |     137    |    1586    |    1452    |
|       from small pool |       5    |       7    |     413    |     408    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'negative', 'negative', 'positive', 'negative', 'positive', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.093508
pred_answer  ['positive', 'negative', 'negative', 'positive', 'negative', 'positive', 'positive', 'positive']
mapped_labels  ['positive', 'negative', 'negative', 'positive', 'positive', 'negative', 'positive', 'positive']
Batch acc:  0.75

sentence len :  20 Parfait pour moi. Ut
Time taken to execute pipeline function: 0:00:00.000011
Time taken to execute prompt gen: 0:00:00.000016
Time taken to execute mapping: 0:00:00.000042
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  19819 MiB |  21459 MiB |  40444 MiB |  20625 MiB |
|       from large pool |  19815 MiB |  21455 MiB |  39672 MiB |  19856 MiB |
|       from small pool |      3 MiB |      4 MiB |    772 MiB |    768 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  19819 MiB |  21459 MiB |  40444 MiB |  20625 MiB |
|       from large pool |  19815 MiB |  21455 MiB |  39672 MiB |  19856 MiB |
|       from small pool |      3 MiB |      4 MiB |    772 MiB |    768 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  19709 MiB |  21347 MiB |  40310 MiB |  20601 MiB |
|       from large pool |  19706 MiB |  21344 MiB |  39539 MiB |  19833 MiB |
|       from small pool |      3 MiB |      4 MiB |    771 MiB |    768 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  21280 MiB |  21826 MiB |  25582 MiB |   4302 MiB |
|       from large pool |  21276 MiB |  21820 MiB |  25568 MiB |   4292 MiB |
|       from small pool |      4 MiB |      6 MiB |     14 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 373634 KiB |    782 MiB |  22012 MiB |  21647 MiB |
|       from large pool | 373175 KiB |    781 MiB |  21239 MiB |  20875 MiB |
|       from small pool |    459 KiB |      2 MiB |    772 MiB |    772 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    4430    |    6904    |    2480    |
|       from large pool |    3386    |    3389    |    4946    |    1560    |
|       from small pool |    1038    |    1042    |    1958    |     920    |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    4430    |    6904    |    2480    |
|       from large pool |    3386    |    3389    |    4946    |    1560    |
|       from small pool |    1038    |    1042    |    1958    |     920    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     616    |     618    |     629    |      13    |
|       from large pool |     614    |     615    |     622    |       8    |
|       from small pool |       2    |       3    |       7    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     204    |     205    |    2321    |    2117    |
|       from large pool |     198    |     200    |    1800    |    1602    |
|       from small pool |       6    |       7    |     521    |     515    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Traceback (most recent call last):
  File "/home/lcur1101/ATCS_group3/code/pipeline_file.py", line 217, in <module>
    acc = pipeline(LM_model, task, prompt_generator)
  File "/home/lcur1101/ATCS_group3/code/pipeline_file.py", line 171, in pipeline
    answers_probs_batch, pred_answer_batch = model(
  File "/home/lcur1101/ATCS_group3/code/main_model.py", line 40, in __call__
    outputs = self.model(**inputs, labels=inputs["input_ids"])
  File "/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/transformers/models/bloom/modeling_bloom.py", line 933, in forward
    shift_logits = lm_logits[..., :-1, :].contiguous()
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 530.00 MiB (GPU 0; 23.65 GiB total capacity; 22.01 GiB already allocated; 519.56 MiB free; 22.40 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
srun: error: r35n4: task 0: Exited with exit code 1
