Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
****Start Time: 2023-05-26_23-38-09
Using MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 369.40it/s]
loading model Duration: 0:00:01.398893
Average length of review_body for rows with 1 star: 170.985525
Average length of review_body for rows with 5 star: 151.0092
len of lowest cat:  38553
len of pos_reviews, neg_reviews:  38553 38553
len dataset  77106
len dataset  200
create dataloader Duration: 0:03:09.537547
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
load model Duration: 0:00:14.440401
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloom-560m SA null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[9.9947e-07, 1.3755e-07, 6.9199e-07, 6.9551e-07, 4.4579e-07, 5.5824e-07,
         1.8190e-07, 5.6908e-06, 7.9713e-06, 4.8926e-09, 1.1486e-06, 7.8955e-07,
         3.8468e-07, 9.8899e-07, 8.3394e-07, 2.1407e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.2804e-05, 8.2219e-07, 7.7684e-06, 4.9584e-06, 2.1951e-06, 8.1001e-06,
         1.4158e-06, 8.8532e-06, 6.9469e-05, 8.0779e-08, 1.2939e-06, 5.6718e-06,
         3.2967e-06, 1.0594e-05, 1.2527e-06, 9.6905e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.824918
summ of probs approach
id: [18260] -> tensor([[4.4592e-06, 2.2139e-08, 1.1454e-06, 2.0414e-07, 5.4116e-08, 1.3676e-07,
         2.8716e-07, 1.0741e-09, 5.1983e-07, 8.4319e-09, 3.8796e-06, 1.8734e-07,
         2.1954e-06, 1.7877e-07, 1.0331e-08, 2.2428e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.9336e-05, 1.5899e-07, 5.9831e-06, 4.0387e-06, 9.5873e-07, 3.3706e-06,
         9.6846e-06, 2.8498e-08, 3.5171e-06, 2.1544e-07, 3.5931e-05, 5.2580e-07,
         8.0962e-05, 1.9651e-06, 2.8300e-07, 2.1618e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.120688
summ of probs approach
id: [18260] -> tensor([[2.5469e-06, 4.7920e-04, 5.6443e-07, 5.7656e-07, 5.1768e-04, 3.5556e-07,
         3.3521e-07, 5.8352e-07, 1.8136e-06, 1.6117e-07, 3.9915e-07, 9.0515e-09,
         1.7734e-07, 3.9281e-08, 3.0973e-07, 9.6816e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[7.3226e-06, 9.2506e-04, 4.9001e-06, 1.1942e-05, 4.8303e-03, 8.1395e-06,
         1.1901e-06, 3.6137e-06, 3.1770e-06, 9.4382e-07, 4.0776e-06, 1.7427e-07,
         1.6313e-06, 4.4096e-07, 1.9860e-06, 6.7058e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.190165
summ of probs approach
id: [18260] -> tensor([[8.2891e-07, 2.9496e-07, 3.0188e-06, 3.6833e-07, 1.0045e-06, 1.2136e-07,
         5.9600e-07, 4.5921e-06, 1.3485e-07, 9.4623e-07, 3.5868e-07, 5.3772e-09,
         9.2519e-07, 2.9562e-07, 2.4321e-07, 3.1000e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[6.6280e-06, 6.0822e-06, 3.5988e-05, 3.3925e-06, 4.2883e-06, 3.8351e-07,
         4.8083e-06, 2.3140e-05, 6.0229e-07, 1.2472e-05, 2.4017e-06, 1.0618e-06,
         9.7901e-06, 1.3963e-06, 2.9936e-06, 2.3883e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.179792
summ of probs approach
id: [18260] -> tensor([[1.6047e-06, 5.0616e-08, 6.6046e-07, 6.0874e-08, 2.6273e-07, 2.8906e-07,
         1.7053e-07, 1.0276e-07, 7.4936e-09, 6.8321e-09, 8.6631e-07, 6.1101e-06,
         7.2252e-08, 1.8445e-07, 7.9486e-09, 3.6589e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.4091e-05, 1.2767e-05, 4.8522e-06, 1.2213e-06, 2.1968e-06, 3.2107e-06,
         1.7385e-06, 5.3216e-06, 4.1442e-08, 7.6242e-06, 4.0737e-06, 2.3310e-05,
         5.9848e-07, 3.7231e-06, 8.0696e-08, 1.2774e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.085753
summ of probs approach
id: [18260] -> tensor([[1.3977e-06, 3.9192e-06, 4.8100e-07, 5.6637e-07, 2.1806e-07, 4.6796e-07,
         1.2663e-06, 2.7055e-07, 8.5006e-07, 2.0462e-06, 2.5209e-07, 1.8540e-08,
         5.4312e-08, 1.1470e-06, 1.1927e-07, 3.6455e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.0638e-06, 8.3787e-06, 2.8661e-07, 1.1952e-05, 1.0775e-06, 3.8880e-06,
         2.3351e-05, 1.7973e-06, 1.0292e-05, 1.6518e-05, 3.3317e-06, 3.7960e-07,
         1.3687e-07, 3.8278e-06, 1.1199e-06, 6.3183e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.163270
summ of probs approach
id: [18260] -> tensor([[1.3875e-07, 2.6558e-07, 5.9492e-07, 3.1370e-06, 2.1402e-09, 2.6347e-08,
         4.2265e-07, 3.3166e-08, 2.3012e-07, 7.9934e-08, 6.0047e-08, 6.6235e-08,
         2.3224e-07, 1.6734e-05, 7.6448e-07, 7.3501e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.3321e-05, 2.5608e-07, 2.6093e-06, 9.9718e-06, 7.0137e-08, 1.2821e-07,
         3.1962e-06, 4.0673e-07, 1.4529e-06, 1.7523e-06, 1.8754e-07, 4.6021e-07,
         1.0628e-06, 1.2959e-04, 1.2521e-05, 7.5591e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.181520
summ of probs approach
id: [18260] -> tensor([[4.1413e-06, 1.7176e-06, 3.4077e-07, 3.2847e-07, 7.2062e-07, 4.3780e-08,
         9.6031e-07, 5.7478e-07, 2.2465e-07, 6.9598e-07, 5.1751e-06, 7.2728e-07,
         4.0015e-08, 2.5632e-06, 4.7668e-08, 1.1143e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.1916e-05, 7.2382e-06, 2.5885e-06, 9.8016e-07, 2.4414e-06, 4.2786e-07,
         1.1158e-05, 3.5418e-06, 1.6690e-06, 1.3362e-06, 8.5102e-05, 5.4896e-06,
         3.3656e-07, 1.3896e-05, 1.0201e-06, 1.2739e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.209878
summ of probs approach
id: [18260] -> tensor([[1.7675e-07, 4.7090e-07, 3.1201e-08, 2.5765e-06, 3.7208e-07, 5.9469e-09,
         3.6895e-07, 2.6129e-05, 1.3496e-07, 1.3601e-07, 8.6243e-08, 1.5637e-03,
         1.0045e-08, 3.6780e-07, 1.0595e-06, 3.7062e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.3735e-06, 4.3664e-07, 2.1171e-07, 5.4548e-05, 3.0668e-06, 8.6184e-09,
         2.0317e-06, 5.8151e-05, 3.0999e-06, 6.6821e-07, 2.3417e-07, 2.5413e-03,
         1.2237e-07, 2.6258e-06, 1.7655e-06, 3.7818e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.254105
summ of probs approach
id: [18260] -> tensor([[5.7940e-07, 1.3173e-07, 9.8163e-08, 1.2297e-07, 6.6510e-07, 5.4633e-09,
         3.6064e-07, 1.7166e-06, 1.8040e-09, 8.9473e-08, 2.5285e-07, 2.7735e-06,
         1.5527e-07, 4.1037e-07, 1.6461e-09, 8.3206e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.1084e-06, 2.3887e-06, 3.1101e-07, 5.1361e-07, 5.8057e-06, 3.4977e-07,
         2.5484e-06, 1.4979e-05, 2.6985e-07, 9.9817e-07, 1.4911e-06, 2.7826e-05,
         2.5484e-06, 9.7391e-07, 1.8411e-07, 1.5155e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.124874
summ of probs approach
id: [18260] -> tensor([[5.0789e-07, 3.6952e-08, 4.5795e-08, 1.0953e-07, 3.8871e-08, 2.6612e-07,
         1.7732e-07, 1.5739e-09, 1.9118e-07, 5.3294e-07, 7.7845e-07, 3.4283e-07,
         4.2447e-07, 4.2881e-06, 3.7708e-07, 1.0065e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.2293e-06, 2.1566e-07, 2.8893e-07, 8.9396e-07, 7.0708e-07, 4.7172e-06,
         2.6355e-06, 1.7871e-07, 1.5751e-06, 7.4529e-07, 3.6307e-06, 9.2968e-07,
         8.1881e-06, 1.8048e-05, 2.0824e-06, 3.0936e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.190744
summ of probs approach
id: [18260] -> tensor([[2.9589e-07, 1.2043e-07, 2.1828e-07, 3.8556e-07, 1.0274e-06, 2.8517e-07,
         1.7077e-09, 4.5638e-07, 2.0895e-06, 7.7225e-07, 2.9103e-07, 2.9207e-07,
         5.2781e-07, 3.2288e-07, 2.7939e-07, 1.9721e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.2688e-07, 7.6973e-07, 9.2738e-07, 1.8305e-06, 3.6598e-05, 1.1078e-06,
         1.2964e-08, 6.7644e-06, 2.8131e-05, 5.4280e-06, 1.6104e-06, 1.7218e-06,
         3.9506e-06, 3.7801e-06, 3.0320e-06, 2.8039e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.155990
summ of probs approach
id: [18260] -> tensor([[9.5504e-08, 7.2766e-07, 6.8123e-07, 4.9454e-08, 8.8029e-07, 4.2270e-08,
         3.0552e-07, 1.5216e-06]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [1936] -> tensor([[3.8199e-07, 2.9902e-06, 1.0469e-05, 2.5640e-06, 6.2326e-06, 9.6127e-07,
         6.2806e-07, 2.9889e-05]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.092482
acc:  0.5
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:02.791667
path ['42', 'en', 'bloom', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
load model Duration: 0:00:12.063253
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloomz-560m SA null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[1.5735e-06, 1.4427e-07, 1.3835e-08, 2.0576e-08, 1.1308e-05, 1.3220e-07,
         8.6213e-07, 3.0053e-09, 1.3633e-06, 5.7939e-07, 5.4545e-08, 3.5929e-07,
         7.6793e-08, 1.6568e-07, 2.3846e-07, 1.6488e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[8.8473e-07, 3.7630e-07, 6.0578e-08, 2.4603e-07, 1.8235e-04, 7.1948e-07,
         2.4158e-06, 1.6437e-09, 3.8112e-07, 7.6951e-07, 4.6182e-06, 2.8862e-06,
         2.0345e-06, 9.1594e-07, 2.6407e-05, 5.6782e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.222301
summ of probs approach
id: [18260] -> tensor([[2.7438e-08, 5.0953e-08, 8.4952e-07, 2.4783e-07, 2.7547e-06, 1.0660e-06,
         2.3321e-07, 9.0269e-07, 1.2594e-05, 3.3183e-07, 2.3619e-06, 1.2431e-04,
         6.1209e-07, 2.7818e-07, 3.6544e-07, 3.4333e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.7017e-07, 9.5640e-07, 2.2371e-05, 7.2719e-06, 6.8707e-05, 4.2306e-06,
         1.3646e-06, 7.6652e-06, 1.4785e-04, 9.2110e-06, 3.4545e-05, 1.6258e-03,
         2.4621e-06, 2.6856e-05, 6.2995e-06, 2.8405e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.157276
summ of probs approach
id: [18260] -> tensor([[7.5276e-06, 5.3482e-08, 3.0366e-07, 6.8522e-06, 8.6785e-10, 1.1263e-07,
         7.5597e-08, 2.4882e-07, 9.3827e-07, 1.9434e-06, 3.5022e-06, 9.9338e-07,
         3.3200e-08, 8.2227e-08, 2.9876e-06, 6.7344e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.7733e-05, 7.9963e-07, 4.1807e-06, 8.1084e-05, 6.2304e-08, 3.0101e-06,
         5.2886e-07, 1.0818e-05, 6.9839e-07, 2.9652e-06, 8.7292e-05, 2.5835e-06,
         1.9372e-06, 1.4329e-06, 2.9911e-06, 1.6308e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.191803
summ of probs approach
id: [18260] -> tensor([[9.2452e-08, 4.9536e-07, 4.1372e-08, 1.8345e-06, 1.2436e-06, 3.2304e-07,
         3.8676e-07, 1.1928e-06, 1.6127e-09, 1.3996e-06, 2.2897e-07, 4.1577e-07,
         1.4649e-08, 6.2196e-06, 1.1305e-05, 1.3979e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.5196e-07, 1.2223e-05, 3.5489e-07, 1.1305e-05, 1.9340e-05, 3.2608e-06,
         1.7944e-05, 1.0170e-05, 1.2379e-07, 2.5142e-05, 2.9425e-06, 9.2234e-06,
         1.6003e-06, 1.8782e-05, 9.0824e-05, 3.1037e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.136012
summ of probs approach
id: [18260] -> tensor([[4.8272e-07, 3.1206e-07, 6.7504e-07, 5.0893e-07, 6.5021e-07, 4.2984e-06,
         1.4055e-06, 2.8501e-08, 6.8505e-07, 6.5846e-07, 4.1067e-08, 2.8861e-07,
         1.0258e-07, 2.8977e-07, 2.6882e-07, 3.5656e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.7401e-06, 1.1997e-05, 1.0124e-05, 3.5602e-06, 5.9810e-06, 1.5095e-05,
         2.2447e-05, 1.2803e-06, 4.3677e-06, 1.7761e-06, 8.3011e-07, 8.0035e-06,
         1.3926e-07, 2.1690e-05, 3.3507e-06, 7.4507e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.131623
summ of probs approach
id: [18260] -> tensor([[4.7953e-05, 4.4307e-06, 2.8954e-07, 4.1486e-08, 7.4074e-10, 5.7798e-07,
         7.8650e-07, 2.2071e-06, 3.9504e-07, 1.2425e-08, 4.2447e-07, 7.5004e-07,
         1.3964e-06, 1.6775e-06, 5.0854e-07, 6.2671e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.1969e-04, 1.3127e-05, 9.0925e-06, 5.5499e-07, 2.9697e-07, 5.3053e-06,
         9.1802e-06, 1.2286e-05, 4.8541e-06, 1.1646e-06, 7.6797e-06, 4.1321e-06,
         1.3748e-05, 1.2502e-05, 1.2833e-05, 1.8666e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.166728
summ of probs approach
id: [18260] -> tensor([[1.9985e-06, 1.8761e-07, 4.9776e-06, 2.6558e-08, 8.7659e-08, 2.5937e-08,
         4.5446e-07, 2.1181e-08, 5.3158e-08, 1.7283e-07, 1.7274e-07, 6.6352e-09,
         2.9741e-07, 1.3987e-06, 1.6258e-07, 1.2659e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.1554e-05, 1.4014e-06, 8.6931e-06, 3.2477e-07, 7.3981e-07, 1.6378e-07,
         4.4357e-06, 7.3216e-08, 3.2097e-06, 2.0353e-06, 1.9536e-05, 1.0002e-07,
         3.3387e-06, 1.2319e-06, 7.0120e-07, 1.4438e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.153750
summ of probs approach
id: [18260] -> tensor([[1.3570e-03, 2.6883e-07, 6.8022e-07, 1.7493e-07, 1.7525e-07, 1.4549e-07,
         9.7792e-08, 5.3228e-08, 4.7969e-07, 2.5544e-08, 6.7380e-10, 3.8418e-07,
         1.1403e-09, 8.6962e-08, 8.3000e-07, 1.5949e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.7101e-03, 1.4389e-07, 1.3033e-06, 8.4927e-06, 4.6232e-07, 1.9573e-06,
         1.5020e-06, 4.8494e-07, 5.1178e-05, 5.1328e-08, 1.2236e-07, 1.7820e-05,
         1.7471e-07, 9.1564e-06, 4.2873e-06, 1.4546e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.191901
summ of probs approach
id: [18260] -> tensor([[2.8503e-07, 3.9769e-08, 3.3719e-07, 4.6987e-06, 3.1619e-08, 8.1482e-07,
         1.5668e-07, 3.0961e-07, 1.2359e-06, 8.1889e-06, 3.4133e-08, 1.4218e-08,
         6.2046e-07, 1.5087e-06, 4.7494e-08, 5.0040e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[6.3779e-07, 4.9868e-06, 6.0259e-06, 2.2052e-05, 3.9346e-06, 8.8810e-06,
         3.7444e-06, 1.3508e-05, 5.5891e-06, 5.9920e-05, 2.4264e-06, 1.8545e-06,
         3.0114e-05, 1.8596e-06, 4.8926e-07, 7.2120e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.155088
summ of probs approach
id: [18260] -> tensor([[2.4470e-06, 5.3296e-07, 5.7049e-08, 2.4560e-06, 1.3021e-07, 1.2257e-05,
         1.2800e-08, 3.8304e-07, 8.2053e-09, 1.0528e-06, 7.8590e-08, 7.2720e-07,
         1.1045e-06, 1.4646e-06, 1.1943e-06, 2.9118e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.0923e-05, 1.1000e-06, 4.7847e-07, 3.0499e-05, 4.0028e-06, 4.1361e-05,
         7.2491e-07, 3.5372e-06, 9.6870e-08, 2.1251e-05, 2.9834e-06, 3.0482e-06,
         7.6881e-06, 1.2716e-06, 2.8052e-06, 1.9024e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.152450
summ of probs approach
id: [18260] -> tensor([[1.0445e-09, 2.4277e-06, 2.2460e-08, 3.1078e-06, 4.9183e-07, 4.0749e-09,
         2.2716e-06, 6.3110e-07, 3.4990e-08, 2.9885e-05, 7.5608e-08, 2.6997e-08,
         1.0380e-07, 2.9162e-06, 3.9602e-08, 3.8734e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.1051e-08, 7.7534e-06, 2.1956e-08, 2.1968e-05, 4.8999e-07, 2.0228e-07,
         1.2860e-04, 6.9469e-06, 1.8399e-06, 7.7306e-04, 1.7847e-07, 5.4001e-07,
         4.5497e-07, 6.0049e-06, 3.0471e-07, 4.6473e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.166647
summ of probs approach
id: [18260] -> tensor([[9.5442e-07, 8.0595e-07, 6.5757e-08, 3.3927e-07, 2.0364e-07, 6.5548e-06,
         2.9959e-06, 4.1292e-07, 4.4888e-07, 7.4841e-09, 1.6746e-08, 4.4296e-07,
         2.0121e-09, 1.7961e-06, 1.1410e-06, 5.1995e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.2491e-06, 1.0948e-05, 1.4404e-06, 1.5349e-05, 7.0748e-07, 6.0907e-05,
         1.6764e-05, 3.0613e-06, 1.0961e-05, 6.4708e-07, 3.6332e-07, 7.1620e-06,
         4.3945e-08, 1.6436e-05, 5.3982e-06, 4.3029e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.247865
summ of probs approach
id: [18260] -> tensor([[7.7894e-09, 5.9983e-07, 1.4176e-06, 3.0806e-07, 1.0430e-08, 2.5212e-09,
         1.6503e-06, 3.0941e-06]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [1936] -> tensor([[1.6852e-06, 1.6724e-06, 1.7613e-06, 7.0817e-08, 1.3095e-07, 2.6434e-07,
         9.3625e-05, 4.0156e-05]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.094523
acc:  0.535
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:02.189006
path ['42', 'en', 'bloomz', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [4273, 1], 'attention_mask': [1, 1]}
id: [4273, 1] -> [4273]
answer  {'input_ids': [150, 1], 'attention_mask': [1, 1]}
id: [150, 1] -> [150]
load model Duration: 0:00:06.964452
prompt_type null has 1 prompts in it
----------- 42 en google/flan-t5-base SA null 0 200 16 --------------
summ of probs approach
id: [4273] -> tensor([[4.2351e-05, 7.4700e-05, 7.5743e-04, 4.1550e-05, 7.1620e-05, 4.4667e-05,
         1.2459e-03, 2.7495e-02, 1.4173e-03, 7.7793e-06, 1.7796e-04, 1.9176e-04,
         2.4894e-04, 1.1179e-04, 1.5780e-04, 1.7420e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[4.6300e-05, 1.9884e-04, 7.8647e-03, 4.9221e-05, 5.1034e-05, 2.5822e-05,
         4.6976e-04, 1.8708e-01, 8.6610e-03, 8.3413e-05, 1.7424e-02, 3.3723e-04,
         1.2827e-04, 1.8736e-02, 1.1908e-04, 2.0308e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.101594
summ of probs approach
id: [4273] -> tensor([[3.3858e-04, 9.5122e-06, 1.0152e-04, 1.4984e-03, 9.2870e-05, 1.5542e-04,
         8.8835e-04, 2.4422e-04, 3.3460e-04, 3.1860e-04, 6.7706e-04, 1.5313e-04,
         2.4419e-03, 4.8245e-03, 2.2690e-05, 6.4757e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.1073e-02, 1.0368e-03, 1.7890e-04, 6.4401e-03, 4.0407e-05, 3.8360e-03,
         1.9105e-03, 4.5684e-03, 1.1940e-03, 4.3646e-04, 5.4350e-04, 1.0868e-04,
         1.7810e-02, 1.0244e-02, 9.0141e-03, 1.4355e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.160377
summ of probs approach
id: [4273] -> tensor([[5.9996e-05, 5.2274e-04, 7.8242e-05, 1.9322e-04, 1.7512e-04, 4.4454e-03,
         2.4036e-03, 4.5225e-04, 9.1556e-06, 2.0260e-04, 5.8790e-05, 7.8321e-05,
         1.2394e-01, 1.2209e-04, 4.9547e-06, 5.2153e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[5.2015e-03, 3.3278e-04, 2.5563e-04, 2.5380e-03, 3.5539e-04, 4.6987e-02,
         4.6724e-02, 9.9440e-04, 6.1279e-04, 3.2439e-03, 1.0313e-04, 4.9673e-03,
         5.0688e-01, 1.9563e-04, 7.4299e-06, 1.4103e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.074939
summ of probs approach
id: [4273] -> tensor([[1.1217e-04, 2.5257e-04, 4.8212e-04, 3.3743e-05, 3.3346e-04, 7.5243e-07,
         3.1898e-05, 2.5737e-03, 6.2661e-04, 1.3522e-04, 1.0764e-05, 8.9957e-05,
         4.8422e-03, 1.6867e-06, 8.5383e-06, 1.6039e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.6820e-04, 9.2403e-04, 1.8122e-02, 7.7681e-04, 6.4915e-03, 9.6515e-05,
         3.9885e-05, 2.0336e-02, 6.1868e-04, 7.0180e-04, 8.6129e-04, 5.5564e-05,
         2.9839e-02, 1.5400e-06, 5.0580e-05, 7.6824e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.084160
summ of probs approach
id: [4273] -> tensor([[4.8911e-04, 4.1300e-05, 2.1547e-04, 5.6357e-04, 4.5974e-05, 3.0262e-05,
         1.6588e-03, 9.2520e-04, 5.1681e-06, 5.4149e-06, 7.5444e-04, 1.4716e-03,
         1.4819e-04, 7.6369e-07, 6.6388e-06, 1.6103e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.1469e-03, 1.8087e-04, 9.6228e-04, 7.2384e-04, 1.5634e-03, 3.2534e-04,
         2.2540e-02, 1.0077e-03, 5.3636e-04, 4.7099e-05, 4.2698e-03, 1.1078e-03,
         1.4794e-03, 8.2493e-06, 3.2581e-06, 8.5563e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.107408
summ of probs approach
id: [4273] -> tensor([[1.7269e-03, 9.1346e-05, 1.1507e-05, 3.3805e-04, 4.2634e-04, 2.3516e-06,
         6.4294e-04, 4.9451e-04, 4.0722e-05, 4.4819e-05, 1.6116e-03, 1.3567e-04,
         8.5041e-05, 2.2290e-04, 7.5243e-05, 1.2344e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.6308e-03, 7.6803e-03, 1.4972e-05, 1.9236e-04, 3.7235e-04, 1.6431e-06,
         2.9748e-03, 2.5867e-04, 4.4508e-03, 6.0900e-04, 7.0825e-04, 1.1316e-03,
         2.9485e-02, 1.0592e-04, 1.1879e-03, 1.5073e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.074277
summ of probs approach
id: [4273] -> tensor([[6.0450e-04, 1.0563e-05, 2.0064e-03, 1.1588e-04, 1.0150e-04, 5.1492e-04,
         1.2739e-03, 9.6047e-05, 8.1134e-04, 1.2009e-03, 3.9687e-05, 4.4102e-04,
         2.0044e-05, 2.5542e-06, 2.2524e-04, 2.8310e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[5.1876e-04, 2.2100e-05, 1.7228e-02, 1.6789e-04, 4.7386e-05, 6.0498e-04,
         1.2263e-03, 2.6007e-04, 3.4611e-02, 9.2460e-03, 2.8470e-05, 5.9889e-04,
         1.0987e-02, 3.7627e-06, 1.4091e-04, 7.8569e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.073667
summ of probs approach
id: [4273] -> tensor([[3.7871e-05, 5.6048e-06, 1.2153e-02, 3.2386e-04, 4.0810e-04, 6.8852e-05,
         2.0160e-05, 5.2547e-05, 7.0778e-05, 2.0873e-04, 7.6522e-05, 1.8632e-03,
         8.7496e-05, 2.6996e-05, 2.4389e-04, 1.1888e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[4.1725e-05, 5.0932e-06, 3.7709e-03, 2.1013e-02, 9.8303e-03, 9.0375e-05,
         4.6143e-04, 4.9603e-04, 6.6883e-05, 1.2906e-04, 7.6266e-04, 1.2527e-02,
         7.8637e-05, 4.1985e-04, 2.8040e-03, 5.2751e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.096383
summ of probs approach
id: [4273] -> tensor([[5.7424e-04, 8.2267e-04, 1.2897e-03, 1.0774e-06, 1.1710e-05, 1.2373e-05,
         2.2538e-04, 5.0184e-04, 6.9092e-07, 1.9281e-05, 6.5131e-04, 8.5919e-04,
         1.3787e-05, 3.6623e-04, 1.8429e-05, 7.1497e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.5715e-02, 3.1366e-03, 1.4276e-03, 8.7271e-05, 9.5182e-04, 3.2481e-05,
         5.9133e-03, 2.3977e-04, 8.2953e-06, 8.5477e-04, 1.1297e-02, 1.5350e-03,
         3.3324e-04, 1.0009e-04, 8.0931e-05, 2.8196e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.061605
summ of probs approach
id: [4273] -> tensor([[6.8561e-04, 1.2146e-03, 5.1367e-05, 9.7718e-04, 3.4103e-05, 3.1021e-05,
         8.5610e-06, 2.4777e-03, 2.9110e-04, 9.6803e-05, 1.1227e-02, 4.2169e-05,
         3.8464e-04, 1.7776e-04, 4.0252e-05, 5.1808e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.0267e-02, 1.2337e-02, 4.2171e-05, 7.3982e-04, 5.7455e-05, 3.8271e-04,
         4.3738e-06, 3.7495e-03, 1.2257e-03, 3.9224e-04, 7.0396e-02, 4.0388e-03,
         6.4777e-03, 3.5566e-04, 4.6930e-05, 7.1133e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.096400
summ of probs approach
id: [4273] -> tensor([[2.3259e-06, 1.3725e-04, 1.3811e-04, 1.0338e-05, 1.1992e-04, 6.3022e-04,
         1.9167e-04, 1.5692e-03, 3.1058e-05, 9.9381e-04, 2.0628e-05, 1.6025e-05,
         2.7897e-03, 2.1349e-06, 2.1172e-05, 1.2094e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.3229e-06, 3.8900e-04, 3.0365e-04, 4.2351e-05, 1.9753e-04, 1.0615e-03,
         1.1748e-03, 6.9169e-03, 1.6755e-04, 1.0550e-03, 7.0327e-04, 4.9106e-05,
         3.8167e-03, 3.5901e-06, 1.5753e-04, 3.1279e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.083505
summ of probs approach
id: [4273] -> tensor([[4.8632e-05, 1.8575e-03, 8.4714e-04, 2.1707e-04, 5.2058e-04, 3.3884e-05,
         1.6362e-03, 1.0500e-04, 8.5751e-04, 8.0524e-05, 5.8910e-04, 2.7281e-04,
         3.3169e-04, 2.9134e-03, 6.0035e-05, 2.0104e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.8021e-03, 7.8596e-04, 3.1447e-03, 3.3528e-03, 2.5528e-03, 1.9490e-03,
         1.1659e-03, 8.9627e-03, 8.4311e-03, 6.0453e-05, 2.7069e-02, 6.5835e-04,
         6.0911e-04, 3.0626e-03, 5.2160e-04, 1.0050e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.096720
summ of probs approach
id: [4273] -> tensor([[3.8874e-04, 8.7116e-05, 2.0819e-04, 2.8694e-05, 2.4451e-04, 1.2167e-03,
         3.0978e-06, 1.5117e-04]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [150] -> tensor([[4.5351e-04, 1.3742e-04, 1.0833e-03, 1.8818e-04, 2.7366e-04, 2.6483e-03,
         8.9268e-07, 5.3049e-03]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.045139
acc:  0.69
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.173049
path ['42', 'en', 'flan', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:39<00:39, 39.34s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 23.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 26.09s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 4874], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 4874] -> [4874]
answer  {'input_ids': [1, 694], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 694] -> [694]
load model Duration: 0:03:10.085210
prompt_type null has 1 prompts in it
----------- 42 en huggyllama/llama-7b SA null 0 200 16 --------------
summ of probs approach
id: [4874] -> tensor([[1.4305e-06, 3.3975e-06, 1.0133e-06, 2.3842e-07, 2.5630e-06, 2.0862e-06,
         1.2517e-06, 1.1921e-07, 2.2650e-06, 1.1623e-05, 8.9407e-07, 1.1921e-06,
         7.0930e-06, 1.3709e-06, 9.2983e-06, 6.6757e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.6391e-05, 4.9770e-05, 7.9489e-04, 1.1861e-05, 9.7454e-05, 3.3379e-05,
         2.5213e-05, 2.9206e-06, 6.3419e-05, 4.4525e-05, 3.8185e-03, 1.0419e-04,
         1.6081e-04, 2.8968e-05, 5.8830e-05, 7.0095e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.299100
summ of probs approach
id: [4874] -> tensor([[2.2948e-05, 7.7486e-07, 2.8312e-05, 8.4043e-06, 5.3644e-07, 4.8876e-06,
         1.5855e-05, 3.0994e-06, 2.6226e-06, 1.5497e-06, 2.3246e-06, 5.1260e-06,
         2.2054e-06, 1.4901e-06, 2.3842e-07, 7.1526e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[7.1239e-04, 5.6028e-06, 1.8096e-04, 1.0848e-04, 2.1577e-05, 7.7963e-05,
         8.3089e-05, 7.1585e-05, 6.1631e-05, 1.2171e-04, 4.7028e-05, 4.5955e-05,
         1.7059e-04, 1.1444e-05, 6.3181e-06, 1.9920e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.326442
summ of probs approach
id: [4874] -> tensor([[8.8036e-05, 2.5630e-06, 5.5432e-06, 1.7881e-07, 1.0133e-06, 3.1590e-06,
         2.5034e-06, 5.9009e-06, 1.0431e-05, 2.4438e-06, 3.2187e-06, 2.8610e-06,
         1.8585e-04, 1.8120e-05, 1.2994e-05, 1.9670e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[4.3154e-04, 2.0647e-04, 6.2823e-05, 1.9646e-04, 1.0192e-05, 2.0981e-05,
         2.9862e-05, 1.9360e-04, 6.3062e-05, 7.1168e-05, 4.0233e-05, 2.3246e-06,
         1.0405e-03, 2.6047e-05, 1.1787e-03, 1.2457e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.215529
summ of probs approach
id: [4874] -> tensor([[1.1742e-05, 2.8610e-06, 6.8545e-06, 7.1228e-05, 1.7881e-06, 9.5367e-07,
         1.0133e-06, 1.1325e-06, 2.7418e-06, 6.9737e-06, 2.8014e-06, 5.3644e-07,
         7.6294e-06, 1.3113e-06, 1.3113e-06, 2.2650e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.2553e-04, 8.0049e-05, 7.3075e-05, 1.1358e-03, 2.7239e-05, 4.8876e-06,
         8.1658e-06, 3.8683e-05, 2.3484e-05, 5.7459e-05, 1.2755e-05, 6.5565e-06,
         1.9526e-04, 1.0431e-05, 1.1396e-03, 6.4135e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.300870
summ of probs approach
id: [4874] -> tensor([[3.5763e-07, 1.5497e-06, 6.3777e-06, 1.1921e-07, 1.5259e-05, 8.9407e-06,
         5.9605e-07, 3.3140e-05, 1.8835e-05, 1.4901e-05, 2.9802e-06, 7.5102e-06,
         3.5763e-06, 2.3842e-07, 3.8743e-06, 2.9802e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[8.4043e-06, 1.7583e-04, 2.9802e-05, 8.3447e-07, 3.4511e-05, 1.6153e-04,
         3.5167e-06, 9.7609e-04, 1.3781e-04, 8.8167e-04, 2.8753e-04, 9.4175e-05,
         3.8326e-05, 9.0003e-06, 1.2028e-04, 3.7551e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.308912
summ of probs approach
id: [4874] -> tensor([[9.1791e-06, 8.3447e-07, 5.6624e-06, 1.1444e-05, 8.9407e-07, 5.6624e-06,
         7.4267e-05, 2.6226e-06, 2.1458e-06, 3.5822e-05, 6.2585e-06, 1.1835e-03,
         9.8944e-06, 1.8477e-06, 4.7684e-07, 2.1994e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[6.4015e-05, 3.5524e-05, 3.0851e-04, 1.4544e-04, 1.9431e-05, 6.2764e-05,
         6.2561e-03, 9.4771e-06, 9.1612e-05, 2.6870e-04, 2.0266e-05, 4.9057e-03,
         6.1750e-04, 4.4465e-05, 5.4836e-06, 6.4313e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.268404
summ of probs approach
id: [4874] -> tensor([[1.2517e-05, 6.3181e-06, 5.9557e-04, 6.0678e-05, 8.3447e-07, 2.9206e-06,
         4.7088e-06, 3.2783e-06, 3.6955e-06, 3.6955e-06, 3.4571e-06, 1.4544e-05,
         4.4346e-05, 1.5736e-05, 7.6890e-06, 3.5167e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[9.3043e-05, 3.1948e-05, 3.6926e-03, 1.2569e-03, 1.5438e-05, 5.6148e-05,
         4.1008e-05, 2.7180e-05, 9.9123e-05, 3.9101e-05, 4.9412e-05, 2.8443e-04,
         7.2098e-04, 6.3467e-04, 1.3089e-04, 2.0199e-03]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.326175
summ of probs approach
id: [4874] -> tensor([[3.5763e-06, 4.9829e-05, 4.1366e-05, 2.6226e-05, 3.5763e-07, 1.1206e-05,
         8.9705e-05, 2.8610e-06, 6.7711e-05, 4.1723e-07, 4.4107e-06, 5.2154e-05,
         1.9073e-06, 1.3351e-05, 2.2054e-06, 5.3406e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[7.8738e-05, 9.9421e-05, 5.7650e-04, 2.1279e-05, 9.5367e-07, 9.7096e-05,
         8.6117e-04, 1.3828e-05, 4.7350e-04, 8.6427e-06, 8.3447e-06, 2.3785e-03,
         3.0220e-05, 1.5366e-04, 4.2856e-05, 8.5497e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.371714
summ of probs approach
id: [4874] -> tensor([[1.0133e-06, 1.2517e-06, 1.4901e-06, 1.6093e-06, 1.3411e-04, 9.8944e-06,
         6.5565e-07, 3.1471e-05, 1.6689e-06, 6.9141e-06, 2.0266e-06, 3.8147e-06,
         4.7684e-07, 2.4438e-06, 2.9802e-06, 1.7285e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[3.1769e-05, 7.5698e-06, 6.5088e-05, 2.7776e-05, 4.0627e-03, 1.1700e-04,
         3.6359e-06, 2.2829e-04, 1.1027e-05, 5.5492e-05, 5.5790e-05, 4.6349e-04,
         3.4571e-06, 2.2233e-05, 1.2994e-05, 2.6441e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.278575
summ of probs approach
id: [4874] -> tensor([[8.8811e-06, 2.3842e-06, 1.1921e-06, 2.3842e-07, 4.3511e-06, 2.7418e-06,
         4.4107e-06, 4.0531e-06, 1.9073e-06, 1.1921e-06, 4.1723e-07, 2.3246e-06,
         6.5565e-07, 7.1526e-07, 1.3709e-06, 1.1325e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.7238e-04, 1.5366e-04, 4.1723e-06, 2.7597e-05, 9.0003e-05, 3.7575e-04,
         1.8275e-04, 1.4901e-05, 1.0312e-04, 9.0003e-06, 1.6570e-05, 4.8459e-05,
         8.7619e-06, 2.4438e-06, 1.1742e-05, 2.6882e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.308316
summ of probs approach
id: [4874] -> tensor([[8.1062e-06, 1.9073e-06, 1.0729e-06, 1.9073e-06, 2.7418e-06, 1.6689e-06,
         2.9206e-06, 2.2709e-05, 1.6987e-05, 4.7684e-07, 3.8743e-06, 4.2915e-06,
         5.9605e-07, 5.3644e-07, 1.5855e-05, 1.3709e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[2.0742e-05, 2.5988e-05, 1.3888e-05, 2.8014e-06, 5.3704e-05, 3.0708e-04,
         4.5002e-05, 7.0453e-05, 3.9101e-04, 3.8445e-05, 1.4246e-04, 2.0504e-04,
         3.7014e-05, 1.1605e-04, 3.9697e-05, 3.6955e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.511715
summ of probs approach
id: [4874] -> tensor([[7.0333e-06, 1.8060e-05, 4.4107e-06, 8.5235e-06, 1.8477e-06, 3.7885e-04,
         4.3511e-06, 4.7684e-07, 1.6093e-06, 5.9605e-08, 7.7486e-07, 8.3447e-07,
         2.3472e-04, 1.7881e-06, 9.2983e-06, 5.5432e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[7.0906e-04, 3.8290e-04, 4.5955e-05, 5.0879e-04, 2.5451e-05, 3.3245e-03,
         1.8907e-04, 4.0531e-06, 1.2398e-05, 8.1062e-06, 2.1324e-03, 6.9737e-06,
         1.0767e-03, 1.3828e-05, 1.9312e-05, 1.5891e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.261664
summ of probs approach
id: [4874] -> tensor([[8.0466e-06, 8.9407e-07, 6.1393e-06, 1.1253e-04, 7.5102e-06, 9.5367e-07,
         5.4240e-06, 1.1921e-06]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
summ of probs approach
id: [694] -> tensor([[5.7757e-05, 1.1444e-05, 5.6922e-05, 3.8452e-03, 1.0180e-04, 9.3460e-05,
         5.5313e-05, 2.3186e-05]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.163358
acc:  0.51
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:03.960428
path ['42', 'en', 'llama', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [36339, 1], 'attention_mask': [1, 1]}
id:[36339, 1]
answer  {'input_ids': [375, 1], 'attention_mask': [1, 1]}
id:[375, 1]
load model Duration: 0:00:05.257762
prompt_type null has 1 prompts in it
----------- 42 en bigscience/mt0-small SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([6.4785e-04, 5.3934e-04, 1.4485e-03, 1.1998e-03, 1.2424e-03, 5.9177e-04,
        5.9195e-04, 4.0823e-04, 3.2683e-04, 2.8278e-04, 7.1555e-03, 5.4534e-04,
        1.0520e-03, 5.3640e-01, 1.2081e-03, 8.0341e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.4018e-03, 7.2967e-04, 1.4102e-03, 1.2039e-03, 1.2189e-03, 5.7146e-04,
        4.8525e-03, 9.6306e-04, 1.5442e-03, 5.3680e-04, 7.2053e-03, 1.6111e-03,
        2.3297e-03, 5.3727e-01, 1.1225e-02, 1.1799e-03], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.109934
summ of probs approach
probs_ shape tensor([5.5185e-04, 4.6220e-04, 4.0161e-04, 3.2364e-03, 3.7117e-04, 1.8166e-04,
        8.6114e-01, 1.3158e-03, 4.1096e-04, 8.7106e-04, 6.6705e-04, 3.5396e-04,
        1.0058e-03, 5.8941e-04, 9.3559e-04, 5.9293e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.0490e-04, 4.8489e-04, 4.8329e-04, 1.7755e-02, 3.6625e-04, 2.9281e-04,
        8.6115e-01, 1.6026e-03, 2.3234e-03, 7.8481e-04, 2.6479e-03, 7.1978e-04,
        9.3566e-04, 5.9501e-04, 1.1579e-03, 5.7982e-04], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.075799
summ of probs approach
probs_ shape tensor([5.7679e-04, 6.2278e-04, 8.9182e-01, 6.7174e-04, 1.7525e-04, 8.5633e-04,
        4.9470e-04, 1.6856e-03, 6.4540e-04, 1.1803e-03, 7.7899e-04, 5.9599e-04,
        5.1088e-04, 1.6089e-03, 5.3211e-04, 8.0314e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.8737e-04, 5.6095e-04, 8.9182e-01, 6.4488e-04, 1.8552e-04, 9.4053e-04,
        5.0074e-03, 1.7028e-03, 1.4974e-03, 4.1338e-03, 1.0433e-03, 6.8987e-04,
        5.0722e-04, 1.5032e-03, 5.9308e-04, 9.3022e-04], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.087102
summ of probs approach
probs_ shape tensor([0.0046, 0.0003, 0.0007, 0.0005, 0.0005, 0.0007, 0.0030, 0.0007, 0.0012,
        0.0002, 0.0005, 0.0004, 0.0006, 0.0001, 0.0018, 0.0003],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0047, 0.0003, 0.0009, 0.0004, 0.0005, 0.0007, 0.0030, 0.0010, 0.0012,
        0.0013, 0.0006, 0.0004, 0.0011, 0.0002, 0.0020, 0.0005],
       device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.082911
summ of probs approach
probs_ shape tensor([1.1904e-04, 6.6382e-04, 8.7399e-04, 6.3207e-01, 1.9382e-04, 3.2758e-04,
        1.1338e-03, 1.7744e-03, 8.5729e-04, 9.3851e-04, 1.6107e-03, 1.3412e-04,
        5.7077e-04, 1.0565e-03, 7.7991e-04, 7.4193e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.0092e-04, 2.3984e-03, 8.2999e-04, 6.3208e-01, 2.9916e-04, 5.6803e-04,
        1.5161e-03, 2.5704e-03, 8.6661e-04, 9.4646e-04, 1.1004e-02, 3.6855e-04,
        5.6688e-04, 2.5070e-03, 3.2364e-03, 1.0601e-03], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.087986
summ of probs approach
probs_ shape tensor([7.4648e-04, 5.5802e-04, 1.1260e-03, 6.2677e-04, 1.8539e-03, 1.3724e-03,
        1.1168e-03, 1.5439e-03, 1.1532e-03, 2.3290e-04, 9.4561e-01, 7.6371e-04,
        1.9138e-03, 5.3294e-04, 1.0439e-03, 7.6632e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.1832e-04, 5.5827e-04, 1.1115e-03, 6.2385e-04, 2.2974e-03, 1.3083e-03,
        2.0497e-03, 3.2939e-03, 1.1397e-03, 1.1922e-03, 9.4561e-01, 8.5282e-04,
        1.1798e-02, 8.5151e-04, 1.0239e-03, 7.4604e-04], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.098006
summ of probs approach
probs_ shape tensor([1.8978e-04, 4.8638e-04, 9.3223e-04, 2.9067e-03, 9.9177e-04, 7.7685e-04,
        5.0823e-04, 7.7006e-04, 2.4572e-03, 4.9346e-04, 9.6836e-01, 5.2378e-04,
        1.0497e-03, 1.5275e-03, 8.2583e-04, 4.4014e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.8923e-04, 1.2621e-03, 9.3343e-04, 2.9032e-03, 1.4532e-03, 2.6101e-03,
        7.6943e-04, 1.8842e-03, 5.2867e-03, 5.7317e-04, 9.6836e-01, 3.3765e-03,
        3.3677e-03, 1.4399e-03, 8.0619e-04, 4.5913e-04], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.087089
summ of probs approach
probs_ shape tensor([3.0867e-04, 3.0284e-04, 5.5430e-04, 8.6491e-04, 7.9331e-01, 8.7232e-04,
        4.8283e-04, 1.1794e-03, 1.7266e-03, 1.2445e-03, 1.8521e-03, 2.0023e-04,
        4.0732e-04, 1.1711e-03, 7.7653e-04, 8.0038e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.9183e-04, 3.0655e-04, 5.4312e-04, 1.8164e-03, 7.9332e-01, 8.8327e-04,
        4.7963e-04, 1.1866e-03, 2.9615e-03, 1.6652e-03, 1.1075e-02, 3.8678e-04,
        4.8689e-04, 1.1515e-03, 1.1426e-03, 1.1897e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.075465
summ of probs approach
probs_ shape tensor([2.3772e-04, 1.0715e-03, 3.3509e-04, 5.4032e-03, 2.7727e-03, 6.4143e-04,
        3.6431e-03, 1.0787e-03, 5.7798e-04, 1.1252e-03, 5.2373e-04, 5.7833e-04,
        7.1141e-05, 9.5557e-01, 1.5255e-03, 9.9790e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.4281e-04, 2.4862e-03, 3.2118e-04, 2.7758e-02, 2.7827e-03, 9.1584e-04,
        4.8522e-03, 1.0082e-03, 4.8667e-04, 1.1234e-03, 6.5845e-04, 5.7893e-04,
        8.2194e-05, 9.5557e-01, 3.3578e-03, 1.2057e-03], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.080098
summ of probs approach
probs_ shape tensor([1.4803e-02, 8.9645e-04, 5.2465e-04, 3.5936e-04, 2.9298e-03, 3.4445e-04,
        9.3752e-04, 8.7946e-04, 9.0270e-01, 1.7418e-03, 8.5820e-04, 1.4758e-03,
        2.9907e-04, 1.7808e-04, 6.9896e-04, 3.4612e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.6917e-02, 8.9094e-04, 2.7493e-03, 6.5357e-04, 3.7135e-03, 7.0834e-04,
        4.4440e-03, 1.4228e-03, 9.0270e-01, 1.7036e-03, 1.6291e-03, 1.5594e-03,
        4.0819e-04, 3.5102e-04, 1.1539e-03, 2.6614e-04], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.093380
summ of probs approach
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
probs_ shape tensor([6.8940e-04, 8.3114e-04, 8.7222e-01, 2.4230e-04, 9.3239e-04, 5.3796e-04,
        2.3288e-04, 7.2786e-04, 5.2574e-04, 2.3056e-04, 6.1837e-03, 8.0754e-04,
        1.2767e-03, 9.4722e-04, 1.2869e-03, 1.2845e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.5405e-03, 8.5609e-04, 8.7277e-01, 4.3423e-04, 2.5646e-03, 2.0384e-03,
        6.7309e-04, 1.2570e-03, 6.0742e-04, 3.6983e-04, 5.4399e-02, 4.0402e-03,
        1.2325e-03, 8.9417e-04, 1.5179e-03, 3.0770e-03], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.077179
summ of probs approach
probs_ shape tensor([2.6181e-03, 4.2233e-03, 1.0471e-03, 1.0434e-03, 2.3186e-03, 3.2653e-04,
        5.6912e-01, 1.5718e-04, 3.0600e-04, 7.4895e-04, 1.0690e-03, 9.0649e-04,
        1.3205e-03, 9.9148e-04, 4.9167e-04, 3.9826e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.6955e-03, 2.2747e-02, 6.9985e-03, 9.8555e-04, 2.9218e-03, 3.2334e-04,
        5.6912e-01, 2.3910e-04, 2.7946e-04, 2.1442e-03, 8.4864e-03, 9.1648e-04,
        2.2628e-03, 7.5381e-04, 2.8969e-03, 3.7339e-04], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.066246
summ of probs approach
probs_ shape tensor([6.5728e-04, 7.1288e-04, 1.2110e-03, 1.3541e-03, 7.9064e-04, 1.9277e-03,
        9.5397e-01, 7.9179e-04], device='cuda:0') torch.Size([8])
summ of probs approach
probs_ shape tensor([6.9912e-04, 6.3891e-04, 1.2016e-03, 1.3658e-03, 7.5752e-04, 1.8785e-03,
        9.5397e-01, 2.8160e-03], device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.047788
acc:  0.745
Time taken to execute the en SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.085170
path ['42', 'en', 't0', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Using NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:00<00:00,  4.99it/s]100%|██████████| 3/3 [00:00<00:00, 14.54it/s]
loading model Duration: 0:00:01.384582
filter data Duraction: 0:00:00.000003
use_neutral is  True
len of entail_examples , neutral_examples, contra_examples:  66 66 66
len dataset  198
random sample Duraction: 0:02:46.540455
create dataloader Duration: 0:02:48.046560
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
answer  {'input_ids': [137111], 'attention_mask': [1]}
id:[137111]
load model Duration: 0:00:08.456460
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloom-560m NLI null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[4.7654e-08, 1.1037e-07, 2.7718e-05, 6.0091e-05, 1.7588e-07, 5.8273e-08,
         3.2524e-07, 1.2286e-05, 3.5395e-07, 1.2386e-07, 1.6321e-05, 8.4890e-08,
         1.3357e-06, 2.2224e-06, 6.9381e-05, 2.3319e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.0048e-07, 2.6239e-05, 8.3674e-05, 3.0860e-04, 9.1098e-07, 1.7039e-06,
         1.0918e-05, 7.7118e-05, 9.9865e-07, 2.8275e-05, 5.0003e-05, 6.5668e-07,
         2.2938e-06, 5.4805e-06, 1.7557e-03, 4.7730e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.2079e-08, 1.3161e-07, 1.9570e-05, 2.0077e-04, 3.5030e-08, 2.2653e-07,
         6.7255e-07, 1.3282e-04, 4.6700e-08, 9.2677e-08, 8.8253e-06, 1.8459e-07,
         2.0529e-07, 1.6806e-06, 8.9215e-05, 2.6246e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.167301
summ of probs approach
id: [18260] -> tensor([[1.4463e-06, 3.2029e-06, 6.3020e-07, 4.8293e-07, 6.2749e-06, 1.0100e-06,
         2.2905e-09, 3.3830e-07, 4.7469e-06, 7.0294e-07, 1.1293e-06, 1.9111e-05,
         4.7708e-08, 2.0920e-08, 3.1559e-07, 2.7010e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.4145e-05, 1.7790e-06, 8.3689e-06, 6.7680e-06, 1.1050e-04, 5.8136e-05,
         9.9383e-08, 1.0104e-05, 1.0694e-04, 1.0504e-05, 1.3145e-05, 5.3896e-05,
         1.1075e-06, 3.9155e-07, 2.2061e-06, 9.5169e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[3.1675e-06, 2.8265e-07, 4.0202e-07, 5.1737e-07, 6.2203e-05, 3.6360e-07,
         1.1806e-08, 7.7538e-07, 7.0530e-06, 2.8536e-08, 1.0632e-06, 7.9666e-06,
         4.9236e-08, 1.3006e-08, 6.0051e-07, 4.4681e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.108186
summ of probs approach
id: [18260] -> tensor([[6.0094e-06, 8.7527e-07, 5.4254e-07, 1.4538e-08, 6.2191e-06, 2.3072e-07,
         5.7832e-08, 9.2018e-08, 3.6744e-08, 7.2550e-08, 2.0718e-07, 1.3055e-05,
         4.2027e-05, 2.5533e-06, 3.4991e-08, 4.8552e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.9449e-04, 5.0926e-05, 1.4289e-05, 2.8421e-06, 1.0902e-04, 1.0886e-04,
         3.7560e-06, 1.0818e-06, 1.2960e-06, 5.6590e-06, 1.3709e-06, 3.6600e-04,
         2.5424e-05, 3.5675e-05, 1.1116e-06, 3.5292e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[4.0262e-06, 1.4680e-06, 2.5518e-07, 1.0833e-07, 3.0340e-05, 1.9152e-07,
         9.7736e-09, 7.1624e-08, 1.4740e-07, 1.3497e-07, 1.2323e-07, 1.0425e-04,
         4.7807e-05, 1.2899e-05, 9.0393e-08, 1.7363e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.147091
summ of probs approach
id: [18260] -> tensor([[2.1928e-07, 2.2411e-05, 3.5935e-07, 1.0285e-05, 6.3328e-08, 4.5142e-07,
         3.5947e-06, 7.0627e-06, 9.5754e-06, 6.0668e-06, 7.1580e-07, 4.1080e-06,
         9.8956e-06, 9.5301e-09, 2.2144e-07, 1.1803e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.5870e-06, 5.5774e-05, 4.4258e-06, 1.5910e-04, 5.3663e-06, 1.9486e-06,
         2.4990e-04, 4.7040e-05, 6.3541e-05, 4.4469e-05, 3.4863e-06, 9.9177e-05,
         6.9160e-05, 3.6850e-08, 3.7155e-06, 4.3342e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[4.5955e-07, 3.4602e-04, 2.4376e-07, 7.9657e-06, 2.2276e-08, 1.6189e-07,
         1.1223e-06, 1.9241e-05, 1.2264e-05, 1.0483e-05, 7.2441e-06, 4.3417e-05,
         1.4272e-05, 2.8271e-09, 1.0065e-08, 3.4183e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.132940
summ of probs approach
id: [18260] -> tensor([[2.3293e-07, 4.2199e-07, 9.6243e-09, 3.7069e-05, 2.1909e-06, 1.0927e-07,
         3.8168e-05, 3.1005e-08, 5.6825e-08, 1.2745e-07, 9.6137e-07, 7.2416e-07,
         1.4013e-06, 4.6860e-07, 6.7502e-06, 2.5698e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.7013e-06, 2.7283e-06, 6.9615e-06, 5.0365e-04, 3.8084e-05, 6.7083e-07,
         1.9364e-04, 7.6898e-07, 2.2159e-06, 2.6216e-06, 9.6528e-06, 9.9402e-07,
         4.5074e-06, 1.2865e-05, 5.7314e-06, 3.8518e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[4.5967e-07, 1.2157e-07, 6.1887e-08, 1.8326e-04, 1.8266e-05, 1.0484e-06,
         5.4623e-05, 1.4653e-08, 4.2219e-08, 1.7176e-08, 3.3273e-06, 2.9428e-07,
         9.1282e-06, 9.4378e-07, 8.6539e-07, 2.7710e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.155145
summ of probs approach
id: [18260] -> tensor([[1.0081e-07, 2.0965e-05, 3.6062e-05, 4.9418e-07, 4.5733e-07, 1.0220e-05,
         7.2257e-07, 3.1790e-07, 1.3416e-06, 2.0586e-08, 6.0942e-07, 1.2879e-07,
         1.4337e-05, 1.6755e-05, 1.5098e-05, 1.3593e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.6399e-07, 7.9497e-05, 1.0650e-04, 1.4331e-06, 2.9812e-05, 6.1044e-06,
         7.1913e-06, 1.2576e-05, 6.1388e-06, 3.9198e-06, 7.4295e-06, 1.4732e-05,
         9.0388e-05, 9.9922e-05, 6.0684e-05, 6.3747e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[8.3200e-08, 9.0390e-05, 2.8938e-05, 5.7526e-07, 3.7433e-07, 9.5720e-06,
         1.8625e-07, 1.1962e-06, 1.1464e-06, 7.5817e-08, 9.5770e-07, 3.5964e-07,
         3.0341e-06, 7.6528e-05, 2.4399e-05, 3.6742e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.210136
summ of probs approach
id: [18260] -> tensor([[1.3675e-07, 8.7026e-05, 1.2543e-06, 8.0632e-08, 1.6026e-06, 4.6256e-06,
         5.2071e-06, 2.8814e-07, 4.6973e-06, 8.6697e-07, 2.9169e-05, 5.1733e-07,
         2.4109e-05, 2.4431e-07, 4.6228e-07, 2.6572e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.4361e-07, 2.0947e-04, 1.8189e-06, 8.7929e-06, 5.7971e-06, 2.5750e-05,
         4.4696e-05, 2.8866e-06, 1.5254e-05, 1.3724e-05, 3.3632e-04, 1.3875e-06,
         1.0316e-04, 1.5178e-05, 5.9242e-06, 5.5587e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[3.7859e-08, 5.4783e-06, 1.6080e-06, 7.4481e-08, 6.2410e-07, 6.0160e-06,
         6.8450e-05, 7.3933e-07, 2.7019e-06, 1.2097e-06, 5.0499e-05, 6.9133e-07,
         3.4117e-05, 9.3691e-07, 1.4088e-06, 7.1830e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.135006
summ of probs approach
id: [18260] -> tensor([[8.3608e-08, 1.1991e-06, 1.2222e-07, 1.8146e-06, 3.3581e-07, 1.2448e-05,
         1.1952e-07, 2.4038e-07, 5.0218e-07, 2.1747e-06, 5.4952e-07, 4.6487e-07,
         7.4583e-05, 7.5821e-06, 5.2346e-07, 4.9290e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.0655e-06, 1.6819e-05, 1.7122e-06, 2.4567e-05, 6.1131e-06, 1.8536e-04,
         6.7533e-07, 2.7391e-06, 5.0748e-05, 2.8124e-06, 4.8647e-06, 2.1516e-06,
         8.2795e-05, 1.1152e-04, 6.4846e-05, 7.4115e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[7.2602e-08, 6.0706e-07, 2.9527e-08, 4.2162e-06, 2.8211e-07, 4.4274e-05,
         2.6642e-07, 7.9799e-08, 2.6993e-07, 2.5484e-06, 5.8566e-07, 3.1022e-07,
         3.6266e-04, 1.5198e-05, 3.5155e-07, 8.1295e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.150108
summ of probs approach
id: [18260] -> tensor([[1.3300e-07, 1.8564e-07, 7.8551e-06, 7.4201e-06, 5.5386e-06, 2.7231e-07,
         1.9820e-07, 4.0816e-07, 3.8535e-07, 3.3182e-05, 1.9075e-05, 9.8484e-07,
         1.9101e-07, 3.9887e-06, 2.6417e-07, 2.4252e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[5.4399e-06, 3.8535e-06, 1.3784e-05, 5.5730e-06, 6.2485e-05, 4.3748e-05,
         3.1827e-06, 5.9958e-06, 7.6488e-06, 5.5319e-04, 1.9225e-04, 9.4905e-06,
         3.6778e-06, 7.1697e-05, 1.9957e-05, 1.9137e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[3.4657e-08, 2.0641e-07, 3.8954e-06, 3.7232e-07, 1.0459e-04, 5.8931e-07,
         3.1410e-07, 1.8154e-07, 1.8333e-07, 1.2197e-04, 5.0446e-05, 1.0728e-06,
         4.4191e-07, 2.4598e-05, 2.5716e-08, 4.6163e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.155076
summ of probs approach
id: [18260] -> tensor([[9.2350e-08, 4.6508e-08, 3.9371e-07, 1.2789e-07, 6.4962e-07, 4.5531e-07,
         3.1143e-06, 3.4500e-08, 1.3530e-06, 2.6839e-07, 3.3022e-08, 3.8458e-05,
         1.1922e-05, 4.3557e-06, 1.1054e-05, 2.7304e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.2749e-06, 3.6026e-07, 2.8609e-05, 3.1035e-06, 2.6423e-05, 2.9632e-06,
         2.4754e-05, 3.8480e-06, 2.9831e-05, 5.6096e-06, 2.6744e-06, 1.4610e-04,
         1.1523e-04, 5.3260e-05, 5.9036e-05, 1.4504e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.6346e-08, 1.7042e-08, 5.7299e-07, 5.9716e-08, 4.7619e-07, 6.1121e-08,
         3.7092e-07, 1.2735e-08, 8.4762e-06, 7.2312e-08, 9.3464e-08, 4.9161e-05,
         5.6417e-06, 2.3214e-06, 9.3178e-05, 6.9915e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.260283
summ of probs approach
id: [18260] -> tensor([[4.7161e-07, 5.9404e-07, 7.3292e-09, 1.2036e-06, 2.0484e-05, 3.0649e-06,
         1.5911e-07, 1.1335e-05, 4.1626e-06, 3.2698e-06, 2.7241e-07, 5.1967e-08,
         1.3561e-07, 2.4040e-07, 1.1599e-05, 6.1593e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.3740e-06, 2.6440e-06, 1.7105e-07, 3.5917e-06, 8.0998e-05, 3.5850e-05,
         1.2621e-05, 2.1651e-04, 1.7496e-05, 3.1082e-05, 8.9749e-06, 4.1582e-06,
         7.6991e-07, 2.9806e-06, 9.2765e-05, 2.1960e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[9.8019e-07, 6.0022e-07, 1.9645e-09, 3.3888e-07, 1.4538e-05, 9.1477e-06,
         4.4751e-07, 1.0879e-05, 1.7857e-06, 2.2665e-06, 2.8249e-07, 2.2043e-08,
         1.1708e-07, 5.2751e-07, 2.6174e-05, 7.2406e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.169916
summ of probs approach
id: [18260] -> tensor([[1.9359e-07, 6.2599e-06, 4.6847e-08, 4.6963e-07, 5.6780e-08, 1.6800e-08,
         5.2455e-08, 9.8124e-06, 1.8553e-07, 7.3021e-08, 5.2610e-07, 1.6163e-06,
         1.0887e-05, 3.7526e-07, 4.8677e-07, 6.5695e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.8634e-06, 4.2275e-05, 4.1602e-06, 1.0590e-05, 1.1182e-06, 5.0017e-07,
         1.6448e-06, 5.1071e-05, 1.0295e-06, 2.0046e-06, 4.7653e-06, 1.8465e-06,
         1.8718e-04, 3.2468e-06, 1.4335e-05, 1.3612e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.3781e-07, 1.4197e-05, 1.2026e-07, 3.2159e-07, 3.2293e-08, 3.0050e-09,
         1.2496e-07, 2.4858e-05, 3.4951e-08, 3.6016e-08, 4.2482e-07, 1.2325e-06,
         1.1503e-05, 2.6892e-07, 2.4849e-06, 1.4451e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.163810
summ of probs approach
id: [18260] -> tensor([[4.3985e-07, 8.3475e-08, 2.4606e-07, 2.0530e-07, 4.5543e-06, 8.7216e-05]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [1936] -> tensor([[3.9935e-06, 1.7415e-06, 6.9911e-06, 7.3782e-06, 2.8444e-05, 8.2693e-05]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [137111] -> tensor([[3.8106e-07, 5.4011e-08, 1.4862e-07, 3.3720e-07, 3.2269e-05, 1.6496e-04]],
       device='cuda:0'), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.055284
acc:  0.37373737373737376
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.045740
path ['42', 'en', 'bloom', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [18260], 'attention_mask': [1]}
id:[18260]
answer  {'input_ids': [1936], 'attention_mask': [1]}
id:[1936]
answer  {'input_ids': [137111], 'attention_mask': [1]}
id:[137111]
load model Duration: 0:00:08.590050
prompt_type null has 1 prompts in it
----------- 42 en bigscience/bloomz-560m NLI null 0 200 16 --------------
summ of probs approach
id: [18260] -> tensor([[1.9724e-08, 4.4340e-08, 4.8086e-11, 4.1802e-08, 1.0845e-10, 2.9631e-10,
         1.7610e-09, 2.9470e-10, 9.5625e-10, 2.6197e-08, 7.8490e-09, 8.2602e-09,
         1.6267e-09, 5.7458e-08, 3.6254e-09, 1.4507e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.7527e-07, 8.9414e-08, 7.0143e-08, 4.4550e-07, 1.2962e-09, 1.4916e-07,
         5.5111e-08, 1.1768e-07, 5.6836e-09, 8.3104e-09, 3.8380e-07, 7.4595e-09,
         1.3074e-07, 2.2872e-07, 6.6257e-09, 4.7539e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.4304e-08, 1.1201e-09, 1.2077e-11, 2.6022e-08, 1.7271e-10, 3.7948e-11,
         1.7861e-10, 2.2345e-11, 1.0201e-11, 6.8749e-10, 1.8993e-09, 5.4655e-10,
         3.7811e-10, 7.3902e-09, 1.8779e-10, 2.8752e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.200480
summ of probs approach
id: [18260] -> tensor([[6.7949e-09, 1.5350e-09, 4.4298e-09, 2.3646e-07, 4.1379e-10, 1.5912e-07,
         9.3908e-08, 5.6068e-08, 1.0887e-08, 9.9001e-09, 5.4962e-07, 2.8764e-09,
         1.0206e-09, 9.5371e-09, 4.1848e-10, 9.3518e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.3052e-07, 2.6381e-08, 3.9769e-08, 1.2012e-07, 3.8226e-08, 9.6532e-08,
         2.3045e-07, 3.9619e-08, 3.8111e-07, 1.2585e-07, 3.7214e-07, 6.3043e-08,
         1.6256e-07, 3.9127e-07, 5.4009e-08, 3.7738e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[7.5808e-10, 3.0225e-10, 3.2279e-09, 1.2518e-08, 6.9414e-11, 1.2021e-08,
         1.0576e-08, 1.2216e-09, 4.4345e-10, 1.0213e-09, 2.2478e-08, 7.4313e-10,
         1.5272e-10, 2.3818e-09, 5.0331e-11, 1.1274e-11]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.137825
summ of probs approach
id: [18260] -> tensor([[4.2467e-07, 1.4193e-08, 5.6325e-09, 7.2391e-07, 5.4748e-11, 7.4505e-10,
         1.0275e-07, 2.2272e-09, 2.2137e-09, 3.4048e-06, 1.8662e-07, 2.6044e-09,
         2.7539e-10, 1.7242e-08, 1.9764e-07, 1.1329e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[3.5601e-07, 1.0114e-07, 1.9374e-08, 2.8663e-06, 1.5369e-09, 3.5464e-09,
         2.1081e-07, 1.6675e-09, 2.3732e-09, 7.2850e-07, 5.4518e-08, 1.1205e-08,
         6.7495e-09, 6.2423e-08, 6.7987e-06, 1.2049e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[3.4253e-08, 2.8996e-09, 1.4675e-10, 5.3686e-07, 2.6680e-12, 4.9261e-10,
         3.6994e-07, 3.8770e-11, 1.6778e-10, 2.8905e-08, 1.0805e-09, 6.1025e-10,
         1.7185e-11, 1.6976e-09, 1.0741e-07, 1.2602e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.148909
summ of probs approach
id: [18260] -> tensor([[2.5876e-09, 3.6035e-09, 7.6959e-10, 8.9807e-09, 1.9763e-09, 5.6287e-09,
         1.1304e-08, 1.9681e-07, 3.3840e-10, 1.5859e-07, 5.1939e-09, 1.1438e-08,
         8.5768e-09, 2.5330e-07, 4.8525e-07, 1.4742e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.5222e-09, 4.6936e-07, 9.3746e-09, 9.1146e-09, 1.1692e-08, 3.4213e-09,
         3.7805e-08, 1.9607e-06, 3.2864e-09, 6.6734e-07, 5.6133e-08, 1.8368e-07,
         1.3988e-07, 4.6197e-06, 1.3908e-06, 1.1328e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[2.4749e-11, 2.5550e-10, 6.3316e-11, 6.2598e-11, 3.1114e-11, 5.0138e-10,
         3.6571e-09, 1.2246e-08, 3.1489e-11, 8.5738e-08, 1.0321e-09, 7.4630e-09,
         1.6408e-09, 3.7453e-08, 2.4170e-07, 6.3851e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.120034
summ of probs approach
id: [18260] -> tensor([[9.6737e-09, 6.9699e-10, 3.8411e-09, 3.1047e-10, 7.9582e-11, 3.0105e-10,
         9.3474e-08, 6.6039e-10, 5.8093e-10, 5.8038e-08, 1.0785e-10, 1.0070e-08,
         2.3916e-07, 2.7205e-09, 1.0005e-09, 2.2312e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[9.3347e-09, 2.3162e-08, 4.9134e-08, 1.0587e-08, 1.1574e-09, 3.7159e-09,
         2.2033e-07, 1.3840e-08, 8.6108e-09, 2.5542e-07, 7.9096e-09, 8.1606e-08,
         2.9285e-06, 1.9325e-08, 2.0216e-09, 2.5174e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[3.1986e-09, 1.7786e-10, 1.1869e-09, 7.0305e-12, 9.2958e-12, 4.4387e-11,
         2.1362e-08, 6.4803e-11, 4.8865e-11, 1.0763e-08, 3.0505e-12, 7.9316e-10,
         8.4247e-08, 3.0995e-11, 6.4935e-11, 2.1701e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.112520
summ of probs approach
id: [18260] -> tensor([[1.0121e-10, 4.1820e-09, 1.4493e-09, 1.9662e-10, 1.0098e-08, 1.2286e-07,
         3.3224e-07, 6.8573e-09, 3.5261e-11, 2.4501e-08, 2.5825e-08, 7.9448e-09,
         1.1396e-09, 2.9724e-09, 6.6501e-07, 9.0751e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.4764e-09, 1.4538e-07, 1.3353e-07, 5.6327e-09, 3.1120e-08, 7.8597e-07,
         6.2981e-06, 3.3633e-07, 9.6954e-10, 1.2464e-08, 1.3877e-06, 6.9916e-09,
         1.2034e-08, 5.3922e-09, 7.6390e-06, 2.9627e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[2.8499e-11, 4.9798e-09, 2.1232e-10, 7.6829e-11, 1.4400e-09, 4.5476e-09,
         1.3145e-07, 9.2117e-10, 7.0747e-12, 1.8996e-09, 2.8143e-08, 3.4665e-09,
         1.9782e-09, 9.6591e-10, 1.3167e-07, 1.6300e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.165980
summ of probs approach
id: [18260] -> tensor([[8.9026e-08, 1.2588e-07, 2.2155e-07, 7.5653e-10, 2.3446e-09, 3.3479e-08,
         4.0990e-08, 4.3952e-07, 2.0392e-07, 9.2786e-11, 2.8468e-08, 1.3632e-10,
         2.0357e-10, 4.8204e-11, 2.9951e-10, 4.8958e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.2835e-06, 7.2925e-07, 4.8375e-07, 1.5408e-07, 1.3948e-08, 7.5822e-08,
         3.4353e-07, 3.3001e-06, 9.1082e-07, 1.5342e-07, 6.1215e-07, 6.1687e-09,
         1.9137e-08, 1.9419e-08, 4.4054e-09, 7.5897e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[2.2269e-07, 3.2613e-08, 7.2196e-08, 1.3661e-10, 9.9939e-09, 5.1830e-10,
         1.3719e-10, 7.8205e-08, 4.2251e-08, 4.6438e-11, 6.6360e-09, 3.2205e-10,
         1.7084e-11, 8.1820e-12, 1.6263e-11, 1.9395e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.163793
summ of probs approach
id: [18260] -> tensor([[7.1329e-09, 5.3462e-09, 2.2789e-08, 1.1360e-08, 9.4988e-10, 1.0157e-09,
         4.7366e-10, 1.6991e-06, 2.1721e-07, 6.4821e-09, 7.2451e-10, 1.6595e-09,
         2.1894e-09, 1.1372e-08, 4.6769e-08, 6.2579e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.1984e-08, 1.9418e-08, 2.4780e-08, 2.8916e-07, 1.5836e-07, 2.6120e-08,
         2.9201e-08, 6.4934e-06, 1.0223e-06, 6.1701e-08, 9.6797e-08, 2.3017e-08,
         1.3492e-07, 1.0735e-06, 1.5711e-06, 7.5434e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[7.6829e-10, 2.5854e-10, 2.5335e-10, 2.9811e-09, 6.2845e-12, 6.4874e-10,
         2.6572e-10, 1.5863e-07, 1.0478e-07, 2.0336e-09, 1.4665e-10, 1.4704e-11,
         4.2922e-10, 3.9550e-09, 6.2816e-09, 1.1690e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.256462
summ of probs approach
id: [18260] -> tensor([[8.7148e-10, 9.3000e-08, 6.7994e-09, 4.3037e-08, 1.3152e-09, 8.8465e-11,
         5.7781e-10, 4.5489e-09, 3.7146e-10, 1.0172e-07, 2.6474e-08, 1.7480e-07,
         4.3758e-08, 2.6785e-08, 5.0066e-09, 1.6359e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[1.5335e-08, 1.6665e-06, 4.7278e-08, 1.9980e-07, 7.6316e-08, 3.0740e-09,
         3.2818e-08, 8.2044e-08, 1.9758e-08, 1.4965e-06, 5.3468e-08, 6.7986e-07,
         1.0596e-07, 1.1826e-07, 4.0326e-07, 3.0379e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[6.3999e-11, 1.7461e-08, 1.4923e-09, 1.7906e-08, 2.7736e-10, 3.5376e-11,
         7.8164e-11, 3.2641e-10, 3.2731e-11, 3.0573e-07, 3.5740e-09, 3.5581e-08,
         6.2978e-09, 1.5647e-09, 7.4698e-09, 3.1478e-10]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.212333
summ of probs approach
id: [18260] -> tensor([[7.3909e-08, 1.4316e-08, 1.6495e-08, 6.1190e-08, 2.7478e-08, 2.2900e-09,
         9.6785e-09, 3.8085e-11, 9.9690e-10, 5.9181e-10, 3.1888e-09, 1.4784e-11,
         5.3731e-10, 8.0751e-08, 2.1784e-10, 4.3262e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.5185e-07, 6.6561e-08, 1.4755e-07, 2.5866e-06, 1.3749e-07, 3.0389e-08,
         6.3537e-08, 1.8882e-09, 1.8559e-08, 6.2243e-08, 8.5706e-09, 3.9729e-10,
         5.0799e-07, 6.2426e-07, 4.7470e-09, 3.0412e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.1247e-08, 2.3753e-09, 6.6708e-09, 7.6611e-08, 1.2092e-08, 7.0832e-10,
         4.0276e-10, 6.4511e-12, 8.3574e-10, 3.4409e-11, 3.3470e-10, 8.4387e-14,
         1.6752e-11, 1.3068e-08, 2.7702e-11, 1.0058e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.151499
summ of probs approach
id: [18260] -> tensor([[4.8618e-10, 6.9846e-10, 8.8081e-11, 7.6749e-06, 1.2255e-10, 7.4711e-09,
         3.0690e-09, 2.0565e-09, 2.0908e-09, 1.1403e-07, 2.6619e-09, 6.3035e-09,
         1.8280e-09, 1.3532e-10, 1.9352e-07, 1.3822e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[4.0665e-09, 4.0355e-09, 1.7330e-09, 4.0617e-05, 3.8152e-09, 3.5191e-09,
         5.0823e-08, 2.0627e-08, 2.4769e-07, 6.3506e-07, 2.1071e-08, 2.3619e-09,
         2.0377e-08, 6.9116e-10, 2.2619e-06, 6.7874e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[1.1102e-11, 6.4367e-11, 2.4250e-11, 3.9362e-07, 1.3215e-10, 1.3038e-09,
         5.1762e-10, 1.4452e-10, 3.9776e-09, 1.9296e-08, 2.7507e-10, 6.9471e-10,
         4.7656e-11, 8.2263e-12, 3.5248e-08, 9.6691e-12]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.148948
summ of probs approach
id: [18260] -> tensor([[2.1627e-09, 5.6756e-10, 1.3381e-09, 4.9093e-08, 4.0456e-08, 2.1169e-10,
         1.1949e-08, 8.3983e-10, 9.4238e-09, 2.6332e-10, 2.8039e-09, 1.6011e-08,
         3.3573e-09, 1.7321e-08, 1.5300e-09, 9.3421e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [1936] -> tensor([[2.1678e-09, 4.3433e-08, 2.0970e-07, 7.5100e-08, 1.7905e-06, 1.8022e-08,
         1.3023e-08, 2.4529e-07, 3.4656e-08, 1.1921e-08, 2.9485e-08, 2.1261e-08,
         3.5915e-08, 5.3051e-07, 3.2881e-08, 8.0423e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [137111] -> tensor([[5.0068e-10, 3.2507e-10, 3.9649e-11, 1.3070e-08, 1.9086e-07, 2.6089e-11,
         1.0892e-10, 1.0549e-10, 2.0192e-08, 3.9178e-10, 2.2970e-10, 5.3092e-09,
         7.3750e-09, 2.7341e-09, 1.5466e-10, 2.2084e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.136854
summ of probs approach
id: [18260] -> tensor([[5.8615e-09, 3.1195e-07, 1.1102e-07, 3.5214e-10, 5.8629e-08, 7.7266e-07]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [1936] -> tensor([[1.9828e-08, 4.2413e-06, 2.1074e-07, 8.3108e-09, 3.4478e-07, 3.4062e-06]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [137111] -> tensor([[1.5660e-10, 2.1423e-07, 3.6354e-08, 2.2913e-10, 1.4464e-08, 3.4487e-07]],
       device='cuda:0'), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.050131
acc:  0.3686868686868687
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.044211
path ['42', 'en', 'bloomz', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [4273, 1], 'attention_mask': [1, 1]}
id: [4273, 1] -> [4273]
answer  {'input_ids': [150, 1], 'attention_mask': [1, 1]}
id: [150, 1] -> [150]
answer  {'input_ids': [2087, 1], 'attention_mask': [1, 1]}
id: [2087, 1] -> [2087]
load model Duration: 0:00:03.107250
prompt_type null has 1 prompts in it
----------- 42 en google/flan-t5-base NLI null 0 200 16 --------------
summ of probs approach
id: [4273] -> tensor([[1.7807e-04, 3.3306e-03, 1.0920e-06, 7.8345e-04, 5.7374e-04, 8.1574e-05,
         7.9427e-06, 2.0584e-02, 2.2349e-03, 1.3681e-06, 2.9025e-06, 3.4035e-05,
         1.2853e-03, 2.4059e-03, 1.0445e-06, 5.5549e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[5.2953e-04, 5.3822e-03, 2.3917e-06, 3.6373e-03, 4.1931e-03, 1.3030e-04,
         2.9405e-05, 1.6828e-02, 1.7651e-02, 4.9449e-05, 1.5861e-03, 1.6138e-03,
         1.9978e-02, 4.2883e-03, 8.4373e-06, 8.4852e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.8915e-05, 1.2940e-03, 7.2642e-08, 3.9640e-05, 3.4428e-06, 9.0842e-07,
         2.1553e-07, 4.4214e-04, 2.0100e-04, 8.2887e-08, 1.7171e-06, 1.7125e-05,
         6.4998e-05, 1.0609e-04, 1.7331e-06, 8.7077e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.104322
summ of probs approach
id: [4273] -> tensor([[4.1777e-04, 4.0380e-04, 5.6962e-03, 2.8972e-03, 4.6694e-04, 5.7532e-05,
         1.6340e-04, 2.5099e-03, 3.1138e-05, 2.6664e-03, 1.0061e-05, 9.8955e-04,
         4.1064e-04, 1.2952e-02, 1.8578e-04, 1.7598e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.1908e-02, 1.2526e-03, 3.0967e-02, 1.2022e-02, 5.5917e-04, 3.4124e-04,
         3.7143e-03, 3.6087e-03, 6.6884e-05, 1.0731e-02, 5.4281e-03, 5.3049e-03,
         1.1503e-01, 9.1054e-03, 1.1241e-03, 2.8459e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.2022e-04, 2.5728e-05, 2.5647e-03, 1.9879e-05, 1.0776e-04, 6.4341e-06,
         8.4254e-06, 1.7574e-04, 3.4101e-06, 5.1992e-04, 3.1907e-07, 1.8105e-05,
         7.3879e-05, 6.7944e-04, 6.6132e-06, 5.9727e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.097205
summ of probs approach
id: [4273] -> tensor([[1.7831e-06, 3.9205e-05, 2.3765e-04, 3.9586e-05, 2.4445e-02, 6.5530e-05,
         2.0738e-05, 2.0379e-02, 3.7803e-03, 9.1990e-04, 6.0068e-03, 4.7786e-05,
         4.3314e-03, 2.9409e-04, 2.1846e-05, 1.6612e-02]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.3551e-05, 2.6187e-04, 8.2770e-03, 6.4706e-04, 2.4911e-03, 1.5501e-02,
         3.0935e-04, 1.6071e-01, 3.5992e-03, 2.2418e-03, 8.1134e-02, 1.0649e-04,
         3.1396e-02, 2.5235e-03, 1.4097e-05, 6.8495e-02]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[3.7913e-08, 3.3194e-06, 1.5748e-04, 1.1587e-05, 1.6070e-03, 2.2936e-05,
         1.6648e-06, 1.4649e-03, 6.1189e-04, 2.0345e-05, 7.3336e-04, 1.8486e-06,
         1.5366e-03, 2.1593e-04, 2.5157e-06, 1.7270e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.114394
summ of probs approach
id: [4273] -> tensor([[1.4659e-03, 2.9628e-04, 5.7098e-04, 9.3912e-05, 4.6698e-05, 2.9938e-04,
         4.1195e-05, 1.1431e-03, 5.1936e-05, 2.1439e-05, 3.6064e-04, 7.1749e-04,
         1.1494e-03, 1.1469e-03, 7.9799e-03, 6.7062e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[0.0057, 0.0016, 0.0036, 0.0044, 0.0011, 0.0029, 0.0004, 0.0153, 0.0012,
         0.0006, 0.0031, 0.0019, 0.0009, 0.1414, 0.0175, 0.0065]],
       device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[5.1160e-05, 2.8785e-06, 1.5207e-05, 3.6727e-06, 1.7289e-06, 3.2344e-05,
         1.4387e-05, 5.1053e-05, 5.4866e-06, 5.6023e-06, 1.7816e-04, 2.5542e-04,
         4.0781e-05, 1.2713e-04, 1.9314e-05, 4.8921e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.116154
summ of probs approach
id: [4273] -> tensor([[3.5305e-05, 1.7068e-04, 2.9099e-03, 8.7430e-05, 1.1280e-04, 8.6697e-02,
         7.5707e-06, 1.8310e-02, 4.0877e-05, 2.2588e-03, 6.6939e-04, 3.9560e-05,
         5.2838e-07, 7.6618e-09, 9.5365e-04, 1.4575e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.0870e-04, 5.6150e-04, 1.7237e-02, 4.2110e-04, 3.5250e-03, 1.4602e-02,
         1.0369e-04, 3.3082e-03, 9.6838e-04, 2.4545e-03, 1.6887e-03, 1.6432e-04,
         2.7385e-06, 1.4477e-07, 9.8866e-04, 6.7813e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[8.2416e-06, 3.3301e-05, 3.8553e-05, 2.8982e-06, 2.8883e-05, 8.6068e-05,
         1.4322e-07, 2.3844e-04, 2.6324e-05, 9.1427e-05, 2.6807e-05, 2.5120e-06,
         1.4059e-07, 9.2593e-10, 5.5003e-05, 3.5730e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.077215
summ of probs approach
id: [4273] -> tensor([[6.1448e-04, 2.3596e-02, 7.6854e-07, 2.0751e-04, 2.5000e-04, 5.8965e-04,
         3.2329e-04, 3.4609e-03, 1.2891e-04, 1.2119e-04, 3.8606e-03, 3.3726e-04,
         1.6520e-04, 6.9957e-05, 2.0754e-02, 2.0165e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.0529e-03, 2.3408e-02, 5.6660e-06, 1.9305e-03, 1.1040e-03, 6.8221e-03,
         3.1767e-04, 1.0996e-02, 5.2958e-04, 2.0161e-03, 6.3930e-03, 1.8924e-03,
         1.4763e-03, 2.3853e-03, 5.1570e-03, 1.4138e-02]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[7.6837e-04, 1.9372e-03, 8.7679e-08, 1.7630e-04, 4.1109e-05, 6.6247e-05,
         3.1280e-04, 6.0729e-04, 1.2888e-05, 8.8216e-06, 4.2243e-04, 1.4920e-06,
         1.5392e-05, 2.6195e-05, 5.3818e-04, 2.1048e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.150621
summ of probs approach
id: [4273] -> tensor([[1.2846e-05, 4.7004e-05, 5.8413e-04, 1.8161e-03, 7.2914e-04, 1.4316e-03,
         7.8497e-04, 5.9048e-03, 8.4234e-05, 7.4186e-04, 2.0929e-03, 3.6465e-02,
         6.4708e-03, 1.5479e-04, 6.1542e-04, 8.7993e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.0241e-04, 3.0140e-04, 2.3078e-03, 4.0233e-03, 7.5524e-03, 4.3480e-02,
         1.9305e-03, 4.3978e-02, 1.3945e-04, 1.0631e-03, 7.3447e-03, 1.3037e-02,
         2.2539e-03, 5.0275e-03, 3.5154e-03, 1.6704e-01]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.1457e-04, 1.2925e-06, 1.0375e-03, 1.8346e-05, 1.5585e-05, 1.5707e-05,
         7.8404e-05, 3.6933e-04, 8.4227e-06, 4.0374e-05, 1.3227e-04, 2.2173e-03,
         3.4091e-05, 6.9602e-05, 3.4836e-05, 1.8491e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.100802
summ of probs approach
id: [4273] -> tensor([[1.3734e-05, 1.0145e-04, 1.6751e-02, 7.6477e-06, 6.1772e-06, 2.0239e-01,
         2.5089e-05, 2.9360e-06, 2.4558e-07, 1.1032e-02, 8.9184e-05, 5.5272e-06,
         3.1351e-06, 1.1412e-05, 3.5240e-04, 8.0652e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.3334e-02, 3.9029e-04, 2.0946e-02, 2.7055e-05, 6.9251e-05, 1.9247e-01,
         3.7885e-03, 8.4494e-05, 1.4209e-06, 2.4675e-02, 2.1503e-03, 3.7548e-05,
         3.8525e-04, 5.1275e-04, 1.3991e-02, 8.1886e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[7.9953e-07, 5.1689e-06, 4.5356e-03, 2.8126e-06, 3.0235e-06, 1.6894e-04,
         4.8178e-07, 8.8806e-09, 1.9469e-07, 3.0935e-04, 4.9253e-05, 9.6493e-07,
         2.7500e-07, 3.2707e-06, 1.7099e-05, 9.1358e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.087799
summ of probs approach
id: [4273] -> tensor([[8.1381e-06, 1.3637e-02, 1.9614e-04, 4.2441e-04, 3.4714e-04, 4.4704e-03,
         3.7326e-04, 8.0716e-04, 5.0860e-04, 3.8549e-04, 3.7512e-05, 5.8852e-04,
         4.6840e-03, 1.1959e-03, 4.3600e-05, 1.9778e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[1.1922e-04, 1.7950e-02, 7.2437e-04, 2.7266e-04, 6.8059e-02, 8.2846e-03,
         4.6151e-03, 6.4851e-04, 1.1078e-03, 7.6854e-03, 1.1944e-01, 2.6509e-03,
         5.2645e-03, 7.7575e-04, 2.6785e-03, 7.0038e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.2683e-06, 1.5251e-02, 3.5357e-05, 3.9137e-05, 1.7251e-04, 9.9377e-04,
         6.8592e-04, 3.2078e-04, 2.8037e-06, 8.2353e-05, 1.4500e-06, 3.7062e-04,
         2.3122e-04, 2.5677e-03, 1.2426e-05, 1.8465e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.079666
summ of probs approach
id: [4273] -> tensor([[2.5999e-04, 3.2306e-04, 2.1411e-05, 1.8080e-04, 1.4922e-04, 4.3274e-04,
         1.9137e-05, 1.5837e-06, 2.1352e-03, 2.1671e-03, 2.0343e-03, 1.1000e-03,
         4.5763e-04, 2.3939e-05, 2.5761e-03, 3.6856e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[3.2884e-04, 2.8169e-03, 4.9492e-04, 4.0517e-03, 4.1071e-03, 5.6643e-04,
         5.5291e-05, 3.6475e-05, 2.2994e-03, 2.9868e-02, 1.1798e-02, 2.1174e-03,
         7.1725e-04, 2.4160e-03, 4.1507e-03, 1.0052e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[3.9720e-04, 1.9565e-05, 3.8185e-06, 5.0428e-05, 6.6011e-06, 2.6178e-05,
         1.9867e-06, 5.3905e-07, 6.8280e-04, 2.1354e-04, 3.3394e-04, 2.2654e-05,
         4.1827e-06, 4.8455e-06, 1.9945e-05, 4.9956e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.085813
summ of probs approach
id: [4273] -> tensor([[9.4299e-04, 6.7714e-04, 5.6085e-04, 5.8359e-03, 2.8960e-04, 5.2452e-05,
         1.2352e-04, 9.9446e-04, 4.7417e-04, 5.0422e-04, 8.0284e-04, 4.4407e-04,
         1.0593e-04, 4.4630e-06, 3.0351e-06, 1.5521e-03]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[2.3479e-03, 2.1579e-03, 5.1627e-02, 4.2192e-02, 2.5797e-03, 7.4322e-04,
         8.7914e-04, 2.1931e-03, 1.1118e-04, 7.2624e-04, 3.0869e-03, 1.3334e-03,
         8.7606e-04, 3.0964e-05, 6.7096e-06, 1.0072e-02]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.8335e-05, 5.8252e-04, 2.2935e-05, 3.9620e-05, 8.8814e-07, 5.2967e-06,
         1.0492e-05, 6.5708e-04, 2.6211e-05, 1.8545e-05, 1.5036e-04, 5.9150e-05,
         3.6826e-06, 2.5871e-08, 3.2330e-06, 1.8924e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.080060
summ of probs approach
id: [4273] -> tensor([[3.4969e-05, 1.6609e-04, 8.7055e-04, 8.4429e-05, 1.1382e-04, 1.0732e-03,
         1.0455e-03, 1.3994e-03, 8.9978e-05, 1.0875e-05, 6.7191e-03, 1.2406e-07,
         2.2062e-04, 6.6362e-05, 1.1783e-04, 2.5706e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [150] -> tensor([[6.5021e-04, 9.4854e-04, 1.2257e-03, 4.8038e-01, 1.7780e-03, 1.1443e-02,
         1.1290e-02, 9.9701e-03, 1.8694e-03, 1.4450e-04, 5.7782e-04, 1.6826e-06,
         1.2561e-01, 7.8987e-04, 3.8156e-04, 1.1464e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [2087] -> tensor([[1.5416e-05, 4.7319e-05, 3.1104e-05, 1.3659e-06, 1.3603e-05, 6.5016e-05,
         2.3266e-06, 3.6252e-05, 2.3961e-05, 2.1101e-06, 5.6256e-06, 4.1914e-08,
         3.9631e-06, 1.1035e-05, 3.5088e-06, 4.1620e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.065283
summ of probs approach
id: [4273] -> tensor([[1.5104e-04, 2.1429e-03, 1.1401e-03, 1.7284e-03, 2.5611e-04, 1.6409e-06]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [150] -> tensor([[8.5407e-03, 5.1439e-03, 2.1324e-03, 4.1348e-03, 1.0827e-01, 4.1819e-06]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [2087] -> tensor([[5.1148e-07, 1.0057e-04, 2.6358e-05, 2.2253e-03, 3.2803e-06, 2.1931e-07]],
       device='cuda:0'), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.043721
acc:  0.3686868686868687
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.239584
path ['42', 'en', 'flan', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.30s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 4874], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 4874] -> [4874]
answer  {'input_ids': [1, 694], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 694] -> [694]
answer  {'input_ids': [1, 5505], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 5505] -> [5505]
load model Duration: 0:02:28.680936
prompt_type null has 1 prompts in it
----------- 42 en huggyllama/llama-7b NLI null 0 200 16 --------------
summ of probs approach
id: [4874] -> tensor([[5.6028e-06, 6.0940e-04, 1.1921e-06, 1.2934e-05, 3.2187e-06, 1.4305e-06,
         2.1100e-05, 5.9319e-04, 2.9087e-05, 6.4373e-06, 4.7684e-07, 1.4305e-06,
         1.0014e-05, 5.9605e-08, 1.1921e-07, 3.2783e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[4.2319e-06, 7.0667e-04, 3.9935e-06, 2.2256e-04, 1.0842e-04, 7.0333e-06,
         1.1468e-04, 8.0442e-04, 2.4199e-05, 5.2810e-05, 2.9802e-06, 1.6093e-06,
         1.1146e-05, 4.7684e-07, 6.5565e-07, 5.0247e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[7.3910e-06, 4.5109e-04, 1.0133e-06, 1.0729e-05, 1.4305e-06, 2.4438e-06,
         2.2590e-05, 3.5076e-03, 4.5776e-05, 2.2352e-05, 7.1526e-07, 7.7486e-07,
         1.4186e-05, 0.0000e+00, 5.9605e-08, 2.6226e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.279043
summ of probs approach
id: [4874] -> tensor([[2.3842e-07, 3.0041e-04, 1.0139e-04, 1.5378e-04, 1.0729e-06, 1.7321e-04,
         2.7657e-05, 3.7193e-05, 1.0133e-06, 3.1710e-04, 1.4007e-05, 1.1921e-07,
         6.6757e-06, 8.1778e-05, 4.8339e-05, 3.9697e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[2.2054e-06, 1.1140e-04, 8.7082e-05, 1.3733e-04, 1.8001e-04, 2.1636e-04,
         6.0797e-06, 5.8115e-05, 1.7047e-05, 2.3937e-04, 5.3048e-05, 8.3447e-07,
         1.1921e-05, 1.8322e-04, 1.4877e-04, 1.9205e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[5.9605e-07, 2.5105e-04, 6.8605e-05, 7.0858e-04, 4.7684e-07, 4.8208e-04,
         5.1856e-06, 1.1283e-04, 9.5367e-07, 8.8036e-05, 1.3053e-05, 5.9605e-08,
         8.5235e-06, 7.5221e-05, 8.7738e-05, 1.1265e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.254357
summ of probs approach
id: [4874] -> tensor([[3.0994e-06, 6.0976e-05, 1.8716e-05, 8.5235e-06, 2.9385e-05, 6.8545e-06,
         5.3644e-07, 1.0169e-04, 4.7684e-07, 3.2187e-06, 4.7469e-04, 5.9605e-08,
         3.1292e-05, 5.1785e-04, 2.2650e-06, 7.1526e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.9670e-06, 6.2406e-05, 1.5378e-05, 1.0550e-05, 3.8862e-05, 1.1086e-05,
         1.6093e-06, 1.4603e-04, 4.4703e-06, 1.0967e-05, 1.5962e-04, 1.7881e-06,
         6.2525e-05, 3.8767e-04, 1.9014e-05, 5.6863e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[1.7285e-06, 3.7551e-05, 3.6263e-04, 2.7418e-06, 3.3379e-05, 8.9407e-07,
         1.1921e-07, 2.2364e-04, 1.3113e-06, 1.6689e-06, 8.3148e-05, 1.1921e-07,
         4.4823e-05, 2.8157e-04, 2.6822e-06, 5.7220e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.491138
summ of probs approach
id: [4874] -> tensor([[2.7597e-05, 7.1526e-07, 5.7220e-06, 3.7551e-06, 8.2850e-06, 2.5630e-06,
         5.6624e-06, 1.6510e-05, 4.1723e-07, 2.9802e-07, 3.3927e-04, 2.5630e-06,
         9.0599e-06, 1.1921e-06, 1.4305e-06, 2.4438e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[4.0352e-05, 9.2387e-06, 2.6166e-05, 5.0664e-06, 2.6286e-05, 4.9770e-05,
         4.7863e-05, 3.2425e-05, 1.6689e-06, 8.9407e-07, 1.6594e-04, 4.5300e-06,
         9.0003e-06, 1.7881e-06, 1.8477e-06, 1.1742e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[9.8944e-06, 2.9802e-07, 2.7776e-05, 7.2122e-06, 5.5671e-05, 1.1325e-06,
         1.1325e-05, 4.8220e-05, 2.3842e-07, 2.9802e-07, 4.4405e-05, 9.5367e-07,
         3.7551e-06, 1.7881e-06, 2.9802e-07, 9.3579e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.256983
summ of probs approach
id: [4874] -> tensor([[1.1921e-06, 1.5914e-05, 1.7881e-07, 9.5367e-06, 1.1921e-06, 1.1921e-07,
         1.5831e-04, 9.0599e-06, 1.6749e-05, 9.7847e-04, 1.6689e-06, 5.1260e-06,
         3.5763e-07, 6.5565e-07, 6.5565e-07, 3.6573e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.3113e-06, 7.8082e-05, 6.5565e-07, 3.4511e-05, 2.5630e-06, 1.6689e-06,
         1.0306e-04, 6.8545e-06, 1.5080e-05, 1.4172e-03, 8.5831e-06, 1.2517e-05,
         7.5698e-06, 3.5763e-06, 1.9073e-06, 5.6887e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[7.7486e-07, 1.7059e-04, 5.9605e-08, 5.1260e-06, 5.9605e-07, 1.1921e-07,
         9.1195e-06, 1.0729e-05, 1.4901e-06, 5.7507e-04, 3.5763e-07, 2.5034e-06,
         8.3447e-07, 3.5763e-07, 4.7684e-07, 2.6655e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.272828
summ of probs approach
id: [4874] -> tensor([[1.8477e-06, 5.0068e-06, 2.7835e-05, 4.9472e-06, 9.4271e-04, 1.2505e-04,
         1.7881e-07, 4.1723e-07, 7.7486e-07, 3.4451e-05, 6.5565e-07, 1.3113e-06,
         2.9802e-07, 2.6226e-06, 1.7285e-06, 1.7881e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[2.0862e-06, 7.1526e-06, 8.2552e-05, 1.2398e-05, 1.2197e-03, 7.3314e-05,
         2.5988e-05, 2.3842e-07, 4.2915e-06, 8.8036e-05, 1.6153e-05, 2.8610e-06,
         3.2187e-06, 6.3717e-05, 5.1260e-06, 3.6359e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[2.7418e-06, 1.1384e-05, 3.0637e-05, 7.2718e-06, 2.1875e-04, 9.7513e-05,
         0.0000e+00, 5.9605e-08, 3.5763e-07, 6.8009e-05, 1.5497e-06, 4.7684e-06,
         4.7684e-07, 4.1127e-06, 1.2815e-05, 2.3842e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.279147
summ of probs approach
id: [4874] -> tensor([[2.6226e-06, 1.6689e-06, 5.9605e-07, 5.9605e-08, 7.1526e-07, 3.3975e-06,
         1.0669e-05, 8.5449e-04, 3.2973e-04, 2.8014e-06, 4.5443e-04, 9.5367e-07,
         9.4771e-06, 4.7684e-06, 5.2452e-06, 4.2319e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[7.6294e-06, 7.3314e-06, 2.3544e-05, 2.0266e-06, 1.8477e-06, 3.5763e-06,
         1.5140e-05, 7.9918e-04, 3.7503e-04, 1.0729e-05, 1.8902e-03, 3.6359e-06,
         2.1219e-05, 4.5300e-06, 1.9550e-05, 7.5698e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[7.4804e-05, 1.4305e-06, 1.1921e-06, 0.0000e+00, 2.3842e-07, 6.0797e-06,
         1.8537e-05, 1.3971e-04, 1.7035e-04, 9.5367e-07, 6.1274e-04, 2.3842e-07,
         2.4736e-05, 1.9073e-06, 1.0133e-06, 3.9339e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.323920
summ of probs approach
id: [4874] -> tensor([[3.1924e-04, 1.2696e-05, 4.8280e-06, 2.2233e-05, 3.9935e-04, 5.1856e-06,
         1.7881e-07, 5.6624e-06, 1.1081e-04, 4.1723e-07, 4.7684e-07, 7.7486e-07,
         6.9737e-06, 1.0133e-06, 1.0729e-06, 1.7881e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.9670e-04, 1.6928e-05, 1.0371e-05, 1.1688e-04, 1.2672e-04, 5.1856e-06,
         8.3447e-07, 3.8743e-06, 1.2565e-04, 1.9610e-05, 4.1723e-06, 2.3663e-05,
         2.0683e-05, 2.5332e-05, 1.4901e-06, 8.1062e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[3.7909e-04, 1.5557e-05, 1.9670e-06, 3.6001e-05, 7.4327e-05, 5.0664e-06,
         2.9802e-07, 3.4571e-06, 8.6665e-05, 1.7881e-07, 6.5565e-07, 1.6689e-06,
         6.7949e-06, 1.2517e-06, 4.1723e-07, 4.1723e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.225205
summ of probs approach
id: [4874] -> tensor([[6.7174e-05, 1.1659e-04, 1.5497e-06, 1.3769e-05, 1.5140e-05, 5.3930e-04,
         2.5630e-06, 1.4901e-06, 6.7949e-06, 1.2481e-04, 2.8610e-06, 2.6107e-05,
         3.5763e-07, 2.4307e-04, 1.4961e-05, 7.7486e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[8.2433e-05, 1.0514e-04, 7.7486e-07, 1.5259e-05, 1.0854e-04, 1.6141e-04,
         2.2113e-05, 1.3709e-06, 1.4305e-05, 9.8526e-05, 3.8743e-06, 3.1471e-05,
         2.5034e-06, 1.2732e-04, 1.9133e-05, 2.0266e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[4.7326e-04, 1.2684e-04, 1.1921e-07, 9.9242e-05, 1.9729e-04, 1.4269e-04,
         2.0266e-06, 1.7881e-07, 1.6689e-05, 2.5105e-04, 1.8477e-06, 7.9751e-05,
         7.7486e-07, 2.6608e-04, 1.4007e-05, 1.7881e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.305696
summ of probs approach
id: [4874] -> tensor([[2.6226e-06, 7.7486e-06, 1.3387e-04, 9.0599e-06, 1.0133e-06, 1.3709e-06,
         3.5763e-07, 3.6955e-06, 5.3644e-07, 2.1458e-06, 7.1526e-07, 2.2292e-05,
         1.1086e-05, 4.4060e-04, 1.0729e-06, 1.3709e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[1.1921e-06, 4.3869e-05, 3.9196e-04, 8.8215e-06, 3.4750e-05, 3.2783e-06,
         1.1921e-06, 3.0994e-06, 2.9206e-06, 3.4571e-06, 5.6028e-06, 4.3333e-05,
         1.1444e-05, 8.6546e-04, 7.8678e-06, 6.9737e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[7.7486e-07, 9.4175e-06, 1.1015e-03, 3.8147e-06, 2.2471e-05, 2.3842e-07,
         1.7881e-07, 2.0266e-06, 1.1921e-07, 7.0930e-06, 5.2452e-06, 2.6405e-05,
         2.6226e-06, 3.5834e-04, 1.0431e-05, 2.7418e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.201058
summ of probs approach
id: [4874] -> tensor([[3.1590e-06, 5.9605e-08, 2.3067e-05, 5.5313e-05, 2.3246e-06, 2.5630e-06,
         2.1112e-04, 1.6093e-06, 1.7583e-05, 9.5367e-07, 2.4724e-04, 4.5776e-05,
         2.0659e-04, 5.2786e-04, 8.3447e-06, 2.3842e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[5.5254e-05, 1.2577e-05, 1.6546e-04, 2.5749e-04, 1.0550e-05, 3.2783e-06,
         7.7963e-05, 7.2122e-06, 9.7752e-06, 4.7088e-06, 1.9562e-04, 3.4571e-06,
         9.3758e-05, 8.7738e-04, 2.2709e-05, 2.9802e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[6.0201e-06, 5.9605e-08, 1.7679e-04, 1.1158e-04, 5.9605e-07, 8.3447e-07,
         3.1829e-04, 7.0930e-06, 1.8477e-06, 1.2517e-06, 1.2589e-04, 2.0862e-06,
         5.2452e-04, 1.5652e-04, 7.7486e-07, 5.9605e-08]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.260939
summ of probs approach
id: [4874] -> tensor([[1.9133e-05, 1.5378e-05, 7.7486e-07, 1.3947e-05, 2.3246e-06, 1.7011e-04,
         5.0247e-05, 4.4703e-06, 1.0815e-03, 1.6296e-04, 1.4305e-06, 7.1526e-07,
         2.4736e-05, 3.8862e-05, 4.2319e-06, 1.3709e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [694] -> tensor([[2.0087e-05, 3.1531e-05, 1.3113e-06, 1.4305e-05, 3.1590e-06, 3.7193e-04,
         2.2829e-05, 4.0650e-05, 8.9169e-04, 1.5593e-04, 3.9339e-06, 7.7486e-07,
         3.3796e-05, 9.8825e-05, 6.3181e-06, 4.2796e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
id: [5505] -> tensor([[2.8014e-06, 9.6560e-06, 3.5763e-07, 3.7551e-06, 3.5763e-07, 1.5616e-04,
         2.5451e-05, 3.9339e-06, 1.4889e-04, 1.3947e-04, 4.7684e-07, 4.7684e-07,
         3.1590e-06, 3.6359e-05, 6.5565e-07, 3.6895e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.386624
summ of probs approach
id: [4874] -> tensor([[2.3842e-07, 5.9605e-08, 4.0531e-06, 3.5167e-06, 1.3030e-04, 7.8082e-06]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
summ of probs approach
id: [694] -> tensor([[2.2650e-06, 1.3709e-06, 1.0550e-05, 7.9870e-06, 1.1957e-04, 7.3016e-05]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
summ of probs approach
id: [5505] -> tensor([[1.1921e-06, 2.3842e-07, 2.7418e-06, 2.8610e-06, 1.7810e-04, 2.7895e-05]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.132073
acc:  0.3939393939393939
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:03.703348
path ['42', 'en', 'llama', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [36339, 1], 'attention_mask': [1, 1]}
id:[36339, 1]
answer  {'input_ids': [375, 1], 'attention_mask': [1, 1]}
id:[375, 1]
answer  {'input_ids': [259, 37627, 1], 'attention_mask': [1, 1, 1]}
id:[259, 37627, 1]
load model Duration: 0:00:05.472192
prompt_type null has 1 prompts in it
----------- 42 en bigscience/mt0-small NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([1.9543e-03, 1.4564e-03, 4.9827e-04, 6.7004e-04, 3.5347e-04, 3.4796e-03,
        1.0681e-02, 3.4450e-03, 3.4510e-03, 9.6473e-01, 3.3060e-05, 1.8002e-03,
        2.0600e-03, 3.6885e-04, 2.0404e-03, 1.8077e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.8875e-03, 2.1019e-03, 6.4546e-04, 8.6674e-04, 3.7798e-04, 2.7481e-03,
        2.8975e-02, 4.0769e-03, 5.3770e-03, 9.6474e-01, 1.1759e-04, 9.4730e-04,
        2.4873e-03, 6.1874e-04, 2.5644e-03, 1.5865e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0812, 0.2705, 0.2801, 0.3271, 0.6382, 0.2041, 0.0403, 0.4280, 0.1868,
        0.9708, 0.0129, 0.4630, 0.1209, 0.1708, 0.1654, 0.1595],
       device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.134789
summ of probs approach
probs_ shape tensor([9.6772e-01, 1.1387e-03, 5.2811e-03, 1.5606e-03, 1.5762e-03, 7.7150e-03,
        1.9651e-03, 3.9807e-04, 6.9039e-04, 2.2038e-04, 1.8762e-03, 1.5545e-03,
        9.1556e-05, 1.6740e-03, 7.1831e-04, 1.1175e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.6772e-01, 1.1825e-03, 1.0270e-02, 1.5837e-03, 2.1355e-03, 2.0498e-02,
        2.1661e-03, 4.5076e-04, 5.7813e-04, 1.7407e-04, 2.6827e-03, 1.5899e-03,
        1.3269e-04, 2.3411e-03, 6.9775e-04, 3.3972e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.9802, 0.1274, 0.3277, 0.3268, 0.4112, 0.4667, 0.1350, 0.0556, 0.1405,
        0.0683, 0.1940, 0.4777, 0.0443, 0.4142, 0.1211, 0.2368],
       device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.077026
summ of probs approach
probs_ shape tensor([1.3824e-03, 8.0177e-04, 4.4780e-04, 3.9090e-04, 1.9834e-03, 1.2623e-03,
        8.6012e-01, 2.7397e-03, 3.0671e-03, 1.1380e-03, 4.3398e-03, 5.6457e-04,
        1.3145e-02, 8.2201e-05, 1.2161e-03, 3.2038e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.9741e-03, 1.8035e-03, 4.3563e-04, 3.9654e-04, 4.8889e-03, 1.5873e-03,
        8.6014e-01, 2.5883e-03, 4.6250e-03, 7.4209e-03, 5.5718e-03, 7.2071e-04,
        2.5076e-02, 5.4042e-05, 1.3220e-03, 3.4442e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1326, 0.1577, 0.5807, 0.5787, 0.1923, 0.4047, 0.8734, 0.0508, 0.1619,
        0.4591, 0.0502, 0.1143, 0.2879, 0.0042, 0.1273, 0.0662],
       device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.129247
summ of probs approach
probs_ shape tensor([9.8867e-01, 1.6817e-04, 7.0689e-04, 3.3709e-03, 3.6160e-03, 5.7880e-03,
        8.4502e-04, 3.8360e-04, 6.2558e-03, 1.2298e-04, 7.3247e-04, 1.4489e-04,
        1.8412e-02, 1.0070e-03, 1.0999e-03, 1.6243e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.8867e-01, 1.6918e-04, 7.3155e-04, 3.3392e-03, 4.0943e-03, 5.7897e-03,
        7.5801e-04, 7.8685e-04, 1.6718e-03, 1.2220e-04, 9.6081e-04, 1.3918e-04,
        1.0527e-02, 1.2008e-03, 1.0992e-03, 1.6518e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.9931, 0.0270, 0.2269, 0.5519, 0.1937, 0.2243, 0.1615, 0.1754, 0.5513,
        0.0138, 0.3363, 0.0539, 0.2316, 0.1028, 0.2227, 0.8821],
       device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.067578
summ of probs approach
probs_ shape tensor([4.5081e-04, 9.1799e-01, 2.2914e-03, 6.2992e-04, 9.8819e-04, 1.1860e-04,
        2.2503e-03, 1.9781e-03, 1.4620e-03, 1.1374e-03, 5.9251e-03, 1.5571e-04,
        2.1017e-04, 6.3414e-04, 6.9360e-04, 1.3904e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.1351e-04, 9.1799e-01, 2.2758e-03, 9.3749e-04, 1.0723e-03, 2.9313e-04,
        2.2614e-03, 3.6895e-03, 1.3504e-03, 1.6802e-03, 1.1609e-02, 1.7295e-04,
        2.4522e-04, 9.5415e-04, 7.5383e-04, 1.3016e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0293, 0.9386, 0.6171, 0.0547, 0.0520, 0.8907, 0.2178, 0.4906, 0.4629,
        0.1602, 0.1421, 0.2007, 0.0346, 0.1184, 0.0843, 0.0850],
       device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.057028
summ of probs approach
probs_ shape tensor([9.9020e-01, 3.8635e-04, 1.5490e-01, 8.3858e-04, 5.6199e-04, 1.1777e-03,
        9.8897e-04, 1.9663e-04, 2.5882e-04, 5.9185e-04, 9.6014e-04, 1.6137e-03,
        2.6537e-04, 5.5984e-04, 7.1115e-04, 4.4536e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.9020e-01, 4.1128e-04, 1.2497e-01, 8.7005e-04, 5.9193e-04, 2.7171e-03,
        9.5607e-04, 8.1833e-04, 4.3353e-04, 5.2412e-04, 8.7160e-04, 1.7029e-03,
        3.7205e-04, 5.2900e-04, 7.0607e-04, 1.0388e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.9959, 0.2005, 0.0261, 0.2288, 0.1758, 0.2514, 0.1577, 0.0243, 0.0940,
        0.4831, 0.1935, 0.1466, 0.0999, 0.0435, 0.1083, 0.0435],
       device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.069219
summ of probs approach
probs_ shape tensor([1.7342e-03, 3.7999e-04, 3.6865e-04, 9.9797e-04, 1.2022e-05, 1.0069e-03,
        4.6783e-04, 6.1767e-04, 5.9037e-04, 1.1627e-02, 1.3829e-03, 3.6613e-03,
        1.2307e-03, 8.3152e-04, 4.1500e-04, 9.7545e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.9788e-03, 3.9469e-04, 4.6153e-04, 9.2614e-04, 4.5404e-05, 9.6806e-04,
        5.1000e-04, 6.0077e-04, 1.0379e-03, 1.0898e-02, 1.3898e-03, 5.8573e-03,
        1.1274e-03, 8.3185e-04, 4.5090e-04, 9.7547e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0395, 0.6965, 0.1556, 0.0364, 0.0550, 0.0230, 0.1100, 0.2168, 0.2122,
        0.1520, 0.0936, 0.1938, 0.2361, 0.1595, 0.2027, 0.9836],
       device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.096035
summ of probs approach
probs_ shape tensor([4.8025e-02, 6.4816e-04, 4.5186e-04, 1.9544e-03, 1.0479e-03, 2.8049e-03,
        9.9846e-01, 1.1096e-02, 4.7248e-03, 7.6154e-04, 1.8456e-03, 6.3955e-04,
        4.7102e-02, 5.7685e-04, 1.9206e-04, 9.3374e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1603e-01, 6.7088e-04, 6.0445e-04, 2.0354e-03, 1.1225e-03, 3.4268e-03,
        9.9846e-01, 2.4892e-02, 4.6574e-03, 6.4934e-04, 1.8424e-03, 7.5103e-04,
        7.1009e-02, 4.2297e-04, 1.6905e-04, 1.1745e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0147, 0.3433, 0.0665, 0.3978, 0.1551, 0.3921, 0.9992, 0.1320, 0.3353,
        0.3669, 0.1847, 0.0439, 0.3385, 0.1636, 0.5851, 0.0521],
       device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.074715
summ of probs approach
probs_ shape tensor([1.8922e-04, 4.1426e-04, 4.4910e-04, 6.2533e-04, 9.9131e-01, 3.9780e-03,
        1.2555e-03, 5.4987e-04, 6.4051e-04, 9.1079e-04, 1.0186e-03, 1.6496e-04,
        7.6862e-04, 4.8705e-03, 2.1996e-03, 7.1711e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.0865e-04, 4.2671e-04, 1.4832e-03, 9.7636e-04, 9.9131e-01, 3.4662e-03,
        1.2349e-03, 2.2621e-03, 7.9973e-04, 1.1445e-03, 1.0189e-03, 1.5032e-04,
        6.6075e-04, 7.3551e-03, 2.3006e-03, 7.2989e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0621, 0.4606, 0.2677, 0.2111, 0.9938, 0.1809, 0.2104, 0.1194, 0.3382,
        0.4732, 0.5015, 0.1133, 0.2604, 0.0210, 0.6037, 0.2684],
       device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.074520
summ of probs approach
probs_ shape tensor([2.2915e-03, 2.4120e-03, 5.9083e-04, 1.2478e-02, 3.0524e-04, 8.8285e-01,
        3.7446e-03, 1.6148e-04, 2.7557e-04, 6.2713e-04, 7.7288e-03, 1.9703e-03,
        8.3052e-04, 1.1498e-03, 4.1663e-03, 2.4023e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.9220e-03, 2.1940e-03, 6.6512e-04, 4.3739e-02, 6.9017e-04, 8.8285e-01,
        4.8486e-03, 2.2733e-04, 3.5360e-04, 4.9564e-04, 7.0768e-03, 2.1526e-03,
        7.5707e-04, 1.1699e-03, 2.7923e-03, 2.7324e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0244, 0.0117, 0.1410, 0.5061, 0.0802, 0.8874, 0.1723, 0.0559, 0.0958,
        0.1098, 0.3178, 0.1539, 0.3686, 0.1426, 0.0505, 0.5188],
       device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.073160
summ of probs approach
probs_ shape tensor([3.1364e-03, 5.7462e-04, 8.1830e-03, 7.0949e-04, 1.1800e-03, 1.3332e-03,
        1.3271e-03, 3.7093e-03, 1.4528e-03, 1.8833e-03, 9.9371e-01, 6.7091e-04,
        8.0767e-03, 3.7526e-03, 4.6719e-03, 3.2503e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.1862e-03, 3.4081e-04, 8.1806e-03, 7.1371e-04, 1.2014e-03, 1.9513e-03,
        9.5216e-04, 9.6926e-03, 2.0557e-03, 2.4757e-03, 9.9371e-01, 1.8321e-03,
        1.6781e-02, 3.6710e-03, 4.6856e-03, 1.9504e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.2196, 0.0075, 0.4901, 0.1792, 0.0958, 0.2821, 0.0347, 0.6718, 0.2692,
        0.1051, 0.9965, 0.1330, 0.1830, 0.3207, 0.3848, 0.2021],
       device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.054532
summ of probs approach
probs_ shape tensor([9.2278e-04, 1.5888e-03, 2.7413e-04, 8.1180e-04, 1.4656e-03, 2.9106e-03,
        1.8141e-03, 5.8115e-04, 8.4446e-03, 1.9198e-03, 9.5085e-01, 2.0685e-03,
        2.9454e-03, 4.5273e-03, 2.5313e-03, 7.9282e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.0444e-04, 1.6105e-03, 2.8084e-04, 9.4828e-04, 1.4465e-03, 4.8899e-03,
        1.8534e-03, 6.1382e-04, 2.7935e-02, 4.0761e-03, 9.5085e-01, 2.4725e-03,
        2.9470e-03, 2.3715e-03, 2.5492e-03, 1.9604e-03], device='cuda:0') torch.Size([16])
summ of probs approach
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/de/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
probs_ shape tensor([0.0242, 0.1162, 0.0016, 0.1708, 0.5149, 0.1875, 0.2737, 0.7541, 0.1280,
        0.1075, 0.9548, 0.1045, 0.1430, 0.6077, 0.1830, 0.1257],
       device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.059911
summ of probs approach
probs_ shape tensor([1.5848e-04, 2.6732e-04, 3.8796e-03, 5.1094e-03, 3.8100e-04, 9.4454e-01],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([1.6490e-04, 6.8834e-04, 4.6674e-03, 6.6035e-03, 3.8038e-04, 9.4454e-01],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([0.2230, 0.0893, 0.5305, 0.5214, 0.1027, 0.9494], device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.036128
acc:  0.3434343434343434
Time taken to execute the en NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.033939
path ['42', 'en', 't0', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_en_v55.pickle' as a pickle file.

Using MARC dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 314.58it/s]
loading model Duration: 0:00:01.227394
Average length of review_body for rows with 1 star: 199.5979
Average length of review_body for rows with 5 star: 177.19965
len of lowest cat:  38908
len of pos_reviews, neg_reviews:  38908 38908
len dataset  77816
len dataset  200
create dataloader Duration: 0:03:11.256829
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1650], 'attention_mask': [1]}
id:[1650]
answer  {'input_ids': [951, 265], 'attention_mask': [1, 1]}
id:[951, 265]
load model Duration: 0:00:08.111725
prompt_type null has 1 prompts in it
----------- 42 de bigscience/bloom-560m SA null 0 200 16 --------------
summ of probs approach
id: [1650] -> tensor([[4.0829e-07, 1.5033e-05, 3.3225e-06, 1.0039e-06, 6.0776e-06, 6.2119e-07,
         6.9065e-06, 9.3024e-06, 2.4655e-06, 6.7918e-06, 4.3613e-06, 1.8449e-07,
         1.4925e-06, 4.5964e-06, 8.8185e-07, 1.7395e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.0941e-05, 1.3601e-03, 4.2325e-05, 9.0278e-06, 1.6606e-05, 1.0149e-05,
        7.3966e-05, 7.1676e-05, 1.8594e-05, 2.0176e-03, 5.0267e-05, 4.5606e-05,
        8.5822e-06, 1.3340e-05, 1.6664e-05, 7.6578e-06], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.218932
summ of probs approach
id: [1650] -> tensor([[6.5656e-07, 1.0597e-06, 1.1553e-04, 1.2846e-06, 9.0406e-07, 1.5771e-06,
         2.9123e-06, 1.1508e-06, 8.8952e-06, 3.0616e-06, 1.4491e-05, 6.7718e-06,
         3.6091e-06, 5.8250e-06, 1.2167e-06, 1.4724e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.6077e-05, 8.1789e-06, 4.6593e-04, 7.1733e-06, 2.5164e-05, 1.8320e-05,
        1.2293e-05, 8.0875e-06, 1.7248e-04, 2.8970e-04, 1.7390e-04, 3.9674e-05,
        2.2075e-05, 8.5078e-05, 1.1596e-05, 8.2075e-06], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.199368
summ of probs approach
id: [1650] -> tensor([[7.6749e-07, 3.6501e-06, 1.4622e-06, 3.4678e-06, 1.6609e-06, 1.1877e-05,
         1.6832e-06, 1.8708e-06, 1.9373e-06, 2.8094e-06, 5.2749e-06, 1.9770e-06,
         5.1758e-06, 2.5318e-06, 1.1063e-06, 5.6017e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.6645e-05, 3.3441e-05, 1.4970e-05, 1.8388e-05, 1.1416e-05, 1.2186e-04,
        1.8873e-05, 1.7208e-05, 1.6356e-05, 3.9836e-06, 1.7015e-04, 1.0392e-05,
        1.1604e-05, 1.0687e-05, 8.0341e-05, 6.2575e-06], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.281469
summ of probs approach
id: [1650] -> tensor([[3.7110e-06, 2.4339e-06, 1.4167e-06, 1.4911e-06, 6.4915e-06, 1.3619e-06,
         3.6053e-06, 8.4635e-06, 3.2564e-07, 2.7842e-06, 3.3948e-06, 1.3180e-06,
         4.7958e-05, 8.2651e-06, 5.0478e-06, 3.8957e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.6379e-05, 6.6805e-06, 1.1978e-05, 9.6779e-06, 6.8453e-05, 6.4465e-06,
        2.3993e-05, 4.4651e-05, 1.0150e-05, 2.7221e-03, 3.6394e-05, 1.2329e-05,
        9.3121e-05, 9.2021e-05, 2.0037e-05, 2.3754e-04], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.136226
summ of probs approach
id: [1650] -> tensor([[7.0184e-07, 8.5466e-06, 1.3707e-04, 2.7049e-06, 1.6336e-06, 1.6391e-06,
         1.8727e-06, 2.2748e-06, 3.2245e-06, 3.0927e-06, 5.4506e-06, 1.0151e-04,
         1.9745e-06, 2.2147e-06, 4.9519e-06, 2.1686e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.3658e-05, 2.7378e-05, 1.1465e-03, 7.0916e-05, 1.4768e-05, 6.8381e-06,
        2.1472e-05, 4.5004e-05, 1.7915e-05, 6.9877e-05, 3.5656e-05, 4.6662e-04,
        1.5757e-05, 3.5950e-05, 2.2936e-05, 1.0550e-05], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.208469
summ of probs approach
id: [1650] -> tensor([[5.0487e-05, 2.0637e-06, 8.7445e-05, 7.1380e-06, 2.7497e-06, 2.0769e-06,
         1.6402e-06, 2.4389e-06, 1.0944e-06, 3.4776e-07, 8.0105e-07, 1.0075e-05,
         2.4239e-06, 3.5268e-06, 3.0140e-06, 4.6388e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6474e-04, 2.5941e-05, 7.2768e-04, 4.6465e-05, 1.1157e-05, 1.5528e-05,
        1.5641e-05, 1.3717e-05, 1.5673e-05, 3.2391e-05, 2.8035e-05, 3.9263e-05,
        8.1897e-05, 3.5542e-05, 2.4167e-05, 2.7509e-05], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.212703
summ of probs approach
id: [1650] -> tensor([[1.2837e-06, 1.5938e-06, 6.9973e-07, 1.4463e-06, 9.3118e-07, 1.1162e-06,
         1.1475e-05, 5.1005e-06, 2.1447e-06, 9.3193e-07, 9.0912e-07, 1.7717e-06,
         9.7004e-07, 4.3590e-06, 3.1239e-05, 3.3537e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.5590e-06, 3.8518e-05, 4.8628e-06, 1.7254e-05, 6.5905e-06, 8.5353e-06,
        5.0248e-05, 1.7937e-05, 1.5040e-05, 1.0767e-05, 6.5406e-06, 1.1657e-05,
        1.7181e-05, 2.6353e-04, 2.8496e-04, 1.5925e-05], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.310834
summ of probs approach
id: [1650] -> tensor([[1.3778e-05, 2.7498e-06, 1.7864e-06, 1.4424e-06, 6.2007e-06, 1.9226e-05,
         1.2267e-06, 1.4873e-06, 6.2719e-07, 1.0053e-06, 3.5038e-06, 2.0095e-05,
         2.4516e-06, 9.5807e-07, 1.6276e-06, 5.8674e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.8138e-04, 1.6113e-04, 1.8826e-05, 1.8747e-05, 2.9905e-04, 1.5139e-03,
        1.1661e-05, 6.6987e-06, 6.7715e-05, 6.1963e-06, 1.2729e-05, 1.5780e-03,
        1.4345e-05, 1.3550e-05, 1.3590e-05, 3.0933e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.325228
summ of probs approach
id: [1650] -> tensor([[8.0998e-07, 1.4341e-06, 5.0558e-05, 8.4186e-07, 2.5068e-06, 1.1122e-06,
         1.3238e-06, 1.8622e-05, 1.5292e-06, 2.1942e-07, 7.2000e-06, 9.5522e-05,
         1.7323e-06, 2.5081e-06, 1.4921e-06, 2.6434e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2603e-05, 1.2175e-05, 1.2712e-03, 3.2935e-05, 4.2250e-04, 7.9099e-06,
        1.4322e-05, 3.5503e-03, 1.3627e-05, 2.8947e-05, 3.6192e-05, 6.7772e-04,
        2.8116e-05, 3.8343e-05, 1.9778e-05, 4.8666e-05], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.312608
summ of probs approach
id: [1650] -> tensor([[2.2177e-06, 8.3271e-06, 1.0325e-05, 1.7347e-05, 1.6557e-06, 1.6552e-06,
         3.9766e-06, 3.1569e-06, 4.8712e-07, 8.5732e-06, 4.2917e-06, 1.0360e-06,
         3.2607e-06, 1.6916e-05, 2.9804e-06, 5.5211e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.2857e-05, 3.4770e-05, 7.6121e-04, 2.1162e-04, 1.1976e-05, 7.4001e-06,
        1.0544e-05, 2.2689e-05, 1.5607e-05, 5.9033e-04, 3.4157e-05, 1.9803e-05,
        1.6186e-05, 7.6511e-05, 1.7674e-04, 1.4166e-05], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.219607
summ of probs approach
id: [1650] -> tensor([[5.5939e-07, 8.4394e-07, 6.5367e-07, 2.1070e-06, 4.2942e-07, 2.1633e-05,
         9.9335e-07, 2.3296e-06, 1.8655e-05, 9.9610e-07, 5.6819e-06, 2.2736e-06,
         3.6245e-05, 1.8638e-06, 1.7208e-06, 4.6175e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.0842e-06, 8.2252e-06, 1.3543e-05, 4.9555e-05, 6.7130e-06, 1.4831e-03,
        1.0164e-05, 2.9007e-05, 1.1138e-04, 1.1164e-05, 2.6864e-05, 5.3417e-05,
        3.6718e-04, 1.4245e-05, 1.1694e-04, 4.4578e-05], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.209112
summ of probs approach
id: [1650] -> tensor([[1.7605e-06, 1.9209e-06, 4.5936e-06, 2.0284e-06, 1.4533e-06, 7.2817e-06,
         5.8595e-06, 1.7261e-06, 1.9361e-05, 2.0386e-06, 5.8712e-06, 1.1236e-04,
         2.9318e-05, 7.6727e-07, 8.1803e-07, 8.9254e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.2946e-06, 5.7088e-05, 4.8234e-05, 1.0954e-05, 6.7534e-06, 1.4522e-04,
        1.2201e-05, 1.2515e-05, 3.4144e-04, 9.9686e-06, 6.0327e-05, 1.8070e-03,
        7.5565e-05, 1.6798e-05, 7.7533e-06, 1.3391e-05], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.294477
summ of probs approach
id: [1650] -> tensor([[9.0701e-07, 4.9785e-06, 3.3841e-06, 7.6095e-06, 6.5754e-07, 1.1318e-06,
         2.7697e-06, 2.2981e-06]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
probs_ shape tensor([9.2431e-06, 2.4571e-05, 1.7647e-04, 7.4039e-05, 8.3146e-06, 2.2681e-05,
        9.6212e-06, 1.4958e-05], device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.169973
acc:  0.5
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:03.117342
path ['42', 'de', 'bloom', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1650], 'attention_mask': [1]}
id:[1650]
answer  {'input_ids': [951, 265], 'attention_mask': [1, 1]}
id:[951, 265]
load model Duration: 0:00:08.078373
prompt_type null has 1 prompts in it
----------- 42 de bigscience/bloomz-560m SA null 0 200 16 --------------
summ of probs approach
id: [1650] -> tensor([[3.9322e-06, 1.5742e-05, 2.2771e-06, 1.9916e-07, 1.0369e-06, 6.8250e-07,
         4.9629e-07, 6.8632e-06, 1.7139e-07, 5.2213e-07, 3.1221e-05, 3.2581e-05,
         6.7804e-07, 3.5517e-06, 3.5412e-07, 1.4776e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.0067e-05, 1.5966e-05, 1.5061e-04, 1.1165e-05, 6.2003e-05, 2.8277e-05,
        2.9874e-05, 2.5610e-04, 6.4918e-06, 1.6297e-05, 3.4000e-04, 7.1009e-04,
        1.8698e-05, 1.3621e-05, 8.7447e-06, 5.4332e-05], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.255522
summ of probs approach
id: [1650] -> tensor([[7.4997e-06, 4.5982e-07, 8.6024e-07, 3.0576e-07, 5.5869e-07, 1.0420e-06,
         3.6273e-06, 6.6236e-07, 4.9293e-07, 2.5709e-08, 2.1477e-06, 1.5503e-06,
         1.6200e-06, 3.4484e-06, 5.0498e-05, 2.8642e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.8634e-04, 1.2178e-05, 1.5527e-05, 1.6080e-05, 1.8825e-05, 2.7210e-05,
        5.6015e-05, 6.0364e-05, 7.3937e-06, 1.7399e-06, 4.2358e-05, 2.9786e-05,
        5.3647e-05, 1.2690e-04, 4.6656e-03, 1.0887e-05], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.261159
summ of probs approach
id: [1650] -> tensor([[1.5248e-06, 7.6223e-07, 6.5049e-07, 6.2934e-07, 7.9754e-06, 1.9442e-06,
         2.5591e-07, 5.8825e-06, 2.7304e-07, 1.0731e-06, 1.2553e-06, 1.8305e-06,
         4.0865e-07, 1.6198e-05, 8.2091e-07, 9.7309e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.1523e-05, 1.2061e-05, 4.5574e-06, 1.1177e-05, 2.6905e-04, 1.0251e-03,
        3.2527e-06, 1.0089e-04, 7.0809e-06, 1.1094e-04, 1.9976e-05, 1.9910e-05,
        8.6277e-06, 9.5089e-05, 1.8923e-05, 1.6865e-05], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.313981
summ of probs approach
id: [1650] -> tensor([[8.0671e-07, 2.3549e-06, 1.5389e-06, 2.6662e-07, 2.8712e-06, 2.7905e-07,
         8.0428e-06, 5.1466e-07, 1.1979e-05, 1.0192e-06, 6.5093e-06, 2.2801e-07,
         1.1177e-06, 1.5079e-06, 3.0228e-06, 6.0007e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.3537e-05, 4.1280e-05, 2.2175e-05, 4.9270e-05, 1.3702e-04, 9.3920e-06,
        2.3448e-04, 1.4094e-05, 2.1418e-04, 2.9363e-06, 1.4062e-05, 1.2550e-05,
        1.0302e-05, 5.3623e-05, 1.4635e-04, 3.1381e-05], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.296153
summ of probs approach
id: [1650] -> tensor([[4.2194e-05, 1.4970e-06, 1.3235e-07, 6.3891e-07, 3.0140e-06, 3.3350e-05,
         1.7648e-06, 1.7620e-05, 5.9521e-07, 7.8765e-07, 8.5834e-07, 2.2322e-06,
         2.5748e-06, 6.7861e-06, 6.8267e-07, 7.8104e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.5423e-05, 1.9056e-05, 3.4653e-06, 8.1587e-06, 1.1482e-05, 4.6160e-04,
        2.1159e-05, 8.5145e-05, 1.6705e-05, 2.3366e-05, 9.0672e-07, 4.9548e-05,
        8.4704e-05, 2.0719e-04, 2.5794e-05, 6.3399e-04], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.213508
summ of probs approach
id: [1650] -> tensor([[7.2869e-07, 1.0485e-06, 7.0543e-05, 1.6266e-06, 3.4417e-06, 1.0550e-06,
         1.7954e-06, 1.4592e-06, 9.3530e-07, 1.6819e-05, 1.9233e-05, 5.8128e-07,
         2.1342e-06, 5.9705e-07, 1.5667e-04, 2.0214e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2644e-05, 8.5706e-06, 5.1282e-04, 3.5041e-05, 3.0040e-04, 1.5395e-05,
        3.6493e-05, 5.9840e-05, 9.4491e-06, 3.4040e-04, 6.1904e-05, 1.5562e-05,
        3.3980e-05, 1.4646e-05, 1.2817e-03, 9.1634e-06], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.308377
summ of probs approach
id: [1650] -> tensor([[1.0725e-05, 3.2242e-06, 2.5282e-06, 1.7834e-05, 1.4193e-05, 1.0543e-06,
         2.1654e-07, 1.5337e-05, 1.0751e-06, 7.8476e-07, 1.2041e-05, 1.2579e-06,
         1.5591e-06, 6.7525e-08, 2.7982e-06, 5.2073e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4167e-04, 1.8198e-04, 5.0869e-05, 9.5892e-05, 7.3113e-04, 1.7240e-05,
        1.3459e-05, 3.2961e-04, 2.4024e-05, 4.7166e-05, 9.4465e-04, 1.4563e-05,
        1.3298e-05, 3.9573e-06, 5.1201e-05, 2.1189e-05], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.217143
summ of probs approach
id: [1650] -> tensor([[2.0104e-05, 3.8864e-06, 7.1636e-07, 6.3403e-07, 4.1346e-05, 2.5258e-05,
         4.3367e-07, 1.2137e-05, 1.7499e-05, 4.5675e-06, 1.0845e-06, 1.6789e-06,
         7.7669e-07, 1.6313e-06, 5.2002e-05, 1.6708e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.2081e-04, 3.2740e-05, 3.7003e-05, 2.1254e-05, 3.3978e-03, 3.0733e-05,
        4.1196e-05, 1.1649e-04, 4.6327e-04, 2.6748e-04, 3.2107e-05, 4.1844e-05,
        1.1736e-05, 1.4760e-05, 6.0581e-04, 5.8905e-05], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.310576
summ of probs approach
id: [1650] -> tensor([[3.0629e-07, 1.4508e-06, 1.8206e-06, 1.4987e-05, 5.9745e-07, 3.5173e-07,
         1.5523e-06, 4.6219e-06, 3.7405e-06, 2.7918e-07, 1.5246e-06, 2.4707e-07,
         4.8599e-07, 2.4239e-06, 8.0056e-07, 2.7022e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.4191e-06, 3.6535e-05, 2.8159e-05, 3.0664e-04, 7.2113e-06, 3.7285e-05,
        1.1251e-04, 2.1612e-05, 7.7735e-05, 3.2742e-05, 2.5105e-05, 8.4658e-06,
        2.1725e-05, 3.5828e-05, 3.1810e-05, 3.3563e-05], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.287450
summ of probs approach
id: [1650] -> tensor([[4.9940e-07, 4.6009e-07, 3.8330e-06, 3.5891e-07, 1.1371e-06, 3.1406e-07,
         4.0684e-05, 1.3093e-05, 8.3576e-07, 3.3967e-06, 4.8017e-07, 2.6907e-07,
         8.1728e-07, 1.7115e-05, 1.9046e-07, 1.3496e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.9101e-05, 1.5844e-05, 2.6790e-04, 7.5182e-06, 2.3644e-05, 1.1989e-05,
        2.9553e-04, 8.8436e-04, 1.6769e-05, 2.8163e-05, 8.7185e-06, 7.7499e-06,
        1.6773e-05, 2.0414e-04, 7.4018e-06, 3.2894e-04], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.328882
summ of probs approach
id: [1650] -> tensor([[3.9524e-07, 4.8130e-07, 1.0341e-06, 3.2160e-07, 7.2039e-07, 8.1349e-07,
         6.1771e-07, 1.0940e-06, 7.7787e-07, 6.8828e-07, 5.2690e-07, 1.1453e-06,
         5.8377e-07, 1.8911e-06, 1.8905e-05, 7.7259e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.4783e-05, 1.1504e-05, 1.3918e-05, 2.7651e-06, 2.8550e-05, 1.6305e-05,
        9.8795e-06, 7.8265e-06, 1.1464e-05, 9.1415e-06, 2.4073e-05, 1.8982e-05,
        1.5094e-05, 1.7182e-05, 3.0431e-04, 8.4493e-04], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.291011
summ of probs approach
id: [1650] -> tensor([[3.1160e-06, 7.3099e-07, 9.5269e-08, 1.3438e-06, 3.4321e-07, 1.7772e-07,
         4.8616e-07, 6.1105e-07, 1.3830e-06, 6.2781e-07, 1.4215e-06, 1.4274e-06,
         4.3857e-07, 7.5758e-07, 1.0287e-06, 1.2162e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.0083e-04, 1.4282e-05, 6.2642e-06, 8.2373e-05, 1.4745e-05, 3.6200e-06,
        1.4344e-05, 3.1033e-05, 1.4985e-05, 7.2890e-06, 7.4413e-05, 9.9256e-05,
        9.3786e-06, 6.5437e-06, 2.2682e-05, 9.7823e-05], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.247002
summ of probs approach
id: [1650] -> tensor([[9.8938e-07, 1.0185e-06, 2.4966e-07, 1.9529e-05, 1.0625e-06, 3.8901e-06,
         6.6637e-07, 7.5817e-07]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
probs_ shape tensor([2.0393e-05, 1.2141e-05, 8.4528e-06, 1.0550e-03, 2.7325e-05, 9.4291e-06,
        2.1076e-05, 1.8008e-05], device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.069705
acc:  0.5
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:03.426045
path ['42', 'de', 'bloomz', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
load model Duration: 0:00:02.862359
prompt_type null has 1 prompts in it
----------- 42 de google/flan-t5-base SA null 0 200 16 --------------
summ of probs approach
id: [2662] -> tensor([[2.7446e-04, 3.7008e-06, 8.9176e-05, 1.6309e-06, 1.9981e-04, 5.2181e-05,
         2.5369e-04, 6.8365e-05, 4.4188e-05, 1.0985e-03, 1.7083e-05, 1.2034e-04,
         3.3969e-04, 1.7615e-04, 1.3710e-04, 1.3082e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[5.8440e-07, 1.0643e-06, 3.2017e-07, 3.4981e-07, 1.6106e-06, 5.0054e-06,
         4.8909e-06, 1.9277e-07, 4.4585e-06, 3.6048e-05, 1.1285e-05, 3.0015e-07,
         4.0773e-05, 3.0306e-06, 8.7136e-05, 2.0983e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.109761
summ of probs approach
id: [2662] -> tensor([[4.5964e-05, 2.6327e-05, 1.9914e-04, 1.9833e-07, 5.4531e-05, 2.7066e-05,
         2.8576e-05, 9.0054e-05, 5.7424e-05, 1.5428e-05, 8.2318e-05, 1.7038e-04,
         3.0102e-04, 2.6055e-05, 1.0562e-04, 4.0004e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[8.8815e-08, 6.5581e-07, 8.9230e-06, 2.8382e-07, 1.2060e-07, 4.2280e-05,
         7.3957e-07, 9.6450e-07, 2.1829e-06, 3.0779e-07, 2.1418e-07, 8.6274e-06,
         1.7835e-06, 9.6905e-07, 3.6030e-06, 3.2401e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.100372
summ of probs approach
id: [2662] -> tensor([[1.6474e-05, 3.0114e-05, 7.6853e-06, 5.1012e-05, 2.4330e-05, 7.4825e-05,
         2.8697e-04, 7.2471e-04, 1.1694e-04, 2.5057e-04, 9.6962e-08, 1.1747e-04,
         9.5290e-06, 1.4071e-05, 1.8301e-04, 1.1201e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.1723e-06, 4.8240e-08, 3.6516e-06, 3.9967e-07, 4.5930e-08, 2.4940e-05,
         2.4557e-06, 1.3754e-04, 6.6470e-07, 1.1909e-06, 1.8673e-08, 1.7647e-06,
         4.5437e-06, 8.0078e-07, 1.1972e-05, 2.5553e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.119329
summ of probs approach
id: [2662] -> tensor([[1.5726e-05, 2.3292e-05, 8.7693e-05, 8.3599e-06, 8.2317e-04, 9.1878e-06,
         4.9507e-05, 2.4057e-04, 7.6917e-05, 1.2432e-04, 2.9327e-04, 9.4929e-05,
         1.2982e-04, 1.6040e-04, 7.5234e-07, 3.6885e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[9.5190e-07, 2.6625e-07, 2.6942e-05, 9.0927e-09, 1.1565e-04, 6.4845e-08,
         2.4897e-05, 1.5069e-05, 1.8968e-05, 1.3444e-05, 3.7201e-06, 4.9892e-07,
         5.3673e-06, 2.9480e-05, 3.6324e-06, 1.1737e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.130952
summ of probs approach
id: [2662] -> tensor([[2.0031e-05, 3.5935e-05, 2.6755e-05, 2.1242e-04, 2.3049e-06, 7.2696e-06,
         3.6145e-04, 1.9409e-05, 8.9669e-05, 2.1402e-03, 2.4124e-04, 6.5931e-07,
         1.0825e-05, 1.2025e-04, 3.2687e-04, 1.5480e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[4.4425e-06, 9.1532e-06, 7.0629e-06, 2.7854e-06, 2.5792e-08, 1.2083e-07,
         2.1963e-07, 2.0396e-06, 7.9115e-05, 1.6282e-05, 6.7696e-07, 7.0497e-07,
         5.6749e-08, 5.6562e-06, 6.5810e-05, 8.0020e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.094361
summ of probs approach
id: [2662] -> tensor([[3.3311e-04, 6.8657e-04, 2.5020e-04, 1.4274e-04, 4.0479e-07, 4.4317e-06,
         4.8320e-04, 2.0906e-04, 4.8282e-04, 2.8434e-05, 3.2030e-05, 7.5734e-05,
         3.5547e-05, 4.0901e-04, 4.8944e-05, 3.8142e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.2301e-05, 6.3222e-05, 1.7423e-04, 2.5149e-05, 1.4704e-08, 4.6305e-07,
         4.2339e-06, 2.8900e-06, 1.4912e-08, 3.5857e-06, 8.2414e-09, 3.6262e-06,
         6.6394e-07, 8.7977e-06, 9.3716e-08, 1.9385e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.120085
summ of probs approach
id: [2662] -> tensor([[6.3594e-05, 1.4419e-04, 1.2210e-03, 4.0293e-04, 9.2419e-06, 9.2624e-06,
         2.1524e-05, 5.5322e-05, 5.2336e-05, 2.7514e-05, 2.8162e-05, 3.9460e-04,
         7.2682e-04, 4.5490e-04, 2.4611e-05, 1.4588e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[4.4125e-06, 5.6238e-07, 2.5308e-05, 7.2336e-06, 1.3841e-08, 1.1281e-07,
         4.1544e-07, 4.9425e-09, 8.4849e-07, 2.9993e-07, 2.4146e-05, 6.2859e-06,
         5.1391e-06, 4.0530e-05, 1.0032e-08, 2.9397e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.108829
summ of probs approach
id: [2662] -> tensor([[4.9276e-05, 2.8205e-06, 2.0278e-05, 2.0081e-05, 1.0576e-05, 9.5138e-05,
         2.2041e-04, 2.6080e-03, 1.1066e-04, 1.1631e-04, 8.1820e-05, 1.2257e-03,
         2.6096e-05, 3.2492e-05, 2.2074e-04, 1.6784e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[4.3965e-06, 4.1725e-09, 3.0811e-08, 1.4134e-07, 4.8920e-08, 1.7272e-07,
         1.4514e-05, 4.8299e-04, 1.4075e-07, 7.2337e-07, 2.2258e-05, 9.1651e-06,
         2.4611e-06, 6.7493e-08, 4.6423e-05, 2.4831e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.085676
summ of probs approach
id: [2662] -> tensor([[2.2170e-04, 4.4491e-05, 3.5729e-06, 9.9175e-05, 1.9708e-04, 3.8424e-05,
         3.2122e-04, 1.3542e-05, 2.3030e-07, 1.0553e-04, 7.1441e-05, 1.9041e-05,
         1.4079e-04, 1.8014e-05, 7.1070e-05, 4.2537e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.0877e-06, 8.7414e-06, 1.4629e-08, 4.4045e-06, 7.1385e-05, 1.6096e-05,
         1.0731e-06, 4.8262e-06, 9.1191e-08, 6.8538e-07, 3.3564e-07, 3.0636e-05,
         4.4777e-06, 9.3519e-06, 1.9422e-05, 2.2139e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.142622
summ of probs approach
id: [2662] -> tensor([[4.7523e-05, 7.1312e-06, 2.2681e-04, 2.0625e-04, 1.8705e-04, 9.2018e-07,
         2.3929e-05, 1.2626e-04, 9.7676e-05, 4.7069e-05, 5.7654e-05, 5.0951e-05,
         1.3547e-03, 8.8120e-05, 3.9315e-05, 1.4170e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[8.6695e-08, 8.2822e-08, 1.7676e-07, 2.3587e-07, 6.4110e-05, 1.4580e-07,
         8.2338e-06, 3.8044e-06, 1.4199e-05, 3.1150e-07, 3.3618e-06, 1.7084e-07,
         4.0358e-05, 1.9862e-07, 6.8431e-06, 1.4562e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.062967
summ of probs approach
id: [2662] -> tensor([[4.8366e-05, 1.7503e-03, 1.0662e-04, 5.2440e-05, 9.6188e-05, 3.3462e-04,
         1.3123e-05, 3.9088e-06, 1.2161e-03, 7.8407e-05, 1.9850e-04, 7.3207e-05,
         8.2670e-05, 6.1907e-05, 6.0473e-04, 4.6707e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.5580e-07, 1.3535e-04, 4.0118e-06, 2.4663e-05, 8.3086e-06, 3.6333e-06,
         3.1030e-08, 5.0470e-07, 1.8903e-04, 7.0254e-05, 4.9255e-06, 1.3804e-05,
         1.4232e-07, 1.5306e-06, 8.6025e-07, 1.9700e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.125299
summ of probs approach
id: [2662] -> tensor([[2.5192e-05, 2.6335e-05, 1.0666e-04, 2.5862e-04, 3.7438e-04, 2.6478e-04,
         6.1746e-05, 1.2896e-04, 4.8605e-05, 3.8550e-05, 4.3641e-05, 5.4884e-06,
         3.9095e-07, 9.9504e-05, 3.2792e-05, 1.9871e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.3077e-07, 6.0201e-05, 1.4726e-07, 7.8667e-06, 1.0473e-04, 1.2791e-05,
         2.4189e-07, 5.1950e-07, 1.1080e-05, 5.9758e-07, 2.6039e-06, 5.1281e-09,
         1.1114e-07, 1.4698e-05, 2.1757e-06, 5.5610e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.124249
summ of probs approach
id: [2662] -> tensor([[5.8806e-05, 7.8323e-08, 9.0680e-05, 5.0026e-04, 9.9284e-05, 1.1211e-04,
         1.5013e-04, 2.4350e-04]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [23607] -> tensor([[8.9226e-07, 1.5744e-07, 1.9919e-05, 3.7984e-04, 2.4465e-07, 1.0362e-05,
         4.0898e-07, 7.7905e-06]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.033941
acc:  0.54
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.375090
path ['42', 'de', 'flan', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.24s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.81s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id:[1, 452, 262]
load model Duration: 0:02:27.430615
prompt_type null has 1 prompts in it
----------- 42 de huggyllama/llama-7b SA null 0 200 16 --------------
summ of probs approach
id: [12337] -> tensor([[6.2585e-06, 8.3447e-07, 3.9935e-06, 2.0862e-06, 2.2650e-06, 2.0862e-06,
         1.2846e-03, 2.9206e-06, 1.7881e-07, 1.5438e-05, 2.5034e-06, 3.5667e-04,
         3.9339e-06, 1.8477e-06, 1.3709e-05, 1.1623e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.9472e-06, 2.2054e-06, 1.1861e-05, 3.2187e-06, 3.5167e-06, 2.9206e-06,
        2.0933e-04, 2.5630e-06, 3.8147e-06, 1.1683e-05, 3.1590e-06, 1.0128e-03,
        3.2187e-06, 6.2585e-06, 1.5879e-04, 3.4988e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.431692
summ of probs approach
id: [12337] -> tensor([[4.1723e-07, 4.4107e-06, 1.0729e-06, 4.4107e-06, 8.7142e-05, 3.0398e-06,
         4.7684e-07, 1.6928e-05, 1.4007e-05, 4.5896e-06, 6.8545e-06, 1.3292e-05,
         5.7817e-06, 2.9206e-06, 1.6093e-06, 5.0020e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.5497e-06, 1.1146e-05, 2.2650e-06, 4.1127e-06, 6.0856e-05, 4.4703e-06,
        1.1432e-04, 2.5034e-05, 1.4246e-05, 6.6757e-06, 7.1526e-06, 4.9591e-05,
        1.1086e-05, 1.0335e-04, 3.1590e-06, 2.1517e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.324697
summ of probs approach
id: [12337] -> tensor([[3.9399e-05, 1.7107e-05, 2.4438e-06, 3.6359e-06, 5.7817e-06, 2.3246e-06,
         4.4703e-06, 2.0266e-06, 4.6492e-06, 9.3555e-04, 1.3709e-06, 2.2924e-04,
         6.6233e-04, 8.3447e-07, 5.2452e-06, 8.8024e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.1827e-04, 2.9743e-05, 4.4703e-06, 1.0908e-05, 1.2755e-05, 7.0333e-06,
        1.9968e-05, 5.3048e-06, 3.2187e-06, 4.7588e-04, 1.9670e-06, 9.0981e-04,
        2.4490e-03, 1.9073e-06, 2.5153e-05, 9.0408e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.438919
summ of probs approach
id: [12337] -> tensor([[8.2850e-06, 1.0133e-06, 5.1260e-06, 1.1325e-06, 2.9540e-04, 1.1325e-06,
         9.8228e-05, 1.3709e-06, 1.5557e-05, 6.4969e-06, 1.0133e-06, 1.0437e-04,
         1.1921e-06, 1.0133e-06, 1.2279e-05, 3.4571e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.6372e-05, 5.5432e-06, 4.7088e-06, 1.7285e-06, 1.6999e-04, 2.1458e-06,
        4.0233e-05, 7.7486e-07, 1.4067e-05, 2.2650e-06, 4.3511e-06, 1.0228e-04,
        3.7551e-06, 9.5367e-07, 1.6153e-05, 1.1504e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.426357
summ of probs approach
id: [12337] -> tensor([[2.2054e-06, 1.1814e-04, 2.3246e-06, 1.2803e-04, 2.6941e-05, 3.3379e-06,
         2.4438e-06, 1.7285e-06, 5.5432e-06, 4.2319e-06, 2.4438e-05, 3.0994e-06,
         3.2783e-06, 3.1590e-06, 1.9670e-06, 8.3447e-07]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.0398e-06, 2.7227e-04, 2.1696e-05, 1.1339e-03, 1.6868e-05, 2.9802e-06,
        7.5698e-06, 1.6093e-06, 6.9737e-06, 3.2723e-05, 2.1100e-05, 3.6478e-05,
        9.5367e-07, 3.3975e-06, 2.6822e-06, 1.7285e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.521316
summ of probs approach
id: [12337] -> tensor([[1.4877e-04, 1.7285e-06, 5.9605e-07, 2.1803e-04, 1.4963e-03, 2.3842e-06,
         5.7817e-06, 1.2910e-04, 6.5386e-05, 2.3842e-06, 4.6277e-04, 3.9673e-03,
         2.8014e-06, 2.2709e-05, 1.2910e-04, 1.7881e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.8096e-04, 5.3644e-06, 2.1458e-06, 4.2009e-04, 1.5211e-04, 2.6822e-06,
        1.2338e-05, 8.9407e-05, 1.6999e-04, 2.4319e-05, 6.5565e-04, 2.1744e-03,
        4.4107e-06, 3.0696e-05, 9.8228e-04, 2.6822e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.373595
summ of probs approach
id: [12337] -> tensor([[1.8311e-04, 1.7881e-07, 4.8876e-06, 3.1590e-06, 2.8992e-04, 4.1366e-05,
         2.2054e-06, 3.5763e-07, 4.7636e-04, 5.6803e-05, 1.8597e-05, 1.6689e-06,
         6.8367e-05, 1.7285e-06, 1.1742e-05, 9.1791e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.3910e-04, 1.1921e-06, 4.2915e-06, 1.7285e-06, 1.1569e-04, 6.4850e-05,
        4.8876e-06, 4.5300e-06, 2.8074e-05, 1.6713e-04, 8.5235e-06, 8.3447e-06,
        3.5405e-05, 5.8413e-06, 2.3127e-05, 1.1504e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.498329
summ of probs approach
id: [12337] -> tensor([[6.0797e-06, 4.7088e-06, 1.9372e-05, 1.4305e-06, 5.9605e-07, 4.1127e-06,
         7.4506e-06, 3.2711e-04, 6.5565e-07, 1.3232e-05, 1.3912e-04, 1.8477e-06,
         1.3709e-06, 1.0026e-04, 2.3842e-07, 1.0920e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.3890e-04, 9.5367e-06, 3.1829e-05, 1.1444e-05, 1.9073e-06, 7.4506e-06,
        6.4969e-06, 1.3638e-03, 2.3246e-06, 1.9860e-04, 3.3245e-03, 5.1260e-05,
        1.0729e-06, 6.7770e-05, 7.7486e-07, 4.2629e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.397357
summ of probs approach
id: [12337] -> tensor([[7.1406e-05, 5.5492e-05, 4.1723e-07, 8.9884e-05, 9.1791e-06, 2.0027e-05,
         3.0398e-06, 4.4525e-05, 1.5497e-06, 2.5630e-06, 3.9935e-06, 6.5565e-07,
         2.8872e-04, 8.1062e-06, 1.4901e-06, 3.1734e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2708e-04, 2.0027e-04, 1.3113e-06, 8.2254e-04, 5.0068e-06, 6.6876e-05,
        7.9870e-06, 3.8385e-05, 4.6492e-06, 4.5300e-06, 1.1206e-05, 1.2517e-06,
        4.0603e-04, 1.4901e-05, 1.9073e-06, 1.0961e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.490671
summ of probs approach
id: [12337] -> tensor([[3.0994e-06, 2.2054e-06, 1.9073e-06, 1.2517e-06, 1.2010e-04, 1.3113e-06,
         7.1526e-06, 4.2319e-06, 7.1883e-05, 1.5235e-04, 8.5831e-06, 1.6093e-06,
         1.8477e-06, 6.1989e-06, 8.3447e-07, 2.2650e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.9407e-06, 2.6226e-06, 5.8115e-05, 4.7088e-06, 1.8263e-03, 2.5630e-06,
        2.0385e-05, 1.2338e-05, 2.7919e-04, 1.2720e-04, 1.1623e-05, 1.3709e-06,
        7.6890e-06, 6.6161e-06, 1.7285e-06, 5.7220e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.484986
summ of probs approach
id: [12337] -> tensor([[1.1921e-06, 2.9743e-05, 1.6749e-05, 7.5102e-06, 5.0664e-06, 3.7551e-06,
         1.0729e-06, 5.8770e-05, 1.5497e-06, 1.3530e-05, 1.0133e-06, 3.8147e-06,
         5.3644e-06, 1.6689e-06, 4.6551e-05, 1.6332e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.8477e-06, 3.9995e-05, 2.9850e-04, 1.8537e-05, 7.1526e-06, 5.7220e-06,
        1.8477e-06, 6.2406e-05, 2.2054e-06, 2.3055e-04, 1.6093e-06, 5.0068e-06,
        3.3379e-06, 6.7353e-06, 7.9274e-06, 2.0146e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.434946
summ of probs approach
id: [12337] -> tensor([[1.2517e-06, 4.7684e-07, 6.4373e-06, 1.3113e-06, 1.4007e-05, 7.2539e-05,
         2.2173e-05, 1.4067e-05, 5.9605e-07, 1.5140e-05, 4.8757e-05, 6.3300e-05,
         1.6093e-06, 4.6909e-05, 1.4985e-04, 3.4499e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.4639e-06, 5.3644e-07, 1.0133e-05, 4.0531e-06, 2.3246e-05, 6.3837e-05,
        5.5981e-04, 9.8610e-04, 2.4438e-06, 2.5630e-05, 6.7413e-05, 1.0818e-04,
        1.2696e-05, 4.1962e-05, 1.6320e-04, 4.7493e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.483142
summ of probs approach
id: [12337] -> tensor([[4.9162e-04, 7.8678e-06, 6.8724e-05, 1.3113e-06, 3.9935e-06, 5.3644e-07,
         2.6524e-05, 2.9206e-06]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
summ of probs approach
probs_ shape tensor([6.1452e-05, 3.2842e-05, 7.7724e-05, 2.1458e-06, 1.1861e-05, 1.1921e-06,
        5.7578e-05, 2.3842e-06], device='cuda:0', dtype=torch.float16) torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.113032
acc:  0.55
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:05.439462
path ['42', 'de', 'llama', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [432, 1], 'attention_mask': [1, 1]}
id:[432, 1]
answer  {'input_ids': [448, 348, 1], 'attention_mask': [1, 1, 1]}
id:[448, 348, 1]
load model Duration: 0:00:05.300685
prompt_type null has 1 prompts in it
----------- 42 de bigscience/mt0-small SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([0.0006, 0.0040, 0.0006, 0.0065, 0.0008, 0.0006, 0.0023, 0.0003, 0.0006,
        0.0014, 0.0013, 0.0008, 0.0014, 0.0007, 0.0067, 0.0010],
       device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0007, 0.0041, 0.0006, 0.0070, 0.0010, 0.0007, 0.0023, 0.0003, 0.0009,
        0.0027, 0.0015, 0.0010, 0.0036, 0.0013, 0.0067, 0.0010],
       device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.120968
summ of probs approach
probs_ shape tensor([7.9579e-04, 7.2024e-04, 7.1663e-04, 1.7551e-03, 7.7773e-04, 7.2461e-04,
        8.6309e-04, 2.4081e-03, 6.4601e-04, 1.4526e-03, 1.0341e-03, 9.6086e-01,
        7.5100e-04, 8.5844e-04, 1.0979e-03, 1.0602e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.2822e-03, 7.2580e-04, 7.2844e-04, 2.5997e-03, 7.7809e-04, 4.6977e-04,
        1.2334e-03, 2.4699e-03, 8.6472e-04, 1.4760e-03, 1.5254e-03, 9.6087e-01,
        1.0079e-03, 8.6373e-04, 1.2977e-03, 1.0068e-03], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.116385
summ of probs approach
probs_ shape tensor([1.4930e-03, 5.9434e-04, 5.8238e-03, 9.4975e-01, 1.7646e-03, 1.1140e-03,
        6.9775e-04, 4.8113e-04, 1.5170e-03, 9.7268e-01, 2.5057e-03, 2.8026e-03,
        1.4026e-03, 8.4797e-04, 1.7626e-03, 2.0977e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.8004e-03, 5.6960e-04, 3.3268e-03, 9.4976e-01, 1.7411e-03, 1.1826e-03,
        9.5188e-04, 5.1366e-04, 1.5226e-03, 9.7268e-01, 2.5237e-03, 2.8411e-03,
        1.4063e-03, 9.7077e-04, 2.0180e-03, 2.9982e-04], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.085454
summ of probs approach
probs_ shape tensor([1.2486e-03, 8.4259e-03, 2.0015e-03, 1.4336e-03, 2.9945e-03, 3.9804e-04,
        9.4870e-04, 1.3849e-03, 3.0396e-03, 9.9420e-01, 2.6890e-03, 5.6230e-04,
        2.6268e-04, 1.9593e-03, 9.6692e-04, 1.0042e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4033e-03, 4.3944e-03, 2.0087e-03, 6.0949e-03, 3.0205e-03, 6.5225e-04,
        1.1448e-03, 2.4330e-03, 3.0702e-03, 9.9420e-01, 2.7065e-03, 1.8121e-03,
        2.6314e-04, 2.0924e-03, 2.5954e-03, 2.5638e-03], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.076893
summ of probs approach
probs_ shape tensor([7.3892e-04, 6.9432e-04, 8.1990e-04, 4.2550e-04, 8.9224e-04, 9.5116e-04,
        1.4727e-03, 1.2582e-03, 5.3814e-04, 9.6969e-01, 1.6593e-03, 1.7483e-03,
        6.7740e-04, 1.0641e-03, 2.5899e-03, 1.0922e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0448e-03, 8.4905e-04, 1.9889e-03, 7.6205e-04, 8.2964e-04, 1.6373e-03,
        1.5400e-03, 1.2684e-03, 1.0135e-03, 9.6969e-01, 1.4205e-03, 1.6465e-03,
        1.8387e-03, 1.3668e-03, 2.6816e-03, 1.1711e-03], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.099354
summ of probs approach
probs_ shape tensor([1.4905e-03, 3.5057e-03, 9.3546e-04, 8.3284e-05, 8.4932e-04, 1.2167e-03,
        1.2292e-03, 1.1420e-03, 8.9410e-04, 4.3914e-03, 1.0447e-03, 8.2157e-04,
        2.6823e-03, 2.7970e-03, 8.9498e-04, 9.5942e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.5113e-03, 5.0280e-03, 1.0537e-03, 8.3573e-05, 1.0811e-03, 2.8593e-03,
        1.2508e-03, 1.5462e-03, 1.3748e-03, 7.6868e-03, 2.1914e-03, 1.4044e-03,
        2.6905e-03, 2.8240e-03, 8.4962e-04, 9.5943e-01], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.116668
summ of probs approach
probs_ shape tensor([1.1162e-03, 6.0293e-04, 1.9809e-03, 1.1725e-03, 3.9288e-04, 2.1929e-03,
        8.6209e-04, 9.8183e-04, 8.7187e-04, 5.8253e-04, 9.6045e-01, 1.2060e-03,
        4.6565e-04, 5.1194e-04, 2.6722e-03, 8.9301e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1381e-03, 1.1224e-03, 1.9978e-03, 1.3835e-03, 6.5834e-03, 2.7968e-03,
        1.2171e-03, 1.0299e-03, 7.3519e-04, 8.9007e-04, 9.6045e-01, 1.9680e-03,
        4.8837e-04, 5.1685e-04, 3.6683e-03, 9.7757e-04], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.085528
summ of probs approach
probs_ shape tensor([3.7328e-04, 1.3380e-03, 2.0358e-03, 5.5276e-04, 4.2266e-03, 2.2690e-03,
        9.7145e-01, 2.7218e-03, 1.8308e-03, 4.7016e-04, 2.9701e-03, 8.6945e-03,
        1.5040e-03, 4.0103e-03, 1.9151e-03, 1.3048e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.5159e-04, 1.4339e-03, 2.8917e-03, 5.6055e-04, 4.2432e-03, 2.1190e-03,
        9.7146e-01, 2.7299e-03, 1.8874e-03, 9.2388e-04, 3.1842e-03, 8.7191e-03,
        2.1434e-03, 4.0206e-03, 1.9567e-03, 2.2227e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.076774
summ of probs approach
probs_ shape tensor([9.2358e-01, 2.3553e-03, 1.3302e-03, 1.8632e-03, 7.5530e-04, 6.5385e-04,
        8.1780e-04, 6.6477e-04, 8.1716e-04, 2.7774e-03, 1.3773e-03, 5.5112e-04,
        1.0097e-03, 2.0704e-03, 2.8619e-03, 9.8911e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.2364e-01, 2.4113e-03, 1.3308e-03, 3.3092e-03, 7.8406e-04, 6.6984e-04,
        1.3143e-03, 3.5965e-03, 8.1775e-04, 2.8281e-03, 1.5204e-03, 7.0664e-04,
        1.0525e-03, 2.2427e-03, 2.8753e-03, 9.3137e-04], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.074357
summ of probs approach
probs_ shape tensor([4.2923e-04, 1.5416e-03, 4.6859e-04, 1.0817e-03, 7.1436e-04, 8.2886e-04,
        6.4127e-04, 1.2757e-03, 1.0506e-03, 1.9169e-03, 7.3816e-04, 8.9103e-01,
        1.3344e-03, 1.3989e-03, 5.8078e-04, 1.0336e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.0180e-04, 3.6184e-03, 7.8758e-04, 1.6725e-03, 7.0487e-04, 8.3318e-04,
        1.2234e-03, 1.4338e-03, 2.3981e-03, 2.6550e-03, 1.5402e-03, 8.9103e-01,
        1.4236e-03, 1.5768e-03, 5.8720e-04, 7.0837e-04], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.107190
summ of probs approach
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/de/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
probs_ shape tensor([1.0411e-03, 2.3663e-03, 5.6618e-04, 1.2142e-03, 8.1666e-04, 9.4916e-01,
        3.0737e-03, 3.5441e-04, 1.1188e-03, 6.4087e-04, 1.5376e-03, 1.9307e-03,
        1.1644e-03, 1.0485e-03, 1.0325e-03, 3.7028e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.2942e-03, 2.4354e-03, 1.2495e-03, 9.7659e-04, 8.7476e-04, 9.4916e-01,
        3.0762e-03, 4.1697e-04, 1.3062e-03, 8.6993e-04, 1.5179e-03, 2.2294e-03,
        1.3708e-03, 1.1910e-03, 1.1249e-03, 3.7263e-03], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.096253
summ of probs approach
probs_ shape tensor([8.9659e-04, 8.0397e-04, 4.9826e-03, 2.7477e-03, 2.8862e-03, 1.6743e-03,
        2.2482e-03, 8.3527e-03, 1.0412e-03, 4.4568e-03, 4.5301e-04, 1.5100e-03,
        9.1527e-04, 9.9075e-04, 2.1185e-03, 9.8236e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.2671e-03, 1.7580e-03, 5.0646e-03, 3.9263e-03, 6.3218e-03, 1.6776e-03,
        1.8602e-03, 8.3842e-03, 1.1018e-03, 4.4864e-03, 4.5399e-04, 1.8116e-03,
        1.9984e-03, 1.4707e-03, 2.1225e-03, 9.8236e-01], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.065177
summ of probs approach
probs_ shape tensor([9.9364e-04, 1.0124e-03, 9.9876e-04, 1.0324e-03, 9.0582e-04, 2.9694e-03,
        1.1133e-03, 9.7898e-01], device='cuda:0') torch.Size([8])
summ of probs approach
probs_ shape tensor([1.1270e-03, 2.4174e-03, 1.0349e-03, 1.9536e-03, 9.3851e-04, 3.1157e-03,
        1.1460e-03, 9.7899e-01], device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.057001
acc:  0.485
Time taken to execute the de SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.196146
path ['42', 'de', 't0', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Using NLI dataset for de
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 242.07it/s]
loading model Duration: 0:00:01.224840
filter data Duraction: 0:00:00.000001
use_neutral is  True
len of entail_examples , neutral_examples, contra_examples:  66 66 66
len dataset  198
random sample Duraction: 0:02:51.317024
create dataloader Duration: 0:02:52.651677
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1650], 'attention_mask': [1]}
id:[1650]
answer  {'input_ids': [951, 265], 'attention_mask': [1, 1]}
id:[951, 265]
answer  {'input_ids': [89, 25898, 18508], 'attention_mask': [1, 1, 1]}
id:[89, 25898, 18508]
load model Duration: 0:00:08.444472
prompt_type null has 1 prompts in it
----------- 42 de bigscience/bloom-560m NLI null 0 200 16 --------------
summ of probs approach
id: [1650] -> tensor([[5.2879e-07, 1.0949e-06, 2.6154e-06, 1.3469e-04, 4.1610e-06, 4.1187e-07,
         9.9745e-06, 8.6341e-07, 3.5281e-07, 8.8704e-06, 3.0339e-07, 3.9142e-07,
         6.6268e-07, 2.8552e-06, 3.7550e-06, 3.0860e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.7958e-06, 3.8843e-06, 5.3687e-06, 1.9665e-03, 4.5753e-05, 2.3632e-06,
        4.9409e-05, 6.4489e-06, 2.4312e-06, 3.5334e-05, 1.7811e-06, 2.2108e-06,
        4.1624e-06, 1.0801e-05, 1.9927e-05, 3.9234e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.5539e-07, 5.2298e-06, 5.5149e-06, 3.0945e-03, 8.4089e-05, 2.5424e-06,
        4.4756e-05, 6.8316e-06, 3.6820e-06, 5.7374e-05, 3.2051e-06, 4.4530e-06,
        7.8650e-06, 6.6880e-06, 3.2374e-05, 1.2392e-04], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.244859
summ of probs approach
id: [1650] -> tensor([[1.8828e-07, 2.2503e-05, 1.4423e-06, 9.6801e-07, 1.3854e-06, 4.3007e-07,
         4.5465e-06, 3.7517e-06, 2.7739e-06, 3.0727e-07, 1.3312e-07, 7.5751e-07,
         3.4505e-06, 5.4329e-07, 2.0783e-07, 2.7183e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.6738e-06, 6.4417e-05, 5.8219e-06, 4.0343e-06, 3.0098e-06, 3.2588e-06,
        1.7518e-05, 2.5694e-05, 1.5967e-05, 1.3743e-06, 9.7265e-07, 5.5653e-06,
        9.0623e-06, 1.4001e-06, 1.0573e-06, 1.2910e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.1864e-06, 1.6686e-04, 5.6058e-06, 4.3945e-06, 4.8749e-06, 2.5933e-06,
        4.4392e-05, 3.6237e-05, 2.4431e-05, 3.7342e-06, 2.3462e-06, 3.6556e-06,
        1.1222e-05, 2.2312e-06, 3.4276e-06, 1.6433e-05], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.238547
summ of probs approach
id: [1650] -> tensor([[1.8363e-06, 8.0438e-06, 1.6347e-06, 2.5973e-06, 2.6595e-07, 4.5256e-07,
         2.9265e-06, 8.3400e-07, 1.1602e-06, 1.9450e-06, 1.1590e-06, 1.4111e-06,
         1.4554e-06, 1.2538e-05, 5.4828e-06, 2.7739e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1532e-05, 1.1759e-05, 3.3703e-06, 3.3097e-06, 4.9650e-07, 2.2790e-06,
        8.9105e-06, 1.6539e-06, 1.0504e-05, 5.6593e-06, 3.6635e-06, 3.2832e-06,
        6.9199e-06, 5.7276e-05, 1.0029e-04, 1.0116e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.0265e-05, 1.1528e-05, 9.4018e-06, 1.0441e-05, 8.1160e-07, 3.3012e-06,
        1.0286e-05, 2.3160e-06, 1.4001e-05, 1.1825e-05, 1.9030e-06, 1.8600e-06,
        1.2218e-05, 7.2113e-05, 1.2088e-04, 1.3189e-05], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.218539
summ of probs approach
id: [1650] -> tensor([[1.9253e-07, 3.5862e-07, 2.9933e-06, 4.1889e-07, 7.5965e-07, 3.0712e-06,
         1.4635e-06, 2.4689e-04, 2.1248e-06, 5.7902e-06, 3.4696e-07, 2.3000e-06,
         4.6099e-07, 7.1441e-07, 3.4655e-06, 1.8599e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.7384e-06, 2.6582e-06, 1.3756e-05, 3.5764e-06, 3.1718e-06, 2.5958e-06,
        4.1090e-06, 2.1798e-04, 5.0366e-06, 2.4154e-05, 4.5270e-06, 6.1166e-06,
        1.0386e-06, 4.8630e-06, 4.4175e-06, 6.4709e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.3234e-06, 2.9624e-05, 2.4120e-05, 4.2277e-06, 6.6389e-06, 3.9284e-06,
        6.5880e-06, 5.3710e-05, 7.0577e-06, 2.3168e-05, 4.3376e-06, 1.2962e-05,
        1.6222e-06, 1.0244e-05, 3.7768e-06, 1.2729e-05], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.166608
summ of probs approach
id: [1650] -> tensor([[1.2652e-06, 3.8387e-06, 1.9268e-06, 1.6484e-06, 1.6552e-06, 1.3776e-06,
         1.8691e-05, 8.1823e-07, 1.3297e-06, 2.8419e-06, 1.1447e-07, 4.5204e-07,
         1.2851e-06, 3.4257e-07, 1.5842e-07, 2.1752e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4387e-05, 1.2502e-05, 5.8161e-06, 8.2215e-06, 4.2374e-06, 3.4743e-06,
        3.7878e-05, 1.4619e-06, 2.4090e-06, 1.6148e-05, 1.1826e-06, 2.9330e-06,
        4.8280e-06, 1.9638e-06, 1.2848e-06, 4.2625e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.8189e-06, 6.2174e-06, 7.3493e-06, 1.0910e-05, 4.7241e-06, 6.7142e-06,
        4.2810e-05, 2.4578e-06, 3.6798e-06, 2.7687e-05, 6.3881e-06, 3.8525e-06,
        2.0958e-05, 3.5113e-06, 3.0808e-06, 1.0320e-05], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.194197
summ of probs approach
id: [1650] -> tensor([[3.3710e-07, 5.7764e-07, 8.2158e-07, 3.6372e-06, 5.3764e-07, 7.6943e-06,
         1.4383e-06, 1.1288e-06, 1.1698e-06, 2.2687e-07, 1.1968e-06, 6.6610e-07,
         1.4835e-06, 1.1456e-06, 3.6808e-07, 4.0352e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1366e-06, 2.6226e-06, 1.0446e-05, 7.8162e-05, 2.7489e-06, 4.4780e-06,
        8.8712e-06, 3.5683e-06, 4.9304e-06, 2.3645e-06, 1.9457e-05, 1.9202e-06,
        2.1087e-05, 4.2042e-06, 4.6339e-06, 2.3633e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.3989e-06, 2.9474e-06, 1.3259e-05, 2.6900e-05, 6.3213e-06, 1.1690e-05,
        1.2952e-05, 5.7027e-06, 9.1677e-06, 3.7701e-06, 2.1780e-05, 2.4441e-06,
        6.2487e-06, 5.0807e-06, 5.6034e-06, 2.3152e-06], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.179590
summ of probs approach
id: [1650] -> tensor([[6.7321e-06, 3.1376e-07, 3.8461e-06, 9.1260e-07, 9.8918e-07, 6.7646e-06,
         5.1242e-07, 7.7680e-06, 1.6183e-06, 1.7634e-06, 1.1352e-06, 8.7679e-07,
         3.0668e-06, 5.0518e-07, 4.7354e-06, 2.3367e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.0496e-06, 9.1710e-06, 1.9719e-05, 8.2524e-06, 3.2745e-06, 4.0780e-05,
        3.1370e-06, 3.4363e-05, 1.7434e-05, 1.1029e-05, 5.0019e-06, 3.9281e-06,
        1.0266e-05, 2.8662e-06, 7.6576e-06, 3.3160e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1082e-05, 2.5979e-06, 2.1919e-05, 5.8632e-06, 5.7195e-06, 4.0050e-05,
        4.7078e-06, 6.2006e-05, 2.0500e-05, 1.1091e-05, 1.0222e-05, 9.2167e-06,
        1.4806e-05, 2.9629e-06, 9.0295e-06, 3.6505e-06], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.226336
summ of probs approach
id: [1650] -> tensor([[3.0831e-07, 2.9915e-07, 6.7713e-06, 4.8395e-07, 2.7994e-06, 3.4765e-05,
         5.3428e-07, 5.0650e-07, 2.6695e-06, 1.4874e-06, 1.0363e-05, 7.5006e-07,
         6.0727e-07, 4.0140e-07, 2.6766e-07, 1.7836e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.0632e-06, 2.7238e-06, 1.5991e-05, 6.4522e-05, 2.5610e-05, 5.2845e-05,
        3.1801e-06, 3.5589e-06, 3.5908e-05, 1.5573e-06, 8.0529e-05, 7.0027e-06,
        2.4644e-06, 2.8687e-06, 2.0301e-06, 1.3978e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.2120e-06, 5.4080e-06, 2.9043e-05, 3.2989e-05, 3.9221e-05, 3.9762e-05,
        4.1248e-06, 5.6570e-06, 9.5176e-06, 1.9762e-06, 1.1913e-04, 1.0788e-05,
        5.5592e-06, 6.1318e-06, 4.6193e-06, 2.8005e-06], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.257537
summ of probs approach
id: [1650] -> tensor([[6.0409e-07, 9.2528e-08, 1.0829e-06, 1.1709e-06, 2.4555e-07, 3.0714e-07,
         1.1344e-06, 2.1488e-07, 2.6228e-07, 1.1576e-06, 1.8329e-06, 1.9456e-06,
         8.7464e-06, 9.8261e-07, 1.0340e-06, 4.6165e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.0061e-05, 6.9765e-07, 7.3617e-06, 2.8864e-06, 1.1035e-06, 2.5807e-06,
        3.6525e-06, 1.1078e-06, 1.0701e-06, 1.6736e-06, 1.2996e-05, 6.0588e-06,
        2.4730e-05, 5.7043e-06, 8.1709e-06, 3.7324e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.0377e-06, 1.5012e-06, 2.9059e-06, 4.0525e-06, 3.0175e-06, 4.5573e-06,
        5.7167e-06, 2.1747e-06, 1.4737e-06, 2.2200e-06, 7.0620e-06, 6.7849e-06,
        2.8494e-05, 1.0282e-05, 2.0191e-05, 5.7579e-06], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.198646
summ of probs approach
id: [1650] -> tensor([[7.4755e-07, 1.4402e-05, 1.1638e-06, 2.6169e-06, 8.0485e-07, 1.7151e-06,
         7.5620e-07, 6.6286e-07, 4.4913e-07, 5.2378e-06, 6.9865e-06, 7.5047e-07,
         1.5402e-05, 8.8351e-07, 4.4115e-06, 2.5756e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.0920e-06, 4.0993e-05, 2.3025e-05, 1.1101e-06, 2.9809e-06, 6.2630e-06,
        2.5089e-06, 3.2281e-06, 4.6333e-06, 9.2006e-06, 2.6956e-05, 1.7727e-06,
        1.6931e-04, 4.1333e-06, 1.7629e-05, 3.1234e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.6943e-06, 3.6170e-05, 2.1782e-04, 1.7547e-06, 4.1495e-06, 9.8618e-06,
        5.4533e-06, 4.8605e-06, 9.9489e-06, 5.8008e-06, 3.8063e-05, 4.0574e-06,
        2.3684e-04, 4.5696e-06, 1.3143e-05, 3.4079e-06], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.221934
summ of probs approach
id: [1650] -> tensor([[5.3936e-07, 9.4089e-08, 2.9212e-07, 4.1430e-07, 1.8820e-05, 1.4643e-06,
         3.5902e-06, 4.9656e-06, 3.8577e-06, 2.0861e-06, 3.9708e-07, 1.3456e-06,
         4.9393e-07, 2.2803e-06, 5.8037e-06, 1.4706e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.3245e-06, 1.0053e-06, 4.5757e-06, 1.2185e-06, 1.0903e-04, 2.6666e-05,
        8.1357e-06, 3.3247e-06, 2.4107e-05, 3.6159e-06, 1.4848e-06, 3.9287e-06,
        4.7836e-06, 2.5469e-05, 2.9735e-05, 5.0524e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1805e-05, 1.4382e-06, 2.1536e-06, 4.1203e-06, 8.8126e-05, 9.3385e-06,
        2.0040e-05, 9.4236e-06, 1.1563e-05, 5.9819e-06, 2.7667e-06, 6.9519e-06,
        6.2855e-06, 1.0528e-05, 5.2872e-05, 7.8636e-06], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.212368
summ of probs approach
id: [1650] -> tensor([[1.1034e-06, 1.1761e-06, 8.9033e-06, 5.6974e-07, 1.8024e-06, 1.9680e-06,
         4.7820e-06, 2.6128e-07, 2.5092e-06, 1.5826e-06, 1.5778e-06, 1.4182e-06,
         2.3302e-06, 7.3527e-07, 2.0963e-07, 3.4290e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.7436e-06, 6.5595e-06, 8.0084e-06, 4.6813e-06, 7.5830e-06, 9.3246e-06,
        6.3866e-06, 9.3023e-07, 1.8209e-05, 5.2558e-06, 2.9485e-06, 7.0852e-06,
        2.7796e-05, 5.5880e-06, 2.0077e-06, 2.9904e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.9175e-06, 7.0004e-06, 1.3489e-05, 3.2241e-06, 5.2070e-06, 7.5648e-06,
        5.1145e-06, 2.6293e-06, 4.6562e-05, 4.7286e-06, 4.8472e-06, 9.6018e-06,
        8.5459e-05, 5.5479e-06, 1.5524e-06, 4.5450e-06], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.400365
summ of probs approach
id: [1650] -> tensor([[4.0714e-07, 4.6601e-07, 8.9818e-06, 7.4360e-07, 2.3334e-05, 6.0847e-07]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([1.7494e-06, 5.7543e-06, 1.8012e-05, 2.2047e-06, 1.7693e-04, 3.2521e-06],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([2.7181e-06, 4.7608e-06, 6.6128e-05, 1.4540e-06, 1.9861e-04, 7.3011e-06],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.100175
acc:  0.3181818181818182
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.889809
path ['42', 'de', 'bloom', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1650], 'attention_mask': [1]}
id:[1650]
answer  {'input_ids': [951, 265], 'attention_mask': [1, 1]}
id:[951, 265]
answer  {'input_ids': [89, 25898, 18508], 'attention_mask': [1, 1, 1]}
id:[89, 25898, 18508]
load model Duration: 0:00:08.186218
prompt_type null has 1 prompts in it
----------- 42 de bigscience/bloomz-560m NLI null 0 200 16 --------------
summ of probs approach
id: [1650] -> tensor([[3.4948e-08, 2.4757e-08, 1.0786e-07, 2.6376e-08, 3.9936e-07, 1.9258e-08,
         1.7473e-08, 1.9364e-08, 9.2103e-09, 7.5288e-08, 5.0167e-08, 4.2681e-08,
         1.5806e-07, 4.3983e-08, 8.0359e-09, 4.3737e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.2321e-06, 7.5933e-07, 1.4823e-07, 4.4063e-07, 3.8039e-06, 1.0395e-06,
        4.5728e-07, 5.4468e-07, 3.6554e-07, 6.4672e-06, 1.9854e-06, 8.4966e-06,
        9.2074e-07, 2.0649e-07, 2.1029e-07, 2.0206e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.7852e-07, 3.9391e-07, 6.8624e-08, 2.4807e-07, 2.5609e-06, 3.2018e-07,
        7.7950e-08, 1.8264e-07, 4.0913e-07, 6.5334e-07, 2.4466e-07, 7.3938e-07,
        7.8773e-07, 4.5242e-08, 9.2735e-08, 3.0053e-08], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.229666
summ of probs approach
id: [1650] -> tensor([[4.9142e-08, 2.0904e-08, 6.1202e-08, 2.8693e-08, 3.8805e-09, 1.0806e-08,
         9.1669e-08, 2.3872e-08, 1.5903e-05, 4.2850e-08, 1.4952e-07, 1.3238e-08,
         2.0074e-07, 3.0822e-07, 1.0780e-06, 7.2154e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2619e-06, 4.8740e-07, 2.9798e-07, 6.8037e-07, 1.9091e-07, 7.9983e-07,
        3.4448e-07, 3.2118e-07, 8.6882e-05, 1.2773e-06, 3.7753e-06, 7.3069e-08,
        2.3484e-06, 1.9602e-06, 1.3935e-05, 5.9017e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.6638e-07, 4.9960e-07, 7.6285e-08, 1.7190e-07, 1.3952e-07, 2.0953e-07,
        2.7686e-07, 5.0512e-08, 1.1242e-04, 5.2712e-07, 1.3235e-06, 2.1899e-08,
        9.7276e-07, 5.0002e-07, 6.4049e-07, 1.7678e-07], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.215046
summ of probs approach
id: [1650] -> tensor([[5.7980e-08, 8.4781e-08, 1.3566e-08, 3.3618e-08, 1.9590e-09, 8.2079e-09,
         2.4789e-08, 4.7075e-08, 2.3108e-09, 5.0028e-08, 4.7999e-08, 1.0675e-07,
         7.2539e-09, 7.9553e-08, 4.5316e-08, 4.1135e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.1259e-07, 7.2458e-07, 3.1527e-07, 1.2007e-06, 1.2368e-07, 3.9981e-07,
        3.3616e-07, 5.3302e-07, 2.8451e-08, 9.2450e-07, 1.4118e-06, 2.3779e-07,
        4.8009e-08, 3.2785e-07, 1.0862e-06, 1.7321e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.5913e-07, 1.8997e-07, 1.4287e-07, 9.0055e-07, 4.0378e-08, 5.6891e-07,
        8.9792e-07, 9.8394e-08, 2.2477e-09, 1.8629e-07, 6.1848e-08, 6.7896e-08,
        1.3668e-08, 6.0990e-08, 2.1639e-07, 8.1496e-08], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.412125
summ of probs approach
id: [1650] -> tensor([[6.9929e-09, 1.0152e-07, 1.3534e-07, 2.3126e-08, 1.4780e-07, 3.1735e-08,
         3.5270e-08, 7.5605e-09, 4.1820e-07, 5.2251e-09, 2.2249e-08, 7.5172e-07,
         2.8869e-08, 1.9398e-07, 2.7644e-07, 4.4393e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.0893e-07, 7.4087e-07, 1.0586e-07, 6.4551e-07, 1.0848e-06, 4.5601e-07,
        2.4708e-07, 8.6929e-07, 3.1499e-06, 3.2933e-07, 2.4256e-07, 3.4255e-07,
        1.8319e-07, 5.6300e-07, 9.0981e-07, 3.5751e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.6653e-08, 4.4242e-07, 2.7971e-08, 2.6257e-07, 6.3174e-07, 2.1387e-07,
        2.3507e-08, 1.1850e-07, 1.0631e-06, 3.8694e-08, 1.9122e-07, 1.0696e-07,
        9.2640e-08, 4.0809e-07, 2.9167e-07, 5.1892e-08], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.227844
summ of probs approach
id: [1650] -> tensor([[1.1169e-07, 8.8332e-08, 5.5693e-08, 4.2914e-08, 1.8230e-06, 4.1162e-08,
         1.2016e-08, 5.7894e-09, 3.4658e-08, 1.6441e-08, 5.8127e-08, 1.3966e-08,
         1.0656e-07, 1.8794e-08, 1.9226e-07, 5.4998e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.3454e-07, 2.1694e-06, 2.6616e-06, 4.7316e-07, 2.6327e-06, 7.8439e-07,
        6.4170e-08, 5.3493e-07, 1.3728e-06, 8.2312e-07, 9.8546e-07, 1.3817e-07,
        5.2609e-07, 4.3587e-07, 3.8617e-07, 1.3662e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.6886e-08, 6.6148e-07, 4.6418e-07, 8.8615e-08, 4.6320e-07, 3.9385e-07,
        1.7796e-08, 4.5017e-08, 4.1430e-07, 4.1759e-07, 4.8954e-07, 5.1270e-08,
        6.2138e-07, 4.6818e-08, 2.6442e-07, 2.8305e-07], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.227617
summ of probs approach
id: [1650] -> tensor([[1.8044e-07, 5.1597e-08, 3.0075e-08, 1.9755e-08, 2.1947e-08, 3.2625e-08,
         4.3078e-08, 1.0210e-08, 1.4381e-07, 3.9746e-07, 1.0362e-07, 2.3740e-08,
         6.0870e-08, 4.0118e-09, 6.5360e-08, 5.1097e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.4074e-07, 1.7243e-06, 3.3182e-07, 6.1077e-07, 2.6707e-07, 9.7348e-08,
        1.4459e-06, 4.1314e-07, 3.0675e-06, 1.4390e-06, 1.0194e-06, 6.6332e-08,
        1.1617e-06, 1.0867e-07, 2.9789e-08, 4.1007e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.9139e-07, 1.4562e-07, 8.2927e-08, 3.4110e-07, 7.0114e-08, 3.6108e-08,
        7.2442e-07, 4.4987e-08, 1.1612e-06, 2.9957e-07, 4.2081e-07, 1.9467e-07,
        2.4188e-06, 2.6096e-07, 2.1098e-08, 5.6948e-07], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.207395
summ of probs approach
id: [1650] -> tensor([[2.4732e-08, 1.0989e-07, 2.0755e-08, 1.7146e-07, 7.3543e-08, 2.6005e-07,
         8.4322e-08, 1.4207e-07, 2.3506e-08, 1.7547e-06, 3.8018e-08, 3.0808e-08,
         5.0884e-08, 2.1089e-07, 3.5400e-07, 5.3540e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.0053e-06, 3.4525e-06, 7.0763e-07, 4.2075e-06, 6.3926e-07, 1.3113e-06,
        1.2458e-06, 1.1633e-06, 1.0259e-06, 3.2389e-07, 1.3605e-06, 3.8925e-07,
        1.0676e-07, 1.2387e-06, 4.5623e-06, 4.9683e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.0373e-07, 5.5054e-06, 8.9598e-08, 7.0976e-07, 2.5662e-07, 1.7658e-07,
        4.5635e-07, 3.3887e-07, 3.9306e-07, 8.5418e-08, 3.4455e-07, 1.5550e-07,
        5.1665e-08, 3.4335e-07, 7.6435e-07, 3.0071e-07], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.181603
summ of probs approach
id: [1650] -> tensor([[5.9630e-08, 1.7155e-08, 2.9212e-08, 5.7858e-08, 1.4737e-07, 7.1585e-08,
         3.3110e-08, 2.9188e-08, 2.5316e-08, 6.3179e-09, 3.4608e-08, 8.6384e-08,
         3.5326e-08, 1.1340e-07, 5.6125e-09, 2.3321e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1069e-06, 6.2891e-07, 1.2114e-07, 1.2945e-06, 1.8083e-06, 1.2416e-06,
        5.9203e-07, 4.9930e-07, 8.1495e-08, 3.2421e-07, 3.0533e-07, 8.6863e-07,
        3.9032e-07, 9.9193e-07, 3.7215e-08, 1.1168e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.1726e-07, 2.6987e-07, 1.9981e-08, 3.3354e-07, 1.8667e-07, 4.4764e-07,
        1.6002e-07, 7.9318e-08, 1.0860e-07, 1.8093e-07, 8.2546e-08, 2.9151e-07,
        1.9750e-07, 3.1280e-07, 7.6016e-09, 2.6188e-07], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.239855
summ of probs approach
id: [1650] -> tensor([[6.8333e-08, 1.9998e-08, 3.5623e-08, 4.7195e-08, 2.9116e-09, 5.1819e-07,
         1.2190e-07, 8.5702e-08, 3.5938e-08, 1.0903e-08, 8.8936e-07, 2.2518e-06,
         5.5504e-08, 1.0996e-08, 1.0885e-07, 7.5461e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.6190e-06, 4.7838e-07, 5.4187e-07, 8.4319e-07, 6.5410e-08, 1.2841e-06,
        1.3644e-06, 2.3113e-07, 2.4120e-07, 1.1794e-06, 3.3258e-06, 4.0031e-06,
        1.3373e-06, 1.3993e-07, 2.2094e-06, 3.7180e-08], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.1122e-06, 2.3939e-07, 1.0257e-07, 3.8969e-07, 9.9435e-08, 6.2070e-07,
        3.9567e-07, 2.2051e-07, 1.1327e-07, 9.7918e-08, 3.0523e-07, 8.8190e-07,
        5.2499e-07, 4.1314e-08, 1.2165e-07, 1.1710e-08], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.167536
summ of probs approach
id: [1650] -> tensor([[5.1175e-08, 1.0929e-07, 6.4524e-08, 2.5352e-08, 1.4370e-07, 9.8445e-07,
         1.9141e-08, 6.9351e-08, 6.3031e-07, 5.2548e-08, 2.1865e-08, 7.6153e-08,
         6.5538e-08, 7.8328e-09, 4.5269e-08, 7.9383e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.2093e-08, 4.1048e-07, 6.5869e-07, 1.7859e-07, 4.9277e-07, 1.5636e-07,
        2.2637e-07, 3.4262e-07, 5.7225e-06, 1.0096e-06, 8.5989e-08, 9.2045e-07,
        8.3348e-07, 5.0408e-07, 1.4842e-06, 4.8945e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.2340e-08, 9.6535e-08, 3.5101e-07, 3.2660e-08, 2.5947e-07, 9.6027e-08,
        1.4328e-07, 1.7129e-07, 2.5935e-06, 9.5522e-07, 1.9741e-08, 6.0445e-07,
        3.4446e-07, 8.5166e-08, 2.8948e-06, 2.0892e-07], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.254230
summ of probs approach
id: [1650] -> tensor([[2.1145e-07, 6.3895e-08, 5.8248e-08, 3.1430e-05, 6.3417e-07, 3.5199e-07,
         2.6821e-09, 3.3336e-08, 3.7108e-09, 3.7015e-08, 2.4544e-08, 5.6064e-07,
         1.9880e-08, 1.7530e-08, 7.8968e-08, 4.8812e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.0189e-07, 6.8276e-07, 2.5979e-06, 8.6168e-05, 1.7755e-05, 5.2352e-07,
        1.1452e-07, 6.2188e-07, 4.1748e-07, 2.6843e-07, 7.2558e-07, 3.7660e-06,
        1.0962e-06, 5.5745e-08, 7.2970e-07, 4.2710e-07], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.9181e-08, 3.6335e-07, 7.9616e-07, 2.2290e-05, 2.5631e-06, 3.0133e-07,
        8.5227e-08, 3.6313e-07, 3.3961e-08, 6.2573e-08, 4.3308e-07, 1.1291e-06,
        3.1153e-07, 5.3311e-09, 8.2009e-08, 1.4811e-07], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.168718
summ of probs approach
id: [1650] -> tensor([[6.7278e-07, 4.3855e-08, 1.9245e-08, 2.4598e-08, 1.6117e-07, 2.1518e-08,
         7.9692e-09, 4.5701e-08, 9.7470e-08, 2.2899e-08, 5.0839e-08, 4.6134e-08,
         8.1648e-09, 3.8489e-08, 1.7720e-07, 1.3059e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.1872e-06, 3.5815e-07, 6.6136e-07, 6.5238e-07, 2.0438e-07, 3.7421e-07,
        9.3392e-07, 1.3669e-06, 2.5225e-07, 8.4921e-08, 8.3506e-07, 3.1266e-07,
        1.4507e-07, 2.2425e-07, 6.8983e-07, 1.3737e-06], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.2569e-06, 4.5815e-07, 3.1810e-07, 2.9989e-07, 1.7950e-08, 1.4871e-07,
        2.2788e-07, 9.1476e-08, 8.1736e-08, 6.7418e-08, 1.6024e-07, 3.6540e-08,
        7.8832e-08, 9.5222e-08, 4.9351e-08, 2.7765e-07], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.296550
summ of probs approach
id: [1650] -> tensor([[1.8707e-08, 9.1667e-09, 9.6496e-08, 3.1924e-07, 2.6722e-08, 2.8486e-08]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([5.3902e-07, 5.4715e-07, 1.8991e-07, 6.3948e-07, 1.2621e-06, 2.5975e-07],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([1.1599e-07, 9.3589e-08, 5.6741e-08, 5.1106e-08, 1.8192e-07, 1.4553e-07],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.055639
acc:  0.3282828282828283
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.920306
path ['42', 'de', 'bloomz', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [2662, 1], 'attention_mask': [1, 1]}
id: [2662, 1] -> [2662]
answer  {'input_ids': [23607, 1], 'attention_mask': [1, 1]}
id: [23607, 1] -> [23607]
answer  {'input_ids': [10330, 1], 'attention_mask': [1, 1]}
id: [10330, 1] -> [10330]
load model Duration: 0:00:02.932282
prompt_type null has 1 prompts in it
----------- 42 de google/flan-t5-base NLI null 0 200 16 --------------
summ of probs approach
id: [2662] -> tensor([[3.7713e-06, 1.2076e-05, 2.4818e-06, 1.1379e-06, 6.6595e-05, 8.4456e-05,
         4.9439e-06, 1.1125e-05, 4.8946e-05, 1.2181e-04, 1.7429e-04, 9.9822e-05,
         5.6233e-06, 4.3215e-07, 3.6014e-05, 3.5180e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[6.5513e-08, 6.2003e-08, 1.9685e-08, 3.3246e-08, 7.0806e-06, 1.2708e-06,
         3.6584e-09, 1.3525e-08, 3.1559e-07, 1.4248e-06, 1.4664e-05, 8.4866e-07,
         1.6525e-07, 4.1472e-07, 4.4271e-07, 7.8086e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[2.9164e-07, 1.6501e-08, 1.1903e-08, 1.4116e-07, 7.9668e-06, 3.2593e-07,
         5.1327e-08, 6.5340e-08, 4.2423e-07, 1.8363e-06, 2.3082e-06, 1.5469e-05,
         1.2443e-07, 5.0720e-08, 1.0864e-06, 2.0018e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.181125
summ of probs approach
id: [2662] -> tensor([[9.7374e-05, 8.4234e-06, 1.2739e-05, 1.6416e-04, 1.3081e-05, 2.0633e-08,
         2.6895e-05, 3.1246e-05, 1.1191e-07, 6.5232e-05, 1.2678e-05, 4.6829e-05,
         1.2799e-05, 1.1334e-05, 1.9282e-05, 1.3497e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[5.4337e-06, 1.3516e-07, 7.9659e-07, 8.2353e-06, 2.5833e-07, 4.4039e-11,
         3.1728e-07, 9.2935e-06, 2.3101e-08, 6.1351e-07, 4.6033e-06, 2.4586e-06,
         3.5975e-06, 2.2439e-06, 1.4795e-06, 3.2598e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[5.8625e-06, 1.2865e-07, 3.3342e-07, 5.6836e-08, 6.5458e-07, 2.7937e-10,
         1.9594e-07, 1.6800e-05, 1.0717e-07, 9.3713e-07, 3.4959e-06, 8.3644e-07,
         1.8730e-06, 9.5786e-07, 5.2499e-07, 4.1921e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.125584
summ of probs approach
id: [2662] -> tensor([[1.5047e-06, 7.5237e-05, 4.0310e-05, 4.5130e-06, 6.4897e-06, 1.3303e-05,
         8.6987e-05, 1.1810e-05, 2.1741e-05, 5.0707e-05, 7.2210e-05, 1.3961e-05,
         3.2539e-05, 5.5362e-07, 4.7134e-05, 2.4177e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[3.0878e-06, 4.1162e-07, 1.8021e-07, 7.4295e-09, 1.0988e-06, 2.4823e-07,
         3.0352e-07, 1.0587e-07, 1.1865e-07, 1.2597e-05, 1.7808e-06, 2.9911e-07,
         2.1564e-06, 3.5328e-08, 6.0136e-07, 1.8129e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[3.7850e-08, 1.7030e-09, 5.6426e-07, 2.8986e-07, 6.7664e-07, 3.9134e-07,
         8.6854e-07, 2.1674e-06, 1.0817e-07, 1.4707e-05, 2.8109e-07, 2.1708e-07,
         3.0356e-07, 5.4616e-09, 4.0439e-07, 2.3845e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.081101
summ of probs approach
id: [2662] -> tensor([[1.0602e-05, 4.2637e-05, 1.0294e-04, 7.0730e-06, 4.7988e-05, 3.5330e-04,
         6.8624e-05, 6.2540e-08, 2.0392e-05, 3.0630e-05, 3.2052e-05, 5.8762e-06,
         3.9193e-05, 1.3993e-05, 7.1957e-05, 1.6735e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.5810e-07, 5.2565e-06, 3.7438e-07, 9.4749e-07, 1.9575e-05, 1.0922e-07,
         3.2128e-06, 8.3313e-08, 1.9510e-07, 2.5086e-06, 9.3280e-05, 8.6839e-06,
         3.3710e-06, 1.5327e-08, 1.7063e-05, 2.9671e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[2.4818e-06, 4.1231e-05, 3.2662e-07, 2.0971e-08, 1.6934e-06, 8.8614e-08,
         2.1924e-06, 4.2841e-09, 2.3715e-07, 5.3923e-06, 6.6331e-07, 1.5339e-07,
         3.1753e-06, 2.4851e-08, 5.1060e-06, 4.3134e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.080609
summ of probs approach
id: [2662] -> tensor([[1.0837e-06, 1.7515e-04, 7.6585e-05, 1.5199e-06, 1.9214e-04, 1.5078e-05,
         1.3149e-04, 6.5188e-04, 2.3569e-06, 6.4863e-06, 1.1289e-05, 5.6413e-05,
         3.3316e-05, 5.3717e-07, 5.0752e-06, 1.7017e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[3.9979e-09, 5.5389e-06, 5.3712e-07, 2.1388e-07, 1.7948e-06, 2.0390e-06,
         1.9818e-06, 3.1734e-06, 2.1011e-08, 2.0197e-06, 2.4047e-06, 1.0900e-06,
         1.3440e-05, 3.8060e-10, 2.2112e-05, 3.6216e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[1.3869e-08, 5.3033e-06, 8.3377e-08, 2.7135e-08, 2.4756e-06, 4.4604e-06,
         3.3451e-07, 2.4166e-07, 2.4735e-08, 1.5246e-06, 2.8036e-06, 7.0493e-08,
         9.5620e-06, 1.2573e-08, 1.2835e-07, 2.0597e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.097811
summ of probs approach
id: [2662] -> tensor([[1.3250e-04, 9.6661e-06, 7.7552e-06, 1.3758e-07, 1.0816e-04, 2.3965e-06,
         6.1019e-05, 8.8294e-05, 2.2671e-05, 2.2105e-04, 5.5801e-04, 1.5113e-04,
         2.4463e-07, 2.5601e-04, 6.7566e-05, 5.6210e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.1121e-06, 9.5568e-07, 4.5755e-07, 1.3007e-08, 8.0669e-07, 1.1917e-07,
         1.6295e-07, 9.0220e-07, 2.7625e-06, 1.6905e-06, 2.0159e-04, 9.9910e-07,
         2.7887e-08, 4.0861e-06, 1.4036e-06, 6.2745e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[3.2206e-07, 1.9001e-06, 3.1441e-07, 2.6528e-09, 1.0394e-06, 4.2258e-08,
         2.4191e-07, 9.6070e-07, 4.8220e-06, 9.4610e-07, 3.7065e-06, 2.7923e-08,
         7.9275e-08, 1.4962e-06, 3.2731e-07, 1.7681e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.086252
summ of probs approach
id: [2662] -> tensor([[1.1617e-03, 1.4241e-03, 5.6378e-05, 1.1464e-05, 7.1317e-05, 1.6084e-04,
         1.3286e-04, 6.6351e-06, 1.5000e-05, 1.3246e-05, 4.2969e-05, 1.6037e-07,
         3.4983e-06, 2.4190e-05, 3.2432e-05, 3.0732e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[5.1853e-05, 7.1243e-05, 9.9758e-07, 1.2683e-05, 2.3739e-07, 1.2465e-06,
         2.0379e-06, 1.0345e-07, 1.3218e-07, 9.1168e-07, 6.8828e-07, 2.7008e-08,
         1.7623e-09, 2.4977e-07, 2.8826e-06, 7.2869e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[6.8995e-06, 3.7997e-06, 2.8068e-07, 1.4251e-06, 1.7494e-07, 1.9139e-06,
         5.7107e-06, 1.0386e-07, 9.1489e-07, 5.0761e-07, 2.0777e-06, 6.7509e-08,
         6.7412e-09, 5.4729e-08, 7.3287e-09, 4.2044e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.109912
summ of probs approach
id: [2662] -> tensor([[3.6019e-04, 2.4195e-05, 8.0020e-06, 1.0784e-04, 1.7451e-04, 4.5762e-05,
         3.3743e-05, 2.2698e-04, 3.6442e-05, 5.7852e-06, 1.1644e-04, 3.6393e-04,
         8.1491e-07, 7.5028e-05, 1.2184e-04, 1.8246e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.5823e-05, 3.4349e-07, 3.6974e-06, 3.5778e-06, 2.0541e-05, 6.0062e-07,
         1.3398e-05, 9.9927e-05, 5.2781e-07, 2.9642e-07, 7.1279e-06, 4.3605e-06,
         3.9194e-09, 3.0591e-05, 6.8811e-07, 5.8378e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[1.6624e-05, 2.6909e-07, 8.7616e-08, 4.8277e-06, 5.0291e-06, 2.1901e-07,
         6.7970e-05, 9.8706e-08, 6.9902e-06, 2.2883e-07, 3.7882e-07, 1.7069e-06,
         2.3220e-09, 1.4059e-07, 2.7026e-07, 3.6072e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.078514
summ of probs approach
id: [2662] -> tensor([[1.5202e-05, 1.2499e-05, 5.9957e-05, 2.3242e-05, 1.5790e-04, 1.3517e-06,
         4.0020e-03, 2.8213e-05, 1.2167e-04, 2.8964e-05, 1.0176e-07, 2.6947e-05,
         8.5083e-06, 3.8541e-05, 5.3205e-05, 5.8817e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[5.6587e-08, 7.1916e-08, 1.7394e-07, 4.6094e-06, 1.4066e-06, 1.3506e-08,
         2.6336e-07, 2.0365e-06, 2.1385e-06, 7.6797e-07, 3.8828e-08, 2.3759e-06,
         6.1063e-08, 2.3989e-05, 1.9287e-06, 1.1348e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[2.1714e-07, 7.2013e-08, 2.8813e-07, 4.4095e-07, 7.9032e-07, 2.9590e-07,
         6.9723e-08, 4.0145e-07, 6.5972e-06, 3.8349e-05, 1.3888e-09, 4.7952e-07,
         7.7917e-08, 3.6327e-07, 4.2276e-05, 2.1253e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.105532
summ of probs approach
id: [2662] -> tensor([[1.6744e-05, 1.2129e-04, 2.2368e-06, 4.7837e-06, 6.7941e-06, 9.7191e-05,
         3.7461e-05, 2.9784e-05, 3.1527e-07, 3.9665e-05, 5.0744e-06, 1.1388e-04,
         1.1976e-05, 2.2783e-04, 2.6956e-06, 7.2255e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[4.8723e-07, 1.6828e-06, 1.3935e-08, 5.7459e-05, 7.1759e-08, 1.7238e-06,
         4.7257e-08, 2.0086e-07, 1.2441e-08, 1.2538e-05, 1.3813e-07, 2.7892e-06,
         1.8232e-07, 7.0911e-06, 2.9145e-08, 2.9849e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[9.6020e-07, 2.7734e-07, 3.9424e-08, 3.5793e-06, 3.3787e-06, 1.4628e-06,
         5.9026e-08, 3.9675e-07, 4.1275e-09, 3.4584e-05, 1.1847e-06, 7.1192e-06,
         3.0034e-07, 2.3783e-06, 1.5866e-08, 5.0700e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.110887
summ of probs approach
id: [2662] -> tensor([[1.0236e-07, 4.0846e-05, 7.1058e-06, 1.1359e-04, 1.5000e-04, 7.1922e-07,
         8.7775e-04, 3.2662e-05, 6.7416e-05, 1.3680e-04, 1.5363e-05, 5.0154e-05,
         1.8197e-04, 1.4557e-04, 2.2566e-04, 1.0265e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[2.0521e-08, 2.1314e-07, 6.5137e-07, 2.2668e-07, 2.4082e-05, 1.9634e-09,
         1.4738e-04, 1.4561e-06, 6.5670e-07, 2.1924e-07, 3.4560e-07, 5.1637e-05,
         2.5582e-06, 2.1978e-06, 1.0318e-06, 1.7916e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[1.7651e-09, 6.9187e-06, 4.3310e-07, 7.6942e-08, 2.0008e-06, 5.4462e-10,
         6.5624e-06, 2.4534e-07, 6.3937e-06, 6.9768e-08, 1.0712e-07, 7.4136e-06,
         2.7657e-07, 9.0492e-06, 5.5200e-07, 9.3356e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.107389
summ of probs approach
id: [2662] -> tensor([[1.6953e-04, 1.1911e-04, 1.9189e-04, 5.5733e-07, 9.7755e-05, 5.0916e-05,
         7.5162e-04, 1.2336e-05, 2.2990e-06, 2.5236e-05, 1.7247e-06, 1.3822e-05,
         6.2278e-06, 5.2159e-05, 1.2941e-04, 1.0180e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [23607] -> tensor([[1.0943e-05, 5.8433e-06, 4.8022e-06, 3.4621e-08, 2.4584e-06, 8.5025e-05,
         1.0643e-04, 1.2787e-08, 1.0102e-07, 3.7410e-08, 2.1783e-07, 1.0337e-07,
         1.4471e-07, 5.9623e-06, 9.2770e-06, 1.4645e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [10330] -> tensor([[7.1750e-06, 5.4965e-06, 5.1970e-05, 3.4671e-09, 1.7902e-06, 6.9455e-06,
         1.6037e-07, 4.5054e-07, 5.5837e-07, 5.5605e-08, 2.7899e-06, 7.4348e-08,
         5.9374e-07, 1.0484e-06, 4.9974e-07, 1.9215e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.109278
summ of probs approach
id: [2662] -> tensor([[2.3430e-08, 7.5646e-04, 1.0576e-06, 1.3353e-04, 1.3996e-06, 2.5242e-05]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [23607] -> tensor([[3.6162e-08, 4.8710e-06, 7.9081e-09, 1.7722e-06, 1.5332e-08, 2.6266e-06]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [10330] -> tensor([[2.0294e-10, 1.6431e-07, 2.7761e-09, 9.8188e-07, 1.2451e-07, 3.7663e-06]],
       device='cuda:0'), torch.Size([1, 6])
 Batch: 12 of null classification Duration: 0:00:00.083487
acc:  0.35353535353535354
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.390868
path ['42', 'de', 'flan', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.24s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 12337], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 12337] -> [12337]
answer  {'input_ids': [1, 452, 262], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id:[1, 452, 262]
answer  {'input_ids': [1, 325, 11381, 1428], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id:[1, 325, 11381, 1428]
load model Duration: 0:02:28.257852
prompt_type null has 1 prompts in it
----------- 42 de huggyllama/llama-7b NLI null 0 200 16 --------------
summ of probs approach
id: [12337] -> tensor([[1.7345e-05, 3.8624e-05, 7.1526e-07, 6.5207e-05, 2.9707e-04, 3.9518e-05,
         2.8014e-06, 1.4901e-05, 1.0073e-05, 1.4305e-06, 3.0875e-05, 1.0073e-05,
         2.6822e-06, 2.0266e-06, 4.7684e-07, 8.7023e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1802e-05, 4.5180e-05, 4.6492e-06, 5.7161e-05, 1.7905e-04, 4.3631e-05,
        2.3842e-06, 1.1683e-05, 1.2815e-05, 1.8954e-05, 1.7643e-05, 2.1577e-05,
        2.8729e-05, 1.0788e-05, 4.0531e-06, 5.5432e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([2.5272e-05, 6.9618e-05, 2.6822e-06, 9.8288e-05, 8.5890e-05, 4.5955e-05,
        6.3181e-06, 1.1563e-05, 1.7583e-05, 3.1412e-05, 6.3598e-05, 1.0908e-05,
        1.5497e-05, 3.0220e-05, 2.8610e-06, 1.7405e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.323241
summ of probs approach
id: [12337] -> tensor([[4.9472e-06, 4.5300e-06, 2.4438e-06, 1.1325e-05, 4.3809e-05, 3.5763e-07,
         1.6570e-05, 1.5020e-04, 1.6570e-05, 1.0729e-06, 1.1623e-05, 5.0664e-06,
         3.0696e-05, 1.7464e-05, 2.5034e-06, 4.3511e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.2810e-05, 2.8491e-05, 2.5034e-06, 1.4305e-05, 2.6047e-05, 4.0531e-06,
        3.1173e-05, 4.4405e-05, 3.5703e-05, 5.7817e-06, 1.5140e-05, 9.7752e-06,
        5.7817e-06, 1.6332e-05, 1.1683e-05, 9.4771e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([2.5392e-05, 1.6797e-04, 6.6161e-06, 1.2100e-05, 5.2512e-05, 1.1384e-05,
        8.3208e-05, 6.4552e-05, 4.1306e-05, 8.1062e-06, 1.1665e-04, 1.5974e-05,
        2.7299e-05, 3.6168e-04, 2.5272e-05, 2.7120e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.324686
summ of probs approach
id: [12337] -> tensor([[4.6551e-05, 1.4901e-05, 4.1723e-07, 4.2081e-05, 5.4240e-06, 1.2875e-05,
         4.1723e-06, 1.1921e-06, 1.2577e-05, 2.2113e-04, 4.6492e-06, 7.4506e-06,
         1.1092e-04, 3.5763e-07, 4.5955e-05, 6.9976e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.7074e-05, 3.6657e-05, 8.4043e-06, 3.2949e-04, 7.5698e-06, 2.5153e-05,
        7.0930e-06, 4.5896e-06, 6.4969e-06, 6.3360e-05, 1.1146e-05, 2.5630e-06,
        5.4836e-05, 9.2983e-06, 3.1054e-05, 3.2425e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([5.8234e-05, 2.1601e-04, 4.9472e-06, 3.8648e-04, 4.0531e-06, 8.4937e-05,
        1.1265e-05, 1.5736e-05, 9.4771e-06, 1.7071e-04, 3.7909e-05, 9.1195e-06,
        1.6403e-04, 1.3649e-05, 7.6115e-05, 1.3084e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.481381
summ of probs approach
id: [12337] -> tensor([[3.5167e-06, 1.9133e-05, 1.3769e-05, 7.1526e-06, 1.9670e-05, 8.7023e-06,
         2.3842e-05, 2.9802e-07, 4.4703e-06, 9.2983e-06, 2.1458e-06, 1.7464e-05,
         9.0599e-06, 1.4603e-05, 1.6093e-06, 3.0339e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6226e-06, 1.9193e-05, 9.7752e-06, 3.3379e-06, 3.8862e-05, 7.5638e-05,
        5.0724e-05, 9.3579e-06, 2.1458e-06, 1.9968e-05, 2.1279e-05, 4.5836e-05,
        3.6716e-05, 7.8082e-06, 4.0531e-06, 1.3471e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([1.6451e-05, 1.1003e-04, 9.5785e-05, 1.1563e-05, 2.7733e-03, 1.0669e-04,
        2.5451e-05, 5.1260e-06, 2.1219e-05, 3.6895e-05, 4.1306e-05, 3.8207e-05,
        5.2810e-05, 2.9266e-05, 4.8280e-06, 3.6657e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.313527
summ of probs approach
id: [12337] -> tensor([[3.2604e-05, 4.1127e-06, 1.4305e-06, 1.6093e-06, 6.7949e-06, 4.9472e-06,
         2.3842e-06, 1.6093e-06, 6.3181e-06, 5.3048e-06, 8.8453e-05, 3.2783e-06,
         1.2517e-06, 1.5497e-06, 1.9670e-06, 4.1723e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.0027e-05, 2.2650e-06, 1.1563e-05, 1.5497e-06, 1.1444e-05, 1.9372e-05,
        3.5048e-05, 4.8280e-06, 1.7166e-05, 4.4107e-06, 6.2943e-05, 5.1260e-06,
        6.7949e-06, 5.6028e-06, 3.5167e-06, 6.4254e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([2.2888e-05, 1.4424e-05, 7.7486e-06, 8.2254e-06, 3.0577e-05, 1.2279e-05,
        2.2650e-05, 2.1458e-06, 3.9518e-05, 1.6987e-05, 9.7930e-05, 1.2875e-05,
        3.0994e-06, 5.7220e-06, 7.8678e-06, 6.4254e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.423937
summ of probs approach
id: [12337] -> tensor([[1.1504e-05, 7.7486e-07, 5.0724e-05, 1.2994e-05, 1.0848e-05, 9.4771e-06,
         6.9141e-06, 1.0610e-05, 4.7684e-07, 2.5630e-06, 1.0192e-05, 4.4107e-06,
         3.3140e-05, 1.6093e-06, 4.2915e-06, 6.1989e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.8087e-05, 4.8280e-06, 2.7001e-05, 2.5868e-05, 7.5102e-06, 2.9206e-05,
        1.4067e-05, 1.0133e-05, 1.0192e-05, 5.7220e-06, 3.2187e-06, 1.9014e-05,
        2.5272e-05, 9.3579e-06, 5.1260e-06, 3.6955e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([2.2888e-05, 1.1325e-05, 2.5690e-05, 1.2088e-04, 1.4484e-05, 8.0705e-05,
        4.9472e-05, 1.2350e-04, 3.8207e-05, 5.4836e-06, 1.4186e-05, 7.5698e-06,
        1.8740e-04, 1.2755e-05, 7.2122e-06, 4.2319e-06], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.380675
summ of probs approach
id: [12337] -> tensor([[5.4121e-05, 8.9407e-07, 2.2888e-05, 1.3113e-06, 4.4465e-05, 8.9407e-07,
         1.1128e-04, 2.6226e-06, 1.3888e-04, 3.0994e-06, 1.3709e-06, 1.0729e-06,
         7.8022e-05, 4.1723e-07, 2.9802e-07, 8.2850e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.9737e-06, 3.5763e-06, 2.8849e-05, 3.9160e-05, 3.7432e-05, 8.8215e-06,
        1.4019e-04, 1.4305e-06, 1.0055e-04, 2.0266e-06, 1.9968e-05, 9.6560e-06,
        9.0718e-05, 8.8811e-06, 2.9206e-06, 1.4722e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([4.6611e-05, 8.7619e-06, 5.9426e-05, 9.5785e-05, 2.1458e-05, 1.3590e-05,
        1.7834e-04, 5.4836e-06, 4.6194e-05, 1.8179e-05, 5.9605e-06, 8.4043e-06,
        2.1720e-04, 1.8537e-05, 3.8743e-06, 1.1325e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.384032
summ of probs approach
id: [12337] -> tensor([[2.3842e-07, 7.2718e-06, 2.9206e-06, 1.3113e-06, 9.2387e-06, 5.6565e-05,
         1.0729e-06, 1.3292e-05, 7.0930e-06, 3.9518e-05, 2.0981e-05, 1.5676e-05,
         1.3590e-05, 1.7285e-06, 8.3447e-07, 2.2531e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4901e-06, 2.5928e-05, 1.1659e-04, 2.7716e-05, 8.3447e-06, 8.2552e-05,
        1.9312e-05, 1.7762e-05, 7.7486e-06, 3.1590e-05, 4.3511e-05, 5.9307e-05,
        5.9009e-06, 1.2219e-05, 3.0398e-06, 1.6189e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([4.1723e-06, 4.3988e-05, 2.9206e-04, 1.1504e-05, 1.6761e-04, 1.8036e-04,
        4.7207e-05, 4.1127e-05, 3.6836e-05, 1.7405e-04, 1.5497e-04, 9.3126e-04,
        9.2387e-06, 3.0518e-05, 2.7418e-05, 1.2887e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.707426
summ of probs approach
id: [12337] -> tensor([[2.3246e-06, 6.6757e-06, 3.7253e-05, 1.0192e-05, 2.9802e-07, 1.0252e-05,
         3.9935e-06, 7.9274e-06, 8.9407e-07, 1.2100e-05, 2.6941e-05, 1.7154e-04,
         3.1829e-05, 5.5432e-06, 4.1723e-06, 6.5565e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.3173e-05, 2.6226e-06, 2.3484e-05, 1.4722e-05, 3.2187e-06, 1.1712e-04,
        7.2122e-06, 6.8545e-06, 2.7418e-06, 6.3181e-06, 3.7611e-05, 1.5187e-04,
        5.0068e-05, 2.9206e-06, 1.7524e-05, 1.2040e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([2.8908e-05, 3.3081e-05, 2.9492e-04, 4.0352e-05, 1.9670e-06, 1.7214e-04,
        9.3579e-06, 1.8358e-05, 1.2815e-05, 2.4021e-05, 4.0174e-04, 1.5187e-04,
        1.4663e-04, 1.9670e-06, 2.2292e-05, 2.2531e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.318483
summ of probs approach
id: [12337] -> tensor([[7.0333e-06, 1.3113e-06, 5.3108e-05, 6.7353e-06, 2.7418e-06, 7.3314e-06,
         1.4126e-05, 8.3447e-07, 2.9802e-06, 1.4901e-06, 1.2338e-05, 2.2709e-05,
         4.1127e-06, 4.8280e-06, 3.7849e-05, 1.7285e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.8743e-06, 2.9802e-06, 1.3161e-04, 5.9009e-06, 2.5630e-06, 2.8133e-05,
        3.4571e-06, 4.6492e-06, 1.6212e-05, 4.5300e-06, 1.0192e-05, 1.0264e-04,
        1.2636e-05, 3.0756e-05, 4.5121e-05, 1.2338e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([5.1677e-05, 3.6955e-06, 1.0830e-04, 3.2783e-05, 4.6790e-05, 2.3425e-05,
        2.6524e-05, 1.3113e-06, 6.9141e-06, 5.2452e-06, 8.7619e-06, 8.4579e-05,
        6.0201e-06, 9.0599e-06, 2.0838e-04, 4.1306e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.396898
summ of probs approach
id: [12337] -> tensor([[6.5565e-07, 2.9802e-06, 5.3346e-05, 2.6393e-04, 1.0133e-05, 8.7619e-06,
         2.4021e-05, 3.9339e-06, 1.2636e-05, 4.8876e-06, 1.2755e-05, 5.3644e-06,
         3.2246e-05, 2.3842e-07, 1.2040e-05, 8.9407e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.5432e-06, 4.1127e-06, 9.0182e-05, 2.0444e-04, 6.3777e-06, 6.0201e-06,
        3.6180e-05, 9.1791e-06, 7.8678e-06, 3.7193e-05, 4.6790e-05, 6.0201e-06,
        1.4818e-04, 4.7684e-06, 7.4506e-06, 2.0981e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([1.9670e-06, 5.3644e-06, 3.3021e-05, 2.6751e-04, 2.4796e-05, 7.8082e-06,
        6.4313e-05, 1.5378e-05, 1.6665e-04, 4.2617e-05, 2.0039e-04, 4.8161e-05,
        3.3092e-04, 1.0729e-06, 4.5002e-05, 2.5570e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.379131
summ of probs approach
id: [12337] -> tensor([[3.0994e-06, 9.6381e-05, 4.1723e-07, 1.9526e-04, 1.4722e-05, 4.6790e-05,
         2.3842e-07, 1.1325e-06, 1.8477e-06, 2.2054e-06, 9.1195e-06, 5.0664e-06,
         1.9670e-05, 6.4373e-06, 6.7949e-06, 3.2544e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.8545e-06, 5.5194e-05, 5.3048e-06, 9.8109e-05, 5.8413e-06, 4.4644e-05,
        7.1526e-07, 5.4836e-06, 2.2173e-05, 1.1086e-05, 4.7386e-05, 3.3975e-06,
        1.0431e-05, 1.2755e-05, 5.3048e-06, 3.0220e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
probs_ shape tensor([8.3447e-06, 3.6478e-05, 6.0797e-06, 9.5189e-05, 8.9169e-05, 7.5638e-05,
        4.7684e-06, 1.3232e-05, 1.1146e-05, 2.0564e-05, 1.0431e-04, 1.2934e-05,
        3.2663e-05, 2.1577e-05, 1.6212e-05, 5.3287e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.356669
summ of probs approach
id: [12337] -> tensor([[5.4240e-06, 1.5318e-04, 5.3227e-05, 1.8775e-05, 1.0729e-06, 8.7023e-06]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([1.6153e-05, 3.6895e-05, 3.4809e-05, 7.1049e-05, 7.8678e-06, 4.4584e-05],
       device='cuda:0', dtype=torch.float16) torch.Size([6])
summ of probs approach
probs_ shape tensor([1.2279e-05, 7.1168e-05, 1.2022e-04, 2.6274e-04, 2.5630e-06, 1.8215e-04],
       device='cuda:0', dtype=torch.float16) torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.136858
acc:  0.3686868686868687
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:04.963261
path ['42', 'de', 'llama', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [432, 1], 'attention_mask': [1, 1]}
id:[432, 1]
answer  {'input_ids': [448, 348, 1], 'attention_mask': [1, 1, 1]}
id:[448, 348, 1]
answer  {'input_ids': [3393, 13584, 1], 'attention_mask': [1, 1, 1]}
id:[3393, 13584, 1]
load model Duration: 0:00:05.576155
prompt_type null has 1 prompts in it
----------- 42 de bigscience/mt0-small NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([1.0602e-03, 2.4030e-03, 2.8046e-03, 4.3636e-03, 1.3964e-03, 1.4534e-03,
        1.0513e-03, 9.5768e-04, 1.6702e-03, 1.1185e-03, 9.5042e-01, 7.7759e-03,
        1.4549e-03, 2.1189e-03, 4.6981e-04, 5.0603e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.7994e-04, 2.9478e-03, 2.9492e-03, 4.3689e-03, 1.3707e-03, 1.6338e-03,
        2.1344e-03, 9.0136e-04, 3.2650e-03, 1.1166e-03, 9.5042e-01, 8.5627e-03,
        3.2971e-03, 2.2010e-03, 6.1833e-04, 5.0758e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.9015e-04, 2.2293e-03, 2.6777e-03, 4.3618e-03, 1.3621e-03, 1.4255e-03,
        6.0511e-04, 8.4619e-04, 5.0496e-04, 1.1127e-03, 9.5042e-01, 7.7390e-03,
        1.1931e-03, 2.0642e-03, 3.9265e-04, 4.7630e-03], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.113860
summ of probs approach
probs_ shape tensor([7.4159e-04, 1.4479e-03, 2.2249e-03, 1.4668e-03, 2.0556e-03, 7.4656e-04,
        5.9334e-04, 2.3674e-03, 2.7258e-03, 6.9835e-04, 1.1950e-03, 1.7720e-03,
        9.7050e-01, 4.2642e-03, 7.2816e-04, 5.7325e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1342e-03, 6.1430e-03, 2.2235e-03, 1.6746e-03, 2.2880e-03, 1.7777e-03,
        6.4650e-04, 2.3573e-03, 3.7393e-03, 7.7483e-04, 1.1112e-03, 1.7704e-03,
        9.7050e-01, 4.3051e-03, 1.0776e-03, 5.7564e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.8728e-04, 1.3692e-03, 2.2120e-03, 1.2599e-03, 1.9937e-03, 5.8091e-04,
        5.5704e-04, 2.1494e-03, 2.4381e-03, 6.8877e-04, 1.0646e-03, 1.7682e-03,
        9.7050e-01, 4.2345e-03, 7.0225e-04, 5.6932e-04], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.093686
summ of probs approach
probs_ shape tensor([3.2249e-04, 5.2806e-04, 7.1167e-04, 8.4009e-04, 2.1582e-03, 2.2980e-03,
        6.2963e-04, 2.1316e-03, 5.3632e-03, 1.1977e-03, 3.5710e-03, 9.5742e-01,
        1.2624e-03, 2.1077e-05, 2.6307e-04, 5.6675e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.2434e-04, 9.0913e-04, 6.4555e-04, 1.8065e-03, 2.3107e-03, 3.3278e-03,
        6.0459e-04, 2.4650e-03, 2.2416e-03, 2.5857e-03, 3.5634e-03, 9.5743e-01,
        5.8083e-03, 1.9932e-05, 3.3123e-04, 5.7910e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.1390e-04, 4.8760e-04, 6.2102e-04, 6.8629e-04, 2.0913e-03, 1.0994e-03,
        5.7539e-04, 1.0860e-03, 5.9753e-04, 1.1241e-03, 3.5538e-03, 9.5742e-01,
        8.2628e-04, 1.8848e-05, 1.6839e-04, 5.5835e-03], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.085353
summ of probs approach
probs_ shape tensor([6.5445e-04, 9.4766e-05, 7.1898e-04, 5.4684e-03, 1.2203e-03, 2.3462e-04,
        2.5970e-04, 2.2921e-03, 7.0100e-03, 2.7918e-03, 1.7313e-03, 9.3230e-01,
        1.2408e-03, 5.4930e-04, 2.1050e-03, 2.7834e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1355e-03, 9.6825e-05, 7.4908e-04, 5.5531e-03, 1.9713e-03, 2.7805e-04,
        2.8752e-04, 3.6000e-03, 7.2862e-03, 3.0569e-03, 8.4565e-04, 9.3230e-01,
        4.6674e-03, 5.6249e-04, 5.0340e-03, 2.8203e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.3897e-04, 9.4535e-05, 7.1075e-04, 5.4369e-03, 7.4993e-04, 2.2118e-04,
        2.4502e-04, 2.2020e-03, 6.9349e-03, 2.6967e-03, 5.9722e-04, 9.3230e-01,
        9.7823e-04, 5.4833e-04, 2.0720e-03, 2.7768e-04], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.100596
summ of probs approach
probs_ shape tensor([1.3460e-03, 9.2521e-03, 9.8159e-01, 3.3704e-04, 7.8249e-04, 2.4020e-03,
        5.8974e-04, 8.8863e-04, 1.4798e-03, 6.0968e-04, 9.7785e-05, 7.9701e-04,
        2.4119e-03, 7.6356e-04, 1.0976e-03, 5.3703e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.6047e-03, 1.5844e-03, 9.8159e-01, 4.3072e-04, 1.0692e-03, 3.0288e-03,
        4.2966e-04, 1.0605e-03, 5.7105e-03, 8.6600e-04, 1.0147e-04, 9.0984e-04,
        8.4894e-04, 8.8197e-04, 6.4246e-03, 6.4288e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.9943e-04, 3.5045e-04, 9.8159e-01, 3.0046e-04, 6.2636e-04, 2.2172e-03,
        3.5330e-04, 7.8292e-04, 7.6880e-04, 6.0550e-04, 7.8221e-05, 7.3268e-04,
        6.4530e-04, 4.3170e-04, 7.0130e-04, 4.1927e-04], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.183849
summ of probs approach
probs_ shape tensor([3.5070e-03, 3.0834e-03, 2.3668e-03, 2.7995e-03, 1.5796e-04, 9.8498e-04,
        7.7555e-04, 1.1100e-03, 1.7285e-03, 2.5410e-04, 2.2151e-03, 3.7627e-03,
        9.0216e-01, 4.8815e-03, 1.8799e-03, 8.6078e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.6597e-03, 3.0964e-03, 2.3726e-03, 2.9138e-03, 1.7494e-04, 9.8845e-04,
        1.0288e-03, 1.5728e-03, 7.1104e-03, 3.4429e-04, 4.9277e-03, 3.7891e-03,
        9.0216e-01, 4.8803e-03, 6.9868e-03, 3.6807e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.4738e-03, 3.0800e-03, 2.3628e-03, 2.7773e-03, 1.5319e-04, 9.6618e-04,
        6.6245e-04, 9.4886e-04, 1.6129e-03, 2.4217e-04, 2.1858e-03, 3.7490e-03,
        9.0216e-01, 4.8729e-03, 3.7643e-04, 7.1440e-04], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.092773
summ of probs approach
probs_ shape tensor([1.5362e-03, 3.3942e-03, 3.5289e-03, 3.0771e-04, 6.4851e-03, 2.7379e-03,
        1.4692e-03, 8.7231e-04, 2.7979e-03, 7.2428e-04, 4.3135e-03, 9.3968e-01,
        7.3303e-04, 1.2129e-03, 1.2447e-03, 1.5566e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.7629e-03, 3.3634e-03, 3.6807e-03, 6.6459e-04, 6.5313e-03, 2.6148e-03,
        1.9037e-03, 1.6363e-02, 2.8382e-03, 7.9273e-04, 4.2459e-03, 9.3968e-01,
        7.3945e-04, 1.1538e-03, 1.5222e-03, 1.7880e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.4280e-03, 3.3486e-03, 3.1482e-03, 2.9616e-04, 6.4623e-03, 2.5497e-03,
        1.4477e-03, 7.8229e-04, 2.7735e-03, 6.3191e-04, 3.8122e-03, 9.3968e-01,
        7.1670e-04, 1.1275e-03, 1.2079e-03, 1.5390e-03], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.080054
summ of probs approach
probs_ shape tensor([2.6787e-04, 2.3475e-03, 1.0671e-03, 9.4991e-03, 1.2663e-03, 9.6205e-04,
        2.3372e-03, 9.2253e-03, 7.1399e-04, 2.2181e-03, 9.3644e-01, 9.2066e-04,
        1.2044e-04, 1.1892e-03, 2.4023e-03, 1.4779e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.4305e-04, 2.3858e-03, 1.3679e-03, 1.0102e-02, 1.4392e-03, 1.6807e-03,
        2.4088e-03, 9.2476e-03, 8.3433e-04, 2.6684e-03, 9.3644e-01, 8.6488e-04,
        1.2567e-04, 1.4112e-03, 2.5334e-03, 1.5153e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.9951e-04, 2.3066e-03, 8.8219e-04, 9.4369e-03, 1.0685e-03, 9.2194e-04,
        2.2781e-03, 9.2161e-03, 3.7723e-04, 1.9720e-03, 9.3644e-01, 7.4132e-04,
        1.2005e-04, 1.0987e-03, 2.2510e-03, 1.4317e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.093658
summ of probs approach
probs_ shape tensor([2.6901e-04, 1.6374e-03, 3.4384e-03, 9.6531e-04, 3.5301e-04, 6.2051e-04,
        1.7001e-03, 1.1331e-03, 1.1001e-03, 6.8260e-05, 2.9102e-03, 9.7119e-01,
        6.3545e-04, 6.4670e-04, 1.4552e-03, 9.3979e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.0938e-05, 4.0624e-03, 3.4574e-03, 7.3665e-04, 4.3937e-04, 6.2136e-04,
        1.8945e-03, 1.3376e-03, 1.0547e-03, 7.2357e-05, 3.7260e-03, 9.7119e-01,
        7.6395e-04, 2.3434e-02, 2.6314e-03, 1.0033e-02], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.4979e-05, 6.6733e-04, 3.4272e-03, 5.6445e-04, 3.4849e-04, 6.1894e-04,
        1.6609e-03, 1.0839e-03, 1.0326e-03, 6.8179e-05, 2.8451e-03, 9.7118e-01,
        4.9148e-04, 3.8818e-04, 8.8372e-04, 9.2911e-03], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.115312
summ of probs approach
probs_ shape tensor([2.3655e-05, 1.9178e-03, 3.2774e-05, 2.4606e-03, 1.9264e-03, 9.9420e-01,
        2.4412e-03, 2.4917e-03, 2.6913e-03, 3.1278e-03, 1.2091e-03, 3.9395e-04,
        1.5651e-03, 1.6822e-03, 1.4178e-03, 6.7960e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.3874e-05, 3.0637e-03, 3.0376e-05, 3.9092e-03, 2.8341e-03, 9.9420e-01,
        2.9353e-03, 3.0835e-03, 9.1040e-03, 3.8710e-03, 1.0216e-03, 4.2325e-04,
        3.6442e-03, 1.7617e-03, 2.1217e-03, 1.0356e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.3630e-05, 1.7087e-03, 2.7101e-05, 2.1653e-03, 1.5879e-03, 9.9420e-01,
        2.4294e-03, 2.4376e-03, 4.2924e-04, 3.0726e-03, 7.7608e-04, 3.7359e-04,
        1.0937e-03, 1.6633e-03, 1.1147e-03, 6.7477e-04], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.065504
summ of probs approach
probs_ shape tensor([1.9323e-03, 1.1987e-03, 7.1962e-04, 1.0347e-03, 2.8970e-03, 3.5696e-03,
        5.2241e-03, 9.6089e-01, 2.2208e-03, 7.2679e-05, 2.5295e-03, 2.0663e-04,
        2.3415e-03, 1.2055e-03, 2.8564e-04, 1.1394e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.5974e-03, 1.2427e-03, 7.2733e-04, 1.5637e-03, 4.4097e-03, 3.9075e-03,
        1.1307e-02, 9.6089e-01, 3.1786e-03, 7.1951e-05, 2.3242e-03, 2.1787e-04,
        4.0609e-03, 1.1840e-03, 2.8751e-04, 1.1428e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.4839e-04, 1.1766e-03, 5.0823e-04, 9.2551e-04, 2.2160e-03, 3.3684e-03,
        4.3374e-03, 9.6089e-01, 2.0653e-03, 6.9786e-05, 1.8779e-03, 2.0646e-04,
        2.3216e-03, 1.1700e-03, 9.6384e-05, 1.0595e-04], device='cuda:0') torch.Size([16])
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/fr/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
 Batch: 10 of null classification Duration: 0:00:00.077521
summ of probs approach
probs_ shape tensor([9.3216e-01, 1.1929e-03, 2.1067e-03, 2.8923e-03, 2.9161e-03, 3.1934e-03,
        2.2209e-03, 1.4127e-03, 6.5683e-04, 4.8942e-03, 1.1906e-03, 7.5507e-04,
        1.8846e-03, 9.6723e-04, 2.4453e-03, 7.3843e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.3216e-01, 1.0066e-03, 2.0135e-03, 3.0216e-03, 4.7051e-03, 2.7310e-03,
        1.9051e-03, 1.3369e-03, 1.3333e-03, 4.8917e-03, 1.9729e-03, 8.9527e-04,
        2.6689e-03, 9.6739e-04, 2.6853e-03, 2.8489e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.3216e-01, 8.4998e-04, 1.9035e-03, 2.8777e-03, 2.4935e-03, 1.7881e-03,
        1.8204e-03, 1.1819e-03, 6.1309e-04, 4.8887e-03, 1.0295e-03, 5.6067e-04,
        1.7832e-03, 9.6662e-04, 1.7444e-03, 1.5033e-04], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.066376
summ of probs approach
probs_ shape tensor([9.8939e-01, 9.0951e-04, 1.4346e-03, 3.0302e-03, 2.2786e-04, 1.8432e-03],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([9.8939e-01, 9.1755e-04, 5.4786e-03, 3.0621e-03, 2.9614e-04, 1.8752e-03],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([9.8939e-01, 9.0197e-04, 8.0127e-04, 3.0222e-03, 2.2088e-04, 1.8331e-03],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.047548
acc:  0.3686868686868687
Time taken to execute the de NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.253272
path ['42', 'de', 't0', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_de_v55.pickle' as a pickle file.

Using MARC dataset for fr
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 310.66it/s]
loading model Duration: 0:00:01.397800
Average length of review_body for rows with 1 star: 155.920675
Average length of review_body for rows with 5 star: 144.119575
len of lowest cat:  39333
len of pos_reviews, neg_reviews:  39333 39333
len dataset  78666
len dataset  200
create dataloader Duration: 0:03:11.764857
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [92000], 'attention_mask': [1]}
id:[92000]
answer  {'input_ids': [25490], 'attention_mask': [1]}
id:[25490]
load model Duration: 0:00:08.165112
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/bloom-560m SA null 0 200 16 --------------
summ of probs approach
id: [92000] -> tensor([[8.8430e-09, 8.4449e-05, 2.6186e-06, 1.3505e-06, 9.0745e-09, 3.5853e-09,
         2.2748e-07, 1.8218e-07, 7.0487e-07, 2.9075e-07, 8.3143e-06, 6.9052e-08,
         2.0626e-07, 1.0203e-07, 1.0410e-08, 5.9256e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.9319e-08, 1.7572e-04, 7.4315e-07, 6.6677e-06, 2.1386e-08, 5.0480e-08,
         3.0348e-06, 2.2671e-06, 5.8153e-07, 5.3816e-07, 3.5088e-06, 2.0527e-07,
         2.0216e-07, 3.6567e-07, 2.9607e-08, 1.2897e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.182383
summ of probs approach
id: [92000] -> tensor([[2.6584e-09, 1.4887e-05, 6.6279e-08, 3.0435e-07, 9.6321e-07, 1.9052e-08,
         3.4036e-07, 1.1115e-06, 6.0982e-08, 2.4616e-07, 2.8209e-08, 5.8774e-05,
         1.6885e-09, 8.2755e-06, 6.8397e-10, 4.9406e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[8.0445e-08, 8.7923e-06, 1.1254e-07, 2.9737e-06, 2.6561e-06, 3.8410e-07,
         1.4665e-06, 2.2754e-06, 9.1038e-07, 4.2059e-07, 6.6960e-08, 1.5509e-04,
         5.6052e-08, 1.1651e-05, 4.7808e-08, 1.1058e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.121959
summ of probs approach
id: [92000] -> tensor([[1.1879e-06, 3.0625e-08, 1.4730e-07, 4.3783e-08, 1.2015e-06, 1.5706e-08,
         1.3489e-08, 1.0952e-06, 3.0358e-08, 1.5086e-06, 2.0764e-06, 1.5667e-07,
         1.0381e-07, 1.9752e-09, 1.9145e-07, 1.9851e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.1793e-06, 1.6672e-07, 2.9392e-07, 3.1855e-07, 8.5340e-07, 7.0457e-08,
         2.7157e-07, 2.3887e-06, 3.1180e-08, 1.8457e-06, 3.9832e-06, 3.7719e-07,
         2.3143e-07, 1.0558e-07, 2.1968e-07, 5.7677e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.188253
summ of probs approach
id: [92000] -> tensor([[3.8066e-07, 5.3350e-07, 1.4548e-04, 4.1342e-07, 3.5479e-07, 1.5433e-09,
         1.5214e-07, 3.6968e-08, 1.3561e-07, 6.3635e-07, 1.7539e-08, 3.5078e-07,
         2.5141e-06, 1.0551e-08, 3.7004e-07, 3.9641e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.3919e-06, 1.0908e-06, 2.0753e-04, 4.3645e-06, 1.4874e-07, 2.0377e-08,
         7.1799e-07, 3.6060e-07, 6.6270e-07, 2.2294e-06, 7.7905e-08, 4.6542e-06,
         1.1870e-05, 8.3298e-08, 2.1447e-06, 5.2898e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.149682
summ of probs approach
id: [92000] -> tensor([[1.6179e-07, 7.0594e-05, 9.6327e-07, 2.3227e-05, 2.0081e-07, 4.7932e-07,
         1.2737e-06, 4.3877e-06, 5.3175e-07, 8.1834e-08, 4.3683e-06, 1.8016e-06,
         1.1903e-07, 1.9918e-08, 9.9038e-10, 1.0950e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[6.6025e-07, 1.5432e-04, 1.8355e-06, 7.5269e-05, 4.5064e-07, 3.3472e-06,
         4.2865e-06, 2.1054e-05, 4.7964e-07, 1.9934e-06, 3.3198e-06, 5.5637e-06,
         3.2322e-06, 1.0308e-06, 4.3995e-08, 4.9905e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.221298
summ of probs approach
id: [92000] -> tensor([[3.8026e-08, 1.8623e-08, 1.6202e-07, 8.7283e-06, 2.6033e-06, 1.3520e-08,
         8.9104e-09, 5.3168e-06, 3.0267e-07, 4.7866e-08, 2.3212e-08, 2.4804e-07,
         3.6431e-09, 7.7164e-10, 2.1215e-06, 1.2779e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.6703e-06, 1.3402e-08, 1.3627e-06, 6.1241e-06, 2.1495e-05, 4.4805e-07,
         9.6828e-08, 3.3524e-06, 3.5995e-07, 6.2319e-07, 9.2789e-09, 4.7337e-07,
         4.1377e-09, 4.0942e-08, 4.7484e-06, 9.7962e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.136990
summ of probs approach
id: [92000] -> tensor([[2.0981e-07, 4.2975e-06, 5.5589e-06, 1.3578e-08, 1.8576e-06, 4.4318e-06,
         5.7798e-08, 3.0213e-08, 6.8760e-09, 7.6294e-06, 4.6497e-07, 3.1229e-06,
         4.1219e-09, 1.7007e-07, 1.4688e-05, 4.7334e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.8820e-07, 7.2452e-06, 7.3106e-05, 1.0708e-07, 1.2037e-06, 3.1715e-05,
         4.0049e-06, 3.6420e-08, 7.3170e-08, 1.5190e-05, 4.6227e-07, 5.0714e-06,
         1.2943e-07, 2.9425e-07, 1.7202e-04, 1.5554e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.153157
summ of probs approach
id: [92000] -> tensor([[1.7101e-07, 1.4217e-05, 1.5204e-07, 9.5006e-08, 2.9825e-10, 6.1026e-05,
         1.4103e-06, 4.4333e-05, 6.7626e-07, 1.1067e-08, 5.7815e-08, 5.0949e-08,
         2.3492e-07, 5.3212e-07, 3.9551e-07, 1.3926e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[8.9571e-07, 1.3040e-05, 8.7755e-07, 1.5268e-06, 4.2092e-08, 3.1890e-04,
         3.0149e-06, 3.8144e-05, 1.5675e-06, 1.6817e-08, 4.0781e-07, 1.3506e-07,
         5.4828e-06, 2.4268e-06, 7.5024e-07, 4.7739e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.135033
summ of probs approach
id: [92000] -> tensor([[2.9397e-07, 7.0210e-08, 2.6649e-08, 4.5621e-06, 3.5960e-07, 1.5817e-06,
         2.8996e-08, 3.2407e-07, 1.0542e-06, 8.2211e-12, 1.3254e-09, 8.5857e-07,
         3.3553e-09, 6.5217e-06, 3.2571e-07, 1.3140e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.0271e-06, 1.6422e-07, 4.0412e-08, 8.1278e-06, 4.5415e-07, 2.4102e-06,
         9.5046e-08, 9.6999e-07, 5.8992e-07, 8.2868e-12, 5.9152e-08, 1.3055e-06,
         4.5926e-08, 4.9430e-06, 1.1288e-06, 1.0448e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.129977
summ of probs approach
id: [92000] -> tensor([[6.3716e-07, 2.4262e-07, 1.5269e-06, 1.1737e-06, 2.0572e-07, 4.4374e-09,
         6.4660e-07, 2.5732e-08, 3.5486e-07, 1.1082e-05, 4.2328e-09, 2.7447e-09,
         2.3945e-07, 6.6088e-07, 3.2366e-09, 1.3327e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.5579e-06, 1.2720e-06, 2.5430e-06, 1.1018e-06, 5.1789e-07, 1.6396e-07,
         4.1525e-06, 1.8961e-07, 2.9792e-07, 2.0228e-04, 9.2692e-09, 1.0857e-07,
         1.3681e-06, 1.9980e-06, 2.3166e-09, 6.5674e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.116979
summ of probs approach
id: [92000] -> tensor([[6.3941e-09, 1.1070e-04, 4.7941e-06, 6.1134e-07, 7.0873e-07, 1.3021e-08,
         9.2379e-07, 3.6929e-07, 9.9456e-07, 1.5906e-06, 1.9524e-08, 3.0898e-08,
         3.2829e-06, 7.1496e-07, 1.8605e-07, 5.3047e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.4958e-08, 6.9113e-05, 8.1765e-06, 8.8096e-07, 5.8511e-06, 5.5979e-08,
         3.3986e-06, 2.0153e-06, 1.0144e-05, 6.9225e-06, 2.0706e-07, 6.0570e-08,
         2.7061e-05, 6.5582e-07, 9.1183e-07, 1.5992e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.131347
summ of probs approach
id: [92000] -> tensor([[2.8357e-09, 5.7023e-07, 4.6131e-07, 2.3955e-06, 1.7854e-06, 4.3372e-07,
         9.0054e-07, 1.4941e-06, 2.2346e-07, 8.6175e-09, 3.6240e-04, 1.8513e-06,
         1.9749e-09, 8.0717e-09, 1.4872e-07, 1.7334e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.1307e-08, 2.4471e-06, 8.4609e-07, 1.7522e-05, 3.2529e-06, 2.1206e-06,
         2.1885e-06, 4.3860e-07, 6.0053e-07, 1.2761e-08, 1.7759e-03, 5.7491e-06,
         9.5401e-08, 2.6127e-08, 8.3483e-07, 1.0734e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.191626
summ of probs approach
id: [92000] -> tensor([[1.7895e-08, 1.0475e-08, 3.2648e-08, 2.2419e-07, 9.6437e-07, 2.5833e-06,
         5.4378e-08, 5.8514e-06]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [25490] -> tensor([[2.5353e-07, 4.5569e-07, 4.2047e-07, 6.7407e-07, 1.5247e-05, 4.0818e-06,
         3.9688e-07, 9.7108e-05]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.087069
acc:  0.54
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.962463
path ['42', 'fr', 'bloom', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [92000], 'attention_mask': [1]}
id:[92000]
answer  {'input_ids': [25490], 'attention_mask': [1]}
id:[25490]
load model Duration: 0:00:08.063132
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/bloomz-560m SA null 0 200 16 --------------
summ of probs approach
id: [92000] -> tensor([[3.7435e-08, 8.0047e-11, 1.2705e-07, 7.3742e-06, 1.2143e-08, 2.0277e-08,
         3.9865e-07, 8.5332e-06, 2.6468e-05, 1.4834e-06, 1.6404e-07, 4.4073e-08,
         8.0664e-07, 1.1443e-06, 6.3114e-08, 3.9577e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.2288e-07, 5.0980e-08, 3.1887e-07, 5.7069e-07, 1.3734e-09, 6.4315e-08,
         3.4196e-07, 1.5551e-05, 1.1301e-04, 7.5151e-06, 4.3998e-07, 2.8584e-07,
         1.6920e-06, 4.3775e-05, 3.7443e-07, 1.0405e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.128837
summ of probs approach
id: [92000] -> tensor([[6.5444e-09, 1.2608e-05, 5.9010e-07, 9.3301e-07, 1.4240e-06, 6.9763e-07,
         4.2759e-08, 1.9759e-10, 2.9310e-07, 1.8142e-06, 8.1094e-07, 2.4897e-08,
         1.6815e-06, 1.1052e-07, 2.0560e-08, 9.7278e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.0800e-08, 3.8070e-07, 3.5791e-06, 4.5440e-07, 2.0489e-06, 1.1439e-06,
         1.3437e-06, 5.0813e-08, 9.0323e-06, 3.3953e-06, 1.1491e-06, 1.4808e-08,
         3.9082e-06, 8.8838e-07, 2.6818e-08, 4.1234e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.172833
summ of probs approach
id: [92000] -> tensor([[5.1100e-08, 1.1543e-08, 6.3582e-07, 2.8721e-06, 1.2133e-09, 1.9208e-10,
         2.8965e-09, 9.5769e-09, 1.3559e-09, 1.4672e-08, 5.6908e-08, 4.0833e-07,
         3.0220e-09, 3.3160e-09, 9.5349e-08, 8.5440e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.7937e-07, 6.6889e-07, 3.7231e-06, 5.2691e-07, 1.6107e-07, 4.4229e-08,
         5.9970e-09, 2.4137e-08, 3.7029e-08, 1.9158e-06, 1.9595e-06, 7.0194e-08,
         3.0802e-09, 4.5862e-10, 3.5553e-07, 9.7730e-08]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.166922
summ of probs approach
id: [92000] -> tensor([[7.0461e-09, 1.9404e-07, 2.5864e-05, 2.6979e-08, 4.7287e-06, 3.7641e-07,
         1.4057e-08, 1.3390e-09, 1.0830e-07, 1.0111e-06, 4.4958e-07, 5.2082e-09,
         6.2310e-08, 1.7169e-07, 2.6553e-07, 2.4213e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.1387e-08, 6.8263e-07, 5.7424e-05, 3.2444e-08, 5.4137e-07, 4.3913e-07,
         2.3852e-08, 1.1295e-07, 6.6404e-07, 1.3839e-06, 2.8429e-07, 2.0584e-08,
         6.6409e-07, 2.0817e-06, 2.3002e-07, 4.2823e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.108928
summ of probs approach
id: [92000] -> tensor([[3.4160e-07, 1.5962e-08, 6.9130e-07, 1.4574e-08, 3.4924e-07, 2.5259e-09,
         8.5023e-06, 3.4241e-09, 4.2270e-08, 5.1212e-09, 9.8861e-08, 7.4705e-08,
         1.7847e-08, 2.8487e-07, 4.0463e-08, 2.9592e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.3787e-06, 3.5664e-08, 1.8209e-06, 1.3862e-06, 8.0775e-07, 2.3481e-08,
         6.7677e-05, 1.7405e-08, 6.8991e-08, 1.3254e-08, 1.3172e-08, 5.5506e-07,
         1.8275e-09, 9.8414e-08, 1.3205e-08, 3.1855e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.121120
summ of probs approach
id: [92000] -> tensor([[5.0894e-07, 9.7246e-09, 5.3297e-08, 6.0224e-09, 4.3492e-07, 4.5314e-07,
         3.6988e-08, 5.1452e-09, 4.3794e-07, 4.4169e-08, 4.8964e-08, 1.9199e-08,
         3.5347e-08, 8.1567e-08, 3.1100e-08, 5.7534e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.2621e-06, 3.5361e-07, 6.3843e-08, 3.2229e-08, 3.5264e-07, 4.2374e-07,
         5.3664e-08, 2.6119e-08, 6.2050e-07, 1.1605e-07, 1.0597e-07, 1.3960e-07,
         3.8732e-08, 2.3488e-07, 4.6014e-08, 3.6878e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.151097
summ of probs approach
id: [92000] -> tensor([[8.5015e-08, 1.3302e-06, 2.2544e-10, 1.8535e-11, 7.0786e-09, 1.2935e-08,
         4.0966e-07, 1.2011e-08, 3.9009e-07, 3.2166e-08, 3.8793e-08, 4.3917e-05,
         7.1166e-11, 1.9779e-06, 2.2104e-09, 7.6790e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[8.8774e-07, 2.7206e-05, 6.1119e-09, 1.3478e-08, 6.6110e-08, 3.2834e-08,
         3.5438e-06, 1.1446e-07, 3.9522e-06, 1.0923e-07, 2.3521e-08, 4.9006e-05,
         2.3980e-09, 1.6677e-06, 8.3497e-09, 1.0247e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.131989
summ of probs approach
id: [92000] -> tensor([[6.6656e-06, 1.2157e-07, 1.0872e-08, 1.2629e-07, 3.8014e-06, 1.8912e-07,
         1.3379e-06, 6.1336e-09, 1.7729e-08, 1.7497e-08, 1.5309e-08, 1.5281e-09,
         2.2666e-07, 7.3028e-05, 7.6154e-07, 5.8577e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.3586e-06, 1.1557e-07, 5.1518e-08, 9.5324e-09, 4.9429e-06, 6.9865e-07,
         1.4938e-06, 1.2190e-08, 2.2549e-07, 4.3088e-07, 2.8088e-08, 2.1448e-07,
         1.1990e-07, 2.1285e-04, 4.2666e-07, 5.1156e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.162557
summ of probs approach
id: [92000] -> tensor([[3.0299e-06, 5.2194e-08, 8.6803e-07, 3.3106e-08, 8.3516e-10, 3.0041e-05,
         1.3732e-08, 1.2720e-07, 6.9685e-09, 1.5406e-08, 5.1487e-05, 8.2855e-09,
         1.7456e-05, 5.6165e-06, 2.5928e-07, 2.8182e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.6988e-07, 3.7616e-07, 1.5480e-06, 2.8504e-07, 2.5862e-09, 1.5469e-05,
         3.4592e-07, 1.7863e-07, 1.4294e-08, 2.9936e-08, 1.0349e-04, 2.5139e-08,
         6.5927e-06, 1.2310e-06, 1.4788e-07, 4.5517e-07]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.136852
summ of probs approach
id: [92000] -> tensor([[1.9328e-06, 2.6379e-07, 2.9247e-08, 2.3867e-08, 6.0676e-07, 2.7561e-09,
         2.5787e-08, 1.1054e-06, 2.0617e-07, 6.3966e-08, 3.7183e-08, 5.6919e-07,
         1.7728e-06, 3.3816e-10, 2.2260e-08, 2.2311e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.0500e-06, 6.7925e-08, 4.6552e-07, 8.7847e-08, 4.2741e-06, 2.2839e-09,
         1.2336e-06, 3.6432e-06, 2.2337e-07, 1.7671e-06, 3.1890e-07, 5.8518e-07,
         2.6664e-06, 8.3477e-09, 8.1649e-08, 6.2430e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.129791
summ of probs approach
id: [92000] -> tensor([[3.5581e-06, 2.4810e-08, 2.4332e-06, 3.4566e-07, 8.5720e-08, 9.2750e-08,
         6.6449e-05, 2.5296e-07, 1.0114e-08, 3.1143e-07, 6.4594e-11, 3.7209e-07,
         2.2327e-07, 2.9681e-08, 7.3445e-10, 1.1728e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.1164e-06, 1.2638e-08, 1.2321e-06, 4.3055e-07, 1.3027e-07, 6.0247e-08,
         3.5606e-04, 2.1431e-06, 7.6363e-08, 3.0068e-07, 2.5853e-11, 1.4186e-07,
         1.6206e-06, 4.3284e-08, 1.3937e-07, 3.3536e-09]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.219840
summ of probs approach
id: [92000] -> tensor([[8.6607e-08, 3.4942e-10, 8.4662e-07, 2.0478e-07, 3.5502e-09, 2.5676e-08,
         2.8875e-09, 2.2622e-08, 4.7900e-07, 4.5201e-08, 1.5271e-09, 1.9249e-07,
         4.7897e-07, 1.6554e-06, 1.1741e-08, 7.7374e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.2197e-07, 3.1147e-08, 1.4965e-05, 7.8052e-06, 7.2213e-10, 3.5845e-07,
         5.5125e-08, 7.5167e-08, 1.0772e-06, 1.4299e-07, 1.5815e-07, 9.4137e-07,
         1.0508e-05, 3.3722e-06, 4.8915e-07, 1.1994e-06]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.194236
summ of probs approach
id: [92000] -> tensor([[1.7071e-07, 3.5066e-07, 4.6448e-07, 8.8094e-08, 1.3663e-06, 9.4533e-09,
         2.1167e-08, 6.6474e-11]], device='cuda:0'), torch.Size([1, 8])
summ of probs approach
id: [25490] -> tensor([[7.1305e-08, 1.7088e-05, 7.0199e-08, 4.0343e-07, 1.6624e-05, 5.0179e-08,
         6.7591e-08, 5.4049e-08]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.050523
acc:  0.625
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.894310
path ['42', 'fr', 'bloomz', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [407, 23, 1], 'attention_mask': [1, 1, 1]}
id:[407, 23, 1]
answer  {'input_ids': [529, 1], 'attention_mask': [1, 1]}
id: [529, 1] -> [529]
load model Duration: 0:00:03.020507
prompt_type null has 1 prompts in it
----------- 42 fr google/flan-t5-base SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([1.2493e-03, 2.0425e-03, 1.8073e-03, 1.7276e-03, 1.5971e-03, 2.1315e-03,
        6.6625e-04, 2.6648e-03, 1.3617e-03, 1.0911e-03, 1.8949e-03, 9.8102e-01,
        1.8126e-03, 2.5380e-03, 5.3860e-04, 4.2958e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[2.5910e-04, 5.6876e-04, 1.7615e-04, 2.0305e-04, 1.3797e-05, 2.8503e-04,
         5.0552e-05, 1.2329e-04, 6.9200e-05, 8.1235e-06, 5.4482e-05, 9.8968e-07,
         3.1493e-04, 4.8825e-04, 1.8339e-05, 2.2692e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.168939
summ of probs approach
probs_ shape tensor([4.0999e-04, 1.0687e-03, 5.5058e-04, 9.9356e-03, 2.1004e-03, 9.8696e-01,
        4.8162e-03, 2.1629e-03, 1.1890e-03, 1.4318e-02, 5.2329e-03, 1.9073e-03,
        4.5295e-04, 1.0926e-03, 8.9967e-04, 7.0044e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[4.3676e-05, 5.7420e-05, 2.1492e-04, 2.0299e-03, 3.1956e-04, 5.5997e-07,
         5.6410e-05, 2.4451e-05, 1.7363e-05, 1.4835e-03, 1.0128e-04, 1.9098e-04,
         6.3888e-06, 6.5152e-05, 8.4925e-05, 1.4822e-03]], device='cuda:0'), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.146037
summ of probs approach
probs_ shape tensor([6.6037e-04, 1.6435e-03, 8.7363e-04, 1.8990e-03, 7.9104e-04, 8.6518e-04,
        1.2773e-03, 9.8658e-01, 8.3627e-04, 2.2347e-03, 3.2759e-03, 4.5995e-03,
        9.7179e-04, 1.9272e-03, 3.5412e-03, 1.0484e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[2.9752e-05, 1.7104e-04, 1.9738e-03, 1.1354e-05, 1.9618e-04, 1.2725e-05,
         1.0025e-05, 2.1698e-06, 2.1463e-05, 5.3337e-04, 5.5878e-05, 1.3550e-04,
         1.1938e-03, 4.7213e-05, 1.3095e-04, 1.9344e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.085455
summ of probs approach
probs_ shape tensor([1.2885e-03, 3.7349e-03, 1.2291e-02, 2.3248e-03, 9.8244e-01, 2.6993e-03,
        3.6991e-04, 1.9933e-03, 3.0657e-03, 1.1542e-03, 1.6993e-03, 1.6806e-03,
        6.8374e-04, 1.9250e-03, 4.7468e-03, 1.8318e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.2823e-04, 6.3331e-05, 2.9787e-04, 4.5953e-05, 1.3673e-06, 1.6697e-04,
         3.4099e-05, 9.8750e-04, 9.7629e-05, 1.1966e-04, 2.5813e-05, 1.7941e-04,
         1.0814e-05, 3.3898e-04, 3.1649e-05, 2.5807e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.115133
summ of probs approach
probs_ shape tensor([4.0146e-04, 3.2179e-03, 3.6742e-04, 1.5846e-03, 2.3207e-03, 6.8625e-04,
        3.9153e-03, 7.1385e-04, 9.9228e-01, 5.0432e-04, 6.3306e-04, 1.7566e-03,
        6.5579e-04, 9.5580e-04, 7.1709e-04, 5.5429e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.9791e-06, 3.9816e-06, 4.7594e-06, 8.7978e-05, 2.0678e-05, 2.4770e-05,
         1.5864e-05, 3.3286e-05, 2.3440e-06, 2.8379e-03, 3.1980e-05, 4.8884e-03,
         1.8787e-05, 6.7932e-05, 1.3567e-05, 5.2143e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.106823
summ of probs approach
probs_ shape tensor([1.3085e-03, 2.6292e-03, 5.4668e-04, 3.5965e-03, 9.6489e-04, 2.3281e-03,
        7.0907e-04, 8.1995e-04, 9.1635e-04, 5.1000e-04, 2.5433e-03, 1.2948e-03,
        1.4506e-03, 9.9035e-01, 1.3739e-03, 3.8295e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.7989e-05, 7.1427e-04, 3.0594e-05, 2.2540e-05, 6.4858e-04, 1.7154e-03,
         6.8880e-06, 2.1783e-05, 1.2492e-05, 3.5511e-06, 1.0125e-03, 7.0894e-05,
         1.8516e-05, 1.0313e-06, 2.7294e-05, 1.6550e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.099373
summ of probs approach
probs_ shape tensor([0.0010, 0.0119, 0.0024, 0.0014, 0.0010, 0.0049, 0.0005, 0.1032, 0.0011,
        0.0012, 0.0025, 0.0014, 0.0028, 0.0023, 0.0011, 0.0011],
       device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[6.4525e-06, 3.1450e-05, 3.2114e-06, 3.0150e-05, 4.6587e-05, 4.9072e-06,
         3.2319e-05, 4.7229e-05, 1.4288e-04, 2.1288e-03, 1.2546e-03, 3.6661e-06,
         2.4679e-05, 2.5092e-05, 1.5695e-04, 6.7158e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.092307
summ of probs approach
probs_ shape tensor([2.0706e-04, 4.2438e-03, 9.8354e-01, 3.2530e-03, 1.6046e-03, 6.8473e-03,
        2.4993e-03, 9.7400e-04, 9.7819e-04, 8.9611e-04, 6.6954e-04, 1.6001e-03,
        9.4523e-04, 3.7503e-04, 7.6242e-04, 1.0778e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[2.5413e-05, 9.7555e-05, 2.4136e-06, 5.7872e-05, 2.5444e-04, 2.0835e-04,
         1.9629e-04, 5.2897e-05, 8.7790e-06, 3.2802e-04, 2.3208e-05, 5.6390e-04,
         4.4382e-05, 5.1159e-05, 3.4836e-06, 3.1388e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.149729
summ of probs approach
probs_ shape tensor([1.2154e-03, 3.7185e-03, 8.7174e-04, 4.4350e-03, 4.6243e-04, 1.9576e-03,
        1.3475e-03, 9.8392e-01, 3.6432e-03, 2.3858e-03, 2.6405e-03, 7.1116e-04,
        2.2534e-03, 2.1001e-03, 8.5551e-04, 3.1490e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[9.5218e-04, 2.9358e-03, 1.2646e-05, 8.8256e-06, 2.2150e-05, 5.7579e-05,
         3.4819e-05, 2.9469e-07, 6.6459e-03, 1.4782e-04, 1.5845e-04, 3.5294e-04,
         6.3038e-06, 2.8115e-05, 4.4522e-05, 4.7150e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.110908
summ of probs approach
probs_ shape tensor([7.3244e-04, 1.3048e-03, 8.8233e-04, 1.5313e-03, 5.1642e-03, 9.1099e-04,
        9.9514e-01, 2.0218e-03, 1.6728e-03, 3.7874e-03, 1.0223e-03, 1.7091e-03,
        2.5353e-03, 3.6247e-03, 4.1851e-03, 2.2427e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[6.1059e-05, 1.7212e-05, 5.8016e-04, 1.2928e-05, 8.9087e-05, 1.9669e-05,
         5.7796e-07, 6.8024e-05, 7.4663e-06, 2.9513e-04, 1.7636e-05, 4.0410e-04,
         2.4126e-05, 5.3273e-04, 6.3352e-05, 1.6835e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.099204
summ of probs approach
probs_ shape tensor([3.0268e-03, 3.1508e-04, 1.4740e-03, 3.5767e-03, 1.1387e-03, 2.1873e-03,
        2.8062e-03, 9.7606e-01, 3.5854e-03, 5.4741e-03, 1.9178e-03, 8.8401e-04,
        8.0076e-04, 2.0765e-03, 1.2031e-03, 4.7055e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.2600e-05, 1.7397e-05, 2.0111e-04, 1.8968e-04, 7.4033e-05, 2.7033e-04,
         2.8704e-03, 6.9074e-07, 4.7917e-05, 3.9476e-04, 3.3696e-04, 1.5510e-04,
         5.4680e-05, 3.2184e-05, 1.5873e-06, 7.7957e-05]], device='cuda:0'), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.100238
summ of probs approach
probs_ shape tensor([0.0043, 0.0024, 0.0015, 0.0049, 0.0014, 0.5734, 0.0018, 0.0006, 0.0014,
        0.0009, 0.0014, 0.0023, 0.0031, 0.0016, 0.0015, 0.0016],
       device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[7.1280e-05, 1.5174e-04, 4.6984e-05, 2.9375e-04, 1.4161e-05, 2.4928e-05,
         3.8771e-06, 1.7925e-05, 3.6232e-04, 3.6622e-05, 5.4124e-06, 2.5540e-06,
         7.9587e-04, 3.3959e-05, 3.0833e-05, 6.0485e-04]], device='cuda:0'), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.105643
summ of probs approach
probs_ shape tensor([0.0035, 0.0023, 0.0018, 0.0013, 0.0043, 0.3986, 0.0014, 0.0021],
       device='cuda:0') torch.Size([8])
summ of probs approach
id: [529] -> tensor([[8.8008e-04, 4.7566e-05, 4.4684e-05, 2.6108e-08, 5.4602e-04, 4.0801e-04,
         1.2760e-03, 4.3616e-04]], device='cuda:0'), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.034334
acc:  0.515
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.430887
path ['42', 'fr', 'flan', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.89s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 2123, 29875], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id:[1, 2123, 29875]
answer  {'input_ids': [1, 1661], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 1661] -> [1661]
load model Duration: 0:02:27.407611
prompt_type null has 1 prompts in it
----------- 42 fr huggyllama/llama-7b SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([6.3086e-04, 7.0751e-05, 6.3972e-03, 3.9482e-03, 1.7805e-03, 1.8024e-04,
        3.1924e-04, 9.3043e-05, 6.3777e-05, 4.2439e-05, 1.2054e-03, 2.5392e-05,
        3.8208e-02, 4.9553e-03, 8.9569e-03, 2.1994e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.0145e-04, 2.2769e-05, 4.6325e-04, 3.6955e-05, 8.7202e-05, 4.4286e-05,
         2.3961e-05, 4.4584e-05, 2.1935e-05, 9.2268e-05, 1.4009e-03, 7.5102e-06,
         3.5334e-04, 2.9874e-04, 1.2503e-03, 1.0371e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 0 of null classification Duration: 0:00:00.520078
summ of probs approach
probs_ shape tensor([5.9545e-05, 4.5252e-04, 7.7677e-04, 4.8599e-03, 4.7040e-04, 1.4555e-04,
        5.2452e-05, 2.4080e-05, 2.9327e-02, 5.8031e-04, 2.3603e-04, 7.9870e-04,
        2.1744e-03, 1.0818e-04, 2.4078e-02, 5.6572e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[6.6757e-05, 1.3614e-04, 9.1732e-05, 2.6965e-04, 4.5896e-06, 1.4639e-04,
         1.3649e-05, 8.4639e-06, 3.9160e-05, 7.9918e-04, 1.2815e-04, 2.1553e-04,
         1.5087e-03, 1.1683e-04, 2.3193e-03, 2.3632e-03]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 1 of null classification Duration: 0:00:00.359713
summ of probs approach
probs_ shape tensor([5.7220e-04, 1.9610e-05, 5.1928e-04, 1.2660e-04, 3.0875e-05, 1.9897e-02,
        3.6001e-04, 1.0986e-02, 1.0681e-03, 9.1493e-05, 1.1563e-05, 1.3566e-04,
        1.2712e-03, 4.3154e-05, 4.7255e-04, 1.9798e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.2650e-04, 5.7817e-06, 6.3717e-05, 4.0531e-05, 1.0312e-05, 2.0180e-03,
         2.5129e-04, 6.9523e-04, 1.0881e-03, 3.7014e-05, 4.5896e-06, 7.7784e-05,
         8.6117e-04, 2.7478e-05, 1.7881e-04, 2.9683e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 2 of null classification Duration: 0:00:00.260130
summ of probs approach
probs_ shape tensor([1.6510e-02, 1.0271e-03, 7.6771e-05, 9.7322e-04, 2.8789e-05, 2.0409e-03,
        3.6716e-03, 3.2353e-04, 5.8889e-05, 1.1569e-04, 5.5075e-05, 1.3981e-03,
        5.7602e-04, 5.3501e-04, 1.2922e-04, 2.6016e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.8396e-04, 3.7014e-05, 6.8128e-05, 7.1943e-05, 5.7817e-06, 5.8711e-05,
         2.5177e-04, 2.1398e-04, 1.6570e-05, 1.9133e-05, 5.9605e-06, 9.0981e-04,
         3.6657e-05, 2.9445e-05, 1.4627e-04, 3.7253e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 3 of null classification Duration: 0:00:00.353921
summ of probs approach
probs_ shape tensor([3.6669e-04, 4.4894e-04, 5.9009e-05, 5.8746e-04, 5.3635e-03, 3.6895e-05,
        3.7432e-04, 1.0841e-02, 1.4915e-02, 1.2231e-04, 3.2365e-05, 3.3302e-03,
        1.3542e-03, 7.6652e-05, 7.4029e-05, 6.1035e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[5.1558e-05, 1.2982e-04, 3.9399e-05, 4.5061e-05, 1.0657e-04, 3.9339e-06,
         4.2319e-05, 4.4703e-05, 8.9931e-04, 5.4240e-06, 9.4175e-06, 7.3385e-04,
         1.9419e-04, 3.8385e-05, 2.0683e-05, 2.2531e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 4 of null classification Duration: 0:00:00.324900
summ of probs approach
probs_ shape tensor([1.0643e-03, 1.3399e-04, 2.8110e-04, 9.0027e-04, 4.0460e-04, 3.9458e-05,
        2.5024e-03, 7.2670e-04, 9.0241e-05, 1.0836e-04, 5.4455e-04, 1.1721e-03,
        3.7098e-03, 3.4218e-03, 3.4380e-04, 5.0902e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.5094e-05, 1.2159e-04, 3.5763e-04, 7.6389e-04, 7.5698e-05, 3.6359e-06,
         4.7159e-04, 1.2994e-04, 4.1842e-05, 1.0073e-05, 3.8683e-05, 4.5717e-05,
         4.4107e-04, 5.6839e-04, 1.3411e-04, 1.1742e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 5 of null classification Duration: 0:00:00.301272
summ of probs approach
probs_ shape tensor([1.7319e-03, 4.0889e-05, 6.8128e-05, 6.8247e-05, 1.0538e-03, 5.8794e-04,
        1.1480e-04, 1.2474e-02, 3.5703e-05, 3.4833e-04, 6.4909e-05, 4.8399e-05,
        1.5831e-04, 1.2846e-03, 9.9087e-04, 7.4348e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.0324e-04, 7.7486e-06, 2.3067e-05, 1.4782e-05, 1.3983e-04, 1.1629e-04,
         3.8683e-05, 2.9564e-04, 2.9802e-05, 8.3447e-05, 9.6560e-06, 5.0068e-06,
         2.8610e-05, 1.0967e-04, 1.3423e-04, 6.7139e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 6 of null classification Duration: 0:00:00.300487
summ of probs approach
probs_ shape tensor([8.8692e-05, 1.1247e-04, 1.4913e-04, 2.4676e-05, 2.3174e-04, 2.1160e-04,
        2.0564e-05, 9.2745e-05, 1.6153e-05, 6.7902e-03, 2.7771e-03, 6.2084e-04,
        3.2783e-05, 6.3300e-05, 2.8725e-03, 1.2312e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.0848e-05, 2.0385e-05, 2.0528e-04, 1.6212e-05, 3.1948e-05, 1.0252e-05,
         1.9491e-05, 1.9312e-05, 1.5199e-05, 2.0695e-04, 3.8509e-03, 2.0349e-04,
         1.6987e-05, 2.6166e-05, 8.2612e-05, 3.1090e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 7 of null classification Duration: 0:00:00.478507
summ of probs approach
probs_ shape tensor([1.7107e-05, 1.6224e-04, 7.2718e-04, 4.0009e-02, 7.5102e-05, 2.4438e-05,
        2.0075e-04, 6.5684e-05, 1.1272e-03, 3.3617e-05, 4.0412e-05, 1.2755e-05,
        2.3384e-03, 3.3975e-05, 1.0071e-03, 2.8789e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.6226e-06, 1.8477e-05, 2.0432e-04, 1.6098e-03, 1.0371e-05, 1.1325e-05,
         2.2328e-04, 4.7863e-05, 3.3677e-05, 9.5367e-07, 1.2612e-04, 1.6809e-05,
         2.2774e-03, 1.1623e-05, 4.3774e-04, 9.9540e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 8 of null classification Duration: 0:00:00.370361
summ of probs approach
probs_ shape tensor([5.1379e-05, 1.0872e-04, 6.5863e-05, 1.0099e-03, 2.3246e-04, 2.2292e-05,
        4.7607e-03, 2.0180e-03, 1.2236e-03, 4.2801e-03, 3.1338e-03, 9.4604e-04,
        5.3942e-05, 4.4785e-03, 2.5868e-05, 7.0858e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[6.8545e-05, 3.3975e-06, 2.0719e-04, 5.7554e-04, 2.2340e-04, 6.1393e-06,
         1.1024e-03, 9.1505e-04, 7.2622e-04, 3.0375e-04, 2.4986e-04, 6.9320e-05,
         6.4969e-06, 8.0585e-04, 2.1100e-05, 7.4208e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 9 of null classification Duration: 0:00:00.226726
summ of probs approach
probs_ shape tensor([1.3280e-04, 6.7174e-05, 7.5340e-05, 8.1682e-04, 1.6565e-03, 4.5598e-05,
        3.1471e-05, 4.2458e-03, 8.9598e-04, 3.5715e-04, 2.0466e-03, 5.0068e-05,
        1.8066e-02, 1.1635e-04, 5.3406e-04, 5.0402e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.9372e-05, 1.8895e-05, 2.4140e-05, 6.0034e-04, 1.2946e-04, 9.5367e-06,
         1.2040e-05, 5.0392e-03, 1.6136e-03, 1.3077e-04, 6.0129e-04, 6.0201e-06,
         1.9205e-04, 2.0742e-05, 3.7789e-04, 2.8205e-04]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 10 of null classification Duration: 0:00:00.221415
summ of probs approach
probs_ shape tensor([5.5265e-04, 9.0485e-03, 3.4332e-04, 7.3314e-05, 4.6802e-04, 3.9756e-05,
        1.1522e-04, 6.0892e-04, 1.2951e-03, 3.0041e-05, 1.1009e-02, 3.8910e-04,
        1.3285e-03, 1.4133e-03, 7.1001e-04, 4.9515e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[4.7660e-04, 1.1492e-03, 1.6403e-03, 1.9193e-05, 9.1255e-05, 5.4240e-06,
         2.5034e-05, 1.0228e-04, 1.3294e-03, 4.7684e-06, 1.2178e-03, 1.5497e-04,
         6.2990e-04, 5.3346e-05, 1.0413e-04, 7.3612e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
 Batch: 11 of null classification Duration: 0:00:00.389310
summ of probs approach
probs_ shape tensor([2.4185e-03, 1.9264e-04, 3.3569e-03, 4.3929e-05, 1.0986e-03, 3.0479e-03,
        2.7847e-04, 9.9182e-03], device='cuda:0', dtype=torch.float16) torch.Size([8])
summ of probs approach
id: [1661] -> tensor([[4.8685e-04, 4.1425e-05, 2.6059e-04, 3.6836e-05, 9.5892e-04, 4.8304e-04,
         6.1560e-04, 2.3341e-04]], device='cuda:0', dtype=torch.float16), torch.Size([1, 8])
 Batch: 12 of null classification Duration: 0:00:00.191411
acc:  0.585
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:04.318380
path ['42', 'fr', 'llama', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1032, 266, 1], 'attention_mask': [1, 1, 1]}
id:[1032, 266, 1]
answer  {'input_ids': [935, 1], 'attention_mask': [1, 1]}
id:[935, 1]
load model Duration: 0:00:05.291618
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/mt0-small SA null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([9.9497e-01, 9.2182e-01, 9.3648e-04, 2.8953e-04, 4.5073e-04, 7.8456e-04,
        1.1401e-03, 3.1669e-04, 7.7593e-04, 8.8118e-04, 8.9752e-04, 2.1470e-03,
        9.5585e-05, 3.7279e-04, 3.3073e-04, 5.0161e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.9497e-01, 9.2181e-01, 9.0414e-04, 2.2084e-04, 4.2453e-04, 8.9570e-04,
        1.3208e-03, 3.0362e-04, 7.7874e-04, 1.7706e-03, 5.5133e-04, 2.0098e-03,
        7.8683e-05, 3.3116e-04, 3.1848e-04, 4.6329e-04], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.131837
summ of probs approach
probs_ shape tensor([2.6959e-04, 4.6554e-04, 5.3672e-04, 5.7074e-04, 1.5987e-03, 9.2133e-04,
        5.6520e-04, 3.4811e-04, 2.3871e-03, 1.0796e-03, 6.8002e-04, 3.9215e-04,
        5.4423e-04, 6.2226e-04, 7.0174e-04, 9.5877e-01], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.4224e-04, 5.5583e-04, 4.0420e-04, 5.5322e-04, 3.8693e-03, 7.7095e-03,
        6.3349e-04, 3.2465e-04, 1.9507e-03, 9.2041e-04, 7.3232e-04, 3.6447e-04,
        3.6826e-04, 5.0149e-04, 6.3529e-04, 9.5876e-01], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.096709
summ of probs approach
probs_ shape tensor([7.7491e-04, 1.2195e-03, 2.1879e-04, 5.4408e-04, 6.6833e-01, 3.1574e-04,
        9.7788e-04, 1.0195e-03, 6.4708e-04, 6.0495e-04, 1.3382e-03, 7.5975e-04,
        6.0993e-04, 6.1301e-04, 4.2347e-04, 1.0368e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.6668e-04, 3.8740e-03, 4.0036e-04, 8.1430e-04, 6.6832e-01, 2.9774e-04,
        8.7075e-04, 9.6362e-04, 5.3114e-04, 5.0103e-04, 8.5351e-04, 7.5150e-04,
        8.8190e-04, 6.8172e-04, 2.8472e-04, 7.1692e-04], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.087454
summ of probs approach
probs_ shape tensor([1.0662e-03, 5.3111e-04, 4.0672e-04, 3.5225e-03, 3.5778e-04, 4.9932e-04,
        6.5611e-01, 3.4354e-04, 2.5722e-04, 7.1124e-04, 5.0050e-04, 8.0118e-04,
        3.6830e-04, 2.0196e-04, 6.4084e-05, 8.7379e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.3354e-03, 5.0680e-04, 3.3427e-04, 4.8608e-03, 1.4022e-03, 7.3673e-04,
        6.5610e-01, 3.2862e-04, 2.1478e-04, 6.6240e-04, 4.9109e-04, 9.0206e-04,
        4.9192e-04, 1.8581e-04, 8.0666e-05, 8.2754e-04], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.134996
summ of probs approach
probs_ shape tensor([6.7308e-04, 8.3489e-04, 6.1631e-04, 4.1601e-04, 1.1209e-04, 8.1215e-04,
        9.6297e-01, 2.6618e-04, 1.7540e-04, 8.8728e-04, 6.9225e-04, 1.5449e-03,
        2.3877e-03, 7.1485e-04, 7.8610e-04, 1.0268e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.8606e-04, 1.2422e-03, 1.6388e-03, 3.5763e-04, 1.0917e-04, 5.6699e-04,
        9.6296e-01, 2.2434e-04, 1.7677e-04, 4.7918e-04, 6.5402e-04, 2.2440e-03,
        1.8299e-02, 7.3489e-04, 5.6464e-04, 8.9455e-04], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.081335
summ of probs approach
probs_ shape tensor([5.3249e-04, 1.0161e-03, 6.3799e-04, 7.2904e-04, 5.6679e-04, 4.9119e-04,
        4.4404e-04, 7.4194e-04, 2.9268e-04, 3.1485e-04, 8.5399e-04, 9.3604e-04,
        6.8696e-04, 1.1849e-03, 9.6959e-01, 4.8019e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.1574e-04, 1.3718e-03, 4.2426e-04, 1.5852e-03, 5.8337e-04, 4.8200e-04,
        3.2378e-04, 1.6050e-03, 2.7849e-04, 3.1949e-04, 8.0254e-04, 1.2192e-03,
        5.1477e-03, 7.3841e-03, 9.6959e-01, 4.8043e-04], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.080093
summ of probs approach
probs_ shape tensor([8.8865e-04, 8.9254e-04, 5.8398e-04, 6.9457e-04, 3.0786e-04, 2.5417e-04,
        9.1118e-01, 1.1052e-03, 5.7292e-04, 5.4061e-04, 7.1485e-04, 7.0626e-04,
        1.3521e-03, 6.8909e-04, 1.7959e-03, 6.8060e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([7.9253e-04, 7.0917e-04, 5.6996e-04, 6.4513e-04, 2.4392e-04, 2.1756e-04,
        9.1118e-01, 1.1489e-03, 3.6338e-04, 4.7798e-04, 6.8796e-04, 6.9207e-04,
        7.3570e-03, 5.1549e-02, 1.7156e-03, 2.4469e-03], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.072703
summ of probs approach
probs_ shape tensor([1.1362e-03, 6.7669e-04, 5.3826e-04, 9.3761e-04, 3.7734e-04, 4.4297e-04,
        6.8904e-04, 4.8745e-04, 6.4024e-04, 6.8532e-04, 6.2364e-04, 9.8140e-01,
        2.0571e-03, 3.3767e-04, 6.2225e-04, 4.4703e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.0848e-03, 5.4211e-04, 8.2790e-04, 9.4987e-04, 4.3234e-04, 5.2472e-04,
        1.3017e-03, 4.5242e-04, 1.1766e-03, 6.3786e-04, 6.1521e-04, 9.8132e-01,
        2.0174e-03, 2.3676e-04, 5.7479e-04, 3.7472e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.075631
summ of probs approach
probs_ shape tensor([9.5516e-05, 4.0714e-04, 2.9836e-04, 8.5028e-04, 1.3388e-03, 1.6006e-03,
        2.1131e-03, 2.2252e-04, 1.1209e-03, 9.9122e-04, 7.0647e-04, 7.0260e-04,
        1.2610e-03, 9.6149e-01, 9.0331e-04, 1.5493e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.1881e-05, 3.9124e-04, 4.6162e-04, 9.0792e-04, 2.1881e-03, 3.9247e-03,
        2.0933e-03, 1.5357e-04, 1.8232e-03, 7.1642e-04, 7.3693e-04, 7.0451e-04,
        1.2640e-03, 9.6149e-01, 8.5785e-04, 1.0172e-03], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.064550
summ of probs approach
probs_ shape tensor([3.1309e-04, 8.3395e-04, 1.5291e-03, 2.2115e-04, 5.6402e-04, 3.9821e-04,
        2.3550e-04, 2.0293e-03, 9.4128e-04, 6.1564e-04, 3.1366e-04, 4.6422e-04,
        6.6325e-04, 1.2990e-03, 9.9872e-01, 2.7190e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.6817e-04, 6.9965e-04, 1.2869e-03, 2.1293e-04, 6.6792e-04, 2.9825e-04,
        2.0483e-04, 3.5432e-03, 9.4270e-04, 1.6577e-03, 2.6069e-04, 4.2936e-04,
        6.3812e-04, 1.0510e-03, 9.9872e-01, 8.9058e-04], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.068028
summ of probs approach
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/fr/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
probs_ shape tensor([6.5696e-04, 3.1514e-04, 3.8561e-02, 2.5754e-04, 1.1129e-03, 4.4906e-04,
        8.4828e-04, 5.3011e-04, 5.9866e-04, 2.0335e-04, 4.0129e-04, 3.3469e-03,
        1.3297e-04, 6.0320e-04, 4.6990e-04, 1.1551e-05], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.1107e-04, 3.0600e-04, 3.4805e-02, 2.0827e-04, 1.6893e-03, 4.5115e-04,
        2.1813e-03, 5.0512e-04, 1.1173e-03, 2.8795e-04, 2.5697e-04, 5.1223e-03,
        1.1835e-04, 5.0736e-04, 4.5086e-04, 7.5691e-06], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.077867
summ of probs approach
probs_ shape tensor([8.9848e-01, 4.5688e-04, 8.0907e-04, 2.6759e-04, 4.4322e-04, 5.9162e-04,
        5.0364e-04, 4.1312e-04, 6.5172e-04, 4.4257e-04, 5.5753e-04, 6.7908e-04,
        8.7932e-04, 4.9745e-04, 9.3656e-04, 2.9186e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.9847e-01, 4.2419e-04, 7.2970e-04, 3.9294e-04, 3.2956e-04, 5.7938e-04,
        4.2505e-04, 3.6395e-04, 4.3836e-04, 3.6514e-04, 5.2506e-04, 4.4803e-04,
        1.8835e-03, 3.2300e-04, 6.1358e-04, 2.6174e-04], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.118320
summ of probs approach
probs_ shape tensor([0.0008, 0.0021, 0.0001, 0.0004, 0.0006, 0.0005, 0.0064, 0.0011],
       device='cuda:0') torch.Size([8])
summ of probs approach
probs_ shape tensor([0.0007, 0.0057, 0.0001, 0.0004, 0.0006, 0.0005, 0.0033, 0.0008],
       device='cuda:0') torch.Size([8])
 Batch: 12 of null classification Duration: 0:00:00.054452
acc:  0.715
Time taken to execute the fr SA task with prompt type null, variation 0 and batchsize 16: 0:00:01.161550
path ['42', 'fr', 't0', 'SA', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Using NLI dataset for fr
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 272.04it/s]
loading model Duration: 0:00:01.157154
filter data Duraction: 0:00:00.000001
use_neutral is  True
len of entail_examples , neutral_examples, contra_examples:  66 66 66
len dataset  198
random sample Duraction: 0:02:51.561486
create dataloader Duration: 0:02:52.820659
Loading model bigscience/bloom-560m
Model bigscience/bloom-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [92000], 'attention_mask': [1]}
id:[92000]
answer  {'input_ids': [25490], 'attention_mask': [1]}
id:[25490]
answer  {'input_ids': [1090, 69696], 'attention_mask': [1, 1]}
id:[1090, 69696]
load model Duration: 0:00:08.471301
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/bloom-560m NLI null 0 200 16 --------------
summ of probs approach
id: [92000] -> tensor([[4.0234e-06, 2.2452e-07, 6.1706e-08, 9.9057e-07, 2.2797e-07, 5.3656e-08,
         8.8644e-08, 5.5089e-07, 3.7161e-08, 4.3806e-07, 7.9087e-07, 3.3908e-06,
         8.1749e-07, 3.9744e-08, 3.2219e-05, 2.6882e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.5203e-05, 9.6817e-07, 1.2902e-07, 7.2057e-07, 1.1059e-06, 2.0695e-07,
         5.0667e-07, 4.7057e-06, 1.1045e-06, 8.7970e-07, 6.5898e-07, 3.0954e-06,
         3.2445e-06, 4.7498e-07, 6.2383e-05, 1.4220e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.1751e-05, 3.1606e-06, 2.9122e-06, 3.1132e-06, 3.2253e-06, 4.0107e-07,
        5.1083e-06, 9.5366e-06, 2.4716e-06, 1.5533e-05, 1.7430e-06, 9.6380e-06,
        1.4874e-06, 5.6473e-06, 3.0796e-05, 1.5338e-06], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.186129
summ of probs approach
id: [92000] -> tensor([[1.7192e-06, 1.0010e-06, 1.4480e-07, 9.1847e-07, 1.2158e-08, 3.4470e-09,
         1.3855e-08, 5.3514e-08, 9.1064e-07, 1.6028e-07, 1.3717e-05, 3.0249e-05,
         2.2560e-05, 1.7185e-05, 1.9614e-06, 3.0412e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.8276e-06, 2.6254e-06, 3.4590e-07, 6.2388e-06, 2.5309e-07, 6.9120e-08,
         2.1642e-07, 8.3776e-07, 5.7454e-07, 7.5259e-07, 5.8920e-05, 2.2658e-05,
         4.5518e-05, 2.7406e-05, 5.2911e-06, 2.4044e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.5494e-05, 4.9032e-06, 9.0071e-07, 1.7029e-06, 3.3431e-06, 1.0942e-06,
        4.0593e-07, 1.2098e-06, 1.5870e-06, 4.3524e-06, 1.2764e-05, 4.0468e-05,
        1.1968e-05, 5.5605e-05, 5.8527e-06, 2.1387e-06], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.160861
summ of probs approach
id: [92000] -> tensor([[1.0045e-07, 4.2942e-07, 7.5308e-06, 2.6763e-06, 3.7497e-06, 2.4569e-06,
         2.1983e-08, 1.0574e-06, 2.6871e-09, 4.2032e-08, 6.1392e-08, 8.3430e-08,
         1.6738e-07, 1.8290e-08, 1.4942e-08, 2.0069e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[6.0224e-07, 2.4467e-06, 1.3789e-06, 3.9934e-06, 5.2542e-06, 1.2862e-05,
         2.3760e-07, 2.6279e-06, 1.0449e-07, 7.2576e-07, 3.7460e-07, 4.2617e-07,
         2.1290e-06, 1.3966e-07, 1.3276e-07, 2.0928e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.2179e-06, 9.7669e-06, 1.6856e-06, 4.1680e-06, 2.7265e-05, 5.0427e-05,
        1.1937e-06, 2.4337e-06, 1.7323e-06, 1.7884e-06, 1.6124e-06, 6.0615e-07,
        9.1424e-06, 1.3681e-06, 1.0656e-06, 8.3875e-07], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.164922
summ of probs approach
id: [92000] -> tensor([[9.3536e-07, 1.4044e-06, 3.5116e-07, 2.0072e-08, 5.4769e-11, 5.1600e-09,
         5.1188e-06, 1.8439e-07, 5.1416e-07, 2.6624e-07, 1.4482e-08, 1.3689e-08,
         2.0199e-08, 1.4748e-05, 1.4374e-07, 6.6791e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.0137e-06, 3.0341e-06, 7.1878e-07, 4.6142e-07, 8.4062e-11, 3.6795e-08,
         3.3583e-06, 1.9297e-07, 4.5529e-06, 3.1585e-07, 1.6484e-07, 2.1486e-07,
         7.3755e-08, 1.2620e-05, 3.5154e-07, 4.2069e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4906e-05, 2.1803e-06, 5.6547e-06, 2.0839e-06, 2.9615e-10, 1.0277e-06,
        1.5978e-05, 3.4288e-06, 9.1639e-06, 2.7272e-06, 5.5763e-07, 8.0412e-07,
        6.1492e-07, 1.2369e-04, 2.1277e-06, 1.8528e-06], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.134563
summ of probs approach
id: [92000] -> tensor([[1.8056e-08, 4.2317e-09, 1.2515e-07, 2.9049e-07, 9.3701e-08, 3.2463e-07,
         1.7416e-08, 9.6587e-09, 4.2705e-08, 1.3900e-09, 1.6116e-07, 1.6985e-07,
         4.8720e-09, 2.9736e-09, 4.4740e-08, 2.0630e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.6447e-07, 1.3051e-07, 8.7594e-08, 7.0710e-07, 2.9620e-07, 3.2644e-07,
         2.1249e-07, 3.7916e-07, 2.3430e-07, 6.1378e-08, 7.8000e-07, 3.2774e-07,
         1.4349e-07, 7.5760e-08, 2.1854e-07, 5.1569e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.8477e-07, 1.4514e-06, 1.8900e-06, 9.2936e-07, 3.9692e-06, 3.5102e-06,
        3.6244e-06, 2.5687e-06, 9.6986e-06, 3.1391e-07, 3.0430e-06, 1.3378e-06,
        9.3807e-07, 1.8894e-07, 2.4399e-06, 2.1592e-06], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.179472
summ of probs approach
id: [92000] -> tensor([[4.5691e-06, 1.1962e-07, 2.2936e-07, 7.9611e-08, 7.3061e-07, 3.9982e-07,
         1.1737e-08, 7.7310e-07, 2.8439e-07, 3.5159e-09, 1.9127e-07, 7.9342e-09,
         5.8328e-06, 8.8802e-06, 4.0992e-08, 1.6054e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[7.2598e-06, 6.4900e-07, 9.2953e-07, 6.6384e-07, 7.0744e-07, 2.3928e-06,
         5.8824e-08, 3.5419e-07, 2.4704e-06, 7.7002e-08, 7.7809e-07, 2.9693e-07,
         8.5731e-06, 5.3203e-06, 5.0433e-07, 6.6997e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.9618e-05, 2.5396e-06, 2.7337e-06, 3.7173e-06, 5.9397e-07, 1.0141e-06,
        9.7740e-07, 2.2605e-06, 3.3461e-05, 1.8478e-06, 2.6476e-06, 7.2174e-07,
        3.7526e-06, 4.6357e-06, 8.6547e-07, 1.0822e-05], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.342087
summ of probs approach
id: [92000] -> tensor([[3.0095e-08, 1.1028e-07, 2.1683e-06, 5.7875e-09, 9.3581e-08, 9.0796e-07,
         1.9731e-06, 8.5333e-07, 3.6043e-08, 1.9436e-08, 2.0771e-07, 4.5577e-07,
         3.0422e-08, 1.8665e-06, 1.8487e-05, 1.5642e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.9115e-08, 1.7512e-06, 2.8342e-06, 1.7672e-07, 5.3165e-07, 2.4803e-06,
         8.5495e-06, 1.0991e-06, 1.3597e-07, 1.3412e-07, 3.3508e-07, 4.7591e-07,
         1.0900e-07, 2.9115e-06, 5.7632e-05, 8.2450e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.9966e-06, 2.2926e-06, 4.4550e-06, 5.5452e-07, 1.8063e-06, 3.6852e-06,
        8.2726e-06, 8.3021e-06, 4.1147e-06, 1.2312e-06, 8.3895e-07, 9.4369e-07,
        1.1966e-06, 1.3634e-05, 8.1403e-05, 7.1929e-06], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.168070
summ of probs approach
id: [92000] -> tensor([[1.6327e-07, 4.0818e-08, 7.6415e-08, 5.4654e-08, 2.1407e-05, 4.6868e-09,
         2.9678e-09, 8.6478e-09, 2.3876e-07, 4.7295e-07, 5.8036e-07, 1.0640e-07,
         3.7999e-09, 8.6319e-08, 5.8613e-07, 8.2074e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.4702e-08, 3.3360e-08, 1.6931e-07, 3.4644e-07, 2.7152e-05, 3.2289e-07,
         2.1184e-08, 1.2350e-07, 7.7986e-07, 5.8378e-07, 5.2394e-06, 1.1837e-06,
         4.0667e-07, 6.3990e-07, 1.6691e-06, 3.2162e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.6816e-07, 7.8543e-08, 3.3447e-06, 2.9249e-08, 6.0346e-05, 1.6067e-06,
        2.2068e-07, 1.3726e-07, 7.7282e-06, 1.4987e-06, 1.0543e-05, 1.6197e-06,
        1.8773e-06, 1.3146e-06, 1.4950e-05, 8.8953e-06], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.178785
summ of probs approach
id: [92000] -> tensor([[1.4416e-06, 2.0927e-05, 4.6642e-07, 2.7904e-05, 1.2888e-06, 1.4328e-07,
         5.9039e-08, 2.2166e-05, 3.1287e-05, 3.7105e-06, 5.7244e-08, 4.1398e-07,
         1.6419e-07, 8.8066e-06, 5.6617e-07, 2.2244e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[8.6403e-06, 4.0787e-05, 1.0090e-06, 2.3894e-05, 2.2419e-06, 9.5405e-07,
         2.0913e-06, 4.2791e-05, 6.0423e-06, 4.6667e-06, 3.7332e-07, 1.4657e-05,
         1.0235e-05, 1.3236e-05, 1.1386e-06, 1.7960e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.5929e-05, 4.4775e-05, 2.4204e-06, 7.1762e-05, 9.5166e-06, 2.7142e-05,
        4.7110e-06, 7.1818e-05, 5.7119e-06, 1.2855e-05, 2.2101e-06, 3.0749e-05,
        2.4351e-05, 1.6216e-05, 2.9574e-06, 5.7713e-06], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.154533
summ of probs approach
id: [92000] -> tensor([[1.0661e-06, 7.7100e-06, 9.3040e-07, 6.5184e-07, 2.0743e-08, 1.5408e-06,
         6.4726e-06, 4.4124e-08, 2.0755e-07, 4.8226e-09, 2.1991e-06, 5.0251e-06,
         2.4092e-07, 2.5398e-08, 3.8941e-08, 2.8230e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[8.5676e-07, 1.1827e-05, 4.0863e-06, 1.7839e-06, 4.8730e-08, 1.6124e-06,
         1.6086e-05, 6.7854e-07, 3.8205e-07, 1.0919e-07, 3.4512e-06, 5.1592e-06,
         1.6284e-06, 9.1462e-08, 2.0509e-07, 5.5315e-06]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.4363e-06, 1.0010e-05, 3.3372e-06, 4.5231e-06, 6.4666e-07, 5.1084e-06,
        1.2426e-05, 3.3765e-06, 3.0245e-06, 6.0694e-07, 4.6969e-06, 7.6708e-07,
        4.9781e-06, 4.3044e-06, 2.4725e-06, 9.5325e-07], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.154287
summ of probs approach
id: [92000] -> tensor([[1.8694e-06, 6.1427e-07, 6.3102e-08, 7.2646e-07, 2.2624e-07, 3.6334e-09,
         1.6436e-08, 5.2002e-07, 1.9375e-07, 1.8135e-07, 2.0937e-05, 1.4575e-07,
         2.0599e-06, 4.9783e-06, 4.4851e-06, 5.0497e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.5504e-06, 4.9426e-06, 6.8720e-07, 6.6300e-07, 6.7552e-07, 1.5763e-07,
         5.5938e-07, 1.9062e-06, 3.9878e-07, 8.1109e-07, 1.8516e-05, 1.0332e-06,
         2.3491e-06, 1.2993e-05, 3.1272e-06, 7.9908e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.9861e-05, 6.8936e-06, 1.0442e-06, 1.3513e-06, 1.4715e-06, 1.3792e-06,
        2.7212e-06, 3.8549e-06, 5.3105e-06, 2.7839e-06, 1.0797e-04, 1.3410e-06,
        6.2834e-06, 2.8452e-05, 2.0397e-05, 4.5402e-07], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.134006
summ of probs approach
id: [92000] -> tensor([[1.7633e-07, 1.4362e-05, 7.3245e-07, 1.0133e-06, 2.5990e-07, 1.0607e-06,
         4.5626e-08, 8.2038e-09, 5.2768e-07, 2.2988e-07, 5.9846e-06, 2.4635e-07,
         4.9061e-09, 8.2791e-09, 1.6560e-09, 1.4968e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.0411e-06, 2.4652e-05, 8.4086e-07, 1.2447e-06, 2.3589e-06, 8.1378e-06,
         1.3701e-07, 7.5535e-07, 6.1525e-07, 5.0314e-06, 2.6370e-06, 1.6622e-06,
         1.2585e-07, 2.6171e-07, 3.2857e-08, 1.5551e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.7385e-06, 3.5351e-05, 4.5550e-06, 1.0178e-05, 2.7609e-05, 1.8446e-05,
        1.2962e-06, 2.1718e-06, 4.6972e-06, 2.3527e-05, 8.1829e-06, 3.6513e-05,
        2.4708e-06, 1.6589e-06, 6.4340e-07, 1.6550e-06], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.192284
summ of probs approach
id: [92000] -> tensor([[1.7847e-07, 1.5242e-08, 9.4087e-07, 1.9638e-05, 7.9073e-07, 1.2176e-07]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [25490] -> tensor([[1.2894e-06, 1.4703e-07, 5.1114e-07, 4.5132e-05, 3.8721e-06, 4.4777e-07]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([4.1341e-06, 4.1749e-07, 1.6452e-06, 6.7983e-05, 9.8824e-07, 1.2572e-06],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.062917
acc:  0.30808080808080807
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.241536
path ['42', 'fr', 'bloom', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [92000], 'attention_mask': [1]}
id:[92000]
answer  {'input_ids': [25490], 'attention_mask': [1]}
id:[25490]
answer  {'input_ids': [1090, 69696], 'attention_mask': [1, 1]}
id:[1090, 69696]
load model Duration: 0:00:08.380423
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/bloomz-560m NLI null 0 200 16 --------------
summ of probs approach
id: [92000] -> tensor([[1.3693e-10, 2.2430e-08, 2.6139e-08, 4.1543e-08, 3.1043e-11, 4.2747e-09,
         4.1757e-08, 7.0090e-08, 5.2037e-09, 2.7145e-08, 9.5980e-08, 6.2124e-11,
         4.1102e-10, 9.0449e-11, 4.7116e-11, 6.1485e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[3.5221e-08, 1.1292e-07, 1.4357e-08, 1.0756e-08, 2.4649e-09, 8.3377e-10,
         5.3933e-08, 8.0085e-09, 4.8355e-08, 9.8496e-08, 4.3644e-08, 4.6742e-10,
         4.9389e-10, 4.9574e-10, 2.6494e-10, 7.5071e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.1379e-08, 9.9791e-08, 2.2377e-07, 2.8535e-08, 4.1987e-08, 9.4941e-10,
        2.1962e-07, 6.1259e-08, 1.9204e-07, 1.8996e-07, 1.7448e-07, 5.3261e-09,
        3.2506e-09, 9.7918e-09, 1.8716e-09, 1.4671e-07], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.243957
summ of probs approach
id: [92000] -> tensor([[6.3667e-09, 8.0187e-09, 4.4673e-10, 1.7630e-09, 1.8890e-08, 5.4868e-09,
         1.8374e-09, 9.6175e-09, 1.2846e-08, 1.8771e-10, 2.8590e-10, 5.5590e-08,
         2.8825e-10, 1.3450e-07, 2.7221e-07, 2.3412e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.4124e-08, 4.4548e-09, 1.7420e-09, 1.7715e-08, 3.9846e-08, 8.6933e-10,
         1.4794e-09, 2.6082e-09, 7.0442e-08, 2.0836e-09, 5.6221e-10, 1.0509e-07,
         4.6718e-09, 1.0220e-06, 4.4819e-07, 8.4960e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.6840e-08, 1.2214e-08, 4.0929e-08, 5.4777e-08, 6.2200e-07, 1.2328e-08,
        5.4591e-08, 2.0294e-07, 1.2372e-06, 1.8182e-08, 7.6322e-09, 8.0920e-07,
        1.6560e-08, 1.9008e-06, 4.1006e-06, 1.0648e-08], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.161599
summ of probs approach
id: [92000] -> tensor([[1.7243e-08, 8.5072e-09, 5.6781e-07, 1.1186e-08, 3.0714e-09, 7.5174e-10,
         1.5482e-09, 1.7996e-08, 1.3461e-09, 4.3460e-10, 1.8750e-10, 1.2309e-09,
         9.6705e-07, 1.0918e-09, 1.5362e-07, 5.3292e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.7160e-08, 3.2082e-09, 4.5964e-07, 1.5358e-08, 4.8411e-09, 3.1622e-09,
         1.4729e-09, 1.7206e-08, 1.0787e-08, 3.3442e-09, 8.7697e-10, 1.9652e-09,
         5.6533e-07, 2.1495e-08, 1.7001e-08, 4.0834e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.5604e-08, 2.5827e-08, 1.6344e-05, 4.1782e-08, 7.0943e-08, 6.2060e-08,
        2.5371e-08, 3.7902e-07, 1.0917e-08, 2.8068e-08, 4.7640e-09, 2.0888e-07,
        4.9509e-06, 6.6727e-08, 8.3377e-08, 2.5968e-08], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.174504
summ of probs approach
id: [92000] -> tensor([[5.2294e-08, 1.7311e-10, 2.2858e-12, 1.2138e-10, 9.1700e-09, 1.5878e-09,
         3.4051e-11, 2.4542e-08, 3.1500e-09, 5.4633e-11, 5.8588e-08, 4.2075e-09,
         5.5670e-09, 5.6103e-08, 3.5644e-09, 7.5294e-12]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.6351e-08, 6.3093e-10, 2.5417e-12, 1.1746e-09, 1.1642e-09, 5.3491e-08,
         8.7169e-10, 1.9689e-07, 3.0445e-09, 5.7042e-10, 6.1034e-08, 5.0909e-08,
         2.3633e-08, 8.1345e-07, 1.3462e-09, 8.4139e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.1108e-09, 3.3870e-08, 6.5089e-11, 1.7473e-08, 6.2474e-09, 4.8073e-07,
        3.2827e-08, 6.7882e-07, 1.7861e-08, 4.2899e-09, 1.6235e-08, 6.6858e-08,
        6.7261e-07, 3.9617e-06, 2.0494e-08, 3.3020e-09], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.179105
summ of probs approach
id: [92000] -> tensor([[8.9214e-10, 3.9367e-07, 4.9365e-10, 1.4336e-11, 2.7298e-08, 3.7581e-10,
         1.1801e-09, 3.0449e-09, 1.9514e-09, 1.9879e-10, 2.2970e-09, 2.4756e-10,
         1.6844e-09, 3.3357e-08, 7.1031e-10, 4.2383e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[1.0890e-08, 5.1969e-08, 1.9854e-09, 1.1499e-09, 1.8879e-08, 2.7748e-09,
         4.5991e-09, 1.0739e-08, 4.8212e-09, 1.8818e-09, 4.2782e-09, 2.9067e-09,
         6.9636e-09, 1.8791e-08, 1.2264e-09, 4.8680e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.5737e-07, 3.7597e-08, 1.7429e-08, 5.4829e-09, 1.0265e-07, 8.2708e-08,
        7.1926e-08, 6.7290e-08, 6.5357e-08, 3.1369e-09, 1.4726e-07, 1.8071e-08,
        3.7013e-07, 2.6720e-07, 4.1604e-08, 7.1746e-08], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.134952
summ of probs approach
id: [92000] -> tensor([[2.8164e-08, 9.0500e-09, 4.8210e-06, 5.0877e-10, 1.1657e-09, 2.7895e-09,
         1.2173e-11, 4.2479e-09, 3.6336e-08, 5.5357e-09, 2.1827e-10, 4.5090e-10,
         5.7358e-09, 2.0492e-09, 5.0273e-09, 1.0056e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.1309e-08, 2.6917e-08, 7.4987e-06, 7.5056e-10, 3.9582e-09, 9.6922e-10,
         1.6049e-09, 4.1681e-09, 3.8195e-08, 6.9669e-09, 2.1714e-09, 2.3775e-08,
         2.7222e-09, 1.9613e-09, 5.1132e-09, 2.5034e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.5229e-07, 8.8235e-08, 7.5787e-06, 9.4392e-09, 1.6966e-08, 1.5881e-08,
        3.1563e-09, 5.9190e-08, 6.0191e-07, 7.7143e-08, 1.0449e-07, 5.6333e-07,
        6.8850e-09, 2.9924e-08, 9.5533e-08, 1.5831e-08], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.338179
summ of probs approach
id: [92000] -> tensor([[2.6136e-09, 2.8833e-09, 8.9222e-12, 1.5605e-08, 2.4150e-10, 3.0560e-09,
         2.1780e-09, 8.3206e-09, 6.7378e-08, 9.1793e-10, 3.4660e-10, 6.9049e-08,
         3.5926e-11, 1.7698e-10, 1.3780e-11, 2.7275e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.8369e-09, 1.1882e-09, 1.8964e-10, 7.4415e-09, 1.0018e-09, 2.9790e-10,
         2.3034e-09, 2.6902e-08, 4.8305e-09, 4.5448e-09, 1.2579e-08, 3.7289e-08,
         2.7997e-10, 3.6243e-10, 2.7787e-10, 3.9162e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([8.0386e-08, 9.5589e-09, 3.1911e-09, 5.6280e-08, 7.4541e-08, 4.7098e-08,
        9.1332e-09, 1.3270e-07, 4.5989e-09, 2.4114e-08, 2.1346e-08, 1.4822e-08,
        9.7836e-09, 4.0442e-08, 3.1782e-09, 3.9211e-07], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.153677
summ of probs approach
id: [92000] -> tensor([[5.7994e-10, 2.9340e-10, 2.6120e-10, 1.3248e-11, 4.9187e-10, 2.9212e-08,
         5.1708e-10, 1.9134e-12, 3.0256e-09, 5.2676e-11, 3.9811e-08, 1.6098e-10,
         2.3182e-09, 7.0333e-09, 8.0950e-07, 2.1517e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[5.3254e-09, 5.6724e-10, 8.6375e-10, 2.9137e-10, 5.4859e-09, 1.0722e-08,
         4.6068e-09, 4.0996e-11, 1.9224e-09, 8.2410e-10, 2.5813e-09, 3.8787e-10,
         4.9201e-09, 8.0237e-09, 1.9844e-06, 5.1476e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.6171e-08, 7.7592e-10, 3.6979e-08, 2.4501e-08, 3.6691e-08, 3.3960e-07,
        1.6098e-08, 8.7661e-10, 1.1033e-07, 5.0737e-09, 3.0502e-09, 1.7002e-08,
        7.2213e-08, 2.2010e-08, 2.7328e-06, 4.7585e-07], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.133068
summ of probs approach
id: [92000] -> tensor([[2.8965e-06, 7.5278e-09, 7.1417e-10, 7.5225e-09, 1.4499e-08, 5.5358e-09,
         2.6199e-08, 4.9266e-08, 3.8233e-09, 2.2616e-09, 7.8709e-08, 2.0757e-09,
         5.7896e-11, 1.0654e-07, 3.1572e-10, 1.6163e-10]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[4.3672e-07, 2.8398e-08, 8.8845e-10, 1.2765e-08, 3.5665e-08, 4.9712e-08,
         1.1891e-08, 1.2204e-08, 7.4662e-09, 9.0656e-10, 2.5093e-07, 3.1521e-10,
         1.3969e-09, 1.7254e-07, 8.2757e-09, 1.9446e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.0349e-07, 2.4933e-07, 2.7941e-08, 5.9726e-08, 2.1042e-07, 1.1702e-07,
        9.4492e-08, 3.1849e-08, 8.1977e-09, 8.7879e-09, 1.5054e-06, 1.8540e-09,
        1.7720e-08, 8.4973e-07, 2.3204e-08, 4.4138e-08], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.153682
summ of probs approach
id: [92000] -> tensor([[3.3442e-09, 9.8464e-10, 1.1147e-11, 3.5921e-08, 2.0697e-09, 6.4887e-09,
         1.6242e-07, 3.1372e-10, 6.4307e-10, 8.9705e-08, 3.6331e-09, 5.9016e-09,
         1.1770e-09, 1.2571e-09, 1.1928e-09, 1.0359e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.3656e-08, 3.2886e-09, 1.9415e-10, 1.3894e-08, 1.7471e-09, 1.1116e-08,
         1.6641e-07, 9.0931e-09, 2.1655e-08, 9.2330e-08, 2.2791e-08, 1.3461e-09,
         4.4511e-08, 2.0385e-09, 3.9184e-09, 8.1027e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.5232e-07, 4.0045e-08, 1.0315e-09, 1.3370e-07, 6.7563e-08, 4.3935e-08,
        2.8806e-07, 1.4115e-07, 1.6818e-08, 7.2739e-07, 4.6107e-08, 1.4715e-08,
        4.8410e-07, 6.2055e-08, 1.5922e-08, 5.1327e-08], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.177725
summ of probs approach
id: [92000] -> tensor([[2.2356e-08, 2.9418e-10, 1.0536e-09, 1.1064e-08, 9.9465e-10, 2.6545e-07,
         6.7361e-10, 6.1917e-09, 8.6435e-08, 1.0035e-08, 9.6805e-08, 5.1058e-10,
         2.2845e-10, 5.2131e-10, 2.6721e-09, 3.9243e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.1503e-09, 2.1261e-09, 7.4422e-09, 6.2413e-08, 1.1276e-09, 1.8417e-07,
         1.0054e-09, 1.4261e-09, 4.2259e-08, 1.3644e-09, 3.0800e-08, 4.5871e-10,
         1.1791e-09, 6.2689e-09, 2.2187e-09, 3.7630e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.3849e-08, 2.8111e-08, 2.9942e-08, 1.5610e-07, 7.0340e-08, 3.6015e-07,
        1.1621e-08, 1.2939e-08, 1.7196e-07, 5.7872e-09, 1.7221e-07, 2.4025e-09,
        4.7879e-09, 9.4334e-08, 4.3309e-08, 1.3241e-07], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.133523
summ of probs approach
id: [92000] -> tensor([[1.1250e-08, 6.3010e-08, 2.6347e-08, 1.7313e-09, 9.8704e-08, 7.7478e-09,
         2.0814e-08, 3.6033e-09, 1.5754e-10, 3.0568e-08, 1.3058e-09, 5.4322e-07,
         2.3280e-10, 8.3174e-09, 3.5494e-07, 1.4282e-09]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
id: [25490] -> tensor([[2.1003e-08, 1.6319e-08, 5.5600e-08, 1.1788e-08, 3.5092e-07, 1.8873e-09,
         5.0191e-08, 1.2857e-09, 1.2686e-09, 2.8769e-08, 1.2374e-09, 6.0471e-07,
         3.9959e-10, 1.6259e-08, 4.4734e-08, 1.5620e-08]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4361e-07, 5.1764e-08, 4.6459e-07, 2.9127e-07, 2.5814e-06, 4.2825e-09,
        4.5517e-09, 1.5677e-08, 2.8934e-08, 2.5644e-07, 2.6361e-08, 2.7665e-07,
        3.5935e-09, 7.9607e-08, 1.6088e-07, 4.4828e-08], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.190197
summ of probs approach
id: [92000] -> tensor([[1.0946e-09, 2.6497e-10, 1.3634e-08, 1.8030e-08, 9.3602e-11, 1.2351e-10]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
id: [25490] -> tensor([[5.8362e-09, 3.8156e-10, 1.2172e-08, 1.5059e-08, 1.0113e-10, 1.7614e-08]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([1.8897e-07, 3.1823e-08, 5.7353e-08, 1.8406e-07, 8.6206e-10, 4.1523e-08],
       device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.049378
acc:  0.36363636363636365
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:02.255380
path ['42', 'fr', 'bloomz', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [407, 23, 1], 'attention_mask': [1, 1, 1]}
id:[407, 23, 1]
answer  {'input_ids': [529, 1], 'attention_mask': [1, 1]}
id: [529, 1] -> [529]
answer  {'input_ids': [1351, 18, 2680, 1], 'attention_mask': [1, 1, 1, 1]}
id:[1351, 18, 2680, 1]
load model Duration: 0:00:02.968626
prompt_type null has 1 prompts in it
----------- 42 fr google/flan-t5-base NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([9.9909e-01, 3.1269e-03, 1.4350e-03, 5.0876e-03, 3.9725e-04, 1.1057e-02,
        2.1816e-03, 8.4483e-04, 1.7902e-02, 2.4932e-03, 3.5042e-03, 1.5313e-03,
        2.2076e-03, 1.3543e-03, 5.8330e-03, 7.7627e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[3.5741e-06, 1.8711e-05, 3.7945e-06, 2.1852e-06, 8.1552e-06, 1.2948e-04,
         4.0869e-04, 1.5720e-05, 1.1969e-03, 6.9153e-05, 1.0069e-04, 1.9849e-05,
         4.5426e-06, 1.6859e-06, 1.6368e-05, 2.0830e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([9.9909e-01, 2.8914e-03, 1.3526e-03, 5.0900e-03, 3.9431e-04, 1.0721e-02,
        1.8677e-03, 6.5582e-04, 1.4798e-02, 1.3747e-04, 3.3250e-03, 5.0860e-04,
        2.2321e-03, 1.3295e-03, 5.5839e-03, 4.4524e-04], device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.138934
summ of probs approach
probs_ shape tensor([6.0421e-03, 9.1210e-03, 1.1040e-03, 5.3371e-03, 2.7625e-02, 2.4126e-04,
        1.5504e-03, 3.6745e-03, 2.2382e-03, 7.3187e-04, 7.5491e-05, 1.2071e-03,
        4.3584e-03, 2.1317e-03, 2.8494e-03, 9.9261e-01], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[6.4701e-05, 7.0794e-05, 1.7882e-05, 2.5509e-05, 1.9369e-04, 1.1792e-05,
         6.7594e-05, 1.5014e-05, 1.7291e-03, 3.4045e-04, 3.6907e-06, 4.5061e-04,
         3.1305e-05, 1.0057e-06, 8.9887e-04, 1.9824e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.8894e-03, 1.8222e-03, 1.0593e-03, 1.5380e-03, 2.7611e-02, 1.3951e-04,
        9.9355e-04, 3.6134e-03, 1.7482e-03, 5.1000e-04, 7.4972e-05, 1.2395e-03,
        3.7802e-03, 2.7124e-04, 2.4489e-03, 9.9261e-01], device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.126806
summ of probs approach
probs_ shape tensor([9.7612e-03, 1.9123e-03, 2.8960e-03, 4.7785e-04, 5.9266e-02, 2.3628e-03,
        1.0150e-02, 1.1670e-03, 1.6314e-03, 3.4484e-03, 1.4178e-03, 1.4661e-03,
        1.5090e-03, 3.0769e-03, 9.9592e-01, 2.8091e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[9.4578e-04, 2.0709e-04, 1.6968e-04, 4.2899e-06, 2.6485e-04, 1.3928e-05,
         2.7027e-04, 6.1941e-05, 5.7736e-06, 1.4074e-04, 1.7183e-04, 9.8989e-06,
         2.0240e-05, 3.2033e-06, 5.9156e-06, 1.5690e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.3630e-03, 5.9482e-04, 1.4333e-03, 2.0667e-04, 5.9272e-02, 2.2950e-03,
        3.2807e-03, 6.0293e-04, 1.6233e-03, 2.4806e-03, 1.2964e-03, 1.3666e-03,
        1.2017e-03, 3.0583e-03, 9.9592e-01, 2.7486e-03], device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.126540
summ of probs approach
probs_ shape tensor([9.4544e-04, 3.1487e-03, 1.6514e-03, 4.1343e-03, 8.6793e-04, 4.7189e-03,
        3.2608e-03, 2.8682e-03, 1.8092e-03, 7.1256e-04, 1.9176e-03, 7.7647e-03,
        5.9506e-03, 9.9778e-01, 5.1723e-03, 2.6465e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[7.1515e-05, 1.7375e-05, 1.4162e-04, 1.0236e-05, 2.6960e-05, 4.8482e-04,
         1.4584e-04, 8.2185e-04, 6.9648e-05, 1.0677e-04, 2.5531e-04, 4.8632e-04,
         5.4877e-04, 5.0088e-07, 1.1578e-04, 1.0698e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.3160e-04, 3.1345e-03, 1.5629e-03, 4.1193e-03, 8.5302e-04, 2.5247e-03,
        3.0410e-03, 2.5550e-03, 1.7479e-03, 3.2739e-04, 1.8418e-03, 6.7982e-03,
        5.4424e-03, 9.9778e-01, 5.2715e-03, 2.6283e-03], device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.144048
summ of probs approach
probs_ shape tensor([1.6242e-03, 3.8883e-03, 1.6206e-03, 8.2045e-03, 6.1470e-03, 4.0417e-03,
        2.2057e-02, 5.9521e-04, 1.5539e-02, 2.0273e-03, 9.9709e-01, 1.2726e-02,
        6.1639e-04, 1.0033e-03, 1.9243e-03, 2.1077e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.2534e-05, 1.3077e-05, 4.5617e-06, 3.3910e-05, 4.5249e-03, 4.3853e-06,
         1.0917e-05, 3.2200e-04, 1.0641e-03, 1.7289e-06, 1.0804e-06, 3.0256e-05,
         9.6760e-07, 4.5707e-06, 9.7128e-05, 2.6312e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2816e-03, 3.8484e-03, 1.6102e-03, 8.1111e-03, 5.8541e-03, 2.5884e-04,
        2.1191e-02, 4.4537e-04, 1.4226e-02, 1.9911e-03, 9.9709e-01, 1.2557e-02,
        5.9148e-04, 9.7551e-04, 1.6772e-03, 1.4140e-03], device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.094996
summ of probs approach
probs_ shape tensor([6.9014e-04, 3.4494e-04, 3.6948e-04, 8.1363e-04, 2.7472e-03, 8.6895e-04,
        2.4545e-03, 2.1109e-03, 5.3636e-03, 2.3787e-03, 1.5995e-03, 9.9652e-01,
        2.5571e-03, 1.1121e-03, 2.9410e-02, 8.3755e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.8547e-05, 1.8479e-05, 9.6222e-07, 3.4535e-05, 1.1341e-04, 1.9433e-04,
         1.3671e-04, 9.4250e-06, 1.1168e-05, 1.3466e-05, 5.1008e-06, 2.7387e-06,
         1.0636e-04, 6.9230e-06, 4.9054e-05, 3.2285e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([6.7149e-04, 2.7176e-04, 3.4968e-04, 3.3164e-04, 2.6234e-03, 8.5056e-04,
        2.3981e-03, 1.9237e-04, 4.6949e-03, 2.2522e-03, 4.5315e-04, 9.9654e-01,
        1.2136e-03, 9.6157e-04, 1.6040e-04, 8.3673e-03], device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.121475
summ of probs approach
probs_ shape tensor([1.5781e-03, 3.4060e-04, 4.1170e-04, 8.9190e-05, 2.5888e-03, 8.3579e-04,
        3.1141e-03, 3.2174e-03, 8.0659e-05, 7.7218e-04, 3.2779e-04, 1.8535e-04,
        6.4031e-03, 4.3450e-03, 1.9290e-03, 9.9455e-01], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[9.0609e-05, 3.5201e-06, 2.6645e-04, 4.0057e-06, 4.8839e-06, 4.6538e-05,
         2.5693e-05, 5.3050e-04, 6.1338e-06, 2.2170e-05, 8.4351e-07, 3.8607e-06,
         8.0669e-05, 1.6968e-03, 1.6970e-04, 2.6683e-07]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.2574e-03, 3.4817e-04, 1.3997e-04, 7.5086e-05, 7.2636e-04, 3.7376e-04,
        2.7772e-03, 3.0614e-03, 7.8557e-05, 7.2944e-04, 7.9327e-05, 6.4118e-05,
        4.9285e-03, 1.0565e-03, 1.5883e-03, 9.9455e-01], device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.125209
summ of probs approach
probs_ shape tensor([8.2193e-04, 1.2950e-03, 1.1758e-02, 6.8300e-02, 3.0022e-03, 9.9535e-01,
        1.9753e-03, 2.2233e-03, 6.2861e-03, 9.4554e-04, 3.6422e-03, 2.4979e-04,
        2.7392e-03, 3.6662e-03, 1.5422e-02, 1.3680e-02], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[2.9127e-06, 7.7932e-06, 1.1386e-04, 1.2997e-04, 3.1554e-05, 4.6959e-06,
         4.5110e-03, 4.6572e-05, 7.3401e-05, 6.3003e-06, 4.9681e-05, 4.6318e-06,
         1.2984e-06, 1.0635e-04, 8.2014e-05, 3.1003e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([7.5312e-04, 1.2929e-03, 1.1693e-02, 6.8582e-02, 2.5453e-03, 9.9535e-01,
        6.6811e-04, 2.1523e-03, 1.9625e-04, 9.5640e-04, 8.2387e-04, 2.5217e-04,
        2.7359e-03, 3.3478e-03, 9.3518e-03, 2.1695e-03], device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.244694
summ of probs approach
probs_ shape tensor([5.0129e-03, 1.1856e-03, 1.0846e-03, 4.6076e-03, 1.8283e-02, 9.7695e-01,
        2.7345e-03, 1.2722e-03, 7.6275e-04, 2.4585e-03, 3.0696e-03, 1.1635e-02,
        2.8570e-03, 3.2349e-04, 6.1762e-03, 6.3472e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[5.9831e-06, 1.8547e-04, 5.9887e-05, 2.4705e-04, 6.9647e-05, 1.2642e-07,
         2.3302e-04, 8.8642e-04, 7.1297e-05, 3.3335e-06, 9.3654e-05, 9.0979e-05,
         9.0323e-05, 2.8881e-06, 5.9006e-04, 1.2531e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.0323e-03, 3.0186e-04, 1.0148e-03, 1.6973e-03, 1.8431e-02, 9.7698e-01,
        2.4215e-03, 1.2162e-03, 3.4611e-04, 2.3033e-03, 2.6548e-04, 2.8762e-03,
        4.0094e-04, 2.2080e-04, 3.4880e-03, 5.6809e-04], device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.140531
summ of probs approach
probs_ shape tensor([0.0016, 0.0034, 0.0075, 0.0012, 0.0022, 0.0044, 0.0036, 0.0018, 0.0012,
        0.0033, 0.0043, 0.9971, 0.0049, 0.0039, 0.0012, 0.0015],
       device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.9754e-06, 3.3606e-05, 1.2349e-05, 6.6427e-07, 3.4205e-04, 2.0860e-05,
         2.7686e-06, 9.3007e-05, 8.3213e-05, 7.7712e-04, 3.9473e-06, 5.8215e-07,
         3.4434e-04, 4.9247e-05, 5.3009e-05, 3.6352e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.5127e-03, 3.1549e-03, 7.3917e-03, 1.1662e-03, 4.8545e-04, 4.3824e-03,
        3.5007e-03, 1.4466e-03, 5.6458e-04, 3.2669e-03, 4.0516e-03, 9.9707e-01,
        4.6921e-03, 4.7083e-04, 7.2629e-04, 1.1935e-03], device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.099944
summ of probs approach
probs_ shape tensor([2.1962e-03, 9.6815e-03, 1.9892e-03, 8.3435e-03, 1.4944e-03, 2.2702e-03,
        8.7067e-04, 8.4658e-03, 9.8941e-01, 1.9981e-03, 6.8195e-03, 9.3189e-04,
        1.3781e-02, 1.0860e-03, 1.1019e-03, 8.5696e-04], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[1.2110e-04, 3.9503e-05, 7.1639e-06, 5.7675e-05, 4.0667e-05, 3.4803e-04,
         2.1900e-05, 1.9740e-05, 2.7662e-07, 1.0783e-06, 5.2812e-03, 8.7306e-05,
         3.7311e-04, 1.0878e-05, 1.6924e-04, 1.0219e-05]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.7588e-03, 9.6725e-03, 1.9364e-03, 8.3036e-03, 1.4473e-03, 2.8093e-04,
        3.6164e-04, 8.4148e-03, 9.8944e-01, 2.0009e-03, 5.9985e-03, 5.3445e-04,
        1.1489e-02, 8.8551e-04, 8.3545e-04, 6.4368e-04], device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.115324
summ of probs approach
probs_ shape tensor([2.7171e-03, 1.9783e-03, 8.0149e-04, 1.1104e-03, 1.2890e-03, 4.0881e-04,
        7.5681e-03, 9.9617e-01, 4.6405e-03, 7.4965e-04, 3.7260e-04, 3.1501e-03,
        1.0718e-02, 2.0948e-03, 2.2541e-03, 1.2400e-03], device='cuda:0') torch.Size([16])
summ of probs approach
id: [529] -> tensor([[4.6715e-04, 2.5417e-04, 2.2727e-04, 1.1493e-05, 7.5986e-05, 2.4063e-05,
         6.1271e-05, 2.2814e-06, 2.1589e-04, 2.3685e-05, 5.3910e-04, 9.4718e-06,
         3.0378e-04, 2.5287e-05, 5.8698e-06, 1.3733e-04]], device='cuda:0'), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4945e-03, 1.8841e-03, 7.7261e-04, 9.0888e-04, 6.3397e-04, 3.5411e-04,
        5.4902e-03, 9.9615e-01, 4.4904e-03, 5.4039e-04, 1.9056e-04, 2.9284e-04,
        2.6044e-03, 1.4047e-03, 2.2472e-03, 7.6151e-04], device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.115540
summ of probs approach
probs_ shape tensor([0.0078, 0.0073, 0.0033, 0.0018, 0.9955, 0.0027], device='cuda:0') torch.Size([6])
summ of probs approach
id: [529] -> tensor([[9.9893e-06, 3.2243e-06, 1.2297e-06, 1.0728e-05, 7.1915e-06, 1.8304e-05]],
       device='cuda:0'), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([0.0074, 0.0028, 0.0028, 0.0017, 0.9955, 0.0025], device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.036186
acc:  0.30808080808080807
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.662969
path ['42', 'fr', 'flan', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Loading model huggyllama/llama-7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.69s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.14s/it]
Model huggyllama/llama-7b loaded
pad token added
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1, 2123, 29875], 'token_type_ids': [0, 0, 0], 'attention_mask': [1, 1, 1]}
id:[1, 2123, 29875]
answer  {'input_ids': [1, 1661], 'token_type_ids': [0, 0], 'attention_mask': [1, 1]}
id: [1, 1661] -> [1661]
answer  {'input_ids': [1, 8164, 29899, 5474], 'token_type_ids': [0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1]}
id:[1, 8164, 29899, 5474]
load model Duration: 0:02:28.376911
prompt_type null has 1 prompts in it
----------- 42 fr huggyllama/llama-7b NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([3.7670e-05, 1.7762e-05, 5.9903e-05, 1.0043e-04, 4.4286e-05, 1.3375e-04,
        8.2195e-05, 7.2122e-06, 4.8995e-05, 1.1790e-04, 7.5722e-04, 2.3532e-04,
        1.6141e-04, 1.3697e-04, 5.7697e-05, 3.3379e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.1458e-06, 1.9073e-06, 1.2279e-05, 3.1710e-05, 1.4305e-06, 2.1219e-05,
         1.3232e-05, 1.9670e-06, 6.7353e-06, 8.3447e-06, 1.6093e-06, 2.0564e-05,
         1.9670e-06, 1.0669e-05, 8.7619e-06, 3.6359e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.2769e-05, 2.6286e-05, 5.9247e-05, 1.1075e-04, 1.5533e-04, 8.4400e-05,
        1.6224e-04, 1.0252e-05, 1.3554e-04, 4.4727e-04, 1.0723e-04, 6.7663e-04,
        1.7357e-04, 5.7745e-04, 1.1724e-04, 2.3663e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.403256
summ of probs approach
probs_ shape tensor([4.6372e-05, 4.0889e-05, 5.1320e-05, 4.7302e-04, 2.4166e-03, 1.0371e-05,
        2.5630e-05, 1.7405e-04, 1.1259e-04, 1.2004e-04, 2.9027e-05, 9.1195e-06,
        9.0003e-06, 8.1599e-05, 1.0002e-04, 8.2374e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[2.5630e-06, 6.7949e-06, 2.9206e-06, 3.7551e-06, 4.8304e-04, 6.5565e-07,
         3.8147e-06, 4.6313e-05, 8.5831e-06, 3.6359e-06, 8.1658e-06, 3.5763e-07,
         1.6093e-06, 2.6226e-06, 1.6272e-05, 2.3723e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.9816e-05, 7.6950e-05, 6.3181e-05, 3.7551e-05, 1.2321e-03, 5.5909e-05,
        1.8895e-04, 1.3471e-04, 1.0741e-04, 1.6809e-04, 6.1512e-05, 3.8266e-04,
        1.0252e-05, 1.5152e-04, 2.2697e-04, 9.8884e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.421390
summ of probs approach
probs_ shape tensor([4.3333e-05, 3.3808e-04, 2.5570e-05, 1.6034e-05, 9.7513e-05, 5.1856e-05,
        4.0793e-04, 4.2975e-05, 1.9193e-05, 1.2398e-04, 2.8348e-04, 1.1671e-04,
        6.5923e-05, 7.2718e-06, 3.0100e-05, 8.5711e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.5497e-06, 3.2067e-05, 2.3842e-06, 4.1723e-07, 8.4043e-06, 5.9605e-07,
         5.3883e-05, 4.2319e-06, 1.6093e-06, 5.7340e-05, 2.4736e-05, 8.2254e-06,
         4.8876e-06, 1.1325e-06, 9.5367e-06, 9.1195e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.8683e-05, 4.1676e-04, 2.7776e-05, 7.9036e-05, 1.1754e-04, 4.1068e-05,
        1.6356e-04, 4.4465e-05, 3.0756e-05, 5.8985e-04, 6.7616e-04, 1.8561e-04,
        3.1769e-05, 7.8678e-05, 8.1718e-05, 1.6451e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.283706
summ of probs approach
probs_ shape tensor([8.2612e-05, 6.6400e-05, 7.0572e-05, 4.8566e-04, 2.9027e-05, 7.5626e-04,
        2.9564e-05, 6.5506e-05, 1.1766e-04, 1.4842e-05, 1.6689e-04, 8.2254e-06,
        3.0541e-04, 2.6464e-05, 9.1970e-05, 2.9504e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[8.5235e-06, 6.0797e-06, 1.1206e-05, 1.0550e-05, 1.1325e-06, 9.0778e-05,
         6.5565e-07, 5.8413e-06, 4.2915e-06, 1.5497e-06, 1.4007e-05, 2.3842e-07,
         3.8624e-05, 3.5763e-07, 2.7478e-05, 2.0266e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1082e-03, 1.5819e-04, 1.6224e-04, 1.7011e-04, 1.4555e-04, 7.9727e-04,
        8.4937e-05, 1.0234e-04, 1.9515e-04, 4.3631e-05, 1.0717e-04, 1.5020e-05,
        6.0654e-04, 1.5593e-04, 3.0994e-04, 5.6505e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.730801
summ of probs approach
probs_ shape tensor([1.2159e-05, 2.9147e-05, 3.4189e-04, 2.3842e-05, 2.4819e-04, 5.1379e-05,
        8.5878e-04, 2.3663e-05, 5.0604e-05, 1.0133e-04, 5.0306e-05, 9.3699e-05,
        1.1939e-04, 1.4601e-03, 4.8816e-05, 2.5916e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[9.5367e-07, 5.3644e-07, 4.2975e-05, 2.2650e-06, 4.0412e-05, 2.7418e-06,
         1.1927e-04, 5.9605e-07, 3.5763e-07, 9.5367e-07, 2.5034e-06, 9.8944e-06,
         5.4836e-06, 4.8971e-04, 1.2159e-05, 7.7486e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([3.8266e-05, 3.0065e-04, 6.1131e-04, 1.2875e-05, 9.9850e-04, 8.5831e-06,
        3.4666e-04, 2.2352e-05, 5.1677e-05, 1.2565e-04, 2.8074e-05, 1.2803e-04,
        2.6870e-04, 1.1780e-02, 1.1086e-04, 1.2898e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.365006
summ of probs approach
probs_ shape tensor([2.9564e-05, 6.1095e-05, 7.8738e-05, 2.4605e-04, 8.8274e-05, 7.6962e-04,
        2.5392e-05, 2.5809e-05, 1.3542e-04, 1.5438e-05, 4.4882e-05, 6.8426e-05,
        3.5238e-04, 9.9301e-05, 2.0385e-04, 2.3186e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[3.4571e-06, 6.0797e-06, 4.6492e-06, 9.6738e-05, 2.0683e-05, 6.4909e-05,
         5.3644e-07, 5.9605e-07, 1.5020e-05, 2.2054e-06, 2.3842e-06, 4.4107e-06,
         6.3658e-05, 1.2159e-05, 4.4882e-05, 1.0729e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([4.6134e-05, 1.8394e-04, 1.3590e-04, 2.7776e-04, 2.1183e-04, 7.9966e-04,
        3.5226e-05, 2.3365e-05, 2.7180e-04, 5.2154e-05, 7.6234e-05, 1.8120e-05,
        2.1732e-04, 4.6539e-04, 1.6737e-04, 3.6299e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.438981
summ of probs approach
probs_ shape tensor([4.1783e-05, 3.7050e-04, 2.1219e-05, 1.8430e-04, 1.0490e-05, 8.2588e-04,
        3.2558e-03, 3.0041e-05, 1.0383e-04, 3.0935e-05, 6.9380e-05, 3.0816e-05,
        2.2531e-05, 6.8247e-05, 1.2083e-03, 4.3273e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[3.9935e-06, 1.6391e-05, 3.6359e-06, 2.3007e-05, 1.0133e-06, 7.0989e-05,
         3.3319e-05, 5.1856e-06, 6.9737e-06, 1.9670e-06, 1.3828e-05, 8.3447e-07,
         3.6955e-06, 8.2850e-06, 7.2837e-05, 7.0930e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.1373e-04, 1.0687e-04, 5.8711e-05, 3.4046e-04, 2.8753e-04, 1.0452e-03,
        4.9877e-04, 1.9157e-04, 1.5748e-04, 9.9242e-05, 1.3900e-04, 3.7372e-05,
        6.5207e-05, 4.3154e-05, 2.1114e-03, 9.7752e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.357814
summ of probs approach
probs_ shape tensor([1.7548e-04, 3.1304e-04, 1.8096e-04, 2.3603e-05, 1.2985e-02, 1.3733e-04,
        1.6117e-04, 5.7817e-06, 9.9242e-05, 3.7193e-05, 5.6803e-05, 4.1008e-05,
        1.4246e-05, 6.2585e-05, 5.8711e-05, 3.7909e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[7.4685e-05, 1.6153e-05, 3.6597e-05, 1.7285e-06, 1.9193e-05, 3.0041e-05,
         2.2948e-05, 1.6093e-06, 6.1393e-06, 1.0848e-05, 4.0531e-06, 5.6028e-06,
         5.9605e-07, 1.6689e-06, 1.1504e-05, 1.3709e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4257e-04, 4.7398e-04, 4.8757e-04, 7.0930e-05, 2.8687e-02, 2.2900e-04,
        1.0109e-03, 2.3007e-05, 2.0146e-04, 5.8031e-04, 8.0347e-05, 8.8155e-05,
        4.2319e-05, 8.2672e-05, 1.7357e-04, 8.3923e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.362549
summ of probs approach
probs_ shape tensor([7.1466e-05, 9.1076e-05, 2.2049e-03, 1.9884e-04, 1.4534e-03, 1.7083e-04,
        9.8944e-05, 4.9925e-04, 1.1873e-04, 1.9908e-04, 2.1482e-04, 1.4782e-05,
        1.2577e-05, 6.7353e-05, 8.0299e-04, 5.0354e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[8.4639e-06, 1.2040e-05, 6.9082e-05, 3.8922e-05, 1.0842e-04, 7.5102e-06,
         3.4451e-05, 2.4080e-05, 4.1068e-05, 5.5432e-06, 4.8816e-05, 1.7881e-06,
         4.1723e-07, 1.4722e-05, 3.5882e-05, 3.9458e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.0550e-04, 6.0177e-04, 7.4310e-03, 1.6046e-04, 9.5987e-04, 3.0303e-04,
        1.5783e-04, 9.3794e-04, 1.6999e-04, 3.2961e-05, 6.3992e-04, 1.8001e-05,
        5.5075e-05, 1.4603e-04, 1.6546e-03, 1.2646e-03], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.432668
summ of probs approach
probs_ shape tensor([4.2796e-05, 7.8261e-05, 2.2352e-05, 3.9220e-05, 2.3627e-04, 1.0633e-04,
        3.2902e-05, 7.1347e-05, 1.3173e-04, 5.9843e-04, 3.8803e-05, 7.0810e-05,
        2.9564e-05, 9.3758e-05, 2.6882e-05, 6.3002e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[1.1921e-06, 6.0201e-06, 1.0133e-06, 6.7353e-06, 1.5259e-05, 1.1921e-06,
         2.3246e-06, 5.3644e-07, 1.2815e-05, 4.7684e-05, 6.0201e-06, 6.1393e-06,
         5.9605e-07, 1.4305e-06, 3.3379e-06, 4.4107e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([1.4811e-03, 5.4359e-04, 8.6367e-05, 7.9513e-05, 3.6240e-04, 1.2565e-04,
        2.9898e-04, 9.3043e-05, 1.9908e-04, 9.3985e-04, 6.8069e-05, 1.0366e-03,
        2.9683e-05, 5.8830e-05, 6.9320e-05, 7.1168e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.358447
summ of probs approach
probs_ shape tensor([1.0192e-05, 2.2054e-05, 1.9312e-05, 1.3590e-05, 6.5386e-05, 3.4332e-05,
        1.8024e-04, 3.6001e-05, 1.1081e-04, 5.0449e-04, 8.0156e-04, 6.3837e-05,
        1.0151e-04, 4.0913e-04, 2.9027e-05, 2.3842e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[7.2718e-06, 3.5763e-06, 3.6359e-06, 5.3644e-07, 6.4969e-06, 4.5896e-06,
         2.0623e-05, 4.7088e-06, 4.5896e-06, 2.7120e-05, 1.8656e-05, 3.5763e-06,
         7.8678e-06, 6.0201e-05, 3.7551e-06, 1.0133e-06]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([5.4777e-05, 5.3346e-05, 3.8624e-05, 1.4102e-04, 1.9681e-04, 5.2452e-05,
        8.3017e-04, 3.8803e-05, 1.5497e-03, 1.6069e-03, 1.8048e-04, 9.6619e-05,
        3.0041e-04, 2.5368e-04, 5.7280e-05, 5.9009e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.305946
summ of probs approach
probs_ shape tensor([2.9922e-05, 3.9518e-05, 4.3213e-05, 2.7180e-05, 2.4855e-05, 3.2604e-05,
        4.3273e-05, 4.6194e-05, 4.1783e-05, 1.2338e-05, 2.1100e-05, 5.2357e-04,
        3.1710e-05, 5.1379e-05, 4.7386e-05, 5.8949e-05], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
summ of probs approach
id: [1661] -> tensor([[3.2187e-06, 6.1989e-06, 1.2398e-05, 1.7881e-05, 2.2054e-06, 3.0994e-05,
         4.0710e-05, 9.4175e-06, 7.1526e-07, 3.0994e-06, 5.3644e-07, 3.6299e-05,
         2.9802e-07, 1.5497e-06, 1.0729e-06, 1.6391e-05]], device='cuda:0',
       dtype=torch.float16), torch.Size([1, 16])
summ of probs approach
probs_ shape tensor([2.9445e-05, 4.2081e-05, 4.2915e-05, 5.6028e-05, 1.3065e-04, 1.8096e-04,
        1.3590e-04, 1.1396e-04, 1.5056e-04, 1.6046e-04, 4.4882e-05, 7.9489e-04,
        1.2696e-05, 3.1257e-04, 5.8949e-05, 1.6904e-04], device='cuda:0',
       dtype=torch.float16) torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.331252
summ of probs approach
probs_ shape tensor([1.4710e-04, 1.3912e-04, 5.9128e-05, 6.3562e-04, 1.5140e-05, 1.1086e-05],
       device='cuda:0', dtype=torch.float16) torch.Size([6])
summ of probs approach
id: [1661] -> tensor([[4.0174e-05, 1.8656e-05, 1.9073e-06, 1.0675e-04, 2.0862e-06, 8.3447e-07]],
       device='cuda:0', dtype=torch.float16), torch.Size([1, 6])
summ of probs approach
probs_ shape tensor([1.3447e-04, 9.1493e-05, 1.3065e-04, 1.0452e-03, 2.6405e-05, 6.7353e-06],
       device='cuda:0', dtype=torch.float16) torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.135004
acc:  0.3383838383838384
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:04.963790
path ['42', 'fr', 'llama', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

Loading model bigscience/mt0-small
Model bigscience/mt0-small loaded
Available device is cuda
Model device: cuda:0
answer  {'input_ids': [1032, 266, 1], 'attention_mask': [1, 1, 1]}
id:[1032, 266, 1]
answer  {'input_ids': [935, 1], 'attention_mask': [1, 1]}
id:[935, 1]
answer  {'input_ids': [259, 5926, 264, 3381, 1], 'attention_mask': [1, 1, 1, 1, 1]}
id:[259, 5926, 264, 3381, 1]
load model Duration: 0:00:05.376067
prompt_type null has 1 prompts in it
----------- 42 fr bigscience/mt0-small NLI null 0 200 16 --------------
summ of probs approach
probs_ shape tensor([3.2060e-04, 1.1175e-02, 4.4485e-04, 1.3263e-04, 8.0119e-04, 5.8776e-04,
        1.3199e-03, 1.3967e-03, 4.2116e-04, 1.8377e-04, 9.5545e-04, 5.6069e-04,
        9.5849e-04, 2.3725e-04, 9.9064e-01, 2.1669e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.0699e-04, 1.5427e-03, 1.0491e-03, 1.1868e-04, 6.5042e-04, 5.2931e-04,
        1.5063e-03, 2.1798e-03, 3.0098e-04, 1.8024e-04, 3.8348e-04, 1.1719e-03,
        1.8568e-03, 1.8654e-04, 9.9064e-01, 2.1064e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1007, 0.1760, 0.0211, 0.0307, 0.0806, 0.0807, 0.0465, 0.0643, 0.1437,
        0.0868, 0.1038, 0.2289, 0.1475, 0.0589, 0.9957, 0.3775],
       device='cuda:0') torch.Size([16])
 Batch: 0 of null classification Duration: 0:00:00.131143
summ of probs approach
probs_ shape tensor([3.8288e-04, 1.2871e-03, 9.5154e-04, 5.9681e-04, 1.0076e-03, 7.3986e-04,
        1.4430e-03, 5.4886e-04, 9.7990e-01, 7.5544e-04, 1.7973e-04, 4.6417e-03,
        2.7177e-04, 3.4229e-04, 4.4311e-04, 1.1347e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([2.0233e-04, 1.1777e-03, 6.3393e-04, 7.4952e-04, 1.1465e-03, 7.1587e-04,
        1.3459e-03, 5.7845e-04, 9.7989e-01, 6.9947e-04, 1.1812e-04, 5.1534e-03,
        2.7295e-04, 4.1536e-04, 4.3155e-04, 1.1144e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0898, 0.1405, 0.2676, 0.0681, 0.1953, 0.0518, 0.1941, 0.1230, 0.9888,
        0.1582, 0.8230, 0.1937, 0.0028, 0.0371, 0.1166, 0.2043],
       device='cuda:0') torch.Size([16])
 Batch: 1 of null classification Duration: 0:00:00.099288
summ of probs approach
probs_ shape tensor([3.1647e-05, 1.2371e-03, 7.3248e-01, 1.2717e-03, 3.3454e-04, 1.7291e-04,
        2.4024e-04, 5.4651e-04, 2.0080e-03, 5.2968e-04, 1.3207e-03, 8.7305e-04,
        3.5734e-04, 3.7416e-04, 1.4572e-04, 2.5795e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([3.1012e-05, 1.2203e-03, 7.3245e-01, 1.0065e-03, 2.2936e-04, 1.4153e-04,
        2.2056e-04, 5.5577e-04, 1.7244e-03, 1.1391e-03, 2.0835e-03, 1.1902e-03,
        3.6110e-04, 2.8863e-04, 3.7747e-04, 2.4852e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0047, 0.1587, 0.7625, 0.1831, 0.1668, 0.0633, 0.0774, 0.0906, 0.2761,
        0.1244, 0.4727, 0.2746, 0.1293, 0.2296, 0.0314, 0.0821],
       device='cuda:0') torch.Size([16])
 Batch: 2 of null classification Duration: 0:00:00.197926
summ of probs approach
probs_ shape tensor([4.9689e-04, 2.0636e-04, 1.1181e-03, 1.0802e-04, 7.1593e-04, 1.6102e-03,
        2.7931e-03, 1.7302e-03, 1.3551e-04, 7.2795e-01, 1.9610e-03, 1.5598e-03,
        3.0623e-04, 3.5464e-04, 1.4990e-03, 2.1449e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([4.6874e-04, 1.4551e-04, 4.4786e-04, 8.1619e-05, 8.5249e-04, 1.6148e-03,
        2.7930e-03, 1.3922e-03, 1.3283e-04, 7.2794e-01, 1.6229e-03, 4.9692e-03,
        2.7436e-04, 4.3316e-04, 1.5780e-03, 2.5135e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0398, 0.0634, 0.2556, 0.0174, 0.0838, 0.1654, 0.3200, 0.2302, 0.0414,
        0.7426, 0.4156, 0.1541, 0.3264, 0.0742, 0.2701, 0.0102],
       device='cuda:0') torch.Size([16])
 Batch: 3 of null classification Duration: 0:00:00.100431
summ of probs approach
probs_ shape tensor([9.2938e-04, 1.6599e-04, 2.8629e-03, 3.2380e-04, 6.0424e-04, 6.8847e-03,
        1.2839e-03, 1.5622e-03, 3.0427e-04, 9.2628e-01, 3.7046e-03, 8.9334e-04,
        7.3970e-04, 2.3167e-04, 2.0686e-03, 1.8134e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.7760e-04, 2.0149e-04, 2.8892e-03, 2.3782e-03, 5.1665e-04, 4.3389e-03,
        1.8555e-03, 7.1604e-04, 3.9394e-04, 9.2628e-01, 1.8817e-02, 5.0951e-04,
        7.9255e-04, 1.5429e-04, 2.3198e-03, 1.5656e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.2745, 0.0593, 0.1783, 0.0494, 0.2570, 0.1088, 0.1867, 0.1987, 0.0351,
        0.9868, 0.1891, 0.1477, 0.1959, 0.0570, 0.1957, 0.1374],
       device='cuda:0') torch.Size([16])
 Batch: 4 of null classification Duration: 0:00:00.097180
summ of probs approach
probs_ shape tensor([6.8881e-04, 3.7742e-04, 9.2034e-01, 8.1672e-04, 1.8858e-04, 4.4552e-04,
        1.2025e-03, 1.1879e-03, 1.2102e-03, 4.2949e-04, 9.6598e-04, 1.1157e-03,
        1.5847e-03, 4.8591e-04, 1.7916e-04, 9.0070e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([5.4800e-04, 3.4476e-04, 9.2033e-01, 1.4462e-03, 4.7854e-04, 9.1880e-04,
        1.1059e-03, 2.2401e-03, 1.3105e-03, 3.5275e-04, 8.8627e-04, 7.8947e-04,
        2.1310e-03, 6.2277e-04, 1.5635e-04, 3.6685e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0811, 0.1570, 0.9363, 0.3361, 0.0843, 0.2026, 0.3431, 0.1601, 0.3446,
        0.1450, 0.2757, 0.2063, 0.2268, 0.0763, 0.0690, 0.4952],
       device='cuda:0') torch.Size([16])
 Batch: 5 of null classification Duration: 0:00:00.113107
summ of probs approach
probs_ shape tensor([9.5450e-01, 3.6083e-04, 3.6145e-05, 2.0190e-03, 2.6829e-04, 4.2352e-04,
        3.6643e-03, 8.1566e-04, 3.4623e-04, 6.8143e-04, 5.4391e-04, 1.3016e-03,
        7.8451e-04, 8.1722e-04, 1.7223e-04, 2.7539e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([9.5450e-01, 7.7367e-04, 3.4832e-05, 1.9294e-03, 1.3067e-04, 7.6471e-04,
        4.4894e-03, 6.1737e-04, 2.8995e-04, 1.0171e-03, 3.9608e-04, 1.2151e-03,
        7.9611e-04, 8.1846e-04, 1.7519e-04, 4.2477e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.9701, 0.1088, 0.0234, 0.1219, 0.1135, 0.0972, 0.2401, 0.3010, 0.1555,
        0.1404, 0.2926, 0.1305, 0.1999, 0.3189, 0.0816, 0.0478],
       device='cuda:0') torch.Size([16])
 Batch: 6 of null classification Duration: 0:00:00.079836
summ of probs approach
probs_ shape tensor([1.6437e-03, 3.5109e-04, 9.4749e-01, 6.4071e-04, 8.2543e-01, 1.5326e-04,
        9.8523e-04, 6.1828e-04, 9.6557e-04, 5.5214e-04, 1.4157e-04, 2.9525e-04,
        8.0326e-04, 2.2002e-03, 1.0230e-03, 5.0509e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.6837e-03, 7.2410e-04, 9.4749e-01, 5.2212e-04, 8.2542e-01, 1.0752e-04,
        1.6611e-03, 6.5749e-04, 8.9914e-04, 4.9862e-04, 1.7005e-04, 3.4585e-04,
        8.0611e-04, 1.6582e-03, 1.0204e-03, 4.6680e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.4901, 0.0654, 0.9549, 0.1471, 0.9662, 0.0206, 0.1573, 0.3007, 0.2315,
        0.1963, 0.1302, 0.1000, 0.0688, 0.0925, 0.1884, 0.0712],
       device='cuda:0') torch.Size([16])
 Batch: 7 of null classification Duration: 0:00:00.085451
summ of probs approach
probs_ shape tensor([8.6255e-01, 5.4608e-04, 5.7152e-04, 6.0152e-03, 3.6402e-03, 8.9272e-04,
        7.3241e-04, 2.3115e-04, 2.2668e-03, 2.0890e-04, 6.4509e-04, 6.0438e-04,
        1.1197e-04, 4.6993e-05, 1.3622e-03, 1.5071e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([8.6255e-01, 4.3965e-04, 7.2652e-04, 6.0326e-03, 2.7164e-03, 1.2250e-03,
        4.7827e-04, 2.4041e-04, 3.3648e-03, 3.1076e-04, 4.9208e-04, 6.2381e-04,
        1.1708e-04, 7.2272e-05, 1.3181e-03, 1.1369e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.9527, 0.1994, 0.0925, 0.2095, 0.1882, 0.1733, 0.0983, 0.0726, 0.0943,
        0.0486, 0.2147, 0.0793, 0.0233, 0.0591, 0.1333, 0.1269],
       device='cuda:0') torch.Size([16])
 Batch: 8 of null classification Duration: 0:00:00.083364
summ of probs approach
probs_ shape tensor([1.8776e-03, 6.7825e-04, 2.0632e-05, 1.2861e-03, 5.0221e-04, 5.4917e-04,
        6.0973e-04, 2.4207e-03, 4.2937e-04, 2.7564e-04, 4.5626e-04, 6.6169e-01,
        6.9007e-04, 1.1522e-03, 2.2464e-04, 4.0769e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.3620e-03, 6.1640e-04, 1.8739e-05, 1.0376e-03, 9.9999e-04, 5.6027e-04,
        5.3372e-04, 4.6750e-03, 6.1257e-04, 3.1088e-04, 3.2865e-04, 6.6166e-01,
        1.1962e-03, 9.6867e-04, 2.3764e-04, 3.6533e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.2942, 0.2642, 0.0062, 0.2235, 0.0835, 0.0376, 0.0766, 0.2279, 0.0480,
        0.1024, 0.2326, 0.7480, 0.0695, 0.4827, 0.2526, 0.0491],
       device='cuda:0') torch.Size([16])
 Batch: 9 of null classification Duration: 0:00:00.177183
summ of probs approach
probs_ shape tensor([4.9399e-03, 6.9489e-04, 9.3853e-04, 8.4454e-04, 9.0179e-05, 4.1631e-04,
        3.9641e-04, 2.8079e-04, 5.4909e-04, 9.1140e-04, 4.9780e-04, 9.5715e-01,
        1.9719e-04, 1.3019e-03, 3.7594e-04, 7.2325e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([6.4592e-03, 5.7096e-04, 1.1505e-03, 8.9093e-04, 1.4402e-04, 4.1771e-04,
        3.5568e-04, 3.0519e-04, 5.3038e-04, 8.7014e-04, 4.7721e-04, 9.5714e-01,
        1.7687e-04, 1.5993e-03, 3.5905e-04, 5.1309e-04], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.1124, 0.1540, 0.1081, 0.0555, 0.0560, 0.0423, 0.2653, 0.0599, 0.5195,
        0.3000, 0.0209, 0.9691, 0.0505, 0.1232, 0.0970, 0.2349],
       device='cuda:0') torch.Size([16])
 Batch: 10 of null classification Duration: 0:00:00.087860
summ of probs approach
probs_ shape tensor([1.2845e-04, 8.9647e-05, 1.1229e-03, 3.8205e-04, 1.4057e-03, 1.1124e-04,
        7.8885e-04, 8.0959e-04, 9.8925e-01, 1.5031e-04, 2.6128e-04, 2.7301e-05,
        8.7886e-04, 7.7852e-04, 4.7577e-04, 1.6778e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([1.1942e-04, 8.3830e-05, 1.0421e-03, 6.0506e-04, 2.7721e-03, 1.0233e-04,
        6.0848e-04, 8.6266e-04, 9.8925e-01, 2.0095e-04, 2.5888e-04, 1.9193e-05,
        4.0725e-04, 5.3301e-04, 4.0958e-04, 2.9340e-03], device='cuda:0') torch.Size([16])
summ of probs approach
probs_ shape tensor([0.0161, 0.0537, 0.0770, 0.0663, 0.4440, 0.0488, 0.1260, 0.1544, 0.9937,
        0.0726, 0.2000, 0.0069, 0.0860, 0.1094, 0.0884, 0.1014],
       device='cuda:0') torch.Size([16])
 Batch: 11 of null classification Duration: 0:00:00.076105
summ of probs approach
probs_ shape tensor([3.2610e-04, 2.4589e-04, 9.0903e-01, 3.2691e-03, 9.1586e-04, 3.3581e-03],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([2.7609e-04, 1.5214e-03, 9.0902e-01, 3.0764e-03, 1.9304e-03, 1.0139e-02],
       device='cuda:0') torch.Size([6])
summ of probs approach
probs_ shape tensor([0.0849, 0.0724, 0.9943, 0.2055, 0.1932, 0.3490], device='cuda:0') torch.Size([6])
 Batch: 12 of null classification Duration: 0:00:00.049451
acc:  0.3333333333333333
Time taken to execute the fr NLI task with prompt type null, variation 0 and batchsize 16: 0:00:01.412985
path ['42', 'fr', 't0', 'NLI', 'null', 'prompt_id_0']
Dictionary saved to './ATCS_group3/saved_outputs/logits_dict_seed_42_lang_fr_v55.pickle' as a pickle file.

****End Time: 2023-05-27 00:15:44.546983 Duration: 0:37:34.713873
