Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
----------- bloomz SA --------------
Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Moving model to cuda
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 272.18it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
MARC dataset loaded
len dataset  100
Batch: 0 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('no', 'yes', 'yes', 'no', 'no', 'no', 'no', 'no', 'no', 'no', 'yes', 'yes', 'no', 'yes', 'no', 'yes')
Batch: 1 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('yes', 'yes', 'yes', 'yes', 'no', 'no', 'no', 'yes', 'yes', 'no', 'no', 'no', 'yes', 'no', 'yes', 'yes')
Batch: 2 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'no', 'no', 'yes', 'yes', 'no', 'no', 'yes', 'no', 'yes', 'yes')
Batch: 3 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('no', 'yes', 'no', 'no', 'no', 'yes', 'no', 'no', 'yes', 'yes', 'no', 'no', 'yes', 'no', 'yes', 'no')
Batch: 4 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('yes', 'yes', 'yes', 'no', 'no', 'yes', 'yes', 'no', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes')
Batch: 5 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('no', 'yes', 'yes', 'no', 'yes', 'no', 'yes', 'no', 'no', 'no', 'no', 'no', 'no', 'no', 'yes', 'yes')
Batch: 6 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes'] , label: ('yes', 'yes', 'yes', 'no')
acc:  0.54
----------- bloomz NLI --------------
Loading model bigscience/bloomz-560m
Model bigscience/bloomz-560m loaded
Moving model to cuda
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 301.48it/s]
Found cached dataset amazon_reviews_multi (/home/lcur1101/.cache/huggingface/datasets/amazon_reviews_multi/en/1.0.0/724e94f4b0c6c405ce7e476a6c5ef4f87db30799ad49f765094cf9770e0f7609)
NLI dataset loaded
len dataset  100
Batch: 0 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
pred_answer ['yes', 'maybe', 'yes', 'yes', 'yes', 'yes', 'maybe', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'maybe', 'yes'] , label: ('no', 'maybe', 'no', 'no', 'maybe', 'no', 'no', 'yes', 'no', 'maybe', 'no', 'no', 'no', 'maybe', 'yes', 'maybe')
Batch: 1 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'maybe', 'yes', 'maybe', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('maybe', 'maybe', 'maybe', 'no', 'maybe', 'no', 'maybe', 'yes', 'no', 'no', 'no', 'no', 'yes', 'no', 'no', 'no')
Batch: 2 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'maybe', 'maybe', 'yes', 'yes', 'yes', 'yes', 'maybe', 'yes', 'yes', 'maybe'] , label: ('no', 'yes', 'no', 'yes', 'maybe', 'yes', 'maybe', 'no', 'yes', 'maybe', 'maybe', 'maybe', 'no', 'yes', 'maybe', 'maybe')
Batch: 3 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
pred_answer ['yes', 'maybe', 'yes', 'yes', 'yes', 'yes', 'maybe', 'yes', 'yes', 'maybe', 'yes', 'yes', 'yes', 'maybe', 'maybe', 'yes'] , label: ('yes', 'yes', 'no', 'maybe', 'maybe', 'no', 'no', 'yes', 'no', 'maybe', 'no', 'no', 'no', 'no', 'no', 'maybe')
Batch: 4 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
pred_answer ['maybe', 'maybe', 'yes', 'maybe', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('maybe', 'no', 'yes', 'maybe', 'yes', 'no', 'maybe', 'maybe', 'maybe', 'maybe', 'no', 'maybe', 'yes', 'yes', 'maybe', 'maybe')
Batch: 5 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes', 'yes', 'maybe', 'yes', 'yes', 'maybe', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes'] , label: ('yes', 'maybe', 'yes', 'yes', 'yes', 'maybe', 'yes', 'yes', 'no', 'no', 'no', 'yes', 'yes', 'maybe', 'maybe', 'yes')
Batch: 6 , batch size: 16, sample_size: 100
answer  {'input_ids': [18260], 'attention_mask': [1]}
answer  {'input_ids': [1936], 'attention_mask': [1]}
answer  {'input_ids': [137111], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'yes', 'yes'] , label: ('no', 'maybe', 'yes', 'maybe')
acc:  0.33
----------- flan SA --------------
Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Moving model to cuda
Loading MARC dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 371.74it/s]
Found cached dataset xnli (/home/lcur1101/.cache/huggingface/datasets/xnli/en/1.1.0/818164464f9c9fd15776ca8a00423b074344c3e929d00a2c1a84aa5a50c928bd)
MARC dataset loaded
len dataset  100
Batch: 0 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
pred_answer ['no', 'yes', 'yes', 'no', 'no', 'no', 'no', 'no', 'yes', 'yes', 'no', 'yes', 'yes', 'no', 'yes', 'no'] , label: ('yes', 'no', 'yes', 'yes', 'no', 'no', 'no', 'no', 'yes', 'yes', 'no', 'yes', 'yes', 'no', 'yes', 'no')
Batch: 1 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
pred_answer ['no', 'yes', 'no', 'no', 'yes', 'yes', 'no', 'no', 'no', 'no', 'no', 'no', 'no', 'no', 'no', 'yes'] , label: ('yes', 'yes', 'yes', 'no', 'yes', 'yes', 'no', 'yes', 'yes', 'no', 'no', 'no', 'no', 'no', 'yes', 'yes')
Batch: 2 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
pred_answer ['yes', 'no', 'no', 'yes', 'no', 'no', 'yes', 'no', 'no', 'yes', 'no', 'no', 'no', 'no', 'no', 'yes'] , label: ('yes', 'no', 'no', 'yes', 'no', 'yes', 'yes', 'yes', 'no', 'yes', 'no', 'yes', 'yes', 'no', 'no', 'yes')
Batch: 3 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
pred_answer ['no', 'no', 'no', 'yes', 'yes', 'no', 'no', 'yes', 'yes', 'yes', 'yes', 'no', 'no', 'no', 'yes', 'no'] , label: ('no', 'yes', 'no', 'yes', 'yes', 'no', 'yes', 'yes', 'yes', 'yes', 'no', 'yes', 'no', 'no', 'yes', 'no')
Batch: 4 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
pred_answer ['no', 'no', 'yes', 'yes', 'no', 'no', 'no', 'no', 'yes', 'yes', 'yes', 'no', 'yes', 'yes', 'no', 'yes'] , label: ('no', 'no', 'yes', 'yes', 'no', 'no', 'yes', 'no', 'yes', 'yes', 'yes', 'yes', 'yes', 'yes', 'no', 'yes')
Batch: 5 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
pred_answer ['no', 'no', 'no', 'yes', 'yes', 'no', 'yes', 'no', 'no', 'yes', 'no', 'yes', 'no', 'no', 'no', 'yes'] , label: ('yes', 'yes', 'no', 'yes', 'yes', 'no', 'yes', 'no', 'no', 'yes', 'no', 'yes', 'no', 'no', 'no', 'yes')
Batch: 6 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'no', 'no'] , label: ('no', 'yes', 'no', 'no')
acc:  0.79
----------- flan NLI --------------
Loading model google/flan-t5-base
Model google/flan-t5-base loaded
Moving model to cuda
Loading NLI dataset for en
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 327.85it/s]
NLI dataset loaded
len dataset  100
Batch: 0 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
answer  {'input_ids': [2087], 'attention_mask': [1]}
pred_answer ['no', 'no', 'yes', 'yes', 'yes', 'yes', 'no', 'no', 'no', 'no', 'no', 'no', 'yes', 'yes', 'no', 'no'] , label: ('maybe', 'no', 'maybe', 'yes', 'maybe', 'maybe', 'no', 'maybe', 'no', 'no', 'no', 'maybe', 'maybe', 'yes', 'no', 'no')
Batch: 1 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
answer  {'input_ids': [2087], 'attention_mask': [1]}
pred_answer ['no', 'no', 'yes', 'no', 'yes', 'no', 'no', 'yes', 'yes', 'yes', 'no', 'yes', 'no', 'no', 'yes', 'no'] , label: ('maybe', 'maybe', 'yes', 'maybe', 'yes', 'maybe', 'no', 'yes', 'yes', 'yes', 'no', 'yes', 'maybe', 'no', 'maybe', 'no')
Batch: 2 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
answer  {'input_ids': [2087], 'attention_mask': [1]}
pred_answer ['no', 'yes', 'no', 'no', 'no', 'no', 'no', 'no', 'yes', 'no', 'no', 'no', 'yes', 'yes', 'yes', 'no'] , label: ('maybe', 'yes', 'no', 'no', 'maybe', 'no', 'no', 'no', 'yes', 'no', 'no', 'no', 'maybe', 'yes', 'maybe', 'maybe')
Batch: 3 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
answer  {'input_ids': [2087], 'attention_mask': [1]}
pred_answer ['yes', 'no', 'yes', 'no', 'yes', 'yes', 'yes', 'yes', 'no', 'no', 'no', 'yes', 'no', 'yes', 'yes', 'yes'] , label: ('maybe', 'no', 'maybe', 'maybe', 'yes', 'yes', 'maybe', 'yes', 'no', 'no', 'no', 'yes', 'maybe', 'maybe', 'yes', 'yes')
Batch: 4 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
answer  {'input_ids': [2087], 'attention_mask': [1]}
pred_answer ['yes', 'yes', 'no', 'no', 'no', 'no', 'no', 'no', 'yes', 'yes', 'no', 'yes', 'yes', 'yes', 'no', 'yes'] , label: ('yes', 'maybe', 'no', 'no', 'no', 'no', 'no', 'no', 'no', 'maybe', 'no', 'maybe', 'maybe', 'yes', 'no', 'maybe')
Batch: 5 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
answer  {'input_ids': [2087], 'attention_mask': [1]}
pred_answer ['no', 'yes', 'yes', 'yes', 'no', 'yes', 'no', 'no', 'yes', 'no', 'no', 'no', 'yes', 'yes', 'yes', 'no'] , label: ('no', 'no', 'yes', 'maybe', 'maybe', 'maybe', 'maybe', 'maybe', 'yes', 'no', 'no', 'no', 'yes', 'yes', 'yes', 'maybe')
Batch: 6 , batch size: 16, sample_size: 100
answer  {'input_ids': [4273], 'attention_mask': [1]}
answer  {'input_ids': [150], 'attention_mask': [1]}
answer  {'input_ids': [2087], 'attention_mask': [1]}
pred_answer ['no', 'yes', 'yes', 'yes'] , label: ('no', 'yes', 'maybe', 'yes')
acc:  0.62
