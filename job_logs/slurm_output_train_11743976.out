/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/torch/utils/data/dataloader.py:561: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
task  SA
self.device  cuda
/home/lcur1101/ATCS_group3/marc_data/dataset_fr_train.json
sentence len :  20 pour un cadeau d enf
Time taken to execute pipeline function: 0:00:00.000037
Time taken to execute prompt gen: 0:00:00.000053
Time taken to execute mapping: 0:00:00.000251
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2133 MiB |   2133 MiB |   2133 MiB |      0 B   |
|       from large pool |   2132 MiB |   2132 MiB |   2132 MiB |      0 B   |
|       from small pool |      1 MiB |      1 MiB |      1 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |   2133 MiB |   2133 MiB |   2133 MiB |      0 B   |
|       from large pool |   2132 MiB |   2132 MiB |   2132 MiB |      0 B   |
|       from small pool |      1 MiB |      1 MiB |      1 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |   2133 MiB |   2133 MiB |   2133 MiB |      0 B   |
|       from large pool |   2132 MiB |   2132 MiB |   2132 MiB |      0 B   |
|       from small pool |      1 MiB |      1 MiB |      1 MiB |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2134 MiB |   2134 MiB |   2134 MiB |      0 B   |
|       from large pool |   2132 MiB |   2132 MiB |   2132 MiB |      0 B   |
|       from small pool |      2 MiB |      2 MiB |      2 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    775 KiB |  18404 KiB | 395260 KiB | 394485 KiB |
|       from large pool |      0 KiB |  16384 KiB | 393216 KiB | 393216 KiB |
|       from small pool |    775 KiB |   2044 KiB |   2044 KiB |   1269 KiB |
|---------------------------------------------------------------------------|
| Allocations           |     295    |     295    |     295    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |     198    |     198    |     198    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     295    |     295    |     295    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |     198    |     198    |     198    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      74    |      74    |       0    |
|       from large pool |      73    |      73    |      73    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |       2    |      25    |      24    |
|       from large pool |       0    |       1    |      24    |      24    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['negative', 'negative', 'positive', 'positive', 'positive', 'negative', 'negative', 'negative']
Time taken to execute classification (32): 0:00:00.997251
pred_answer  ['negative', 'negative', 'positive', 'positive', 'positive', 'negative', 'negative', 'negative']
mapped_labels  ['negative', 'negative', 'negative', 'positive', 'negative', 'negative', 'negative', 'positive']
Batch acc:  0.625

sentence len :  20 Ce papier photo me c
Time taken to execute pipeline function: 0:00:00.000021
Time taken to execute prompt gen: 0:00:00.000026
Time taken to execute mapping: 0:00:00.000061
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4338 MiB |   5931 MiB |   6884 MiB |   2545 MiB |
|       from large pool |   4337 MiB |   5929 MiB |   6786 MiB |   2449 MiB |
|       from small pool |      1 MiB |      2 MiB |     97 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   4338 MiB |   5931 MiB |   6884 MiB |   2545 MiB |
|       from large pool |   4337 MiB |   5929 MiB |   6786 MiB |   2449 MiB |
|       from small pool |      1 MiB |      2 MiB |     97 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4305 MiB |   5898 MiB |   6844 MiB |   2538 MiB |
|       from large pool |   4304 MiB |   5896 MiB |   6746 MiB |   2442 MiB |
|       from small pool |      1 MiB |      2 MiB |     97 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5972 MiB |   5972 MiB |   5972 MiB |      0 B   |
|       from large pool |   5968 MiB |   5968 MiB |   5968 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36210 KiB |  64476 KiB |   2706 MiB |   2671 MiB |
|       from large pool |  35730 KiB |  63980 KiB |   2608 MiB |   2573 MiB |
|       from small pool |    480 KiB |   2044 KiB |     98 MiB |     97 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     812    |     818    |    1122    |     310    |
|       from large pool |     509    |     512    |     704    |     195    |
|       from small pool |     303    |     307    |     418    |     115    |
|---------------------------------------------------------------------------|
| Active allocs         |     812    |     818    |    1122    |     310    |
|       from large pool |     509    |     512    |     704    |     195    |
|       from small pool |     303    |     307    |     418    |     115    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     190    |     190    |     190    |       0    |
|       from large pool |     188    |     188    |     188    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      20    |     396    |     378    |
|       from large pool |      14    |      17    |     289    |     275    |
|       from small pool |       4    |       5    |     107    |     103    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'negative', 'negative', 'negative', 'negative', 'negative', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.087753
pred_answer  ['positive', 'negative', 'negative', 'negative', 'negative', 'negative', 'positive', 'positive']
mapped_labels  ['positive', 'negative', 'positive', 'negative', 'positive', 'negative', 'positive', 'positive']
Batch acc:  0.75

sentence len :  20 Je nais pas reçu mon
Time taken to execute pipeline function: 0:00:00.000012
Time taken to execute prompt gen: 0:00:00.000020
Time taken to execute mapping: 0:00:00.000063
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   6519 MiB |   8112 MiB |  11606 MiB |   5087 MiB |
|       from large pool |   6517 MiB |   8110 MiB |  11412 MiB |   4895 MiB |
|       from small pool |      1 MiB |      2 MiB |    193 MiB |    192 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   6519 MiB |   8112 MiB |  11606 MiB |   5087 MiB |
|       from large pool |   6517 MiB |   8110 MiB |  11412 MiB |   4895 MiB |
|       from small pool |      1 MiB |      2 MiB |    193 MiB |    192 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   6469 MiB |   8062 MiB |  11546 MiB |   5076 MiB |
|       from large pool |   6468 MiB |   8060 MiB |  11352 MiB |   4884 MiB |
|       from small pool |      1 MiB |      2 MiB |    193 MiB |    192 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8168 MiB |   8168 MiB |   8168 MiB |      0 B   |
|       from large pool |   8164 MiB |   8164 MiB |   8164 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  51636 KiB | 584776 KiB |   5598 MiB |   5547 MiB |
|       from large pool |  51450 KiB | 584494 KiB |   5404 MiB |   5353 MiB |
|       from small pool |    186 KiB |   2044 KiB |    194 MiB |    193 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1328    |    1334    |    1948    |     620    |
|       from large pool |     920    |     923    |    1310    |     390    |
|       from small pool |     408    |     412    |     638    |     230    |
|---------------------------------------------------------------------------|
| Active allocs         |    1328    |    1334    |    1948    |     620    |
|       from large pool |     920    |     923    |    1310    |     390    |
|       from small pool |     408    |     412    |     638    |     230    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     223    |     223    |     223    |       0    |
|       from large pool |     221    |     221    |     221    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      26    |      27    |     701    |     675    |
|       from large pool |      20    |      23    |     486    |     466    |
|       from small pool |       6    |       6    |     215    |     209    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'positive', 'positive', 'negative', 'positive', 'positive', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.085881
pred_answer  ['positive', 'positive', 'positive', 'negative', 'positive', 'positive', 'positive', 'positive']
mapped_labels  ['negative', 'negative', 'positive', 'positive', 'positive', 'negative', 'positive', 'negative']
Batch acc:  0.375

sentence len :  20 Je suis déçue je vou
Time taken to execute pipeline function: 0:00:00.000012
Time taken to execute prompt gen: 0:00:00.000017
Time taken to execute mapping: 0:00:00.000087
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   8700 MiB |  10293 MiB |  16328 MiB |   7628 MiB |
|       from large pool |   8698 MiB |  10291 MiB |  16038 MiB |   7339 MiB |
|       from small pool |      2 MiB |      3 MiB |    290 MiB |    288 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   8700 MiB |  10293 MiB |  16328 MiB |   7628 MiB |
|       from large pool |   8698 MiB |  10291 MiB |  16038 MiB |   7339 MiB |
|       from small pool |      2 MiB |      3 MiB |    290 MiB |    288 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   8634 MiB |  10226 MiB |  16249 MiB |   7615 MiB |
|       from large pool |   8632 MiB |  10224 MiB |  15959 MiB |   7327 MiB |
|       from small pool |      2 MiB |      3 MiB |    290 MiB |    288 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10364 MiB |  10364 MiB |  10364 MiB |      0 B   |
|       from large pool |  10360 MiB |  10360 MiB |  10360 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  68999 KiB | 593179 KiB |   8497 MiB |   8430 MiB |
|       from large pool |  67060 KiB | 591144 KiB |   8205 MiB |   8140 MiB |
|       from small pool |   1939 KiB |   2048 KiB |    292 MiB |    290 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1844    |    1850    |    2774    |     930    |
|       from large pool |    1331    |    1334    |    1916    |     585    |
|       from small pool |     513    |     517    |     858    |     345    |
|---------------------------------------------------------------------------|
| Active allocs         |    1844    |    1850    |    2774    |     930    |
|       from large pool |    1331    |    1334    |    1916    |     585    |
|       from small pool |     513    |     517    |     858    |     345    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     256    |     256    |     256    |       0    |
|       from large pool |     254    |     254    |     254    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |      35    |     953    |     922    |
|       from large pool |      26    |      28    |     683    |     657    |
|       from small pool |       5    |       7    |     270    |     265    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['negative', 'positive', 'negative', 'positive', 'positive', 'negative', 'positive', 'negative']
Time taken to execute classification (32): 0:00:00.074199
pred_answer  ['negative', 'positive', 'negative', 'positive', 'positive', 'negative', 'positive', 'negative']
mapped_labels  ['negative', 'negative', 'negative', 'negative', 'negative', 'negative', 'negative', 'positive']
Batch acc:  0.375

sentence len :  20 Je suis totalement e
Time taken to execute pipeline function: 0:00:00.000012
Time taken to execute prompt gen: 0:00:00.000020
Time taken to execute mapping: 0:00:00.000096
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  10908 MiB |  12524 MiB |  21113 MiB |  10205 MiB |
|       from large pool |  10906 MiB |  12522 MiB |  20727 MiB |   9820 MiB |
|       from small pool |      2 MiB |      3 MiB |    386 MiB |    384 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  10908 MiB |  12524 MiB |  21113 MiB |  10205 MiB |
|       from large pool |  10906 MiB |  12522 MiB |  20727 MiB |   9820 MiB |
|       from small pool |      2 MiB |      3 MiB |    386 MiB |    384 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  10830 MiB |  12445 MiB |  21020 MiB |  10190 MiB |
|       from large pool |  10827 MiB |  12443 MiB |  20633 MiB |   9806 MiB |
|       from small pool |      2 MiB |      3 MiB |    386 MiB |    384 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  12600 MiB |  12600 MiB |  12600 MiB |      0 B   |
|       from large pool |  12596 MiB |  12596 MiB |  12596 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  77124 KiB | 600162 KiB |  11406 MiB |  11330 MiB |
|       from large pool |  75480 KiB | 598423 KiB |  11017 MiB |  10944 MiB |
|       from small pool |   1644 KiB |   2048 KiB |    388 MiB |    386 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    2360    |    2366    |    3600    |    1240    |
|       from large pool |    1742    |    1745    |    2522    |     780    |
|       from small pool |     618    |     622    |    1078    |     460    |
|---------------------------------------------------------------------------|
| Active allocs         |    2360    |    2366    |    3600    |    1240    |
|       from large pool |    1742    |    1745    |    2522    |     780    |
|       from small pool |     618    |     622    |    1078    |     460    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     290    |     290    |     290    |       0    |
|       from large pool |     288    |     288    |     288    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |      40    |    1162    |    1124    |
|       from large pool |      33    |      36    |     880    |     847    |
|       from small pool |       5    |       7    |     282    |     277    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['negative', 'positive', 'negative', 'positive', 'positive', 'positive', 'positive', 'negative']
Time taken to execute classification (32): 0:00:00.076546
pred_answer  ['negative', 'positive', 'negative', 'positive', 'positive', 'positive', 'positive', 'negative']
mapped_labels  ['negative', 'positive', 'negative', 'positive', 'positive', 'positive', 'positive', 'positive']
Batch acc:  0.875

sentence len :  20 Parfait pour moi. Ut
Time taken to execute pipeline function: 0:00:00.000011
Time taken to execute prompt gen: 0:00:00.000016
Time taken to execute mapping: 0:00:00.000044
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  13149 MiB |  14789 MiB |  25968 MiB |  12819 MiB |
|       from large pool |  13146 MiB |  14786 MiB |  25485 MiB |  12338 MiB |
|       from small pool |      2 MiB |      3 MiB |    483 MiB |    480 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  13149 MiB |  14789 MiB |  25968 MiB |  12819 MiB |
|       from large pool |  13146 MiB |  14786 MiB |  25485 MiB |  12338 MiB |
|       from small pool |      2 MiB |      3 MiB |    483 MiB |    480 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  13057 MiB |  14696 MiB |  25860 MiB |  12802 MiB |
|       from large pool |  13055 MiB |  14693 MiB |  25377 MiB |  12322 MiB |
|       from small pool |      2 MiB |      3 MiB |    482 MiB |    480 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14920 MiB |  14920 MiB |  14920 MiB |      0 B   |
|       from large pool |  14916 MiB |  14916 MiB |  14916 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 133795 KiB | 622690 KiB |  14389 MiB |  14258 MiB |
|       from large pool | 132447 KiB | 621247 KiB |  13904 MiB |  13775 MiB |
|       from small pool |   1347 KiB |   2048 KiB |    484 MiB |    483 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    2876    |    2882    |    4426    |    1550    |
|       from large pool |    2153    |    2156    |    3128    |     975    |
|       from small pool |     723    |     727    |    1298    |     575    |
|---------------------------------------------------------------------------|
| Active allocs         |    2876    |    2882    |    4426    |    1550    |
|       from large pool |    2153    |    2156    |    3128    |     975    |
|       from small pool |     723    |     727    |    1298    |     575    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     327    |     327    |     327    |       0    |
|       from large pool |     325    |     325    |     325    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |      74    |    1346    |    1273    |
|       from large pool |      67    |      69    |    1052    |     985    |
|       from small pool |       6    |       7    |     294    |     288    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'positive', 'negative', 'positive', 'positive', 'negative', 'negative', 'positive']
Time taken to execute classification (32): 0:00:00.071896
pred_answer  ['positive', 'positive', 'negative', 'positive', 'positive', 'negative', 'negative', 'positive']
mapped_labels  ['positive', 'negative', 'positive', 'positive', 'positive', 'positive', 'negative', 'negative']
Batch acc:  0.5

sentence len :  20 J'ai acheté ce produ
Time taken to execute pipeline function: 0:00:00.000009
Time taken to execute prompt gen: 0:00:00.000014
Time taken to execute mapping: 0:00:00.000041
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  15357 MiB |  16973 MiB |  30752 MiB |  15395 MiB |
|       from large pool |  15354 MiB |  16970 MiB |  30173 MiB |  14819 MiB |
|       from small pool |      2 MiB |      3 MiB |    579 MiB |    576 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  15357 MiB |  16973 MiB |  30752 MiB |  15395 MiB |
|       from large pool |  15354 MiB |  16970 MiB |  30173 MiB |  14819 MiB |
|       from small pool |      2 MiB |      3 MiB |    579 MiB |    576 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  15253 MiB |  16869 MiB |  30631 MiB |  15377 MiB |
|       from large pool |  15251 MiB |  16866 MiB |  30052 MiB |  14801 MiB |
|       from small pool |      2 MiB |      3 MiB |    579 MiB |    576 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17136 MiB |  17136 MiB |  17136 MiB |      0 B   |
|       from large pool |  17132 MiB |  17132 MiB |  17132 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 166716 KiB | 701612 KiB |  17331 MiB |  17168 MiB |
|       from large pool | 165664 KiB | 700464 KiB |  16751 MiB |  16589 MiB |
|       from small pool |   1052 KiB |   2048 KiB |    580 MiB |    579 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    3392    |    3398    |    5252    |    1860    |
|       from large pool |    2564    |    2567    |    3734    |    1170    |
|       from small pool |     828    |     832    |    1518    |     690    |
|---------------------------------------------------------------------------|
| Active allocs         |    3392    |    3398    |    5252    |    1860    |
|       from large pool |    2564    |    2567    |    3734    |    1170    |
|       from small pool |     828    |     832    |    1518    |     690    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     360    |     360    |     360    |       0    |
|       from large pool |     358    |     358    |     358    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |      85    |    1555    |    1473    |
|       from large pool |      76    |      79    |    1247    |    1171    |
|       from small pool |       6    |       7    |     308    |     302    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'positive', 'negative', 'negative', 'negative', 'positive', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.071791
pred_answer  ['positive', 'positive', 'negative', 'negative', 'negative', 'positive', 'positive', 'positive']
mapped_labels  ['positive', 'negative', 'negative', 'negative', 'positive', 'positive', 'negative', 'negative']
Batch acc:  0.5

sentence len :  20 J utilise se coffret
Time taken to execute pipeline function: 0:00:00.000010
Time taken to execute prompt gen: 0:00:00.000015
Time taken to execute mapping: 0:00:00.000041
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17564 MiB |  19180 MiB |  35536 MiB |  17972 MiB |
|       from large pool |  17561 MiB |  19177 MiB |  34861 MiB |  17299 MiB |
|       from small pool |      3 MiB |      4 MiB |    675 MiB |    672 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  17564 MiB |  19180 MiB |  35536 MiB |  17972 MiB |
|       from large pool |  17561 MiB |  19177 MiB |  34861 MiB |  17299 MiB |
|       from small pool |      3 MiB |      4 MiB |    675 MiB |    672 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  17449 MiB |  19065 MiB |  35402 MiB |  17952 MiB |
|       from large pool |  17446 MiB |  19062 MiB |  34727 MiB |  17280 MiB |
|       from small pool |      3 MiB |      4 MiB |    675 MiB |    672 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19354 MiB |  19354 MiB |  19354 MiB |      0 B   |
|       from large pool |  19348 MiB |  19348 MiB |  19348 MiB |      0 B   |
|       from small pool |      6 MiB |      6 MiB |      6 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 175421 KiB | 710835 KiB |  20268 MiB |  20097 MiB |
|       from large pool | 174664 KiB | 709983 KiB |  19591 MiB |  19421 MiB |
|       from small pool |    756 KiB |   2048 KiB |    676 MiB |    675 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    3908    |    3914    |    6078    |    2170    |
|       from large pool |    2975    |    2978    |    4340    |    1365    |
|       from small pool |     933    |     937    |    1738    |     805    |
|---------------------------------------------------------------------------|
| Active allocs         |    3908    |    3914    |    6078    |    2170    |
|       from large pool |    2975    |    2978    |    4340    |    1365    |
|       from small pool |     933    |     937    |    1738    |     805    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     394    |     394    |     394    |       0    |
|       from large pool |     391    |     391    |     391    |       0    |
|       from small pool |       3    |       3    |       3    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      88    |      91    |    1858    |    1770    |
|       from large pool |      83    |      85    |    1442    |    1359    |
|       from small pool |       5    |       7    |     416    |     411    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

pred_answer ['positive', 'positive', 'negative', 'negative', 'positive', 'positive', 'positive', 'positive']
Time taken to execute classification (32): 0:00:00.071825
pred_answer  ['positive', 'positive', 'negative', 'negative', 'positive', 'positive', 'positive', 'positive']
mapped_labels  ['positive', 'negative', 'negative', 'negative', 'positive', 'positive', 'negative', 'positive']
Batch acc:  0.75

sentence len :  20 Impeccable facile à 
Time taken to execute pipeline function: 0:00:00.000020
Time taken to execute prompt gen: 0:00:00.000036
Time taken to execute mapping: 0:00:00.000112
summary:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  19805 MiB |  21445 MiB |  40391 MiB |  20586 MiB |
|       from large pool |  19801 MiB |  21441 MiB |  39619 MiB |  19817 MiB |
|       from small pool |      3 MiB |      4 MiB |    772 MiB |    768 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  19805 MiB |  21445 MiB |  40391 MiB |  20586 MiB |
|       from large pool |  19801 MiB |  21441 MiB |  39619 MiB |  19817 MiB |
|       from small pool |      3 MiB |      4 MiB |    772 MiB |    768 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  19677 MiB |  21316 MiB |  40242 MiB |  20564 MiB |
|       from large pool |  19674 MiB |  21312 MiB |  39470 MiB |  19796 MiB |
|       from small pool |      3 MiB |      4 MiB |    771 MiB |    768 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  21674 MiB |  21674 MiB |  21674 MiB |      0 B   |
|       from large pool |  21668 MiB |  21668 MiB |  21668 MiB |      0 B   |
|       from small pool |      6 MiB |      6 MiB |      6 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231907 KiB | 717854 KiB |  23258 MiB |  23031 MiB |
|       from large pool | 231447 KiB | 717239 KiB |  22485 MiB |  22259 MiB |
|       from small pool |    460 KiB |   2048 KiB |    772 MiB |    772 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    4430    |    6904    |    2480    |
|       from large pool |    3386    |    3389    |    4946    |    1560    |
|       from small pool |    1038    |    1042    |    1958    |     920    |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    4430    |    6904    |    2480    |
|       from large pool |    3386    |    3389    |    4946    |    1560    |
|       from small pool |    1038    |    1042    |    1958    |     920    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     431    |     431    |     431    |       0    |
|       from large pool |     428    |     428    |     428    |       0    |
|       from small pool |       3    |       3    |       3    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     123    |     125    |    2159    |    2036    |
|       from large pool |     118    |     120    |    1635    |    1517    |
|       from small pool |       5    |       7    |     524    |     519    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Traceback (most recent call last):
  File "/home/lcur1101/ATCS_group3/code/pipeline_file.py", line 217, in <module>
    acc = pipeline(LM_model, task, prompt_generator)
  File "/home/lcur1101/ATCS_group3/code/pipeline_file.py", line 171, in pipeline
    answers_probs_batch, pred_answer_batch = model(
  File "/home/lcur1101/ATCS_group3/code/main_model.py", line 40, in __call__
    outputs = self.model(**inputs, labels=inputs["input_ids"])
  File "/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/transformers/models/bloom/modeling_bloom.py", line 938, in forward
    loss = loss_fct(
  File "/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1174, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/home/lcur1101/.conda/envs/dl2022/lib/python3.10/site-packages/torch/nn/functional.py", line 3029, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 536.00 MiB (GPU 0; 23.65 GiB total capacity; 22.55 GiB already allocated; 123.56 MiB free; 22.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
srun: error: r35n4: task 0: Exited with exit code 1
